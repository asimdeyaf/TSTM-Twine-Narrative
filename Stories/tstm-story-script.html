<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>The Simulation™ - Story Script</title>
<style title="Twine CSS">@keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes fade-in-out{0%,to{opacity:0}50%{opacity:1}}@keyframes rumble{25%{top:-0.1em}75%{top:.1em}0%,to{top:0px}}@keyframes shudder{25%{left:.1em}75%{left:-0.1em}0%,to{left:0px}}@keyframes buoy{25%{top:.25em}75%{top:-0.25em}0%,to{top:0px}}@keyframes sway{25%{left:.25em}75%{left:-0.25em}0%,to{left:0px}}@keyframes pulse{0%{transform:scale(0, 0)}20%{transform:scale(1.2, 1.2)}40%{transform:scale(0.9, 0.9)}60%{transform:scale(1.05, 1.05)}80%{transform:scale(0.925, 0.925)}to{transform:scale(1, 1)}}@keyframes zoom-in{0%{transform:scale(0, 0)}to{transform:scale(1, 1)}}@keyframes shudder-in{0%,to{transform:translateX(0em)}5%,25%,45%{transform:translateX(-1em)}15%,35%,55%{transform:translateX(1em)}65%{transform:translateX(-0.6em)}75%{transform:translateX(0.6em)}85%{transform:translateX(-0.2em)}95%{transform:translateX(0.2em)}}@keyframes rumble-in{0%,to{transform:translateY(0em)}5%,25%,45%{transform:translateY(-1em)}15%,35%,55%{transform:translateY(1em)}65%{transform:translateY(-0.6em)}75%{transform:translateY(0.6em)}85%{transform:translateY(-0.2em)}95%{transform:translateY(0.2em)}}@keyframes fidget{0%,8.1%,82.1%,31.1%,38.1%,44.1%,40.1%,47.1%,74.1%,16.1%,27.1%,72.1%,24.1%,95.1%,6.1%,36.1%,20.1%,4.1%,91.1%,14.1%,87.1%,to{left:0px;top:0px}8%,82%,31%,38%,44%{left:-1px}40%,47%,74%,16%,27%{left:1px}72%,24%,95%,6%,36%{top:-1px}20%,4%,91%,14%,87%{top:1px}}@keyframes slide-right{0%{transform:translateX(-100vw)}}@keyframes slide-left{0%{transform:translateX(100vw)}}@keyframes slide-up{0%{transform:translateY(100vh)}}@keyframes slide-down{0%{transform:translateY(-100vh)}}@keyframes fade-right{0%{opacity:0;transform:translateX(-1em)}to{opacity:1}}@keyframes fade-left{0%{opacity:0;transform:translateX(1em)}to{opacity:1}}@keyframes fade-up{0%{opacity:0;transform:translateY(1em)}to{opacity:1}}@keyframes fade-down{0%{opacity:0;transform:translateY(-1em)}to{opacity:1}}@keyframes flicker{0%,29%,31%,63%,65%,77%,79%,86%,88%,91%,93%{opacity:0}30%{opacity:.2}64%{opacity:.4}78%{opacity:.6}87%{opacity:.8}92%,to{opacity:1}}@keyframes blur{0%{filter:blur(2rem);opacity:0}25%{opacity:1}to{filter:blur(0rem);opacity:1}}.dom-debug-mode tw-story,.dom-debug-mode tw-passage,.dom-debug-mode tw-sidebar,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{outline:1px solid #f5a3da;min-height:32px;display:block !important}.dom-debug-mode tw-story::before,.dom-debug-mode tw-passage::before,.dom-debug-mode tw-sidebar::before,.dom-debug-mode tw-include::before,.dom-debug-mode tw-hook::before,.dom-debug-mode tw-expression::before,.dom-debug-mode tw-link::before,.dom-debug-mode tw-dialog::before,.dom-debug-mode tw-columns::before,.dom-debug-mode tw-column::before,.dom-debug-mode tw-align::before{position:absolute;top:0;left:0;height:16px;background-color:#f5a3da;color:#000;font-size:16px;font-weight:normal;font-style:normal;font-family:monospace;display:inline-block;line-height:100%;white-space:pre;z-index:999997}.dom-debug-mode tw-story:hover,.dom-debug-mode tw-passage:hover,.dom-debug-mode tw-sidebar:hover,.dom-debug-mode tw-include:hover,.dom-debug-mode tw-hook:hover,.dom-debug-mode tw-expression:hover,.dom-debug-mode tw-link:hover,.dom-debug-mode tw-dialog:hover,.dom-debug-mode tw-columns:hover,.dom-debug-mode tw-column:hover,.dom-debug-mode tw-align:hover{outline:1px solid #fc9}.dom-debug-mode tw-story:hover::before,.dom-debug-mode tw-passage:hover::before,.dom-debug-mode tw-sidebar:hover::before,.dom-debug-mode tw-include:hover::before,.dom-debug-mode tw-hook:hover::before,.dom-debug-mode tw-expression:hover::before,.dom-debug-mode tw-link:hover::before,.dom-debug-mode tw-dialog:hover::before,.dom-debug-mode tw-columns:hover::before,.dom-debug-mode tw-column:hover::before,.dom-debug-mode tw-align:hover::before{background-color:#fc9;transition:background-color 1s}.dom-debug-mode tw-passage,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{padding:1em;margin:0}.dom-debug-mode tw-story::before{content:'<tw-story tags="' attr(tags) '">'}.dom-debug-mode tw-passage::before{top:-16px;content:'<tw-passage tags="' attr(tags) '">'}.dom-debug-mode tw-sidebar::before{top:-16px;content:"<tw-sidebar>"}.dom-debug-mode tw-hook::before{content:'<tw-hook name="' attr(name) '">'}.dom-debug-mode tw-expression::before{content:'<tw-expression name="' attr(name) '">'}.dom-debug-mode tw-link::before{content:'<tw-link name="' attr(name) '">'}.dom-debug-mode tw-dialog::before{content:"<tw-dialog>"}.dom-debug-mode tw-columns::before{content:"<tw-columns>"}.dom-debug-mode tw-column::before{content:"<tw-column>"}.dom-debug-mode tw-align::before{content:"<tw-align>"}.dom-debug-mode tw-include::before{content:'<tw-include type="' attr(type) '" name="' attr(name) '">'}tw-open-button[goto]{display:none}.debug-mode tw-open-button[replay],.debug-mode tw-open-button[goto]{display:inline}.debug-mode tw-expression{display:inline-block !important}.debug-mode tw-expression[type=variable]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"$" attr(name)}.debug-mode tw-expression[type=tempVariable]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"_" attr(name)}.debug-mode tw-expression[return=boolean]{background-color:rgba(179,179,179,.2)}.debug-mode tw-expression[return=array]{background-color:rgba(255,102,102,.2)}.debug-mode tw-expression[return=dataset]{background-color:rgba(255,128,0,.2)}.debug-mode tw-expression[return=number]{background-color:rgba(255,179,102,.2)}.debug-mode tw-expression[return=datamap]{background-color:rgba(255,255,102,.2)}.debug-mode tw-expression[return=changer]{background-color:rgba(179,255,102,.2)}.debug-mode tw-expression[return=lambda]{background-color:rgba(102,255,102,.2)}.debug-mode tw-expression[return=hookname]{background-color:rgba(102,255,204,.2)}.debug-mode tw-expression[return=string]{background-color:rgba(102,255,255,.2)}.debug-mode tw-expression[return=datatype]{background-color:rgba(102,153,255,.2)}.debug-mode tw-expression[return=gradient],.debug-mode tw-expression[return=colour]{background-color:rgba(204,102,255,.2)}.debug-mode tw-expression[return=instant],.debug-mode tw-expression[return=macro]{background-color:rgba(240,117,199,.2)}.debug-mode tw-expression[return=command]{background-color:rgba(153,153,255,.2)}.debug-mode tw-expression.false{background-color:rgba(255,0,0,.2) !important}.debug-mode tw-expression[type=macro]::before{content:"(" attr(name) ":)";padding:0 .5rem;font-size:1rem;vertical-align:middle;line-height:normal;background-color:inherit;border:1px solid rgba(255,255,255,.5)}.debug-mode tw-expression[title]:not([title=""]){cursor:help}.debug-mode tw-hook{background-color:rgba(0,85,255,.1) !important}.debug-mode tw-hook::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"["}.debug-mode tw-hook::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"]"}.debug-mode tw-hook[name]::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"]<" attr(name) "|"}.debug-mode tw-pseudo-hook{background-color:rgba(255,170,0,.1) !important}.debug-mode tw-collapsed::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"{"}.debug-mode tw-collapsed::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"}"}.debug-mode tw-verbatim::before,.debug-mode tw-verbatim::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:"`"}.debug-mode tw-align[style*="text-align: center"]{background:linear-gradient(to right, hsla(14deg, 100%, 87%, 0) 0%, hsla(14deg, 100%, 87%, 0.25) 50%, hsla(14deg, 100%, 87%, 0) 100%)}.debug-mode tw-align[style*="text-align: left"]{background:linear-gradient(to right, hsla(14deg, 100%, 87%, 0.25) 0%, hsla(14deg, 100%, 87%, 0) 100%)}.debug-mode tw-align[style*="text-align: right"]{background:linear-gradient(to right, hsla(14deg, 100%, 87%, 0) 0%, hsla(14deg, 100%, 87%, 0.25) 100%)}.debug-mode tw-column{background-color:rgba(189,228,255,.2)}.debug-mode tw-enchantment{animation:enchantment .5s infinite;border:1px solid}.debug-mode tw-link::after,.debug-mode tw-broken-link::after{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:attr(passage-name)}.debug-mode tw-include{background-color:rgba(204,128,51,.1)}.debug-mode tw-include::before{font-size:.8rem;padding-left:.2rem;padding-right:.2rem;vertical-align:top;content:attr(type) ' "' attr(name) '"'}.debug-dialogs tw-backdrop:not(.eval-replay):not(.harlowe-crash){pointer-events:none;opacity:.1}tw-eval-replay tw-eval-code,tw-eval-replay tw-eval-explanation{max-height:20vh;overflow:auto;margin:10px auto}tw-eval-replay tw-eval-code{display:block;font-family:monospace;padding-bottom:1ex;border-bottom:2px solid gray}tw-eval-replay tw-eval-explanation{display:block;text-align:center}tw-eval-replay tw-eval-explanation>code{white-space:pre-wrap}tw-eval-replay tw-eval-explanation>code.from-block{width:40%;display:inline-block;text-align:left;max-height:4em;overflow-wrap:anywhere;overflow-y:scroll}tw-eval-replay tw-eval-explanation>code.from-block~.to-desc{width:calc(40% - 2em);margin-left:2em;display:inline-block}tw-eval-replay tw-eval-explanation>code.from-block+span::after{content:"..."}tw-eval-replay tw-eval-explanation>code.from-inline{text-align:right}tw-eval-replay tw-eval-explanation>:nth-child(2){white-space:pre}tw-eval-replay tw-eval-explanation>.to-desc{text-align:left}tw-eval-replay tw-eval-explanation>table{width:100%;margin-top:1em}tw-eval-replay tw-eval-explanation>table td{white-space:pre-wrap !important;word-wrap:anywhere}tw-eval-replay tw-eval-reason{text-align:center;font-size:80%;font-style:italic;display:block}tw-eval-replay tw-eval-it{text-align:center;font-size:80%;display:block}tw-eval-replay tw-dialog-links{display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around}@keyframes enchantment{0%,to{border-color:#ffb366}50%{border-color:#6fc}}tw-debugger{position:fixed;box-sizing:border-box;bottom:0;right:0;z-index:999999;min-width:14em;min-height:1em;padding:0em .5em .5em 1em;font-size:1.25em;font-family:sans-serif;color:#262626;background-color:#fff;border-left:solid #262626 2px;border-top:solid #262626 2px;border-top-left-radius:.5em;opacity:1}tw-debugger.fade-panel:not(:hover){opacity:.33}tw-debugger.theme-dark{color:#d9d9d9;background-color:#000}tw-debugger.theme-dark{border-color:#d9d9d9 rgba(0,0,0,0) rgba(0,0,0,0) #d9d9d9}tw-debugger select{margin-right:1em;width:12em}tw-debugger button,tw-debugger tw-link{border-radius:3px;border:solid #999 1px;margin:auto 4px;color:#262626;background-color:#fff;cursor:pointer}tw-debugger button.enabled,tw-debugger tw-link.enabled{color:#000;background-color:#d9d9d9;box-shadow:inset #999 3px 5px .5em}tw-debugger.theme-dark button,tw-debugger.theme-dark tw-link{color:#d9d9d9;background-color:#000;border-color:#666}tw-debugger.theme-dark button.enabled,tw-debugger.theme-dark tw-link.enabled{color:#e6e6e6;background-color:#424242;box-shadow:inset #666 3px 5px .5em}tw-debugger button{font-size:1em;overflow-x:hidden;text-overflow:ellipsis;white-space:pre}tw-debugger tw-link{font-size:1.25em;border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}tw-debugger tw-link:hover{border-color:#262626;color:#262626}tw-debugger.theme-dark tw-link:hover{border-color:#d9d9d9;color:#d9d9d9}tw-debugger tw-dialog{background-color:#fff;color:#000;font-size:1.25em}tw-debugger.theme-dark tw-dialog{background-color:#000;color:#e6e6e6}tw-debugger .panel{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:absolute;bottom:100%;left:-2px;right:0;padding:1em;overflow-y:scroll;overflow-x:hidden;border:inherit;box-sizing:content-box;background-color:#fff;border-bottom:solid #999 2px;border-top-left-radius:.5em;border-bottom-left-radius:.5em;font-size:.8em}tw-debugger .panel:empty,tw-debugger .panel[hidden]{display:none}tw-debugger.theme-dark .panel{background-color:#000;border-bottom-color:#666}tw-debugger .panel-source .panel-row-buttons{width:2rem}tw-debugger .panel-source .source-tags{width:20%;font-style:italic}tw-debugger .panel-row-source td{font-family:monospace;font-size:1rem;white-space:pre-wrap;overflow-wrap:anywhere;max-height:8rem;padding:1rem}tw-debugger .panel-rows{width:100%;overflow-x:scroll}tw-debugger .panel-rows>*{display:table-row}tw-debugger .panel-rows>div:nth-of-type(2n){background-color:#e6e6e6}tw-debugger .panel-tools .panel-rows>*,tw-debugger .panel-options .panel-rows>*{margin-top:.4rem;display:block}tw-debugger.theme-dark .panel-rows>div:nth-of-type(2n){background-color:#212121}tw-debugger .panel-row-buttons{text-align:right}tw-debugger .panel-variables .panel-rows:empty::before{content:"~ No variables ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-enchantments .panel-rows:empty::before{content:"~ No enchantments ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-errors .panel-rows:empty::before{content:"~ No errors... for now. ~";font-style:italic;color:#575757;text-align:center}tw-debugger .panel-errors .panel-rows:empty+.panel-errors-bottom{display:none}tw-debugger.theme-dark .panel-variables .panel-rows:empty::before,tw-debugger.theme-dark .panel-enchantments .panel-rows:empty::before,tw-debugger.theme-dark .panel-errors .panel-rows:empty::before{color:#a8a8a8}tw-debugger .panel-rows:empty+.panel-variables-bottom{display:none}tw-debugger th[data-col]{text-decoration:underline;cursor:pointer}tw-debugger th[data-col][data-order=asc]::after{content:"↓"}tw-debugger th[data-col][data-order=desc]::after{content:"↑"}tw-debugger .panel-storylets:not(.panel-exclusive) .storylet-exclusive,tw-debugger .panel-storylets:not(.panel-urgent) .storylet-urgent{display:none}tw-debugger .storylet-exclusive,tw-debugger .storylet-urgent,tw-debugger .storylet-open{text-align:center}tw-debugger .panel-variables-bottom{padding-top:5px}tw-debugger .enchantment-row{min-height:1.5em}tw-debugger .variable-path{opacity:.4}tw-debugger .temporary-variable-scope,tw-debugger .enchantment-local{font-family:sans-serif;font-weight:normal;opacity:.8;font-size:.75em}tw-debugger .temporary-variable-scope:not(:empty)::before,tw-debugger .enchantment-local:not(:empty)::before{content:" in "}tw-debugger .variable-name,tw-debugger .enchantment-name{font-family:monospace;font-weight:bold}tw-debugger .variable-type{color:#575757;font-weight:normal;text-overflow:ellipsis;overflow:hidden;max-width:10em}tw-debugger.theme-dark .variable-type{color:#a8a8a8}tw-debugger .error-row{display:table-row;background-color:rgba(230,101,204,.3)}tw-debugger .error-row:nth-of-type(2n){background-color:rgba(237,145,219,.3)}tw-debugger .error-row>*{display:table-cell;padding:.25em .5em}tw-debugger .error-row .error-message[title]:not([title=""]){cursor:help}tw-debugger .error-row .error-passage{color:#575757}tw-debugger.theme-dark .error-row .error-passage{color:#a8a8a8}tw-debugger .storylet-row{background-color:rgba(193,240,225,.3)}tw-debugger .storylet-row:nth-child(2n){background-color:rgba(152,231,204,.3)}tw-debugger .storylet-row.storylet-closed{font-style:italic;background-color:#fff}tw-debugger .storylet-row.storylet-closed:nth-child(2n){background-color:#e6e6e6}tw-debugger .storylet-row.storylet-closed>:not(.storylet-lambda){opacity:.6}.storylet-error tw-debugger .storylet-row{background-color:rgba(230,101,204,.3)}.storylet-error tw-debugger .storylet-row:nth-child(2n){background-color:rgba(237,145,219,.3)}tw-debugger .storylet-row .storylet-name,tw-debugger .storylet-row .storylet-value{display:inline-block;width:50%}tw-debugger .storylet-row .storylet-lambda{font-family:monospace;font-size:1rem;white-space:pre-wrap;overflow-wrap:anywhere}tw-debugger.theme-dark .storylet-row.storylet-closed{background-color:#000}tw-debugger.theme-dark .storylet-row.storylet-closed:nth-child(2n){background-color:#212121}tw-debugger .tabs{padding-bottom:.5em}tw-debugger .tab{border-radius:0px 0px .5em .5em;border-top:none;top:-2px}tw-debugger .resizer-h{position:absolute;height:14em;border-left:2px solid #999;border-right:2px solid #999;top:10px;left:4px;width:8px;cursor:ew-resize}tw-debugger.theme-dark .resizer-h{border-color:rgba(0,0,0,0) #666}tw-debugger .resizer-v{position:absolute;height:8px;border-top:2px solid #999;border-bottom:2px solid #999;margin-bottom:4px;top:4px;left:10px;width:95%;cursor:ns-resize;box-sizing:border-box}tw-debugger.theme-dark .resizer-v{border-color:#666 rgba(0,0,0,0)}tw-debugger mark{color:inherit;background-color:rgba(101,230,230,.3) !important}tw-dialog{z-index:999997;border:#fff solid 2px;padding:2em;color:#fff;background-color:#000;display:block}@media(min-width: 576px){tw-dialog{max-width:50vw}}tw-dialog input[type=text]{font-size:inherit;width:100%;border:solid #fff !important}tw-dialog-links{text-align:right;display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}tw-backdrop{z-index:999996;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.8);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}tw-backdrop~tw-backdrop{display:none}tw-link,.enchantment-link{cursor:pointer;color:#4169e1;font-weight:bold;text-decoration:none;transition:color .2s ease-in-out}tw-passage [style^=color] tw-link:not(:hover),tw-passage [style*=" color"] tw-link:not(:hover),tw-passage [style^=color][hover=true] tw-link:hover,tw-passage [style*=" color"][hover=true] tw-link:hover,tw-passage [style^=color] .enchantment-link:not(:hover),tw-passage [style*=" color"] .enchantment-link:not(:hover),tw-passage [style^=color][hover=true] .enchantment-link:hover,tw-passage [style*=" color"][hover=true] .enchantment-link:hover{color:inherit}tw-link:hover,.enchantment-link:hover{color:#00bfff}tw-link:active,.enchantment-link:active{color:#dd4b39}.visited{color:#6941e1}tw-passage [style^=color] .visited:not(:hover),tw-passage [style*=" color"] .visited:not(:hover),tw-passage [style^=color][hover=true] .visited:hover,tw-passage [style*=" color"][hover=true] .visited:hover{color:inherit}.visited:hover{color:#e3e}tw-broken-link{color:#933;border-bottom:2px solid #933;cursor:not-allowed}tw-passage [style^=color] tw-broken-link:not(:hover),tw-passage [style*=" color"] tw-broken-link:not(:hover),tw-passage [style^=color][hover=true] tw-broken-link:hover,tw-passage [style*=" color"][hover=true] tw-broken-link:hover{color:inherit}tw-link.enchantment-mouseover,.link.enchantment-mouseover,tw-expression.enchantment-mouseover>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;border-bottom:2px dashed #999}tw-link.enchantment-mouseover:hover,tw-link.enchantment-mouseover:active,.link.enchantment-mouseover:hover,.link.enchantment-mouseover:active,tw-expression.enchantment-mouseover>tw-link:hover,tw-expression.enchantment-mouseover>tw-link:active{color:inherit}tw-link.enchantment-mouseover.enchantment-button,.link.enchantment-mouseover.enchantment-button,tw-expression.enchantment-mouseover>tw-link.enchantment-button{border-style:dashed}tw-link.enchantment-mouseout,.link.enchantment-mouseout,tw-expression.enchantment-mouseout>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;border:rgba(64,149,191,.6) 1px solid;border-radius:.2em}tw-link.enchantment-mouseout:hover,tw-link.enchantment-mouseout:active,.link.enchantment-mouseout:hover,.link.enchantment-mouseout:active,tw-expression.enchantment-mouseout>tw-link:hover,tw-expression.enchantment-mouseout>tw-link:active{color:inherit}tw-link.enchantment-mouseout:hover,.link.enchantment-mouseout:hover,tw-expression.enchantment-mouseout>tw-link:hover{background-color:rgba(175,197,207,.75);border:rgba(0,0,0,0) 1px solid}tw-link.enchantment-dblclick,.link.enchantment-dblclick,tw-expression.enchantment-dblclick>tw-link{color:inherit;font-weight:inherit;transition:none;cursor:inherit;cursor:pointer;border:2px solid #999;border-radius:0}tw-link.enchantment-dblclick:hover,tw-link.enchantment-dblclick:active,.link.enchantment-dblclick:hover,.link.enchantment-dblclick:active,tw-expression.enchantment-dblclick>tw-link:hover,tw-expression.enchantment-dblclick>tw-link:active{color:inherit}tw-link.enchantment-dblclick:active,.link.enchantment-dblclick:active,tw-expression.enchantment-dblclick>tw-link:active{background-color:#999}tw-link.enchantment-button,.link.enchantment-button,.enchantment-button:not(.link) tw-link,.enchantment-button:not(.link) .link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}.enchantment-button{display:block}.enchantment-clickblock{cursor:pointer;width:100%;height:100%;display:block}.enchantment-clickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;color:rgba(65,105,225,.5);transition:color .2s ease-in-out}.enchantment-clickblock>:not(tw-enchantment):hover::after{color:rgba(0,191,255,.5)}.enchantment-clickblock>:not(tw-enchantment):active::after{color:rgba(222,78,59,.5)}.enchantment-clickblock>:not(tw-enchantment)::after{box-shadow:inset 0 0 0 .5vmax}.enchantment-clickblock>tw-passage::after,.enchantment-clickblock>tw-sidebar::after{box-shadow:0 0 0 .5vmax}.enchantment-mouseoverblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:2px dashed #999}.enchantment-mouseoutblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:rgba(64,149,191,.6) 2px solid}.enchantment-mouseoutblock:hover>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;background-color:rgba(175,197,207,.75);border:rgba(0,0,0,0) 2px solid;border-radius:.2em}.enchantment-dblclickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;cursor:pointer;border:2px solid #999}tw-dialog-links{padding-top:1.5em}tw-dialog-links tw-link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block;display:inline-block}html{margin:0;height:100%;overflow-x:hidden}*,:before,:after{position:relative;box-sizing:inherit}body{margin:0;height:100%}tw-storydata{display:none}tw-story{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font:100% Georgia,serif;box-sizing:border-box;width:100%;min-height:100%;font-size:1.5em;line-height:1.5em;padding:5% 5%;overflow:hidden;background-color:#000;color:#fff}tw-story [style*=content-box] *{box-sizing:border-box}@media(min-width: 576px){tw-story{padding:5% 20%}}tw-story tw-consecutive-br{display:block;height:1.6ex;visibility:hidden}tw-story select{background-color:rgba(0,0,0,0);font:inherit;border-style:solid;padding:2px}tw-story select:not([disabled]){color:inherit}tw-story textarea{resize:none;background-color:rgba(0,0,0,0);font:inherit;color:inherit;border-style:none;padding:2px}tw-story input[type=text]{background-color:rgba(0,0,0,0);font:inherit;color:inherit;border-style:none}tw-story input[type=checkbox]{transform:scale(1.5);margin:0 .5em .5em .5em;vertical-align:middle}tw-story tw-noscript{animation:appear .8s}tw-passage{display:block}tw-sidebar{text-align:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}@media(min-width: 576px){tw-sidebar{left:-5em;width:3em;position:absolute;-ms-flex-direction:column;flex-direction:column}tw-enchantment[style*=width]>tw-sidebar{width:inherit}}tw-icon{display:inline-block;margin:.5em 0;font-size:66px;font-family:"Verdana",sans-serif}tw-icon[alt]{opacity:.2;cursor:pointer}tw-icon[alt]:hover{opacity:.4}tw-icon[data-label]::after{font-weight:bold;content:attr(data-label);font-size:20px;bottom:-20px;left:-50%;white-space:nowrap}tw-meter{display:block}tw-hook:empty,tw-expression:empty{display:none}tw-error{display:inline-block;border-radius:.2em;padding:.2em;font-size:1rem;cursor:help;white-space:pre-wrap}tw-error.error{background-color:rgba(223,58,190,.6);color:#fff}tw-error.warning{background-color:rgba(223,140,58,.6);color:#fff;display:none}.debug-mode tw-error.warning{display:inline}tw-error-explanation{display:block;font-size:.8rem;line-height:1rem}tw-open-button,tw-folddown{cursor:pointer;line-height:0em;border-radius:4px;border:1px solid rgba(255,255,255,.5);font-size:.8rem;margin:0 .2rem;padding:3px;white-space:pre}tw-folddown::after{content:"▶"}tw-folddown.open::after{content:"▼"}tw-open-button[replay]{display:none}tw-error tw-open-button,tw-eval-replay tw-open-button{display:inline !important}tw-open-button::after{content:attr(label)}tw-notifier{border-radius:.2em;padding:.2em;font-size:1rem;background-color:rgba(223,182,58,.4);display:none}.debug-mode tw-notifier{display:inline}tw-notifier::before{content:attr(message)}tw-colour{border:1px solid #000;display:inline-block;width:1em;height:1em}tw-enchantment:empty{display:none}h1{font-size:3em}h2{font-size:2.25em}h3{font-size:1.75em}h1,h2,h3,h4,h5,h6{line-height:1em;margin:.3em 0 .6em 0}pre{font-size:1rem;line-height:initial}small{font-size:70%}big{font-size:120%}mark{color:rgba(0,0,0,.6);background-color:#ff9}ins{color:rgba(0,0,0,.6);background-color:rgba(255,242,204,.5);border-radius:.5em;box-shadow:0em 0em .2em #ffe699;text-decoration:none}center{text-align:center;margin:0 auto;width:60%}blink{text-decoration:none;animation:fade-in-out 1s steps(1, end) infinite alternate}tw-align{display:block}tw-columns{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.transition-in{animation:appear 0ms step-start}.transition-out{animation:appear 0ms step-end}[data-t8n^=dissolve].transition-in,[data-t8n=fade].transition-in{animation:appear .8s}[data-t8n^=dissolve].transition-out,[data-t8n=fade].transition-out{animation:appear .8s reverse}[data-t8n^=shudder].transition-in{display:inline-block !important;animation:shudder-in .8s}[data-t8n^=shudder].transition-out{display:inline-block !important;animation:shudder-in .8s reverse}[data-t8n^=rumble].transition-in{display:inline-block !important;animation:rumble-in .8s}[data-t8n^=rumble].transition-out{display:inline-block !important;animation:rumble-in .8s reverse}[data-t8n^=pulse].transition-in{animation:pulse .8s;display:inline-block !important}[data-t8n^=pulse].transition-out{animation:pulse .8s reverse;display:inline-block !important}[data-t8n^=zoom].transition-in{animation:zoom-in .8s;display:inline-block !important}[data-t8n^=zoom].transition-out{animation:zoom-in .8s reverse;display:inline-block !important}[data-t8n^=blur].transition-in{animation:blur .8s;display:inline-block !important}[data-t8n^=blur].transition-out{animation:blur .8s reverse;display:inline-block !important}[data-t8n^=slideleft].transition-in{animation:slide-left .8s;display:inline-block !important}[data-t8n^=slideleft].transition-out{animation:slide-right .8s reverse;display:inline-block !important}[data-t8n^=slideright].transition-in{animation:slide-right .8s;display:inline-block !important}[data-t8n^=slideright].transition-out{animation:slide-left .8s reverse;display:inline-block !important}[data-t8n^=slideup].transition-in{animation:slide-up .8s;display:inline-block !important}[data-t8n^=slideup].transition-out{animation:slide-down .8s reverse;display:inline-block !important}[data-t8n^=slidedown].transition-in{animation:slide-down .8s;display:inline-block !important}[data-t8n^=slidedown].transition-out{animation:slide-up .8s reverse;display:inline-block !important}[data-t8n^=fadeleft].transition-in{animation:fade-left .8s;display:inline-block !important}[data-t8n^=fadeleft].transition-out{animation:fade-right .8s reverse;display:inline-block !important}[data-t8n^=faderight].transition-in{animation:fade-right .8s;display:inline-block !important}[data-t8n^=faderight].transition-out{animation:fade-left .8s reverse;display:inline-block !important}[data-t8n^=fadeup].transition-in{animation:fade-up .8s;display:inline-block !important}[data-t8n^=fadeup].transition-out{animation:fade-down .8s reverse;display:inline-block !important}[data-t8n^=fadedown].transition-in{animation:fade-down .8s;display:inline-block !important}[data-t8n^=fadedown].transition-out{animation:fade-up .8s reverse;display:inline-block !important}[data-t8n^=flicker].transition-in{animation:flicker .8s}[data-t8n^=flicker].transition-out{animation:flicker .8s reverse}
</style>
</head>
<body>
<tw-story><noscript><tw-noscript>JavaScript needs to be enabled to play The Simulation™ - Story Script.</tw-noscript></noscript></tw-story>
<tw-storydata name="The Simulation™ - Story Script" startnode="1" creator="Twine" creator-version="2.7.1" format="Harlowe" format-version="3.3.7" ifid="547CABDE-0004-4A71-A30D-B2E4A401E118" options="" tags="" zoom="0.6" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">.imageContainer {
  display: flex;
  justify-content: space-around; /* This will space out the images evenly */
  flex-wrap: wrap; /* Allows wrapping to next line */
}







.fit {
  max-width: 100%;
  height: auto;
  margin-bottom: 1em;
}

.fitHalf {
  width: 60%;
  display: block;
  margin: 0 auto;
}

.fit49 {
  width: 49%;
  display: block;
  margin: 6px auto;
  object-fit: cover;
}
.fit32 {
  width: 32%;
  display: block;
  margin: 6px auto;
  object-fit: cover;
}










tw-hook[name="specialtitle"] {
  display: block;
  font-family: 'Arial', sans-serif;
  font-size: 300%;
  font-weight: bold;
  text-align: center;
  text-transform: uppercase;
  margin-top: 20%;
  margin-bottom: 20%;
}








tw-hook[name="act"] {
  display: block;
  font-family: 'Arial', sans-serif;
  font-size: 150%;
  font-weight: bold;
  text-align: center;
  text-transform: uppercase;
  margin-top: 2em;
  /*margin-bottom: 1em;*/
}

tw-hook[name="scene"] {
  display: block;
  font-family: 'Arial', sans-serif;
  font-weight: bold;
  text-transform: uppercase;
  text-align: left;
  margin: 1em 0;
  background-color: rgba(70, 40, 40, 1);
  padding: 5px;
}

tw-hook[name="action"] {
  display: block;
  text-align: justify;
  margin-left: 3%;
  margin-right: 3%;
  color: rgba(255, 255, 255, .65);
}

tw-hook[name="name"] {
  display: block;
  font-weight: bold;
  text-align: left;
  text-transform: uppercase;
  margin-left: 26%;
  margin-right: 26%;
}

tw-hook[name="dialogue"] {
  display: block;
  text-align: justify;
  margin-left: 20%;
  margin-right: 20%;
  margin-top: -1.5em;
}

tw-hook[name="parenthetical"] {
  display: block;
  font-style: italic;
  text-align: left;
  margin-left: 26%;
  margin-right: 26%;
  margin-top: -1.5em;
  color: rgba(255, 255, 255, .65);
}




/* BASE STYLE FOR ALL BRANCHES INSIDE tw-hook */

tw-hook[name^="branch-"] details {
  background-color: #222222;   /* Dark gray background */
  color: #ffffff;             /* White text */
  border: 5px solid #666666;  /* Default 5px border, overridden below */
  padding: 10px;
  border-radius: 5px;
  margin: 10px 0;
}

/* YES -> Green border */
tw-hook[name="branch-yes"] details {
  border-color: #00ff00;
}

/* NO -> Red border */
tw-hook[name="branch-no"] details {
  border-color: #ff0000;
}

/* WAIT -> Yellow border */
tw-hook[name="branch-wait"] details {
  border-color: #ffff00;
}

/* Additional branches (A, B, C, D, E) with distinct vivid colors */

/* A -> Cyan border */
tw-hook[name="branch-a"] details {
  border-color: #00ffff;
}

/* B -> Magenta border */
tw-hook[name="branch-b"] details {
  border-color: #ff00ff;
}

/* C -> Orange border */
tw-hook[name="branch-c"] details {
  border-color: #ffa500;
}

/* D -> Bright Blue border */
tw-hook[name="branch-d"] details {
  border-color: #0000ff;
}

/* E -> Deep Pink border */
tw-hook[name="branch-e"] details {
  border-color: #ff1493;
}

/* Additional branches (F, G, H, I, J) with distinct vivid colors */

/* F -> Purple border */
tw-hook[name="branch-f"] details {
  border-color: #800080;
}

/* G -> Coral border */
tw-hook[name="branch-g"] details {
  border-color: #ff7f50;
}

/* H -> Dark Turquoise border */
tw-hook[name="branch-h"] details {
  border-color: #00ced1;
}

/* I -> Saddle Brown border */
tw-hook[name="branch-i"] details {
  border-color: #8b4513;
}

/* J -> BlueViolet border */
tw-hook[name="branch-j"] details {
  border-color: #8a2be2;
}

/* Semantic branch families used for Twine <-> VOD sync */

/* IF -> Amber border */
tw-hook[name="branch-if"] details {
  border-color: #ffbf00;
}

/* LOOP -> Yellow border */
tw-hook[name="branch-loop"] details {
  border-color: #ffff00;
}

/* PATH 1 -> Red border */
tw-hook[name="branch-path1"] details {
  border-color: #ff4d4d;
}

/* PATH 1 IF -> Orange border */
tw-hook[name="branch-path1-if"] details {
  border-color: #ff8c00;
}

/* PATH 2 -> Cyan border */
tw-hook[name="branch-path2"] details {
  border-color: #00ffff;
}

/* PATH 2 IF -> Bright Blue border */
tw-hook[name="branch-path2-if"] details {
  border-color: #1e90ff;
}

/* Visible Twine line-code token (reference-only, not spoken text) */
.vod-line-code {
  display: block;
  font-family: "Courier New", monospace;
  font-weight: 200;
  font-size: 0.78em;
  opacity: 0.68;
  letter-spacing: 0.06em;
  line-height: 1.15;
  margin: 0 0 0.08em 0;
}

/* Hidden production metadata toggle (A1-S01 pilot) */
.vod-hidden-data {
  display: none;
  font-family: "Courier New", monospace;
  font-weight: 200;
  font-size: 0.72em;
  opacity: 0.62;
  letter-spacing: 0.04em;
  line-height: 1.1;
  margin: 0 0 0.08em 0;
}

.vod-meta-label {
  display: inline-block;
  text-decoration: underline;
  background: rgba(130, 130, 130, 0.24);
  border-radius: 0.2em;
  padding: 0 0.25em;
}

.vod-meta-value {
  opacity: 0.95;
}

.vod-status {
  display: inline-block;
  border-radius: 0.22em;
  padding: 0 0.3em;
  font-weight: 600;
}

.vod-status:empty {
  display: none;
}

.vod-status-good {
  background: rgba(42, 168, 68, 0.28);
}

.vod-status-maybe {
  background: rgba(255, 196, 35, 0.36);
}

.vod-status-redo {
  background: rgba(220, 53, 69, 0.32);
}

.vod-hidden-toggle {
  margin-right: 0.35em;
  vertical-align: middle;
}

.vod-hidden-label {
  display: inline-block;
  font-family: "Courier New", monospace;
  font-weight: 300;
  font-size: 0.72em;
  opacity: 0.84;
  letter-spacing: 0.04em;
  margin: 0 0.95em 0.8em 0;
}

/* Scene-local visibility toggles for A1-S01 */
.a1s01-script .vod-line-code {
  display: none;
}

/* Prevent orphan line break when VO metadata is hidden */
.a1s01-script .vod-hidden-data + br {
  display: none;
}

#a1s01-show-vo-meta:checked ~ .a1s01-script .vod-hidden-data {
  display: block;
}

#a1s01-show-line-codes:checked ~ .a1s01-script .vod-line-code {
  display: block;
}

/* Scene-local visibility toggles for A1-S02 */
.a1s02-script .vod-line-code {
  display: none;
}

/* Prevent orphan line break when VO metadata is hidden */
.a1s02-script .vod-hidden-data + br {
  display: none;
}

#a1s02-show-vo-meta:checked ~ .a1s02-script .vod-hidden-data {
  display: block;
}

#a1s02-show-line-codes:checked ~ .a1s02-script .vod-line-code {
  display: block;
}
</style><script role="script" id="twine-user-script" type="text/twine-javascript"></script><tw-tag name="Time-Period-Primitive" color="orange"></tw-tag><tw-tag name="Timeframe_Advanced" color="purple"></tw-tag><tw-tag name="Timeframe_Primitive" color="yellow"></tw-tag><tw-tag name="Timeframe_Modern" color="blue"></tw-tag><tw-tag name="Timeframe_Early" color="green"></tw-tag><tw-passagedata pid="1" name="START GAME" tags="Timeframe_Advanced" position="725,350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[START GAME SCENE]
SCENERY FOR A DOOMSDAY
EXT - DAWN - RIPPLE RANGE REGION]
&lt;img src=&quot;https://i.imgur.com/Inlkiz0.jpg&quot; class=&quot;fitHalf&quot;&gt;
You awaken on a flat desert wasteland. The winds howl. Nothing’s around for miles. Nothing but a far off city beyond mountains in the distance. You gaze at the city. Suddenly, BOOOOOM!


&lt;img src=&quot;https://i.imgur.com/5yTO4Tq.jpg&quot; class=&quot;fitHalf&quot;&gt;
A nuclear explosion engulfs the city.


&lt;img src=&quot;https://i.imgur.com/GnKk1I6.jpg&quot; class=&quot;fitHalf&quot;&gt;
A huge dust wave heads your way.


&lt;img src=&quot;https://i.imgur.com/pNrwO8i.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/i8aJOE4.jpg&quot; class=&quot;fitHalf&quot;&gt;
Before the massive wave smothers you, your vision glitches. A holographic message materializes, accompanied by an artificial voice, instructing you to &quot;Remove Simulator&quot;. After realizing this was just a simulation, you remove the simulator headset from your face.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|Act 1]]]

[[Narrative Bible Import Test (Temp, Local) - A1-S02|NB-ImportTest-A1S02-Local]]
[[Narrative Bible Import Test (Temp, Local) - A1-S07|NB-ImportTest-A1S07-Local]]






























Here are some links for conveniently jumping to different points in the story...
NOTE: Scene names are intended as devlopment labels, and they may not appear in game.

[[Act 2 - Scene 01: DREJNON|A2-S01]]

[[Act 2 - Scene 18: AMBUSH|A2-S18]]

[[Act 2 - Scene 24: DECISION|A2-S24]]
The storyline diverges into the &quot;good&quot; path or the &quot;bad&quot; path, depending on your actions in this scene.
NOTE: Paths are not labeled in game as &quot;good&quot; or &quot;bad&quot;. These are just a development labels.

[[Act 3 - Scene 01 - Good Path: THE QUERY|A3-S01-G]]

[[Act 3 - Scene 01 - Bad Path: WORLDS COLLIDE|A3-S01-B]]




























Here are links to micellaneous notes that are about the game in general, not scene specific...
WARNING: These notes are mostly for myself so they are probably messy and confusing.

[[Key Details about this game]] 
[[Names List]] 
[[Expletive Replacements]] 
[[Linguistic Terms]] 
[[Haku Talkabouts]] 
[[Location Names]] </tw-passagedata><tw-passagedata pid="2" name="A1-S01" tags="Timeframe_Advanced" position="725,600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 01]
ROOM 101
INT - DAY - SIM LABS HQ]

You find yourself in a small office room. A holographic display on the wall shows the company name &quot;Sim Labs&quot; and its slogan: &quot;Simulate the past. Predict the future.™&quot;


&lt;img src=&quot;https://i.imgur.com/dfUtjvJ.jpg&quot; class=&quot;fitHalf&quot;&gt;
After a brief wait, a Muffin scientist named Professor Ludwig barges in.


&lt;img src=&quot;https://i.imgur.com/ltesxgZ.jpg&quot; class=&quot;fitHalf&quot;&gt;
Ludwig introduces himself and begins questioning you, to which you can only respond by nodding yes or no. He then explains that you'll start with a training simulation and presents you with a simulator device to wear.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A1-S02]]]


---
---
---
---


SCRIPT:

&lt;!-- VODMETA scene=A01_S01 sheet=VOD_Sheet_A01_S01.csv source=Twine updated=2026-02-15 by=codex --&gt;

&lt;input type=&quot;checkbox&quot; id=&quot;a1s01-show-vo-meta&quot; class=&quot;vod-hidden-toggle&quot; /&gt;
&lt;label for=&quot;a1s01-show-vo-meta&quot; class=&quot;vod-hidden-label&quot;&gt;Show VO File + Status&lt;/label&gt;
&lt;input type=&quot;checkbox&quot; id=&quot;a1s01-show-line-codes&quot; class=&quot;vod-hidden-toggle&quot; /&gt;
&lt;label for=&quot;a1s01-show-line-codes&quot; class=&quot;vod-hidden-label&quot;&gt;Show Line Codes&lt;/label&gt;
&lt;div class=&quot;a1s01-script&quot;&gt;

|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 01]
ROOM 101
INT - DAY - SIM LABS HQ]

|action&gt;[You are waiting in a small office room. A holographic display screen ahead of you reads &quot;Sim Labs: Simulate the Past. Predict the Future.&quot; After a few moments, Ludwig barges in, occasionally repeating the question if you remain silent too long.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101001_Ludwig_SorryImLate`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D101001_Ludwig_SorryImLate line=001-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-A]&lt;/span&gt;Sorry I’m late. You must be the new test subject. I am Professor Ludwig.
&lt;!-- VODMETA clip=D101001_Ludwig_SorryImLate line=001-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-B]&lt;/span&gt;Now, I’m sure you have many questions for me. Some of which will be answered, most of which will not be. But I can assure you—
&lt;!-- VODMETA clip=D101001_Ludwig_SorryImLate line=001-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-C]&lt;/span&gt;—you will be very confused by my words. Do you understand?]

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You have yet to respond&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Loop --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101002_Ludwig_Loop_DoYouUnderstand`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
  &lt;!-- VODMETA clip=D101002_Ludwig_Loop_DoYouUnderstand line=002-A branch=Loop speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[002-A]&lt;/span&gt;Nod your head yes or no. Do you understand?
  &lt;!-- VODMETA clip=D101002_Ludwig_Loop_DoYouUnderstand line=002-B branch=Loop speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[002-B]&lt;/span&gt;Do you understand what I have said?
  &lt;!-- VODMETA clip=D101002_Ludwig_Loop_DoYouUnderstand line=002-C branch=Loop speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[002-C]&lt;/span&gt;Please nod your head yes or no in response to my questions.
  &lt;!-- VODMETA clip=D101002_Ludwig_Loop_DoYouUnderstand line=002-D branch=Loop speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[002-D]&lt;/span&gt;Do you understand?]
  |action&gt;[Questions loop until you respond.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You nod YES&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101003_Ludwig_Yes_Fantastic`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
  &lt;!-- VODMETA clip=D101003_Ludwig_Yes_Fantastic line=003 branch=Yes speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[003]&lt;/span&gt;Hmm. An improvement on the last test subject. Fantastic.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You nod NO&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101004_Ludwig_No_DeficientIntellect`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
  &lt;!-- VODMETA clip=D101004_Ludwig_No_DeficientIntellect line=004 branch=No speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[004]&lt;/span&gt;Does not understand. Deficient intellect.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101005_Ludwig_MrAnderson`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D101005_Ludwig_MrAnderson line=005-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[005-A]&lt;/span&gt;Well then. Let’s not waste any time then, Mister Anderson.
&lt;!-- VODMETA clip=D101005_Ludwig_MrAnderson line=005-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[005-B]&lt;/span&gt;Would you mind if I refer to you as Mister Anderson?]

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You have yet to respond&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Loop --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101006_Ludwig_Loop_DoYouMind`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
  &lt;!-- VODMETA clip=D101006_Ludwig_Loop_DoYouMind line=006-A branch=Loop speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[006-A]&lt;/span&gt;Do you mind if I refer to you as Mister Anderson?
  &lt;!-- VODMETA clip=D101006_Ludwig_Loop_DoYouMind line=006-B branch=Loop speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[006-B]&lt;/span&gt;Nod your head yes or no. Would you mind being referred to as Mister Anderson?]
  |action&gt;[Questions loop until you respond.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You nod YES&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101007_Ludwig_Yes_Unfortunate`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
  &lt;!-- VODMETA clip=D101007_Ludwig_Yes_Unfortunate line=007 branch=Yes speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[007]&lt;/span&gt;Well that’s unfortunate for you, Mister Anderson.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You nod NO&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101008_Ludwig_No_Accommodating`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
  &lt;!-- VODMETA clip=D101008_Ludwig_No_Accommodating line=008 branch=No speaker=Ludwig --&gt;
  &lt;span class=&quot;vod-line-code&quot;&gt;[008]&lt;/span&gt;No objections? How accommodating of you.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D101009_Ludwig_TrainingSimulationIntro`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status vod-status-good&quot;&gt;good&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-A]&lt;/span&gt;We'll start you off in our training simulation.
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-B]&lt;/span&gt;This will teach you the basics of how to operate our simulations here at Sim Labs.
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-C]&lt;/span&gt;Simulate the past, predict the future…
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-D]&lt;/span&gt;Trademarked!]

|action&gt;[A platform descends from the ceiling, holding a simulator device. Ludwig sets it up, then gestures at you to pick it up.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-E]&lt;/span&gt;This is your simulator. It’s configured with a controlled simulation. That means I will be able to monitor your training from the control room.
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-F branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-F]&lt;/span&gt;Please put on this simulator when you are ready to begin your training.
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-G branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-G]&lt;/span&gt;Go on, Mister Anderson.
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-H branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-H]&lt;/span&gt;The simulator is ready for you to wear.
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-I branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-I]&lt;/span&gt;This is not difficult. Simply pick up the simulator and put it on your face.
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-J branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-J]&lt;/span&gt;Are you defective?
&lt;!-- VODMETA clip=D101009_Ludwig_TrainingSimulationIntro line=009-K branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009-K]&lt;/span&gt;Ugh. I’ll be in the control room. Just hurry and put it on, Mister Anderson. We don’t have all day.]

|action&gt;[Ludwig exits, leaving you alone. You pick up the simulator and prepare to put it on.]


&lt;/div&gt;

---
---
---
---</tw-passagedata><tw-passagedata pid="3" name="A1-S02" tags="Timeframe_Modern" position="725,725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 02]
THE SIMULATION TRAINING EXPERIENCE MODULE™
EXT - DAY - TRAINING SIMULATION]

You enter a blank white simulation space. Professor Ludwig's voice greets you over an intercom. He initially loads the wrong simulation before correcting his mistake and loading the &quot;Sim Labs Simulation Training Experience Module™&quot;.


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/eRBT96m.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/BQFntEV.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/702iXSJ.jpg&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(ART NOTE: Parody of a scene from The Matrix.)]
|parenthetical&gt;[(very old art)]
You find yourself in a square area enclosed by a picket fence, with a sign above a gate reading &quot;Training Simulation&quot;. Within this area, Ludwig guides you through basic training, which includes: navigation, interacting with objects, firearms handling, grenade usage, and breaching drills with Cit Cat Combustible Composition (C4).


&lt;img src=&quot;https://i.imgur.com/zRdUrX1.jpg&quot; class=&quot;fitHalf&quot;&gt;
Ludwig first guides you through basic simulation operation. This includes walking, grabbing, and using the simulation configuration menu by removing your simulator. He also clarifies that only extraction events truly move you out of a simulation layer. Once you become familiar with the basics, Ludwig instructs you to follow a path to a place called &quot;Super Awesome Adventure Candy Land™&quot; for more advanced training. You follow the trail beyond the gates.


&lt;img src=&quot;https://i.imgur.com/Fwot0AL.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: I want to flip the paths from right to left when making in 3D.)]
After completing the basic training, Ludwig directs you to follow a path leading to &quot;Super Awesome Adventure Candy Land™&quot;. You pass through the gate and enter a pleasant forest. Along this path, you encounter a fork in the road:
 - The left path is marked with danger signs.
 - The right path is clearly the intended route.
If you choose the left path, a hidden sniper kills you, forcing a checkpoint restart. This serves as a humorous reminder to stick with the linear narrative of the game.
Ludwig explains this checkpoint behavior exists because Sim Labs management disabled his &quot;Ultra Realism Haptic Engine™&quot;, so dying in-simulation now rewinds you instead of killing you in reality.


&lt;img src=&quot;https://i.imgur.com/dUGGdQ8.jpg&quot; class=&quot;fitHalf&quot;&gt;
Continuing on the correct path, you reach a canyon area with a plateau. At the base of the plateau is the tunnel entrance to Super Awesome Adventure Candy Land™, but the tunnel entrance has collapsed. Ludwig explains the multi-layered space-time architecture of Sim Labs simulations. You learn that whenever you enter a simulation within a simulation, you are in effect going back in time. He sends you a simulator to enter a past version of the simulation prior to the tunnel collapse. In typical Ludwig fashion, he also sends a temporary defensive upgrade by mistake, tries to delete it with a meteor, and the impact knocks the simulator into a nearby tree. After a short climb and a warning about recursive simulation risks, he instructs you to wear the simulator.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A1-S03]]]


























---
---
---
---


SCRIPT:

&lt;!-- VODMETA scene=A01_S02 sheet=VOD_Sheet_A01_S02.csv source=Twine updated=2026-02-22 by=codex --&gt;

&lt;input type=&quot;checkbox&quot; id=&quot;a1s02-show-vo-meta&quot; class=&quot;vod-hidden-toggle&quot; /&gt;
&lt;label for=&quot;a1s02-show-vo-meta&quot; class=&quot;vod-hidden-label&quot;&gt;Show VO File + Status&lt;/label&gt;
&lt;input type=&quot;checkbox&quot; id=&quot;a1s02-show-line-codes&quot; class=&quot;vod-hidden-toggle&quot; /&gt;
&lt;label for=&quot;a1s02-show-line-codes&quot; class=&quot;vod-hidden-label&quot;&gt;Show Line Codes&lt;/label&gt;
&lt;div class=&quot;a1s02-script&quot;&gt;

|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 02]
THE SIMULATION TRAINING EXPERIENCE MODULE™
EXT - DAY - TRAINING SIMULATION]

|action&gt;[You enter a blank white simulation. The environment changes as you hear Ludwig's voice over an intercom.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102001_Ludwig_CanYouHearMe`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102001_Ludwig_CanYouHearMe line=001-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-A]&lt;/span&gt;Anderson? Can you hear me, Mr. Anderson? Can you hear my voice, Mr. Anderson?]

|action&gt;[You find yourself standing in a featureless white space.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102001_Ludwig_CanYouHearMe`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102001_Ludwig_CanYouHearMe line=001-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-B]&lt;/span&gt;Ah, there you are. Let me just load this up here.]

|action&gt;[Suddenly, an array of gun racks appears around you, reminiscent of a scene from The Matrix.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102001_Ludwig_CanYouHearMe`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102001_Ludwig_CanYouHearMe line=001-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-C]&lt;/span&gt;Oops, wrong simulation. Wrong simulation.]

|action&gt;[The gun racks disappear, and the environment transitions to a forest area titled &quot;The Sim Labs Training Simulation Experience Module™&quot;.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102001_Ludwig_CanYouHearMe`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102001_Ludwig_CanYouHearMe line=001-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-D]&lt;/span&gt;Welcome to the Sim Labs Training Simulation Experience... Module... trademarked. This is where you will learn everything you must know, about simulations.
&lt;!-- VODMETA clip=D102001_Ludwig_CanYouHearMe line=001-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-E]&lt;/span&gt;Your first lesson is navigation. This guidepost demonstrates how to move around using our proprietary Sim Labs navigation method. Go ahead and give it a try.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102001_Ludwig_CanYouHearMe`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102001_Ludwig_CanYouHearMe line=001-F branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[001-F]&lt;/span&gt;Follow the instructions on the guide post to navigate this simulated environment.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102002_Ludwig_Loop_SwingYourArms`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102002_Ludwig_Loop_SwingYourArms line=002-A branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[002-A]&lt;/span&gt;You simply swing your arms, Mr. Anderson.
&lt;!-- VODMETA clip=D102002_Ludwig_Loop_SwingYourArms line=002-B branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[002-B]&lt;/span&gt;Swing your arms as if you are walking or running.]

|action&gt;[You experiment with moving around using the innovative navigation method provided.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102002_Ludwig_Loop_SwingYourArms`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102002_Ludwig_Loop_SwingYourArms line=002-C branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[002-C]&lt;/span&gt;Simply swing your arms in the direction you wish to traverse.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102003_Ludwig_DoYouLikeNavMethod`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102003_Ludwig_DoYouLikeNavMethod line=003-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[003-A]&lt;/span&gt;So, what do you think? Do you like our Sim Labs proprietary method of navigation?
&lt;!-- VODMETA clip=D102003_Ludwig_DoYouLikeNavMethod line=003-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[003-B]&lt;/span&gt;Nod your head yes or no. Be honest. I promise I will not be offended.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102004_Ludwig_Loop_NavQuestion`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102004_Ludwig_Loop_NavQuestion line=004-A branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[004-A]&lt;/span&gt;Do you like this method of navigation?
&lt;!-- VODMETA clip=D102004_Ludwig_Loop_NavQuestion line=004-B branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[004-B]&lt;/span&gt;Do you like swinging your arms to navigate, Mr. Anderson?
&lt;!-- VODMETA clip=D102004_Ludwig_Loop_NavQuestion line=004-C branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[004-C]&lt;/span&gt;Please nod your head yes or no.]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You nod YES&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Yes --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102005_Ludwig_Yes_YouMustBeInsane`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102005_Ludwig_Yes_YouMustBeInsane line=005 branch=Yes speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[005]&lt;/span&gt;Wait, really? You like this method? You must be insane. Well...]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You nod NO&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=No --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102006_Ludwig_No_SoRudeChangeNav`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102006_Ludwig_No_SoRudeChangeNav line=006-A branch=No speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[006-A]&lt;/span&gt;Alright sheesh. Sorry for trying to improve the simulation experience by providing an innovative way to navigate. You don't have to be so rude about it, Mr. Anderson.]

  |action&gt;[You hear button sounds that Ludwig presses.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102006_Ludwig_No_SoRudeChangeNav`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102006_Ludwig_No_SoRudeChangeNav line=006-B branch=No speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[006-B]&lt;/span&gt;There. I just changed your method of navigation. These are instructions showing the same, standard, boring method of navigation that all the other simulation programs use.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102007_Ludwig_ConfigMenuIntro`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102007_Ludwig_ConfigMenuIntro line=007-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[007-A]&lt;/span&gt;If you ever wish to change your navigation method, you can always do so in the simulation configuration menu.
&lt;!-- VODMETA clip=D102007_Ludwig_ConfigMenuIntro line=007-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[007-B]&lt;/span&gt;You might be wondering how to get to that simulation configuration menu. No, it is not a button you press. To enter that menu, you simply remove the simulator from your face.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102008_Ludwig_Loop_RemoveHeadset`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102008_Ludwig_Loop_RemoveHeadset line=008-A branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[008-A]&lt;/span&gt;Go on, remove your simulator headset.
&lt;!-- VODMETA clip=D102008_Ludwig_Loop_RemoveHeadset line=008-B branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[008-B]&lt;/span&gt;Please remove the simulator headset from your face.]

|action&gt;[You remove the simulator and find yourself in a virtual menu.]

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You remove the simulator early to enter the menu&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102009_Ludwig_If_EnterMenuEarly`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102009_Ludwig_If_EnterMenuEarly line=009 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[009]&lt;/span&gt;Uhp. Looks like you already know how to enter the menu.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102010_Ludwig_MenuExplanation`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102010_Ludwig_MenuExplanation line=010-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[010-A]&lt;/span&gt;As you will notice, this is not the room you were in prior to wearing the simulator. This is the simulation configuration menu, where you can adjust your settings and whatnot.
&lt;!-- VODMETA clip=D102010_Ludwig_MenuExplanation line=010-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[010-B]&lt;/span&gt;The only way to truly exit a simulation is via an extraction event. I'll explain what that means when the time comes.
&lt;!-- VODMETA clip=D102010_Ludwig_MenuExplanation line=010-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[010-C]&lt;/span&gt;If you remove your simulator again from within this menu, you will continue the current simulation. Or you can simply put on the simulator that you had just taken off.
&lt;!-- VODMETA clip=D102010_Ludwig_MenuExplanation line=010-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[010-D]&lt;/span&gt;Whenever you're ready, go ahead and exit this menu so we may proceed with your training.]

|action&gt;[You remove the simulator again and return to the training simulation.]

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You remove the simulator early to exit the menu&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102011_Ludwig_If_ExitMenuEarly`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102011_Ludwig_If_ExitMenuEarly line=011 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[011]&lt;/span&gt;It seems you are going ahead of me, Mr. Anderson. Very well.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102012_Ludwig_PickUpIntro`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102012_Ludwig_PickUpIntro line=012-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[012-A]&lt;/span&gt;For our next lesson, we're going to learn how to pick up items.
&lt;!-- VODMETA clip=D102012_Ludwig_PickUpIntro line=012-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[012-B]&lt;/span&gt;Embedded in each of your arms is a resonance frequency attractor. This gives you the passive ability to pick up nearby items that are just out of reach. Try picking up an item now.]

|action&gt;[Items drop from the sky, and you practice grabbing one.]

&lt;tw-hook name=&quot;branch-loop&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You have yet to pick up an item&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Loop --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102013_Ludwig_Loop_PickUpInstructions`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102013_Ludwig_Loop_PickUpInstructions line=013-A branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[013-A]&lt;/span&gt;Simply point your arm in the direction of an item and grab it.
&lt;!-- VODMETA clip=D102013_Ludwig_Loop_PickUpInstructions line=013-B branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[013-B]&lt;/span&gt;Make a grabbing gesture in the direction of an item.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102014_Ludwig_GotHangOfIt`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102014_Ludwig_GotHangOfIt line=014-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[014-A]&lt;/span&gt;Looks like you got the hang of it.
&lt;!-- VODMETA clip=D102014_Ludwig_GotHangOfIt line=014-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[014-B]&lt;/span&gt;All right, enough with the boring stuff. It's time to have fun with some toys.]












|action&gt;[A portal opens up under you and you fall through, appearing in a new location. It's a large empty upscale warehouse environment.
An AR-9 sits on a platform in front of you.]

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You drop your assault rifle for the first time&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102101_Ludwig_If_FirstTimeDropRifle`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102101_Ludwig_If_FirstTimeDropRifle line=101 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[101]&lt;/span&gt;Dropping a primary firearm will holster it over your right shoulder. To use it again, simply grab it from there.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You must be holding your assault rifle to continue&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102102_Ludwig_If_NeedRifle`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102102_Ludwig_If_NeedRifle line=102-A branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[102-A]&lt;/span&gt;You need your assault rifle. Pick it up from over your right shoulder.
&lt;!-- VODMETA clip=D102102_Ludwig_If_NeedRifle line=102-B branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[102-B]&lt;/span&gt;Please grab your primary firearm from your right shoulder, Mr. Anderson.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You drop your pistol for the first time&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102103_Ludwig_If_FirstTimeDropPistol`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102103_Ludwig_If_FirstTimeDropPistol line=103 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[103]&lt;/span&gt;Releasing a pistol will automatically return it to your right‑hip holster.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You must be holding your pistol to continue&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102104_Ludwig_If_NeedPistol`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102104_Ludwig_If_NeedPistol line=104-A branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[104-A]&lt;/span&gt;You need your pistol now. Grab it from your right hip holster.
&lt;!-- VODMETA clip=D102104_Ludwig_If_NeedPistol line=104-B branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[104-B]&lt;/span&gt;Please grab your pistol from its holster, Mr. Anderson.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[A sign with the firearm safety rules appears.
actually real FIREARM SAFETY RULES:
1. ALWAYS TREAT FIREARMS AS IF THEY ARE LOADED.
2. Never point firearm at anything you aren't willing to destroy.
3. Do not touch trigger until you are ready to shoot.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102105_Ludwig_AR9`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102105_Ludwig_AR9 line=105-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[105-A]&lt;/span&gt;This is an AR‑9 Assault Rifle. It fires a 9×56 mm high‑velocity Tootsy Roll cartridge.
&lt;!-- VODMETA clip=D102105_Ludwig_AR9 line=105-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[105-B]&lt;/span&gt;But before touching it, it’s important you understand that firearms are NOT toys to have fun with. They are deadly devices.
&lt;!-- VODMETA clip=D102105_Ludwig_AR9 line=105-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[105-C]&lt;/span&gt;As such, we must always follow the three firearm‑safety rules to avoid careless accidents.]

|action&gt;[Several explosive red barrels appear surrounding you.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102105_Ludwig_AR9`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102105_Ludwig_AR9 line=105-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[105-D]&lt;/span&gt;These are actually real firearm safety rules, so please adhere to them very judiciously, Mr. Anderson...
&lt;!-- VODMETA clip=D102105_Ludwig_AR9 line=105-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[105-E]&lt;/span&gt;...except for rule #1. That rule is not important because I know for a fact that this firearm is currently not loaded. Trust me, I checked. There is definitely not one bullet in the chamber that I forgot about.]

|action&gt;[You now have a choice: shoot the barrels, shoot elsewhere, or don't shoot at all.]

&lt;tw-hook name=&quot;branch-loop&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You have yet to fire&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Loop --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102105_Ludwig_AR9`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102105_Ludwig_AR9 line=105-F branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[105-F]&lt;/span&gt;In fact, I’m so confident this firearm is not loaded that I’ll allow you to aim it at those explosive red barrels and pull the trigger. I assure you absolutely nothing bad will happen.
&lt;!-- VODMETA clip=D102105_Ludwig_AR9 line=105-G branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[105-G]&lt;/span&gt;Or you don’t have to shoot the barrels, but at least fire at something.
&lt;!-- VODMETA clip=D102105_Ludwig_AR9 line=105-H branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[105-H]&lt;/span&gt;I need to be sure it isn’t loaded before we continue—this might, in fact, be one of the loaded firearms from our simulated arsenal.]

  &lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
    &lt;summary&gt;You have yet to pick up the firearm&lt;/summary&gt;
    &lt;!-- VODBRANCH canonical=If --&gt;
    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102106_Ludwig_If_FirearmNotPickedUp`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102106_Ludwig_If_FirearmNotPickedUp line=106-A branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[106-A]&lt;/span&gt;Go on and pick up the firearm, Mr. Anderson.
&lt;!-- VODMETA clip=D102106_Ludwig_If_FirearmNotPickedUp line=106-B branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[106-B]&lt;/span&gt;Please pick up the firearm.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102107_Ludwig_Loop_ShootReminder`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102107_Ludwig_Loop_ShootReminder line=107-A branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[107-A]&lt;/span&gt;Come now, Mr. Anderson. We haven’t got all day. Just fire in any direction.
&lt;!-- VODMETA clip=D102107_Ludwig_Loop_ShootReminder line=107-B branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[107-B]&lt;/span&gt;I promise you won’t get in trouble. This is all part of the training.
&lt;!-- VODMETA clip=D102107_Ludwig_Loop_ShootReminder line=107-C branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[107-C]&lt;/span&gt;This is not a difficult task, Mr. Anderson. Simply pull the trigger.]

  |action&gt;[codex: These prompts loop until you fire.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-path1&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You fire at the barrels&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path1 --&gt;
  |action&gt;[The explosion damages your health. You will regenerate health over time.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102110_Ludwig_Path1_FiredAtBarrels`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102110_Ludwig_Path1_FiredAtBarrels line=110-A branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[110-A]&lt;/span&gt;Oh my! Are you alright, Mr. Anderson?! I could’ve sworn that firearm was not loaded.
&lt;!-- VODMETA clip=D102110_Ludwig_Path1_FiredAtBarrels line=110-B branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[110-B]&lt;/span&gt;Hmm. Perhaps that first rule of firearm safety is important after all.
&lt;!-- VODMETA clip=D102110_Ludwig_Path1_FiredAtBarrels line=110-C branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[110-C]&lt;/span&gt;Luckily you’re in the weapons‑training zone, where you are immune from death. And so long as you aren't dead, your health will recover fully after an injury.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-path2&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You aim and shoot elsewhere&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path2 --&gt;
  |action&gt;[The red barrels are removed from the environment.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102111_Ludwig_Path2_ShotElsewhere`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102111_Ludwig_Path2_ShotElsewhere line=111-A branch=Path2 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[111-A]&lt;/span&gt;Well, it’s a good thing you didn’t listen to me and shoot those red barrels. Let me just remove them now before I forget.
&lt;!-- VODMETA clip=D102111_Ludwig_Path2_ShotElsewhere line=111-B branch=Path2 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[111-B]&lt;/span&gt;Regardless of if you shot them, you are currently in the weapons training zone. That means you are immune from death until you leave. So if you do get injured, your health will simply recover after an injury.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102112_Ludwig_HealthRegen`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102112_Ludwig_HealthRegen line=112-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[112-A]&lt;/span&gt;I know, I know. It's very cliché that your health regenerates over time, but almost all simulations are doing this nowadays.
&lt;!-- VODMETA clip=D102112_Ludwig_HealthRegen line=112-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[112-B]&lt;/span&gt;Plus, it's easier than requiring bandages, and health packs, and all that nonsense. Alright, let’s continue your weapons training.]

|action&gt;[Ludwig sends you AR magazines with ammo.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102113_Ludwig_LoadingMag`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102113_Ludwig_LoadingMag line=113-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[113-A]&lt;/span&gt;This is a magazine of ammunition for your assault rifle.
&lt;!-- VODMETA clip=D102113_Ludwig_LoadingMag line=113-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[113-B]&lt;/span&gt;Insert it into the receiver, then chamber a bullet by pulling back and releasing the charging handle.]

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You drop your magazine into your inventory&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102114_Ludwig_If_FirstTimeDropMag`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102114_Ludwig_If_FirstTimeDropMag line=114 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[114]&lt;/span&gt;When you release a magazine with ammunition from your hand, it will fall into your front inventory. You can take it from there and insert it into your firearm.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You need help with the magazine&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102115_Ludwig_If_MagWellHelp`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102115_Ludwig_If_MagWellHelp line=115-A branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[115-A]&lt;/span&gt;There’s a magazine well on the underside of your firearm. That is where you insert the magazine.
&lt;!-- VODMETA clip=D102115_Ludwig_If_MagWellHelp line=115-B branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[115-B]&lt;/span&gt;Look for a rectangular hole on the bottom of your firearm, Mr. Anderson. Then insert the magazine into that hole.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You need help with the charging handle&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102116_Ludwig_If_ChargingHelp`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102116_Ludwig_If_ChargingHelp line=116-A branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[116-A]&lt;/span&gt;Now grab the charging handle and release it.
&lt;!-- VODMETA clip=D102116_Ludwig_If_ChargingHelp line=116-B branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[116-B]&lt;/span&gt;It’s the little stick on the side of your firearm. Simply pull and release.
&lt;!-- VODMETA clip=D102116_Ludwig_If_ChargingHelp line=116-C branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[116-C]&lt;/span&gt;This is not difficult, Mr. Anderson. Simply pull and release the charging handle.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You try to kill yourself&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102117_Ludwig_If_AttemptingSelfTerminate`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102117_Ludwig_If_AttemptingSelfTerminate line=117 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[117]&lt;/span&gt;Nice try, Mr. Anderson. But you won't be able to self terminate within this weapons training zone. We learned after a few test subjects not to allow that.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102118_Ludwig_EliminateTheTargets`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102118_Ludwig_EliminateTheTargets line=118-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[118-A]&lt;/span&gt;Your firearm is now loaded. It’s time to test your aiming skills.]

|action&gt;[Several donut-shaped wooden targets appear.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102118_Ludwig_EliminateTheTargets`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102118_Ludwig_EliminateTheTargets line=118-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[118-B]&lt;/span&gt;Eliminate all of the targets.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102120_Ludwig_MoreTargets`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102120_Ludwig_MoreTargets line=120 branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[120]&lt;/span&gt;There are more targets, Mr. Anderson. Keep eliminating them.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102121_Ludwig_MustEliminateAllTargets`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102121_Ludwig_MustEliminateAllTargets line=121 branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[121]&lt;/span&gt;You must eliminate every target.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102122_Ludwig_SwitchPistol`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102122_Ludwig_SwitchPistol line=122 branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[122]&lt;/span&gt;Switching to your pistol is faster than reloading.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102123_Ludwig_Loop_SwitchPistol`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102123_Ludwig_Loop_SwitchPistol line=123-A branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[123-A]&lt;/span&gt;Your assault rifle is out of ammunition. Switch to your pistol, Mr. Anderson.]

&lt;tw-hook name=&quot;branch-path1&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You fail to eliminate every target with the ammunition provided&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path1 --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102123_Ludwig_Loop_SwitchPistol`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102123_Ludwig_Loop_SwitchPistol line=123-B branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[123-B]&lt;/span&gt;I synthesized a pistol to your right hip. Grab it and use it to eliminate the remaining targets.
&lt;!-- VODMETA clip=D102123_Ludwig_Loop_SwitchPistol line=123-C branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[123-C]&lt;/span&gt;There is a pistol attached to your right hip. Use it to eliminate the final targets.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102126_Ludwig_Path1_OneTargetRemains`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102126_Ludwig_Path1_OneTargetRemains line=126-A branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[126-A]&lt;/span&gt;Hmm, one target remains. I am not impressed, Mr. Anderson. You should have eliminated every target with the ammunition provided.]

  |action&gt;[If you have yet to reload the pistol all by yourself, Ludwig will walk you through each step, as needed.]

  &lt;tw-hook name=&quot;branch-path1-if&quot;&gt;&lt;details&gt;
    &lt;summary&gt;You have yet to remove the empty magazine&lt;/summary&gt;
    &lt;!-- VODBRANCH canonical=Path1_If --&gt;
    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102126_Ludwig_Path1_OneTargetRemains`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102126_Ludwig_Path1_OneTargetRemains line=126-B branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[126-B]&lt;/span&gt;Very well—here is another magazine for your pistol. Let’s see if you can reload by yourself. I must know if I should set this simulation to easy mode or not.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102127_Ludwig_Path1_If_YetToRemovePistolMag`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102127_Ludwig_Path1_If_YetToRemovePistolMag line=127-A branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[127-A]&lt;/span&gt;First, remove the empty pistol magazine by grabbing it.
&lt;!-- VODMETA clip=D102127_Ludwig_Path1_If_YetToRemovePistolMag line=127-B branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[127-B]&lt;/span&gt;Physically grab the empty magazine to remove it.
&lt;!-- VODMETA clip=D102127_Ludwig_Path1_If_YetToRemovePistolMag line=127-C branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[127-C]&lt;/span&gt;Please remove the empty pistol magazine at the bottom of your firearm.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  &lt;tw-hook name=&quot;branch-path1-if&quot;&gt;&lt;details&gt;
    &lt;summary&gt;You have yet to insert a new magazine&lt;/summary&gt;
    &lt;!-- VODBRANCH canonical=Path1_If --&gt;
    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102128_Ludwig_Path1_If_YetToInsertPistolMag`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102128_Ludwig_Path1_If_YetToInsertPistolMag line=128-A branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[128-A]&lt;/span&gt;Insert the new pistol magazine.
&lt;!-- VODMETA clip=D102128_Ludwig_Path1_If_YetToInsertPistolMag line=128-B branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[128-B]&lt;/span&gt;Please insert the new magazine, Mr. Anderson.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  &lt;tw-hook name=&quot;branch-path1-if&quot;&gt;&lt;details&gt;
    &lt;summary&gt;You have yet to release the slide&lt;/summary&gt;
    &lt;!-- VODBRANCH canonical=Path1_If --&gt;
    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102129_Ludwig_Path1_If_YetToRackSlide`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102129_Ludwig_Path1_If_YetToRackSlide line=129-A branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[129-A]&lt;/span&gt;Pull the slide back and release it to chamber a bullet.
&lt;!-- VODMETA clip=D102129_Ludwig_Path1_If_YetToRackSlide line=129-B branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[129-B]&lt;/span&gt;Pull back on the top slide, then release it—similar to a rifle.
&lt;!-- VODMETA clip=D102129_Ludwig_Path1_If_YetToRackSlide line=129-C branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[129-C]&lt;/span&gt;The slide is that top part of the pistol, Mr. Anderson.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  |action&gt;[You finish reloading your pistol.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102130_Ludwig_Path1_PistolLoaded`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102130_Ludwig_Path1_PistolLoaded line=130 branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[130]&lt;/span&gt;Your pistol is now loaded. Eliminate the final target.]

  |action&gt;[You shoot the last target.]

  &lt;tw-hook name=&quot;branch-path1-if&quot;&gt;&lt;details&gt;
    &lt;summary&gt;You miss the last target with every bullet&lt;/summary&gt;
    &lt;!-- VODBRANCH canonical=Path1_If --&gt;
    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102131_Ludwig_Path1_If_MissedEveryShot`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102131_Ludwig_Path1_If_MissedEveryShot line=131 branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[131]&lt;/span&gt;(Sigh.) I’m going to pretend you didn’t just miss every shot at the target.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102132_Ludwig_Path1_WeShallContinue`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102132_Ludwig_Path1_WeShallContinue line=132 branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[132]&lt;/span&gt;Now that you understand the basics of firearms, we shall continue to the next stage.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-path2&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You eliminate every target with the ammunition provided&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path2 --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102133_Ludwig_Path2_PerfectTargetElimination`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102133_Ludwig_Path2_PerfectTargetElimination line=133-A branch=Path2 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[133-A]&lt;/span&gt;Wow! You managed to hit every target with the ammunition provided. I believe that's the first time a test subject has ever done that. Well done, Mr. Anderson.
&lt;!-- VODMETA clip=D102133_Ludwig_Path2_PerfectTargetElimination line=133-B branch=Path2 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[133-B]&lt;/span&gt;Let's continue to the next stage.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[New environment elements spawn around you. It looks like a combat training area. You're in the small starting area and there's a long corridor ahead of you.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102134_Ludwig_ReloadBothFirearms`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102134_Ludwig_ReloadBothFirearms line=134-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[134-A]&lt;/span&gt;Please reload both firearms. We’ll continue after you’ve reloaded.
&lt;!-- VODMETA clip=D102134_Ludwig_ReloadBothFirearms line=134-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[134-B]&lt;/span&gt;Hurry up, Mr. Anderson. You should know how to do this by now.
&lt;!-- VODMETA clip=D102134_Ludwig_ReloadBothFirearms line=134-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[134-C]&lt;/span&gt;Just follow the visual guides, Mr. Anderson. I’ll wait.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102135_Ludwig_TargetsThatShootBack`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102135_Ludwig_TargetsThatShootBack line=135 branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[135]&lt;/span&gt;It’s time to test how well you do against targets that shoot back.]

|action&gt;[Simulated enemy donut soldiers will start coming out. They stand still and fire in your direction, mostly missing, for basic training.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102139_Ludwig_Path1_OutOfAmmoPistol`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102139_Ludwig_Path1_OutOfAmmoPistol line=139 branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[139]&lt;/span&gt;You’re out of ammunition in your pistol. Switch to your assault rifle.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102140_Ludwig_Path2_OutOfAmmoRifle`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102140_Ludwig_Path2_OutOfAmmoRifle line=140 branch=Path2 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[140]&lt;/span&gt;You’re out of ammunition in your assault rifle. Switch to your pistol.]

|action&gt;[When your ammo runs out, the rest of the enemies scatter away.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102141_Ludwig_ScavengeMags`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102141_Ludwig_ScavengeMags line=141-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[141-A]&lt;/span&gt;You’ve expended all your ammunition, but you can always scavenge more from enemies.
&lt;!-- VODMETA clip=D102141_Ludwig_ScavengeMags line=141-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[141-B]&lt;/span&gt;Go ahead and scavenge ammunition from your defeated enemies.
&lt;!-- VODMETA clip=D102141_Ludwig_ScavengeMags line=141-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[141-C]&lt;/span&gt;Please grab magazines off an enemy.]

|action&gt;[You move up and scavenge ammo.]

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You grab a Donut AR-56&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102145_Ludwig_If_PickUpDonutAR56`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102145_Ludwig_If_PickUpDonutAR56 line=145-A branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[145-A]&lt;/span&gt;You just picked up the Donut-made AR-56. That's fine. I'm not offened if you prefer enemy's designs over Muffin-made weaponry.
&lt;!-- VODMETA clip=D102145_Ludwig_If_PickUpDonutAR56 line=145-B branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[145-B]&lt;/span&gt;Just note that picking up a new primary firearm will replace your currently holstered primary firearm.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102146_Ludwig_KeepScavengingMags`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102146_Ludwig_KeepScavengingMags line=146-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[146-A]&lt;/span&gt;Any full magazines you pick up and drop will immediately go to your front inventory until you have reached maximum capacity. You may carry up to three magazines per class of firearms.
&lt;!-- VODMETA clip=D102146_Ludwig_KeepScavengingMags line=146-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[146-B]&lt;/span&gt;Scavenge magazines until your inventory is full, Mr. Anderson.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102146_Ludwig_KeepScavengingMags`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102146_Ludwig_KeepScavengingMags line=146-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[146-C]&lt;/span&gt;Scavenge three pistol magazines and three rifle magazines.
&lt;!-- VODMETA clip=D102146_Ludwig_KeepScavengingMags line=146-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[146-D]&lt;/span&gt;Please scavenge more magazines.
&lt;!-- VODMETA clip=D102146_Ludwig_KeepScavengingMags line=146-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[146-E]&lt;/span&gt;I’ll wait for you to finish scavenging.]

|action&gt;[You fill your inventory with magazines.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102151_Ludwig_FinalPhaseOfTraining`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102151_Ludwig_FinalPhaseOfTraining line=151 branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[151]&lt;/span&gt;Now that your inventory is full, let’s begin the final phase of your weapons training.]

|action&gt;[Button presses can be heard from Ludwig outside the simulation, clearly indicating he's triggering a new sequence. You spawn in a new room with no doors or windows. You hear Donut voices.]
|action&gt;[This segment doubles as a breaching-charge drill using Sim Labs Cit Cat Combustible Composition (C4).]

|name&gt;[DONUT OP #1]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102152_DonutOp1_Breaching`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102152_DonutOp1_Breaching line=152 branch=Main speaker=Donut Op #1 --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[152]&lt;/span&gt;Breaching—stand clear!]

|action&gt;[A wall is breached from the outside.]

|name&gt;[DONUT OP #2]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102153_DonutOp2_FlashBang`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102153_DonutOp2_FlashBang line=153 branch=Main speaker=Donut Op #2 --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[153]&lt;/span&gt;Flash bang out!]

|action&gt;[A blue Tootsie Roll lollipop grenade is thrown in the room. It goes off and you are blinded. When your vision clears, enemies are in the room shooting at you.]

|name&gt;[DONUT OP #1]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102154_DonutOp1_Contact`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102154_DonutOp1_Contact line=154 branch=Main speaker=Donut Op #1 --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[154]&lt;/span&gt;Enemy contact!]

|action&gt;[You eliminate all the enemy donuts.]

&lt;tw-hook name=&quot;branch-path1&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You took heavy damage&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path1 --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102155_Ludwig_Path1_HeavyDamageTaken`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102155_Ludwig_Path1_HeavyDamageTaken line=155 branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[155]&lt;/span&gt;Hmm. Diagnostics show you would have died many times over. Mr. Anderson, you must always remain vigilant for an enemy response. They may strike when you least expect it.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-path2&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You took light damage&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path2 --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102156_Ludwig_Path2_LightDamageTaken`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102156_Ludwig_Path2_LightDamageTaken line=156 branch=Path2 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[156]&lt;/span&gt;You handled yourself rather well, Mr. Anderson, considering the circumstances. Fantastic work!]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102157_Ludwig_TootsyPopGrenadeIntro`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102157_Ludwig_TootsyPopGrenadeIntro line=157-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[157-A]&lt;/span&gt;Now, you might be wondering where that blinding flash came from. That, was a blue &quot;Tootsy Pop&quot; flashbang grenade.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102157_Ludwig_TootsyPopGrenadeIntro`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102157_Ludwig_TootsyPopGrenadeIntro line=157-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[157-B]&lt;/span&gt;Different Tootsy Pop grenades are color‑coded by function.]

|action&gt;[The environment shifts. It's a large area with tall ceilings and cinderblocks that are too strong for bullets to penetrate. Enemies can be partially seen hiding behind that cover.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102157_Ludwig_TootsyPopGrenadeIntro`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102157_Ludwig_TootsyPopGrenadeIntro line=157-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[157-C]&lt;/span&gt;Brown is fragmentation, blue is flashbang, and there are others you’ll learn later. Grab two of each type to fill your inventory.
&lt;!-- VODMETA clip=D102157_Ludwig_TootsyPopGrenadeIntro line=157-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[157-D]&lt;/span&gt;Simply grab and release grenades to add them to your inventory.
&lt;!-- VODMETA clip=D102157_Ludwig_TootsyPopGrenadeIntro line=157-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[157-E]&lt;/span&gt;Please pick up the remaining grenades, Mr. Anderson. We can move on once you have filled your inventory.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102159_Ludwig_If_PulledOffWrapperEarly`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102159_Ludwig_If_PulledOffWrapperEarly line=159 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[159]&lt;/span&gt;Mr. Anderson, tearing off the wrapper arms the grenade. Let’s not get ahead of ourselves.]

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You put a live Tootsy Pop grenade in your mouth&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |action&gt;[A Tootsy Pop crunch sound is heard.]
  
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102160_Ludwig_If_OutOfGrenades`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102160_Ludwig_If_OutOfGrenades line=160 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[160]&lt;/span&gt;You're grenades are depleted. I've added more to your inventory.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102161_Ludwig_GrenadeInstruction`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102161_Ludwig_GrenadeInstruction line=161-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[161-A]&lt;/span&gt;Enemies often hide behind material bullets can’t penetrate.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You toss a grenade without pulling off the wrapper first&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102161_Ludwig_GrenadeInstruction`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102161_Ludwig_GrenadeInstruction line=161-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[161-B]&lt;/span&gt;In such situations, it would be wise to make use of the brown Tootsy Pop Fragmentation Grenade, in order to dislodge the enemy.
&lt;!-- VODMETA clip=D102161_Ludwig_GrenadeInstruction line=161-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[161-C]&lt;/span&gt;To utilize a grenade, simply rip off the wrapper with either your hand or mouth, then toss the grenade at your intended target. Tootsy Pop grenades have a 5 second fuze until detonation.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You miss your grenade toss&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102161_Ludwig_GrenadeInstruction`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102161_Ludwig_GrenadeInstruction line=161-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[161-D]&lt;/span&gt;Please toss a brown Tootsy Pop fragmentation grenade behind the enemy cover.
&lt;!-- VODMETA clip=D102161_Ludwig_GrenadeInstruction line=161-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[161-E]&lt;/span&gt;Tear off the wrapper with your mouth, then toss the grenade.]

  |action&gt;[Your inventory has more grenades.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You eliminate the enemies with the wrong grenade&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102163_Ludwig_If_GrenadeInMouth`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102163_Ludwig_If_GrenadeInMouth line=163 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[163]&lt;/span&gt;Crunching a Tootsy Pop grenade in your mouth converts it to an impact fuze instead of a time delayed. It's also a good place to store an extra grenade, if you so wish.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You eliminate the enemies without using a frag grenade&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102164_Ludwig_If_RemoveWrapperReminder`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102164_Ludwig_If_RemoveWrapperReminder line=164 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[164]&lt;/span&gt;Remember to tear the wrapper off first, Mr. Anderson. Tootsy Pop grenades will not activate until the wrapper comes off.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102165_Ludwig_If_MissedToss`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102165_Ludwig_If_MissedToss line=165 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[165]&lt;/span&gt;Hmm. You appear to have missed the enemy. I’ll equip you with more grenades for this exercise.]

|action&gt;[An entirely new and most elaborate setup spawns with enemies in different positions. There are signs explaining “throw a brown fragmentation grenade here” or “throw red incendiary grenade here.” Although you can do it your own way, the instructions clearly want a specific method.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102166_Ludwig_If_WrongGrenade`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102166_Ludwig_If_WrongGrenade line=166 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[166]&lt;/span&gt;That was a blue flash‑bang. Please use a brown fragmentation grenade.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102167_Ludwig_If_NoFragUsed`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102167_Ludwig_If_NoFragUsed line=167 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[167]&lt;/span&gt;…or you can ignore me and do that instead.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102168_Ludwig_FinalTestIntro`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102168_Ludwig_FinalTestIntro line=168-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[168-A]&lt;/span&gt;That’s enough instruction. Time for a test of your combat proficiency.
&lt;!-- VODMETA clip=D102168_Ludwig_FinalTestIntro line=168-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[168-B]&lt;/span&gt;It is completely up to you how you choose to handle this test. I simply put some subtle suggestions of things you could do.]

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You don't follow the instructions exactly&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102170_Ludwig_If_NotFollowingHints`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102170_Ludwig_If_NotFollowingHints line=170 branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[170]&lt;/span&gt;I mean, that’s not how you’re supposed to do it, but alright.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102171_Ludwig_HostageAdvice`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102171_Ludwig_HostageAdvice line=171 branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[171]&lt;/span&gt;This final room has a Muffin hostage. I strongly suggest tossing a blue flash‑bang grenade inside before entering.]

&lt;tw-hook name=&quot;branch-path1&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You kill the hostage&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path1 --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102172_Ludwig_Path1_HostageKilled`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102172_Ludwig_Path1_HostageKilled line=172 branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[172]&lt;/span&gt;Butter biscuits, Mr. Anderson! You were supposed to save the hostage, not get them killed. Oh well, perhaps the next test subject will do better.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-path2&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You save the hostage&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path2 --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102173_Ludwig_Path2_HostageSaved`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102173_Ludwig_Path2_HostageSaved line=173 branch=Path2 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[173]&lt;/span&gt;Wow! You are one of the few test subjects that actually managed to save the hostage. Fantastic work, Mr. Anderson.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[A portal opens up under you and you fall through, appearing back at the starting location of the training simulation. Your weapons stay behind.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102174_Ludwig_ReturnSurface`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102174_Ludwig_ReturnSurface line=174 branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[174]&lt;/span&gt;Let’s return you to the surface. You won’t be needing those weapons anymore.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102201_Ludwig_MoreAdvancedTraining`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102201_Ludwig_MoreAdvancedTraining line=201-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[201-A]&lt;/span&gt;Now that you have a solid grasp of the basics, we shall begin more advanced training at our next location.]




|action&gt;[The gate leading outside of the starting area opens.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102201_Ludwig_MoreAdvancedTraining`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102201_Ludwig_MoreAdvancedTraining line=201-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[201-B]&lt;/span&gt;Follow the path beyond the gate; it will lead you to Super Awesome Adventure Candy Land™, the most amazing, super awesome place in all of everywhere. Also trademarked.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102203_Ludwig_HiddenSnipersMonologue`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-A]&lt;/span&gt;As you are well aware, our experimental simulations, here at Sim Labs, can sometimes often be extremely dangerous.]

---
---

|action&gt;[You follow the path.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102203_Ludwig_HiddenSnipersMonologue`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-B]&lt;/span&gt;Which is of course why we utilize expendable test subjects, like yourself, in the first place. After all, we wouldn't want to lose anything of value testing potentially dangerous simulations, would we now? Ha ha ha!
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-C]&lt;/span&gt;But on a serious note, you are a very expensive asset to manufacture, Mr. Anderson, so it is imperative you listen to my instructions to avoid a premature catostrophic loss.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-D]&lt;/span&gt;And, by far, my most important instruction is that... let's see, how do I put this?
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-E]&lt;/span&gt;Let's imagine, for a moment, that your entire existence is all part of some video game.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-F branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-F]&lt;/span&gt;Which, obviously, it is not. But just for a brief moment, let's say this hypothetical video game, which you are a part of, was developed be a relatively small developer team, and so they put all their effort into constructing a mostly linear story.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-G branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-G]&lt;/span&gt;And sure, there might be some... narrative deviations here and there. Perhaps even a big decision you can make later in the story. (ahem) Foreshadowing.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-H branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-H]&lt;/span&gt;But for the most part, it would be best to navigate such a story-focused experience with a sense of decorum.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-I branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-I]&lt;/span&gt;For instance, if a character in this hypothetical video game requests that you follow them or if it sounds like they are discussing something important, you wouldn't just wander off and ignore them entirely. No, that would not be polite.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-J branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-J]&lt;/span&gt;You would naturally be there, in the moment. Just play along with it, is what I'm trying to say. Don't deliberately try to ruin your own experience.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-K branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-K]&lt;/span&gt;The reason I mention all this is because our simulations have... this problem... with hidden snipers... yes, that's it, a hidden snipers problem.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-L branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-L]&lt;/span&gt;While I can assure you, our Sim Labs simulations are absolute state-of-the-art open worlds, where you are theoretically unrestricted, we’ve discovered that whenever a test subject, such as yourself, strays too far off in strange directions, or even if you simply take an unusual action, like hypothetically killing a main character required for the story to progress, a hidden sniper will eliminate you, for some odd reason.
&lt;!-- VODMETA clip=D102203_Ludwig_HiddenSnipersMonologue line=203-M branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[203-M]&lt;/span&gt;We honestly haven't the slightest idea why this happens or where these hidden snipers even come from. But please do mindful of this deadly hazard for the entire duration of you experience.]

|action&gt;[You reach a fork in the road. The left path is blocked off with danger signs and warnings of death ahead. The right path continues on, with a signpost indicating &quot;To Super Awesome Adventure Candyland™&quot;. The left sign reads &quot;DO NOT ENTER&quot;.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102204_Ludwig_ForkInTheRoad`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102204_Ludwig_ForkInTheRoad line=204-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[204-A]&lt;/span&gt;Ah, a fork in the road. Classic conundrum. I'm sure you can deduce the correct path you should take, in this instance.
&lt;!-- VODMETA clip=D102204_Ludwig_ForkInTheRoad line=204-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[204-B]&lt;/span&gt;Do continue to the right, towards Super Awesome Adventure Candyland™. I assure you, there's nothing of interest down that left path. Nothing at all.]

&lt;tw-hook name=&quot;branch-path1&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You go left&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path1 --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102205_Ludwig_Path1_DoNotEnterSign`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102205_Ludwig_Path1_DoNotEnterSign line=205 branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[205]&lt;/span&gt;Mr. Anderson? You do see the comically large &quot;DO NOT ENTER&quot; sign, don't you? Perhaps your visual sensors need recalibration.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102206_Ludwig_Path1_DidntListenToAWord`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102206_Ludwig_Path1_DidntListenToAWord line=206-A branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[206-A]&lt;/span&gt;It's as if you didn't listen to a word I said earlier.
&lt;!-- VODMETA clip=D102206_Ludwig_Path1_DidntListenToAWord line=206-B branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[206-B]&lt;/span&gt;Look. I understand you want to test if our simulations are indeed open worlds, which they definitely are, but I must advise against this course of action, Mr. Anderson. Veering off course like this is extremely dangerous.]

  |action&gt;[codex: Continuing along the left path...]

  |action&gt;[You see a treasure chest in the distance.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102207_Ludwig_Path1_TreasureIsntReal`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102207_Ludwig_Path1_TreasureIsntReal line=207-A branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[207-A]&lt;/span&gt;Oh no. He sees it.
&lt;!-- VODMETA clip=D102207_Ludwig_Path1_TreasureIsntReal line=207-B branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[207-B]&lt;/span&gt;That treasure chest isn't real, Mr. Anderson. It's a mirage, a cruel trick of the light. And even if it was real, you'll never reach it because of the hidden snipers.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102208_Ludwig_Path1_WarningShots`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102208_Ludwig_Path1_WarningShots line=208-A branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[208-A]&lt;/span&gt;They don't always give warning shots, Mr. Anderson. I suggest you turn back immediately!
&lt;!-- VODMETA clip=D102208_Ludwig_Path1_WarningShots line=208-B branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[208-B]&lt;/span&gt;Continuing further down this unsanctioned path will result in your demise. And as you should very well know... if you die in a simulation... you die in reality.]

  |action&gt;[A sniper fires a warning shot overhead.]

  &lt;tw-hook name=&quot;branch-path1-if&quot;&gt;&lt;details&gt;
    &lt;summary&gt;You turn back&lt;/summary&gt;
    &lt;!-- VODBRANCH canonical=Path1_If --&gt;
    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102209_Ludwig_Path1_If_TurnedBack`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102209_Ludwig_Path1_If_TurnedBack line=209 branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[209]&lt;/span&gt;An excellent decision, Mr. Anderson. Your ability to recognize and avoid danger will serve you well in future simulations.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  &lt;tw-hook name=&quot;branch-path1&quot;&gt;&lt;details&gt;
    &lt;summary&gt;You keep going left&lt;/summary&gt;
    &lt;!-- VODBRANCH canonical=Path1 --&gt;
    |action&gt;[A hidden sniper lands a lethal shot. You die.]

    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102210_Ludwig_Path1_YouDied`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-A branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-A]&lt;/span&gt;Oh no! Mr. Anderson! I can't believe you're actually dead! This is dreadful! I...
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-B branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-B]&lt;/span&gt;...wait a moment. What’s going on here? Why is there a thought provoking quote? Oh, don’t tell me…
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-C branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-C]&lt;/span&gt;Karen, did you disable my Ultra Realism Haptic Engine, trademarked?
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-D branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-D]&lt;/span&gt;Yes, the one that kills you in real life if you die in a simulation.]

    |action&gt;[Ludwig calls Karen.]

    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102210_Ludwig_Path1_YouDied`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-E branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-E]&lt;/span&gt;“Unethical”? Come on Karen, don’t be such a Jennifer.
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-F branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-F]&lt;/span&gt;What do you mean “I’m the only one who disagrees with this decision”?
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-G branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-G]&lt;/span&gt;Well then, tell the whole board of directors they are all a bunch of idiots.]

    |action&gt;[Ludwig hangs up.]

    |name&gt;[LUDWIG]
    |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102210_Ludwig_Path1_YouDied`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-H branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-H]&lt;/span&gt;(Sigh.) I’m sorry, Mr. Anderson. Management decided to disable my Ultra Realism Haptic Engine, trademarked, so instead of being killed in real life and getting the full immersive experience, you’ll just see some random inspirational quote or whatever, before you restart at a checkpoint.
&lt;!-- VODMETA clip=D102210_Ludwig_Path1_YouDied line=210-I branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[210-I]&lt;/span&gt;I apologize for this inconvenience.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102211_Ludwig_Path1_If_BadPathAgain`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102211_Ludwig_Path1_If_BadPathAgain line=211 branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[211]&lt;/span&gt;Really, Mr. Anderson? Again? I admire your persistence, but I assure you, the result will be the same. The hidden snipers are quite consistent in their work.]

    |action&gt;[You see the thought-provoking quote fade away, then a prompt to &quot;remove simulator headset from face&quot; appears. Doing so restarts you at the fork in the road checkpoint.]

    &lt;tw-hook name=&quot;branch-path1-if&quot;&gt;&lt;details&gt;
      &lt;summary&gt;You attempt the left path again&lt;/summary&gt;
      &lt;!-- VODBRANCH canonical=Path1_If --&gt;
      |name&gt;[LUDWIG]
      |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102212_Ludwig_Path1_If_BadPathAgainX2`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102212_Ludwig_Path1_If_BadPathAgainX2 line=212 branch=Path1_If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[212]&lt;/span&gt;You know what, Mr. Anderson. I'm just gonna leave. I'll return back after you've decided to take the right path.]
    &lt;/details&gt;&lt;/tw-hook&gt;
    
    &lt;tw-hook name=&quot;branch-path1&quot;&gt;&lt;details&gt;
      &lt;summary&gt;You go right this time&lt;/summary&gt;
      &lt;!-- VODBRANCH canonical=Path1 --&gt;
      |name&gt;[LUDWIG]
      |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102213_Ludwig_Path1_PathOfLeastResistance`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102213_Ludwig_Path1_PathOfLeastResistance line=213 branch=Path1 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[213]&lt;/span&gt;Ah, finally choosing the path of least resistance, I see. Excellent choice, Mr. Anderson. Now, let's continue our journey to Super Awesome Adventure Candyland™.]
    &lt;/details&gt;&lt;/tw-hook&gt;
  &lt;/details&gt;&lt;/tw-hook&gt;
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-path2&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You go right&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=Path2 --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102214_Ludwig_Path2_RightPath`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102214_Ludwig_Path2_RightPath line=214 branch=Path2 speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[214]&lt;/span&gt;You had me nervous for a moment there, but I'm glad you chose the right path.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[Once you are on the right path (via direct choice or after resetting at the checkpoint), the story continues with no further branching here.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102215_Ludwig_IMustWarnYou`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102215_Ludwig_IMustWarnYou line=215-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[215-A]&lt;/span&gt;I must warn you, Mr. Anderson. When you arrive at Super Awesome Adventure Candy Land™, please try to maintain some composure.
&lt;!-- VODMETA clip=D102215_Ludwig_IMustWarnYou line=215-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[215-B]&lt;/span&gt;The sheer magnificence of this place has paralyzed former test subjects in a permanent state of blissful happiness.
&lt;!-- VODMETA clip=D102215_Ludwig_IMustWarnYou line=215-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[215-C]&lt;/span&gt;Even after exiting this simulation and conducting years of depressing therapy, we could not strip the joy and satisfaction from their hearts. Truly sad to see really.
&lt;!-- VODMETA clip=D102215_Ludwig_IMustWarnYou line=215-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[215-D]&lt;/span&gt;As you might imagine, such a magnificent place could only exist in a highly advanced simulation. And our simulations here at Sim Labs are, simply put, the very best.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102216_Ludwig_TunnelHasCollapsed`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102216_Ludwig_TunnelHasCollapsed line=216-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[216-A]&lt;/span&gt;What's this? It appears the tunnel entrance to Super Awesome Adventure Candy Land™ has collapsed.
&lt;!-- VODMETA clip=D102216_Ludwig_TunnelHasCollapsed line=216-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[216-B]&lt;/span&gt;No matter. Because our simulations are designed upon a multi-layered spacetime architecture, each layer deeper within our simulations will effectively place you further in the past.]

---
---

|action&gt;[You reach the tunnel entrance to Super Awesome Adventure Candy Land™ but find it has collapsed.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102216_Ludwig_TunnelHasCollapsed`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102216_Ludwig_TunnelHasCollapsed line=216-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[216-C]&lt;/span&gt;That means, we can simply have you enter another simulation within this one, and that should put you at a time before the collapse of this tunnel.
&lt;!-- VODMETA clip=D102216_Ludwig_TunnelHasCollapsed line=216-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[216-D]&lt;/span&gt;I'm sending you a simulator now. Put it on your face to enter the simulated simulation.
&lt;!-- VODMETA clip=D102216_Ludwig_TunnelHasCollapsed line=216-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[216-E]&lt;/span&gt;Oh, and I'm sending you a temporary defensive upgrade, as a precaution.]

|action&gt;[Ludwig sends a simulator crashing down like a meteor, briefly opening the tunnel.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102216_Ludwig_TunnelHasCollapsed`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102216_Ludwig_TunnelHasCollapsed line=216-F branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[216-F]&lt;/span&gt;Wait, what am I thinking? I'm only sending you a few days back in the past. There's nothing dangerous at that point in history. Let me just delete that upgrade really quick.]

|action&gt;[A meteor slams into the unwanted upgrade, deleting it. The impact sends the simulator flying into a nearby tree.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102216_Ludwig_TunnelHasCollapsed`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102216_Ludwig_TunnelHasCollapsed line=216-G branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[216-G]&lt;/span&gt;Aw cranberry sauce. Looks like the simulator is stuck in that tree. Well, this isn't part of the official training, but you must climb that tree in order to retrieve the simulator.]

|action&gt;[A climbing guidepost drops near the tree.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102217_Ludwig_Loop_PleaseClimb`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102217_Ludwig_Loop_PleaseClimb line=217-A branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[217-A]&lt;/span&gt;Simply follow the climbing instructions on the guide post, Mr. Anderson.
&lt;!-- VODMETA clip=D102217_Ludwig_Loop_PleaseClimb line=217-B branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[217-B]&lt;/span&gt;Go on and climb the tree.]

|action&gt;[You begin climbing while Ludwig repeats instructions.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102217_Ludwig_Loop_PleaseClimb`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102217_Ludwig_Loop_PleaseClimb line=217-C branch=Loop speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[217-C]&lt;/span&gt;Please climb the tree, Mr. Anderson.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102218_Ludwig_SimulationsWithinSimulations`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102218_Ludwig_SimulationsWithinSimulations line=218-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[218-A]&lt;/span&gt;Before you wear the simulator, Mr. Anderson, I must provide you with a word of caution.]

|action&gt;[A sign about climbing crashes near the tree. You begin to climb.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102218_Ludwig_SimulationsWithinSimulations`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102218_Ludwig_SimulationsWithinSimulations line=218-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[218-B]&lt;/span&gt;Whenever entering simulations within simulations, you always run the risk of getting stuck multiple layers deeper than intended.
&lt;!-- VODMETA clip=D102218_Ludwig_SimulationsWithinSimulations line=218-C branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[218-C]&lt;/span&gt;It may seem you’re just entering one layer in, but in actuality, you could end up ten, twenty, or even hundreds of layer deep within the simulation stack.
&lt;!-- VODMETA clip=D102218_Ludwig_SimulationsWithinSimulations line=218-D branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[218-D]&lt;/span&gt;In which case, you must exit multiple simulations before you can truly exit the initial simulation completely.
&lt;!-- VODMETA clip=D102218_Ludwig_SimulationsWithinSimulations line=218-E branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[218-E]&lt;/span&gt;That reminds me of one expirement I recall. We tried to find the deepest layer of the simulation stack. Never did. For all we know, it could be infinitely recursive.
&lt;!-- VODMETA clip=D102218_Ludwig_SimulationsWithinSimulations line=218-F branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[218-F]&lt;/span&gt;In fact, I believe we still have that test subject in there. He's been floating for eons in the dark void of primordial space.]

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You reach the top&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |action&gt;[You near the top of the tree.]
  
  |action&gt;[As you reach for the simulator, a gentle breeze knocks it from the branch...]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-if&quot;&gt;&lt;details&gt;
  &lt;summary&gt;You don't reach the top in time&lt;/summary&gt;
  &lt;!-- VODBRANCH canonical=If --&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102218_Ludwig_SimulationsWithinSimulations`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102218_Ludwig_SimulationsWithinSimulations line=218-G branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[218-G]&lt;/span&gt;Now that I think about it, we should probably pull the plug on him. That’s unethical, even by my standards.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102219_Ludwig_If_StillHaventReachedTop`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102219_Ludwig_If_StillHaventReachedTop line=219-A branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[219-A]&lt;/span&gt;Still haven't reached the top yet? I'm disappointed in your climbing skills. However, we must continue on.]
  
  |action&gt;[A gentle breeze knocks it from the branch...]
&lt;/details&gt;&lt;/tw-hook&gt;

 |action&gt;[The simulator falls on the ground and shatters.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102219_Ludwig_If_StillHaventReachedTop`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102219_Ludwig_If_StillHaventReachedTop line=219-B branch=If speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[219-B]&lt;/span&gt;Let me just trigger a gentle breeze to blow that simulatior off the tree.
&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102220_Ludwig_YouBrokeIt`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102220_Ludwig_YouBrokeIt line=220-A branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[220-A]&lt;/span&gt;You broke it. I can't believe you broke it. Oh well. I suppose I could just send you another simulator.]

|action&gt;[A new simulator crashes down as before.]

|name&gt;[LUDWIG]
|dialogue&gt;[&lt;div class=&quot;vod-hidden-data&quot;&gt;[&lt;span class=&quot;vod-meta-label&quot;&gt;VO Audio File Name:&lt;/span&gt; &lt;span class=&quot;vod-meta-value&quot;&gt;`D102220_Ludwig_YouBrokeIt`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;vod-meta-label&quot;&gt;VO Recording Status:&lt;/span&gt; &lt;span class=&quot;vod-status&quot;&gt;&lt;/span&gt;]&lt;/div&gt;
&lt;!-- VODMETA clip=D102220_Ludwig_YouBrokeIt line=220-B branch=Main speaker=Ludwig --&gt;
&lt;span class=&quot;vod-line-code&quot;&gt;[220-B]&lt;/span&gt;Hurry and put it on, Mr. Anderson. We’re behind schedule.]

|action&gt;[You put on the simulator.]


&lt;/div&gt;

---
---

MIGRATION AUDIT (A1-S02, legacy CSV -> Twine):
- Source checked: Assets/__TSTM__/READMEs/VO_Dialogue/_DEPRECATED/Scenes/VOD_Sheet_A01_S02.csv
- Branch hook names in this passage were normalized to semantic hook names (`branch-if`, `branch-loop`, `branch-path1`, `branch-path1-if`, `branch-path2`, plus `branch-yes`/`branch-no`).
- Line-code coverage check result: all CSV line codes for A1-S02 already exist in this Twine passage.

Lines from CSV not found in Twine (by line code):
- none

Follow-up review targets (content/placement quality, not missing lines):
- Inspect path-splitting around the 129/131 group in the "Rare Case" section to confirm the intended path ownership.
- Confirm any remaining `VODMETA branch=...` labels against intended canonical branch behavior after narrative polish.


---
---
---
---</tw-passagedata><tw-passagedata pid="4" name="Act 1" tags="Timeframe_Primitive Timeframe_Early Timeframe_Modern Timeframe_Advanced" position="725,475" size="100,100">|specialtitle&gt;[(text-style:&quot;underline&quot;)[The Simulation™]
(text-size:5)[Act 1]]

(align:&quot;==&gt;&quot;)[[[Continue...|A1-S01]]]</tw-passagedata><tw-passagedata pid="5" name="template" tags="" position="525,225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 0]
]

|action&gt;[]

|name&gt;[]
|parenthetical&gt;[()]
|dialogue&gt;[]

|action&gt;[]

|name&gt;[]
|dialogue&gt;[]

&lt;img src=&quot;&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: )]

&lt;img src=&quot;&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]

&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit49&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit49&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]

&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]





(align:&quot;==&gt;&quot;)[[[Continue...|...]]]
















---
SCRIPT:

|action&gt;[]

|name&gt;[]
|parenthetical&gt;[()]
|dialogue&gt;[]

|action&gt;[]

|name&gt;[]
|dialogue&gt;[]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Nod YES&lt;/summary&gt;
  |name&gt;[]
  |dialogue&gt;[]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Nod NO&lt;/summary&gt;
  |name&gt;[]
  |dialogue&gt;[]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Wait&lt;/summary&gt;
  |name&gt;[]
  |dialogue&gt;[]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-a&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Action A&lt;/summary&gt;
  |name&gt;[]
  |dialogue&gt;[]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-b&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Action B&lt;/summary&gt;
  |name&gt;[]
  |dialogue&gt;[]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-c&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Action C&lt;/summary&gt;
  |name&gt;[]
  |dialogue&gt;[]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-d&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Action D&lt;/summary&gt;
  |name&gt;[]
  |dialogue&gt;[]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-e&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Action E&lt;/summary&gt;
  |name&gt;[]
  |dialogue&gt;[]
&lt;/details&gt;&lt;/tw-hook&gt;

---
|action&gt;[]

|name&gt;[]
|dialogue&gt;[]</tw-passagedata><tw-passagedata pid="6" name="..." tags="" position="525,350" size="100,100"></tw-passagedata><tw-passagedata pid="7" name="A1-S04" tags="Timeframe_Advanced" position="725,975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 04]
THE SIMULATION™
INT - DAY - SIM LABS HQ]

You are back in your starting room. There are signs of damage to the room from what looks like a bombing raid. Professor Ludwig arrives in the room, talking to someone through an earpiece. Ludwig explains that all of the equipment that can run simulations at Sim Labs has been destroyed... All except one. Hardware for The Simulation™, a proprietary and highly experimental simulation, is still functional. Ludwig does not like the idea of running The Simulation™, but he is convinced there is no other choice. Ludwig ominously replies to the scientist through his earpiece: &quot;Prepare, The Simulation, Trademarked.&quot; Ludwig ends the call and turns to you. He warns you that The Simulation™ is the most advanced, highly expiremental simulation ever conceived. Entering this simulation could be extremely dangerous, painful, and you will most certainly die upon entry. But what truely disturbs Ludwig is The Simulation™&#39;s apparent effect on reality.


&lt;img src=&quot;https://i.imgur.com/uUmHIO1.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
&lt;img src=&quot;https://i.imgur.com/HSoi8A7.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: This looks like a different room, but this should be &quot;Room 101&quot;, which is the room you were in before entering the training simulation. The room shouldn&#39;t appear so damaged. Maybe just some ceiling tiles displaced, a knocked over plant in the corner, and slight damage like that. This room is deep underground so it wouldn&#39;t be heavily affected by a bombing raid.)]
He puts on protective gear and places the simulator for The Simulation™ on a nearby platform. Ludwig then leaves the room. The simulator is ready for you to wear.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A1-S05]]]

















|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 04]
]

|action&gt;[You are back in Room 101 at Sim Labs. There are minor signs of damage from a bombing raid: some displaced ceiling tiles, a knocked over plant in the corner, and slight cracks in the walls. LUDWIG bursts into the room, slamming the door behind him. He&#39;s talking urgently to someone through an earpiece.]

|name&gt;[LUDWIG]
|dialogue&gt;[Yes, I&#39;ve checked the backup servers. Any hardware that can run a simulation has been destroyed in the attack...
The Simulation™? Well yes, that equipment is intact, but that&#39;s proprietary hardware. It only works for The Simulation™. It&#39;s not compatible with any other Sim Labs simulations...
Have you gone mad?! Do you not recall what happened last time we tried running The Simulation™? There must be some other option...
I suppose you&#39;re right. We have no choice. Prepare... The Simulation™.]

|action&gt;[Ludwig removes the earpiece and turns to address you, his expression grave.]

|name&gt;[LUDWIG]
|dialogue&gt;[They say desperate times call for desperate measures, but this, this is suicide. Brace yourself, Mr. Anderson, for you are about to enter our most advanced, highly experimental simulation, ever conceived.]

|action&gt;[Industrial mechanical noises can be heard in the background as if a highly complex process is preparing The Simulation™.]

|name&gt;[LUDWIG]
|dialogue&gt;[In this simulation, we cannot monitor you, we cannot help you, and there&#39;s a good chance you&#39;ll die a horrible, painful death upon entry. But what truly disturbs me about The Simulation™ is its apparent effect on reality. This reality. Of course, a mere simulation can never alter reality itself. However, there are... inexplicable anomalies. Not quantifiable. Rather, I can&#39;t believe I&#39;m saying this, but it&#39;s a feeling... a feeling that the past is not what it used to be... Am I insane? Do I sound insane to you?
Do I sound insane to you, Mr. Anderson?]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Nod YES&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[Then perhaps I&#39;ve stared into the abyss for far too long.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Nod NO&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[At least I&#39;m not alone in my madness.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;WAIT&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[Your silence is not very reassuring.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[A compartment in the wall opens with a hiss, revealing the simulator headset loaded with The Simulation™. Dramatic smoke effects surround it. Ludwig dons protective gear and uses prongs to carefully place the simulator on a nearby desk.]

|name&gt;[LUDWIG]
|dialogue&gt;[It is ready. While you&#39;re in The Simulation™, we will be working diligently to extract you. That way you may report on what you&#39;ve experience. And maybe, just maybe, this simulation will finally be the one.
I&#39;ll leave this simulator for you to put on, whenever you&#39;re ready. Godspeed, Mr. Anderson. Godspeed.]

|action&gt;[Ludwig exits the room, leaving you alone with the simulator. The device boots up with glowing blue elements activating, like on a standard Sim Labs simulator. But this one seems to hum with an otherworldly energy, inviting yet ominous. Exhaust vents on the simulator open up, revealing more blue glowing elements that ramp up in brightness, as if to expel a large amount of heat energy. The display turns on. Swirling psychedelic vortices of fantastic colors can be seen through the simulator headset display. You pick it up, put it on your face, and enter... The Simulation™.]

















</tw-passagedata><tw-passagedata pid="8" name="A1-S05" tags="Timeframe_Advanced" position="725,1100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 05]
THE REAL WORLD
INT &amp; EXT - DAY - FACILITY X]
&lt;img src=&quot;https://i.imgur.com/9D8lJ6M.jpg&quot; class=&quot;fitHalf&quot;&gt;
After entering The Simulation™, you fall through a wormhole-like vortex of cosmic colors. You hear faint, distorted voices discussing &quot;signal interception&quot; and extraction. The simulator is abruptly removed from your face, and you find yourself in a small room at a military facility with Sergeant Kegan (a Bar Donut) and a Filled Donut Scientist.


&lt;img src=&quot;https://i.imgur.com/Ov5yUuj.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/wsfNJRH.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/nGxMwOy.jpg&quot; class=&quot;fit49&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/bIXaodx.jpg&quot; class=&quot;fit49&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
Kegan informs you that everything you just experienced was a simulation, and you&#39;ve now returned to the &quot;real world&quot;. He explains that you&#39;re one of his soldiers on a mission to debug a corrupt program (Professor Ludwig) within a simulation. Phase 1 of your mission is complete, and they&#39;re preparing for Phase 2.
Kegan hands you a thumb drive to deliver to Commander Gorg. As you leave, you overhear two donuts talking, one mentioning a delivery to Gorg&#39;s office. You follow this donut, first to an elevator with propaganda posters, then across the base to another building.
Near the building entrance, you encounter an enthusiastic Weapons Range Operator who invites you to shoot some guns. You can choose to accept or decline this optional activity.
You then take another elevator to Gorg&#39;s office, overhearing a conversation between Gorg and General Zimar about military operations and prisoner treatment. After Zimar leaves, you enter and deliver the thumb drive to Gorg.


&lt;img src=&quot;https://i.imgur.com/kaZ7R9F.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/UXQrMb0.jpg&quot; class=&quot;fitHalf&quot;&gt;
Gorg reviews the drive&#39;s contents and makes some comments attesting to Sgt. Kegan&#39;s legendary skill and professionalism. He then receives a call from Kegan and sends you back.


&lt;img src=&quot;https://i.imgur.com/NZSQDnv.jpg&quot; class=&quot;fitHalf&quot;&gt;
Upon return, you find Kegan and the scientists in a panic over Ludwig&#39;s actions in the simulation.


&lt;img src=&quot;https://i.imgur.com/6ZMKPHB.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
There&#39;s a sense of urgency. Kegan briefs you on your next task: to find and activate a distress signal at Sim Labs. Before sending you back into the simulation, Kegan injects something into your head.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A1-S06]]]


NOTE: The first time a faction flag appears, it will be shown here at the end of the scene description...
&lt;img src=&quot;https://i.imgur.com/gGTKqzY.png&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(Donut Defence Legion Flag)]













|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 05]
]

|action&gt;[You are falling through a wormhole-like vortex of cosmic colors. The vortex is redirected. You hear faint, distorted voices.]

|name&gt;[KEGAN]
|dialogue&gt;[What&#39;s the status?]

|name&gt;[FILLED DONUT SCIENTIST]
|dialogue&gt;[Successful capture of the target. 10 seconds till extraction.]

|name&gt;[KEGAN]
|dialogue&gt;[Commence signal interception.]

|name&gt;[FILLED DONUT SCIENTIST]
|dialogue&gt;[5 seconds... 3, 2... Package secure.]

|name&gt;[UNKNOWN]
|dialogue&gt;[Roger tango two four niner.]

|action&gt;[The simulator is abruptly removed from your face. You find yourself in a small room at a military facility. Kegan, a bar donut, and a filled donut scientist are present. Kegan inspects you closely.]

|name&gt;[KEGAN]
|dialogue&gt;[Welcome back, soldier. How are you holding up?]

|name&gt;[FILLED DONUT SCIENTIST]
|dialogue&gt;[Sir, his memories may need time to recover.]

|name&gt;[KEGAN]
|dialogue&gt;[Soldier, I am Sergeant Kegan. Do you remember me?
Do you understand what happened to you just now?
Do you know where you came from, soldier?]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Nod YES&lt;/summary&gt;
  |name&gt;[KEGAN]
  |dialogue&gt;[That&#39;s right, you were in a simulation. Welcome back to the real world. As you know...]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Nod NO&lt;/summary&gt;
  |name&gt;[KEGAN]
  |dialogue&gt;[Everything you just experienced was a simulation. This is the real world. You may not believe me while you recover, but that is the truth.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Wait&lt;/summary&gt;
  |name&gt;[KEGAN]
  |dialogue&gt;[I see you&#39;re still disoriented. Let me explain. Says NO response dialogue.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[Regardless of your response, Kegan continues.]

|name&gt;[KEGAN]
|dialogue&gt;[The simulation you just came from is one of our artificial laboratories. They&#39;re used to assist real scientists with... many things.
Occasionally, a corrupt program within a simulation requires debugging. You just completed phase 1 in that process.]

|action&gt;[Kegan starts a slideshow detailing information on Ludwig.]

|name&gt;[KEGAN]
|dialogue&gt;[Program 867B, also known as Professor Ludwig, is exhibiting unstable behavior and has been scheduled for termination. We will execute this termination once all critical research data is compiled.]

|action&gt;[The filled donut scientist pulls a thumb drive from his computer and hands it to Kegan. Kegan hands you the thumb drive.]

|name&gt;[KEGAN]
|dialogue&gt;[In the meantime, run this to Commander Gorg. You&#39;ll find him in his office. Top floor of the tallest building. Next to the weapons range.
The door is unlocked for you, soldier.
Commander Gorg&#39;s office is in the building near the weapons range. Top floor. Get moving.
Better get moving, soldier.
You should get moving.]

|action&gt;[You exit the room and go down the hall. As you exit, you overhear two donut officers in the hallway—a Bar Donut Officer and a Filled Donut Officer—having a conversation. (This conversation can start before you leave the room. It&#39;s an easter egg if you linger.)]

|name&gt;[BAR DONUT OFFICER]
|dialogue&gt;[Johnson&#39;s diversion gave us enough time to punch a hole through the enemy perimeter and escape. We all made it out. All of us... except Johnson.]

|name&gt;[FILLED DONUT OFFICER]
|dialogue&gt;[That&#39;s a dang shame. Sergeant Johnson was just too good for this world.]

|name&gt;[BAR DONUT OFFICER]
|dialogue&gt;[We made Muffins pay the price. Called in artillery. Blew that whole area sky-high.]

|name&gt;[FILLED DONUT OFFICER]
|dialogue&gt;[That should teach those Muffin fudgebuckets not to mees with us.]

|name&gt;[BAR DONUT OFFICER]
|dialogue&gt;[Don&#39;t count on it. You know Muffins never learn.]

|name&gt;[FILLED DONUT OFFICER]
|dialogue&gt;[Well, you are right about that. Whatchya got there?]

|name&gt;[BAR DONUT OFFICER]
|dialogue&gt;[Classified documents.]

|name&gt;[FILLED DONUT OFFICER]
|dialogue&gt;[What&#39;s it about?]

|name&gt;[BAR DONUT OFFICER]
|dialogue&gt;[Classified.]

|name&gt;[FILLED DONUT OFFICER]
|dialogue&gt;[Alright, keep your secrets.]

|action&gt;[As you approach, their conversation finishes.]

|name&gt;[BAR DONUT OFFICER]
|dialogue&gt;[Anyway, I gotta run these documents up to Commander Gorg&#39;s office.]

|name&gt;[FILLED DONUT OFFICER]
|dialogue&gt;[Don&#39;t keep him waiting. I hear he has the worst temper.]

|action&gt;[You follow the Bar Donut Officer across the street to the tallest building on the base. Near the entrance, you encounter an enthusiastic Ring Donut Weapons Range Operator.]

|name&gt;[RING DONUT WEAPONS RANGE OPERATOR]
|dialogue&gt;[Hey there! You wanna come shoot some guns?]
|dialogue&gt;[What about you officer? We got guns, grenades, targets. Everything you need.
All right, I&#39;ll get you next time.]

|action&gt;[The ring donut weapons range operator asks the bar donut officer, who declines and keeps walking. He then turns to you.]

|name&gt;[RING DONUT WEAPONS RANGE OPERATOR]
|dialogue&gt;[How about you? I assume you&#39;re a soldier... or something? I got too much ammunition. Wanna help me waste some?
So how about it? Wanna shoot some guns?
Wanna help me waste some ammo?]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Nod YES&lt;/summary&gt;
  |name&gt;[RING DONUT WEAPONS RANGE OPERATOR]
  |dialogue&gt;[Yehaw! That&#39;s what I&#39;m talkin&#39; about! Step right in. Pick whatever you want and let it rip.]

  |action&gt;[Inside the weapons range, the ring donut weapons range operator offers extra commentary as you pick up different weapons or items.]

  |name&gt;[RING DONUT WEAPONS RANGE OPERATOR]
  |dialogue&gt;[Oh yeah, that&#39;s a nice one. Can&#39;t go wrong with that piece. You&#39;ll be knockin&#39; down muffins all day with it.]

  |name&gt;[RING DONUT WEAPONS RANGE OPERATOR]
  |dialogue&gt;[That&#39;s the XR-47 rifle. A bit of recoil, but packs a punch. Perfect for shreddin&#39; those muffin troublemakers.]

  |name&gt;[RING DONUT WEAPONS RANGE OPERATOR]
  |dialogue&gt;[Heh, so you like grenades? Always watch the fuse on those. Great for takin&#39; out a group of &#39;em at once.]

  |action&gt;[After you finish your shooting session and decide to leave, the operator sees you off.]

  |name&gt;[RING DONUT WEAPONS RANGE OPERATOR]
  |dialogue&gt;[Come back anytime if you wanna shoot some guns or blow more stuff up!]

  |action&gt;[You then head into the building lobby, where the bar donut officer has already gone ahead.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Nod NO or Keep Walking&lt;/summary&gt;
  |action&gt;[You continue following the bar donut officer, skipping the weapons range altogether. You enter the building lobby with him. You follow him to an elevator. Inside, you notice propaganda posters on the walls. The elevator ascends to the top floor. Eventually, you reach Filled Donut Secretary for Commander Gorg. She is behind her desk.]
  
  |name&gt;[BAR DONUT OFFICER]
  |dialogue&gt;[Good morning, miss. You&#39;re looking pretty today.]

  |name&gt;[FILLED DONUT SECRETARY]
  |dialogue&gt;[Don&#39;t flatter me, officer. Seriously, don&#39;t. You know how the Commander gets when I&#39;m not sticking to business.]

  |name&gt;[BAR DONUT OFFICER]
  |dialogue&gt;[Don&#39;t let me ruin your day. I&#39;m just here to drop off some documents... about our last mission.]

  |name&gt;[FILLED DONUT SECRETARY]
  |dialogue&gt;[Oh... I&#39;m sorry about Sergeant Johnson.]

  |name&gt;[BAR DONUT OFFICER]
  |dialogue&gt;[Ya, me too.]

  |name&gt;[FILLED DONUT SECRETARY]
  |dialogue&gt;[Hey officer. How about we get coffee.. later tonight?]

  |name&gt;[BAR DONUT OFFICER]
  |dialogue&gt;[That sounds nice.]

  |action&gt;[The bar donut officer walks off.]
&lt;/details&gt;&lt;/tw-hook&gt;

---
&lt;!-- After the user finishes either branch (Yes or No), the scene merges. --&gt;

|action&gt;[The filled donut secretary now turns her attention to you.]

|name&gt;[FILLED DONUT SECRETARY]
|dialogue&gt;[Hello, if you have an appointment, you can wait in the... Pardon me, I see you have a delivery from Sergeant Kegan. I&#39;m sure you know the rules. Kegan&#39;s projects are top secret, so that goes directly to Commander Gorg. Not even I am allowed to handle it.]

|action&gt;[The door to Gorg&#39;s office is unlocked.]

|name&gt;[FILLED DONUT SECRETARY]
|dialogue&gt;[He&#39;s currently in a meeting with General Zymar, so please enter quietly.
You may enter Gorg&#39;s office now.
Please enter, but do so quietly.]

|action&gt;[You enter an elevator with propaganda posters. It ascends to Commander Gorg&#39;s office floor.
As you approach, you overhear a conversation between Gorg and General Zymar.]

|name&gt;[GENERAL ZYMAR]
|dialogue&gt;[After breaking through the front here and here, we completely encircled 5 divisions of the enemy force.]

|name&gt;[GORG]
|dialogue&gt;[Yes! That&#39;s what I like to hear!]

|name&gt;[GENERAL ZYMAR]
|dialogue&gt;[Most of the enemies we encircled have already surrendered, so we&#39;ll need to build more camps to house the new prisoners.]

|name&gt;[GORG]
|dialogue&gt;[Prisoners? General Zymar, if we keep taking prisoners, the enemy won&#39;t fear us and they will keep fighting.]

|name&gt;[GENERAL ZYMAR]
|dialogue&gt;[Uh- Aa- You are absolutely correct, Commander Gorg. My appologies. Though if I may suggest, we also captured some manufacturing plants in the same region. We could build a few camps nearby and have the new prisoners manufacture more war supplies, since we are depleting them rather quickly. Sir.]

|name&gt;[GORG]
|dialogue&gt;[Are you suggesting we have these muffin prisoners make the very bullets that will kill their muffin comrades?]

|name&gt;[GENERAL ZYMAR]
|dialogue&gt;[(Scared silence.) Well- I- Uh-.]

|name&gt;[GORG]
|dialogue&gt;[Ha ha ha. General, you&#39;re even more diabolical than I am. Get started on those prison camps right away.]

|name&gt;[GENERAL ZYMAR]
|dialogue&gt;[Yes sir!]

|action&gt;[General Zymar walks out, looking at you with contempt. You enter Gorg&#39;s office.]

|name&gt;[GORG]
|dialogue&gt;[Hey! What is this thing?
(reads your name tag) ... test subject Anderson... Subject...
Who brought this Subject in here?]

|action&gt;[The filled donut secretary steps in and whispers across the room to Gorg.]

|name&gt;[FILLED DONUT SECRETARY]
|dialogue&gt;[He has a delivery from Sergeant Kegan, sir.]

|name&gt;[GORG]
|dialogue&gt;[A delivery? Let me see what you have, subject.
Give it here, subject.
Hand it over.
Come on. I don&#39;t have all day.]

|action&gt;[You hand the thumb drive to Gorg. He walks to his desk and inserts it into his computer, reviewing it privately.]

|name&gt;[GORG]
|dialogue&gt;[Ah, so you&#39;re part of that computer task, stuff... project. Why is he sending me this— Look, I don&#39;t follow all of this technical mumbo-jumbo that Sergeant Kegan is up to. But whatever it is you&#39;re doing, I trust it&#39;s a necessary step towards defeating our savage enemy. Sergeant Kegan is... perfect, better than the best, and he does not waste time. That&#39;s why I like him. We need more men like Sergeant Kegan.]

|action&gt;[Gorg gets a phone call and answers it.]

|name&gt;[GORG]
|dialogue&gt;[What?!
Yes, Sergeant. I received it.
Ya, everything looks good. Keep up the great work.
No, no, I do appreciate the updates. Keep &#39;em coming. Keep &#39;em coming.
Ok, I will tell that subject of yours to return back.]

|action&gt;[Gorg hangs up.]

|name&gt;[GORG]
|dialogue&gt;[Speaking of which, your mission with Sergeant Kegan is ready to commence. Don&#39;t keep him waiting.]

---
---

|action&gt;[You return to Kegan&#39;s room. Everyone is staring at a monitor showing Professor Ludwig.]

|name&gt;[KEGAN]
|dialogue&gt;[What&#39;s he doing?]

|name&gt;[FILLED DONUT SCIENTIST]
|dialogue&gt;[He appears to be altering the algorithm of the simulation. Sir, is this supposed to be happening?]

|name&gt;[KEGAN]
|dialogue&gt;[Get it ready.]

|name&gt;[FILLED DONUT SCIENTIST]
|dialogue&gt;[But sir, the research data has not finished compiling.]

|name&gt;[KEGAN]
|dialogue&gt;[That doesn&#39;t matter anymore. We need to move now.]

|name&gt;[FILLED DONUT SCIENTIST]
|dialogue&gt;[Yes sir.]

|action&gt;[Kegan presses some buttons while he is talking to you.]

|name&gt;[KEGAN]
|dialogue&gt;[Ready up soldier, it&#39;s time to terminate the program. Once inside, locate and activate the signal. Our teams will handle the rest.]

|action&gt;[The filled donut scientist has a simulator prepared to put on your face. Kegan injects something into your head.]

|name&gt;[KEGAN]
|dialogue&gt;[Good luck soldier.]

|action&gt;[Just after the injection, the filled donut scientist puts the simulator on your face.]

















</tw-passagedata><tw-passagedata pid="9" name="A1-S06" tags="Timeframe_Advanced" position="725,1225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 06]
CORUPT PROGRAM
INT - NIGHT - SIM LABS HQ]

You find yourself back at the small room at Sim Labs that you started in. The door to the room is open and you go to explore. Ludwig spots you snooping around, but he calls you into his Simulation Computation Chamber to witness his latest project, a new way to simulate reality.


&lt;img src=&quot;https://i.imgur.com/h0fV3Ot.jpg&quot; class=&quot;fitHalf&quot;&gt;
After Ludwig’s long demonstration, he reminds you that it’s still a work in progress, but he believes that it could produce a close enough representation of reality to accurately simulate the past and predict the future. Ludwig then leads you to your resting quarters. Along the way, a name idea strikes Ludwig for what to call the simulation based on this new algorithm. He calls it, The Simulation™. Before you reach your resting quarters, you pass by a distress signal switch. Ludwig warns you not to press it. That switch will broadcast a signal for Muffin first responders, but enemy Donuts could pick up that signal as well. You enter your room to rest.


&lt;img src=&quot;https://i.imgur.com/yROL7vA.jpg&quot; class=&quot;fitHalf&quot;&gt;
The door shuts, and everything goes black.

(align:&quot;==&gt;&quot;)[[[Sleep...|A1-S07]]]




















|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 06]
]

|action&gt;[You spawn in an empty room at Sim Labs. The door is slightly open. You walk out in search of Ludwig.]

|name&gt;[LUDWIG]
|dialogue&gt;[Who&#39;s there?
Show yourself.
Don&#39;t think I can&#39;t see you.
Ah, test subject Anderson. I&#39;m surprised to see you up so late.
Since you&#39;re around, come in here. I&#39;d like to show you something.]

|action&gt;[Ludwig welcomes you into the simulation computation chamber. He is wearing a small glove-like device on each hand that is used to control 3D holograms spatially. He also has advanced-looking nuclear goggles (similar to night vision) attached to him, but not flipped down in front of his eyes yet. You walk into a circular chamber with a holographic monitor in the center.]

|name&gt;[LUDWIG]
|dialogue&gt;[Come in. Come in.
Give me one second. I just need to pull this up on my monitor.]

|action&gt;[Ludwig does some technical work. Nothing appears on the hologram display yet.]

|name&gt;[LUDWIG]
|dialogue&gt;[So, what do you think? Pretty marvelous, isn&#39;t it?
It may not look like much, but this right here may very well be the foundation for crafting a perfect simulation of our universe.]

|action&gt;[The 3D hologram display plays a dynamic presentation that coincides with Ludwig&#39;s monologue.]

|name&gt;[LUDWIG]
|dialogue&gt;[You see, most simulations incorporate just enough detail to provide the illusion of reality.
Instead of simulating all the fundamental particles that make up a ball, for instance, one may simply simulate a singular ball object with bouncing properties, as though it were an indivisible entity. This works well for simulations with a narrow scope.
However, for a perfect simulation of our entire universe, it&#39;s not so simple. From the perspective of our universe, an indivisible ball object does not exist. What does exist is a temporary amalgamation of fundamental particles. Those particles will take many forms, the likes of which we cannot imagine, throughout the course of their existence.
Hence, our only recompense for an accurate simulation of the universe, is to simulate those most fundamental particles that compose reality.
There&#39;s just one problem. What is fundamental?]

|action&gt;[The display shows various particle models as Ludwig continues.]

|name&gt;[LUDWIG]
|dialogue&gt;[Atoms certainly are not fundamental. They&#39;re composed of electrons and nucleons, which themselves comprise various types of quarks and leptons.
Perhaps quarks and leptons are the most fundamental components of ordinary matter. Even if that were so, we&#39;d still have to simulate the other 95% of the universe that is not ordinary matter.
In fact, that 95% of the universe doesn&#39;t seem to be anything at all. It has tremendous effects on large scales: binding galactic structures together, driving distant galaxies further apart.
Yet, when we try to examine the source of this force, there seems to be absolutely nothing there.
Just, empty, space.]

|action&gt;[The hologram display goes blank. Ludwig repeats his question until you respond by nodding YES or NO.]

|name&gt;[LUDWIG]
|dialogue&gt;[Tell me, Mr. Anderson, do you see anything here?
Do you see anything?
Do you see something here, Mr. Anderson?]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;NOD YES&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[That&#39;s right. There is something here.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;NOD NO&lt;/summary&gt;
  |action&gt;[You shift your focus closer to the hologram display, but the projected space still appears empty.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[That&#39;s because you must look closer, Mr. Anderson. Come, look closer...]

  |action&gt;[You step in for a better view, trying to discern any shape or form.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[Closer still, Mr. Anderson...
  Closer...]

  |action&gt;[The hologram continues showing only emptiness, yet Ludwig seems convinced there&#39;s more to see.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[(whispering) The closer you look, the less of it you see.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[Suddenly, the hologram display shows swirling blue particles of spacetime, reacting to Ludwig’s system.]

|name&gt;[LUDWIG]
|dialogue&gt;[This is spacetime. Like most, you might perceive spacetime as synonymous with nothing. But what if I told you spacetime is not nothing? What if spacetime is everything?
Brace yourself, Mr. Anderson.]

|action&gt;[Ludwig puts on his nuclear goggles and flips a switch. Computers around the chamber begin to hum. The chamber vibrates intensely. Large magnetic levitating rings lift upwards from below, spinning ominously and radiating energy. A simulation of spacetime particles floods the chamber. Ludwig appears elated.]

|name&gt;[LUDWIG]
|dialogue&gt;[Ha ha. This is it. This is it!]

|action&gt;[The spinning rings destabilize, leaning off-axis and scraping the chamber walls. Ludwig barely manages to stabilize them.]

|name&gt;[Ludwig]
|dialogue&gt;[Oh dear. Uh. Just a slight hiccup. We still have 87% stability. I&#39;m sure I can fix that later. But this is it!
A universe simulated entirely by a single fundamental element: spacetime. This is how it all started, with a rapid expansion of spacetime.
This model of the universe is so elegantly simple. One element with one interaction: spacetime expanding.]

|action&gt;[The simulation shows regions of varying spacetime density, depicting cosmic formations in the early universe. Everything Ludwig describes is reflected in the hologram.]

|name&gt;[Ludwig]
|dialogue&gt;[Look here. Although spacetime expansion is relativistically isotropic, this is not to say it&#39;s entirely uniform. Even the most infinitesimal perturbations yield sufficient incongruence in spacetime density field vectors to cascade into multilateral coalescence.]

|action&gt;[He notices you might not follow, so he simplifies his explanation.]

|name&gt;[Ludwig]
|dialogue&gt;[They&#39;re clumps. The spacetime forms clumps. These clumps of high-density spacetime emerge as a natural consequence of expanding spacetime. You might wonder how they remain stable if spacetime itself is fighting to expand them apart. Make no mistake, they&#39;re expanding too—exploding apart, in fact, but so is the universe. Everything is continuously exploding everywhere all at once.
As these clumps undergo radial dispersal, isotropic compressive forces from the surrounding expanding spacetime induce a cyclical implosion-explosion dynamic. Each clump endures the cumulative omni-directional pressure of the expanding universe, perpetuating this oscillatory behavior. Truly fascinating.
It&#39;s as if every clump is bearing the weight of the entire universe pushing inward from every direction. That&#39;s what stabilizes these particulate formations, these particles. Don&#39;t you see? This is fundamentally what ordinary matter is. High-density amalgamations of spacetime. Matter does not warp the fabric of spacetime. Matter **is** that warp in spacetime.]

|action&gt;[Spacetime particles spread out. Ludwig&#39;s computer throws alerts.]

|name&gt;[Ludwig]
|dialogue&gt;[Regional spacetime scalar field gradient decreasing.
Coalescing decoherence.
Wave conversion of radial fluctuation to linear propagation.
High frequency mass-energy transference.
These clumps are unbinding at a rapid rate.
We must be in a super void.

Let&#39;s... zoom out here and find some high-density region with a bit more stability. This is all just a few moments after the universe’s inception, and already it is mostly what we describe as empty space.
The predominant portion of primordial post-inflationary spacetime pervasively propagated, precipitating the proliferation of these vast intergalactic voids. Even at low relativistic densities, these voids continue further expansion, permeating an immense isotropic tension throughout the universe at near uniformity. That universal constant pressure is effectively what&#39;s binding the remnant clumps—ordinary matter that survived the early universe&#39;s rapid expansion.

Ah, here we are. You&#39;ll notice the peripheral interfaces of expansive intergalactic voids exhibit high-density spacetime condensations, stabilized through isotropic compressive forces, leading to the consolidation of these remnant clumps into proto-galactic formations.]

|action&gt;[Ludwig eagerly awaits this part of the simulation, clearly excited.]

|name&gt;[Ludwig]
|dialogue&gt;[(soft chuckle) This is my favorite part. Naturally, one might expect high-density spacetime perturbations to mutually repulse under expansive isotropy, and indeed they do—until they surpass a certain separation. Each clump partially occludes a minuscule quantous of this pervasive universal force. 
Now, hypothesize the dynamics when a clump encounters marginally diminished omni-directional pressure from the direction of an adjacent clump. Then envision a multitude of clumps, each fractionally obstructing the ambient isotropic tension of the universe. I&#39;m sure you can guess what happens as a consequence of this omnidirectional force being obstructed between clumps. 
Can you guess what these clumps would be doing when they have slightly less force pushing inward from between them? You may respond yes or no. 
Do you understand what is happening here?]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;NOD YES&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[Yes, that&#39;s right. They gravitate towards each other.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;NOD NO&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[How can you not guess? It&#39;s really quite obvious. They gravitate towards each other. It&#39;s gravity, Mr. Anderson.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;WAIT&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[You aren&#39;t very adept, are you, Mr. Anderson. It&#39;s gravity. They gravitate towards each other.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[Ludwig]
|dialogue&gt;[For ages, physicists have endeavored to uncover some mechanism to explain gravity. Some theorized a graviton particle. Numerous intricate experiments have been conducted in hopes of detecting this graviton&#39;s presence. Yet, empirical evidence remains elusive. This is due to the simple fact that graviton particles do not exist. My colleagues have looked at this all wrong. You see, gravity is not the addition of a force. Rather it is the subtraction of a force relative to a direction. And this force being subtracted is the same force which binds the constituents of your atoms together, the same force which expands the space between galaxies, the same force which defines the universe. Don’t you see? Gravity, electromagnetism, the strong and weak nuclear interactions, dark energy, dark matter, ordinary matter, everything you can imagine from our universe… it&#39;s all derivative of spacetime expanding.]

|action&gt;[Just as Ludwig finishes, the entire simulation computation chamber shuts down due to lack of power. Only a few emergency lights remain on.]

|name&gt;[Ludwig]
|dialogue&gt;[Did I seriously just use all our energy budget already?]

|action&gt;[He checks some data on his computer.]

|name&gt;[Ludwig]
|dialogue&gt;[Yes I did, and all our power reserves are depleted as well.
Cinnamon sticks, there was still so much more I wanted to explain to you in great, meticulous, painstaking detail.
But I suppose we had to stop eventually. One cannot live their whole life entirely within a simulation, after all. Otherwise I would be in that simulation right now. Ha ha ha. Can you imagine? Living in a simulation.]

|action&gt;[Ludwig finishes typing. Some power is restored as more lights activate. A computerized female voice with a British accent speaks over the intercoms.]

|name&gt;[Computerized Female Voice]
|dialogue&gt;[Emergency auxiliary power activated.]

|name&gt;[Ludwig]
|dialogue&gt;[This is a good time to leave before anyone notices we&#39;ve got no power left.]

|action&gt;[He presses a button, and the circular platform you both stand on begins to rise like an elevator, heading up to the top floor.]

|name&gt;[Ludwig]
|dialogue&gt;[Just keep in mind, Mr. Anderson, everything I showed you is all theoretical. For all I know, this theory could indeed produce an accurate enough simulation of our world, while being completely incongruent with the underlying reality of our universe. So don&#39;t go around calling your colleagues complete and utter imbeciles for not immediately agreeing with some untested hypothesis. Trust me, it&#39;s not very persuasive.
But I do feel we are getting closer. Closer now than ever before to achieving our company mission. Soon, we will simulate the past, and predict the future… Trademarked! Don&#39;t forget that&#39;s trademarked. I trademarked that. Which reminds me... I still need to come up with a name for the simulation I&#39;m currently working. I was thinking, The Very EXTREMELY Cool And Good Thing 9000, trademarked. Mmm yes. What do you think about that name? Do you like it, Mr. Anderson?
Yes or no? Do you like that name?
Give me your honest opinion. I promise I will not be offended.]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;NOD YES&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[Really? It&#39;s not that great of a name. Well, I suppose that shows just how incredibly skilled I am at naming things. That said, I still feel there is a better name out there. Something more simple... more befitting of the simulation.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;NOD NO&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[Well that&#39;s— Do you have a degree in nameology from the prestigious Blueberry Institute, huh? Well neither do I, but I totally could&#39;ve gotten in if I wanted to. Alright? By the way, I&#39;m keeping that name: The Really.. EXTREMELY... uh.. Nice And.... AHHH! Look what you&#39;ve done, Mr. Anderson. You made me forget the perfect name for the simulation.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;WAIT&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[Your lack of input seems to be a critique of its own, Mr. Anderson. Very well. I understand it&#39;s not the best name. I suppose I will have to come up with a better name for the simulation.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[Ludwig is quiet for a moment before realizing the perfect name. His eyes widen.]

|name&gt;[Ludwig]
|dialogue&gt;[That&#39;s it! The Simulation… trademarked. Why haven&#39;t I thought of that name before? The Simulation trademarked. That&#39;s it. That&#39;s the perfect name. It&#39;s genius.]

|action&gt;[The platform stops. You and Ludwig step off at the top floor and exit the chamber.]

|name&gt;[Ludwig]
|dialogue&gt;[Come now. Let me guide you to your resting quarters, Mr. Anderson.
We should move quick since you aren&#39;t supposed to be up so late. Well actually, you shouldn&#39;t even be out here at all in a conscious state, but you know, don&#39;t tell anyone. Ha ha ha. I say that as if you have agency. Which of course you don&#39;t.]

|action&gt;[You follow Ludwig past a control panel with a &quot;distress signal&quot; switch.]

&lt;tw-hook name=&quot;branch-a&quot;&gt;&lt;details&gt;
  &lt;summary&gt;PRESS THE SWITCH&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[Mr. Anderson. Get away from that switch.
Please don&#39;t touch that switch, Mr. Anderson.
You&#39;re not programmed to do that.
What are you doing, Mr. Anderson?! Stop!]

  |action&gt;[You flip the switch; alarms blare for a split second before a hidden sniper fires a single shot, killing you instantly. You restart at a nearby checkpoint with the switch unpressed.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[If you ignore the switch, Ludwig remarks on it casually.]

|name&gt;[Ludwig]
|dialogue&gt;[Also, don&#39;t touch that switch. It disables our lockdown security mechanism and broadcasts a distress signal, which anyone can hear. To be honest, we really should fix that to make it so only authorized rescue can receive the signal. Although so far, we haven&#39;t had a single compromise in our facility by hostile forces, so it&#39;s probably fine as is. Just don&#39;t touch it still. Obviously, we programmed all test subjects, like yourself, to avoid pressing such switches, but I do get nervous sometimes as some of you test subjects seem to have a mind of your own. Is there a mind in there? Are you a conscious experiencer, Mr. Anderson?
Are you some sort of consciousness experiencing this interaction right now?
Well, are you?
Are you conscious, Mr. Anderson?]

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;NOD YES&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[(shocked) No, ha-- (uncertain) No, that&#39;s not possible. (muttering) Is it possible? (quiet scientific gibberish) Never mind. Follow me, Mr. Anderson.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;NOD NO&lt;/summary&gt;
  |name&gt;[Ludwig]
  |dialogue&gt;[Ha ha. Of course you are not. You&#39;re just a compilation of circuitry running an algorithm. That would be like asking a math equation if it&#39;s conscious. Absolutely ridiculous. (robotic voice) Y = x squared. I could&#39;ve been a comedian, you know.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[Ludwig enters the quarters.]

|name&gt;[Ludwig]
|dialogue&gt;[This is your room for tonight. Please rest well.]

|action&gt;[He flips the door switch and is confused to see the room is already occupied.]

|name&gt;[Ludwig]
|dialogue&gt;[Wait. Are you not Test Subject Anderson 426?]

|action&gt;[Ludwig lifts his goggles upward to squint closely at your name tag.]

|name&gt;[Ludwig]
|dialogue&gt;[Huh, 429. I must&#39;ve lost track of the number of Mr. Andersons we&#39;ve had. I suppose we have been depleting your test subject model type at a rapid pace. Come here. Just take the next room over.
You are welcome to step in now.
Please go in, Mr. Anderson.
It&#39;s time for you to doze off now.
Rest well Mr. Anderson, we have a long day of experimentation tomorrow. Tata.]

|action&gt;[You walk in as the door shuts behind you. Everything is pitch black. You go to sleep.]












</tw-passagedata><tw-passagedata pid="10" name="A1-S07" tags="Timeframe_Early Timeframe_Modern Timeframe_Advanced" position="725,1350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 07]
THE DREAM
EXT - DAY - TRENCHES BATTLEFIELD]

“Incoming artillery!” That’s the first thing you hear before you begin to see again.


&lt;img src=&quot;https://i.imgur.com/nQQlrqG.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/UIVve9n.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/MetarzL.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/90X9m9i.jpg&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
You find yourself in the middle of a fierce battle between Donuts and Muffins. The Donut Officer leads the charge. You and your Donut soldier comrades are tasked to capture a hill from the Muffin enemy.


&lt;img src=&quot;https://i.imgur.com/bRGVTka.jpg&quot; class=&quot;fitHalf&quot;&gt;
Once you gain control, you must defend the hill from Muffin counterattacks. As the counterattacks are repelled, a small group of Donut sappers appears, running from the enemy buildings towards your position. They are carrying a TNT switch for explosives planted in the enemy buildings. You and the Donuts provide covering fire for them, but they are all shot down before they reach safety.


&lt;img src=&quot;https://i.imgur.com/YsV7yth.jpg&quot; class=&quot;fitHalf&quot;&gt;
The Donut Officer volunteers you to run out and trigger that TNT switch while the Donuts provide suppressive fire. You trigger the TNT switch, causing the enemy buildings to explode, and immediately wake from the dream.


&lt;img src=&quot;https://i.imgur.com/VApL22P.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: This should be more like a cartoon TNT switch where you press down on a bar. The mechanics of this switch will correspond to how the distress signal switch at Sim Labs HQ functions.)]

(align:&quot;==&gt;&quot;)[[[Wake...|A1-S08]]]



MY NOTES:
This is a dream, so anomalous things might happen that are of course normal by dream logic. For instance, artillery blowing up a Donut soldier and they just keep falling up into the sky. Just subtle things like that.






SCRIPT DRAFT:

|action&gt;[PART 1: TRENCH WARFARE (Midday)
Surreal elements: Artillery explosions occasionally send soldiers floating upwards. All the audio can sound slightly muffled and echoed to make it feel more surreal.]

|action&gt;[The scene starts pitch black. YOU hear the battle before seeing anything.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Incoming artillery!]

|action&gt;[YOU suddenly see and find yourself in the middle of a raging battle. YOU are fighting with Donuts against Muffins. Artillery pounds the area behind you. DONUT OFFICER leads the charge.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[There&#39;s only one way now, men! Push up!]

|action&gt;[DONUT OFFICER blows whistle. Donuts battlecry as they rush towards the Muffin enemy position. YOU rush with them, taking out Muffin enemies along the way.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[Grenade out!]

|action&gt;[You fight in close quarters combat in the trenches against muffins.]

|name&gt;[MUFFIN SOLDIER 1]
|dialogue&gt;[No retreat! No surrender!]

|name&gt;[MUFFIN SOLDIER 2]
|dialogue&gt;[Don&#39;t let them take this position!]

|name&gt;[MUFFIN SOLDIER 3]
|dialogue&gt;[Hold the trench!]

|action&gt;[You and the donuts eliminate all the muffins after intense fighting.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Where is it?]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[I don&#39;t know where it is.]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[It&#39;s supposed to be here somewhere.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[What&#39;s the status?]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Sir. We can&#39;t find the signal anywhere.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[Look harder. We need to find and activate that signal. ASAP!]

|action&gt;[DONUT SOLDIER 4 comes running up.]

|name&gt;[DONUT SOLDIER 4]
|dialogue&gt;[Sir, I think we found something. Follow me.]

|action&gt;[You follow that soldier to a part of the trench where there is a trap door.]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[What is it? A trap door?]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Looks like some sort of underground tunnel.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[But where does it lead?]

|name&gt;[DONUT SOLDIER 4]
|dialogue&gt;[You think that signal might be in here, sir?]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[There&#39;s only one way to find out.]

|action&gt;[Donut officer turns to you.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[You, soldier. Go see what&#39;s down there. If you find the signal, your orders are to activate it immediately.
Get down there soldier.
Clock&#39;s ticking. You better get in there.
Get in there and search for the signal.
You better go now soldier.]

|action&gt;[You fall into the trap door. The door immediately closes shut above you. It is pitch black except for a light illuminating faintly on the other side of a tunnel. You go towards that light and the environment has switched to a jungle environment at dusk.]

|action&gt;[PART 2: JUNGLE WARFARE (Dusk)
Surreal elements: Trees occasionally shift positions. Tunnel holes can suddenly appear and Muffin enemies will attack from there.]

|action&gt;[As you near the tunnel exit, you hear voices of donuts.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Keep your eyes peeled. Muffins could be hiding anywhere in this jungle.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Sarge, I don&#39;t like this. It&#39;s too quiet.]

|action&gt;[You exit the tunnel.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[I see movement!]

|action&gt;[Donuts breifly fire in your direction.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Ceasefire! Ceasefire.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Hold your fire!]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[You there, soldier! What in the dough are you doing?! Almost got yourself killed.
Grab a machine gun and fall in line.
Hustle up soldier!
Come grab a machine gun.
Hurry up, we&#39;re losing daylight!]

|action&gt;[You take a machine gun.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Alright. Remember men. Our orders are to locate and activate the signal. After we complete our objective...]

|action&gt;[Sporadic rifle fire opens up from the jungle.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[I said ceasefire!]

|action&gt;[A few donut soldiers get hit. Suddenly, machine gun fire erupts from the dense jungle. Muffin soldiers appear, ambushing your group.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[It&#39;s an ambush! We&#39;re under attack!]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Return fire! Spread out!]

|action&gt;[An intense firefight breaks out.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[They&#39;re everywhere Sarge! We&#39;re pinned down!]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Call in helos. We need danger close on our position.]

|name&gt;[DONUT RADIO TECH]
|dialogue&gt;[But Sarge, what about the wounded--]

|action&gt;[DONUT RADIO TECH gets shot before finishing his sentence. DONUT SERGEANT picks up the radio.]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[I don&#39;t wanna die here Sarge. I don&#39;t wanna die.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Come in command. We need danger close ordinance. Drop everything you have on our position.]

|name&gt;[DONUT RADIO OPERATOR]
|dialogue&gt;[Roger that. Helo support inbound.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[We have to get moving! On me, NOW!]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[Wait! Don&#39;t leave me!]

|action&gt;[DONUT SOLDIER 3 gets up a limps before getting killed. There are not many Donuts left alive. You and the survivors make a run for it.]

|name&gt;[DONUT RADIO OPERATOR]
|dialogue&gt;[Helo support coming in hot.]

|action&gt;[The fighting continues as you run for safety. All other Donuts have been killed except for you and DONUT SERGEANT. The sound of helicopter rotors grows louder. You approach a small concrete building partially hidden by vegetation.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Through that door. Go go go!]

|action&gt;[DONUT SERGEANT gets hit as helicopter gunships come in and strafe targets in the jungle.]

|action&gt;[As you burst through the door, you don&#39;t enter a building, but rather, you exit into the next environment.]

|action&gt;[PART 3: ADVANCED WARFARE (Night)
Surreal elements: Buildings occasionally shift and reform.]

|action&gt;[You are now in a modern-day urban environment at nighttime. There are some donut soldiers around you who are equipped with advanced Spec Ops gear. If you look behind you after going through the door, you will just see an empty room of a building. Everyone is silently observing a distant building. One Donut soldier is using high-tech binoculars. Suddenly, large missiles streak across the sky, impacting the building. It collapses in a spectacular explosion.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Holy sprinkles! Did you see that?]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[That was fudging nuts.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Stay focused. We still have a mission to complete.]

|action&gt;[A Donut soldier pulls out a small drone.]

|name&gt;[DONUT DRONE TECH]
|dialogue&gt;[Launching recon drone.]

|action&gt;[The drone is thrown into the air and buzzes ahead, providing a bird&#39;s-eye view of the area.]

|name&gt;[DONUT DRONE TECH]
|dialogue&gt;[I&#39;m picking up Muffin signatures in the buildings ahead. They&#39;re setting up defensive positions.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Roger that. Let&#39;s move out. Stay in formation and watch the windows.]

|action&gt;[Your team advances through the city streets. Occasionally, buildings seem to shift and reform around you.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[Contact left!]

|action&gt;[Muffin forces open fire from a nearby building. Your team takes cover and returns fire.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Suppress and advance! We need to reach that target building!]

|action&gt;[You fight through several blocks. DONUT DRONE TECH fires missles during the fight.]

|name&gt;[DONUT DRONE TECH]
|dialogue&gt;[Sir, the drone&#39;s showing a clear path to the objective up ahead.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Good work. All units, push forward! Stay ready for contact!]

|action&gt;[Your team moves up. The buildings shift and one heavily fortified building aligns itself in front of you.]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[Enemy 12 o&#39;clock!]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Frag out!]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[Throwing frag!]

|action&gt;[After a brief but intense firefight, you secure the entrance.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Soldier, you&#39;re on point. You 3, stack up. Everyone else, secure the perimeter.]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[Flash ready.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Execute!]

|action&gt;[DONUT SOLDIER 2 kicks in the door.]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[Flash out!]

|action&gt;[DONUT SOLDIER 3 throws a flash bang. You all go in and clear the room where there are only 3 enemy Muffins. There are Donut hostages that have been lined up against the wall and executed. The dead include Donut children.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[We... we didn&#39;t make it in time.]

|name&gt;[DONUT SOLDIER 3]
|dialogue&gt;[Ugh. I think I&#39;m gonna be sick.]

|action&gt;[DONUT SOLDIER 3 goes to the corner of the room to vomit.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[Damn these Muffin savages.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Hostage rescue was a secondary objective. Our primary objective is much more important. If you want payback against Muffins, then find that signal.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[On it sir.]

|action&gt;[Everyone searches. DONUT SOLDIER 2 finds it.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[Sir, I think I found the signal.]

|action&gt;[Everyone goes to the room where the signal is.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[Is that it? Is that the signal?]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Ya. That&#39;s it.]

|action&gt;[DONUT SOLDIER 2 is about to go press it. He is stopped by DONUT FIRETEAM LEADER.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Hold on. We have to make sure it&#39;s not booby trapped.]

|action&gt;[DONUT FIRETEAM LEADER turns to you. You hear an overlapping echo of KEGAN&#39;S voice along with DONUT FIRETEAM LEADER.]

|name&gt;[DONUT FIRETEAM LEADER / KEGAN&#39;S VOICE (overlapping)]
|dialogue&gt;[You there, soldier. Go activate that signal.
That&#39;s an order soldier.
We&#39;re waiting on you soldier. Activate the signal.
Go activate that signal.]

|action&gt;[You move up to activate the signal.]

|name&gt;[DONUT FIRETEAM LEADER / KEGAN&#39;S VOICE (overlapping)]
|dialogue&gt;[Press it down.
Activate it now! Now!]

|action&gt;[You reach for the switch and press it down firmly. The moment you do, you immediately wake out of the dream and transition to the next scene.]














































































































|action&gt;[PART 1: TRENCH WARFARE (Midday)
Surreal elements: Artillery explosions occasionally send soldiers floating upwards. All the audio can sound slightly muffled and echoed to make it feel more surreal.]



|action&gt;[YOU spawn in the middle of a raging battle. YOU are fighting with Donuts against Muffins. DONUT OFFICER leads the charge.]

|name&gt;[ANY DONUT SOLDIER]
|dialogue&gt;[Incoming artillery!]

|action&gt;[Artillery pounds the area behind you.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[There&#39;s only one way now, men! Push up!]

|action&gt;[DONUT OFFICER blows whistle. Donuts battlecry as they rush towards the Muffin enemy position. YOU rush with them, taking out Muffin enemies along the way.]


|action&gt;[You fight in close quarters combat in the trenches against muffins.]



|name&gt;[ANY MUFFIN SOLDIER]
|dialogue&gt;[No retreat! No surrender!
Don&#39;t let them take this position!
Hold the trench!]


|action&gt;[You and the donuts eliminate all the muffins after intense fighting.]


|name&gt;[ANY DONUT SOLDIER]
|dialogue&gt;[Where is it?
I don&#39;t know where it is.
It&#39;s supposed to be here.]


|name&gt;[DONUT OFFICER]
|dialogue&gt;[What&#39;s the status?]

|name&gt;[ANY DONUT SOLDIER]
|dialogue&gt;[Sir. We can&#39;t find the signal anywhere.]

DONUT OFFICER
Look harder. We need to find and activate that signal. ASAP!

ANY DONUT SOLDIER
Sir, I think we found something. Follow me.

You follow that soldier to a part of the trench where there is a trapped door.



ANY DONUT SOLDIER
What is it?
A trap door. 
Looks like some sort of underground tunnel. 
But where does it lead?
You think that signal might be in here, sir?

DONUT OFFICER
There&#39;s only one way to find out.


Donut officer turns to you.


DONUT OFFICER
You there, soldier. Go see what&#39;s down there. If you find the signal, your orders are to activate it immediately.
Get down there, soldier.
Clocks ticking. You better get in there.
Get in there and search for the signal.
You better go now, soldier.
 


You fall into the trapped door. The door immediately closes shut above you. It is pitch black except for a light illuminating faintly on the other side of a tunnel. You go towards that light and the environment has switched to a jungle environment at dusk.









|action&gt;[PART 2: JUNGLE WARFARE (Dusk)
Surreal elements: Trees occasionally shift positions. Tunnel holes can suddenly appear and Muffin enemies will attack from there.]

|action&gt;[As you come out of the tunnel, you hear voices of donuts.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Keep your eyes peeled. Muffins could be hiding anywhere in this jungle.]

|name&gt;[ANY DONUT SOLDIER]
|dialogue&gt;[Sarge, I don&#39;t like this. It&#39;s too quiet.]


|name&gt;[ANY DONUT SOLDIER]
|dialogue&gt;[I see movement!]

|name&gt;[DONUT SERGEANT]
Ceasefire! Ceasefire.



|name&gt;[ANY DONUT SOLDIER]
Hold your fire!

|name&gt;[DONUT SERGEANT]
You there, soldier! What in the dough are you doing?! Almost got yourself killed.
Grab a machine gun and fall in line.
Hustle up soldier!
Come grab a machine gun.
Hurry up, we&#39;re losing daylight!


You take a machine gun.

|name&gt;[DONUT SERGEANT]
Alright. Rememeber men. Our orders are to locate an activate the signal. After we complete our objective...


Sporadic rifle fire opens up from the jungle.


|name&gt;[DONUT SERGEANT]
I said ceasefire!


|action&gt;[A few donut soldiers get hit. Sudden machine gun fire erupts from the dense jungle. Muffin soldiers appear, ambushing your group.]



|name&gt;[ANY DONUT SOLDIER]
|dialogue&gt;[It&#39;s an ambush! We&#39;re under attack!

|name&gt;[DONUT SERGEANT]
Return fire! Spread out!]

|action&gt;[An intense firefight breaks out.]

|name&gt;[ANY DONUT SOLDIER]
|dialogue&gt;[They&#39;re everywhere! We&#39;re pinned down!]


|name&gt;[DONUT SERGEANT]
Call in helos. We need danger close on our position.

|name&gt;[ANY DONUT SOLDIER]
But sir, what about the wounded--

That donut gets shot before finishing his sentence.


|name&gt;[DONUT SERGEANT]
Come in command. We need danger close ordinance. Drop everything you have on our position.

DONUT RAIDO OPERATOR
Roger that. Helo support inbound.


|name&gt;[DONUT SERGEANT]
|dialogue&gt;[We have to get moving! On me, NOW!]

There are not many Donuts left alive. You make a run for it with the survivers.

DONUT RAIDO OPERATOR
Helo support coming in hot.


|action&gt;[The fighting continues as you run for safety. All other Donuts are killed except for you and DONUT SERGEANT. The sound of helicopter rotors grows louder.]

|action&gt;[You approach a small concrete building partially hidden by vegetation.]

|name&gt;[DONUT SERGEANT]
Through that door. Go go go!

DONUT SERGEANT gets hit as helicopter gunships come in and strafe targets in the jungle.

|action&gt;[As you burst through the door, you don&#39;t enter the building, but you exit into the next envionment.]














|action&gt;[PART 3: ADVANCED WARFARE (Night)
Surreal elements: Buildings occasionally shift and reform.]

|action&gt;[You are now in a modern-day urban environment at nighttime. There are some donut soldiers around you who are equipped with advanced Spec Ops gear. If you look behind you after going through the door, you will just see an empty room of a building. Everyone is silently observing a distant building. A Donut soldier uses high-tech binoculars to scout.]

|action&gt;[Suddenly, large missiles streak across the sky, impacting the building. It collapses in a spectacular explosion.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Holy sprinkles! Did you see that?]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Stay focused. We still have a mission to complete.]

|action&gt;[A Donut soldier pulls out a small drone.]

|name&gt;[DONUT TECH]
|dialogue&gt;[Launching recon drone.]

|action&gt;[The drone is thrown into the air and buzzes ahead, providing a bird&#39;s-eye view of the area.]

|name&gt;[DONUT TECH]
|dialogue&gt;[I&#39;m picking up Muffin signatures in the buildings ahead. They&#39;re setting up defensive positions.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Roger that. Let&#39;s move out. Stay in formation and watch the windows.]

|action&gt;[Your team advances through the city streets. Occasionally, buildings seem to shift and reform around you.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[Contact left!]

|action&gt;[Muffin forces open fire from a nearby building. Your team takes cover and returns fire.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Suppress and advance! We need to reach that target building!]

|action&gt;[You fight through several blocks, encountering sporadic resistance.]

|name&gt;[DONUT TECH]
|dialogue&gt;[Sir, the drone&#39;s showing a clear path to the objective up ahead.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Good work. All units, push forward! Stay ready for contact!]

|action&gt;[Your team moves up. The buildings shift and one heavily fortified building aligns itself in front of you. After a brief but intense firefight, you secure the entrance.]


|name&gt;[DONUT FIRETEAM LEADER]
Soldier, you&#39;re on point. You 3, stack up. Everyone else, secure the paremeter.


|name&gt;[DONUT SOLDIER 3]
Flash ready.

|name&gt;[DONUT FIRETEAM LEADER]
Execute!

DONUT SOLDIER 2 kicks in the door.

|name&gt;[DONUT SOLDIER 3]
Flash out!

DONUT SOLDIER 3 throws a flash bang. You all go in and clear the room where there are only 3 enemy Muffins. There are Donut hostages that have been lined up against the wall and executed. The dead include Donut childern.

|name&gt;[DONUT SOLDIER 1]
We... we didn&#39;t make it in time.

|name&gt;[DONUT SOLDIER 3]
Ugh. I think I&#39;m gonna be sick.

DONUT SOLDIER 3 goes to the corner of the room to vomit.

|name&gt;[DONUT SOLDIER 2]
Damn those Muffin savages.



|name&gt;[DONUT FIRETEAM LEADER]
Hostage rescue was a secondary objective. Our primary objective is much more important. If you want payback against those savage Muffins, then find that signal.

|name&gt;[DONUT SOLDIER 1]
On it sir.

Everyone searches. DONUT SOLDIER 2 finds it.


|name&gt;[DONUT SOLDIER 2]
Sir, I think I found the signal.

Everyone goes to the room where the signal is.


|name&gt;[DONUT SOLDIER 2]
Is that it? Is that the signal?


|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Ya. This is it.]

DONUT SOLDIER 2 is about to go press it. He is stopped by DONUT FIRETEAM LEADER.


|name&gt;[DONUT FIRETEAM LEADER]
Hold on. We have to make sure it&#39;s not booby trapped.]

DONUT FIRETEAM LEADER turns to you. You here an overlapping echo of KEGAN&#39;S voice along with DONUT FIRETEAM LEADER. 

|name&gt;[DONUT FIRETEAM LEADER / KEGAN&#39;S VOICE (overlapping)]
You there, soldier. Go activate that signal.
That&#39;s an order soldier.
We&#39;re waiting on you soldier. Activate the signal.
Go activate that signal.]

You move up to activate the signal.

|name&gt;[DONUT FIRETEAM LEADER / KEGAN&#39;S VOICE (overlapping)]
|dialogue&gt;[Press it down.
Activate it now! Now!]

|action&gt;[You reach for the switch and press it down firmly. The moment you do, you immediately wake out of the dream and transition to the next scene.]













































































SCRIPT DRAFT:

|action&gt;[PART 1: TRENCH WARFARE (Midday)
Surreal elements: Artillery explosions occasionally send soldiers floating upwards. The sky periodically shifts colors rapidly. Trenches sometimes appear to stretch infinitely.]

|action&gt;[YOU spawn in the middle of a raging battle. YOU are fighting with Donuts against Muffins. DONUT OFFICER leads the charge.]

|name&gt;[DONUT SOLDIER]
|dialogue&gt;[Incoming artillery!]

|action&gt;[Artillery pounds the area behind you.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[There&#39;s only one way now, men! Push up!]

|action&gt;[DONUT OFFICER blows whistle. Donuts battlecry as they rush towards the Muffin enemy position. YOU rush with them, taking out Muffin enemies along the way.]

|name&gt;[DONUT SOLDIER]
|dialogue&gt;[The hill! Capture the hill!]

|action&gt;[YOU take the hill and have to defend it.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[Nice job, men, but the battle is not over. Defend this position.]

|action&gt;[Hordes of Muffin enemies counterattack your position.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[Hold the line, men! Do not let them take the hill!]

|action&gt;[YOU and the Donut soldiers defend the hill from the Muffin counterattack.]

|name&gt;[DONUT SOLDIER]
|dialogue&gt;[We have secured the hill.]

|action&gt;[Suddenly, a group of Donut sappers appear from the enemy side, running towards your position. They are holding the trigger for the explosives they have planted in the Muffin enemy buildings.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[Hold your fire! Don&#39;t shoot our own soldiers!]

|name&gt;[DONUT SAPPER]
|dialogue&gt;[We&#39;ve got the trigger! Cover us!]

|action&gt;[The Donut sappers are getting shot down one by one as they run towards your position.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[Put suppressing fire on those Muffins.]

|name&gt;[DONUT SOLDIER]
|dialogue&gt;[They&#39;re not gonna make it.]

|action&gt;[The last of the Donut sappers is gunned down.]

|name&gt;[DONUT SOLDIER]
|dialogue&gt;[They&#39;re dead. They&#39;re all dead.]

|name&gt;[DONUT SOLDIER]
|dialogue&gt;[Sir, what&#39;s the plan?]

|action&gt;[DONUT OFFICER thinks for a moment. He then looks at you.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[You there, soldier. We need someone to trigger that switch. Are you up for it?]

|action&gt;[Before you can respond, the DONUT OFFICER continues.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[On my mark, we&#39;re gonna open up with everything we&#39;ve got. You make a run for that switch. Got it?]

|action&gt;[YOU nod.]

|name&gt;[DONUT OFFICER]
|dialogue&gt;[Alright men, give &#39;em everything you&#39;ve got! Fire!]

|action&gt;[The Donuts open fire, providing cover as you make a run for the switch. As you near it, the world seems to slow down. Kegan&#39;s voice echoes faintly.]

|name&gt;[KEGAN&#39;S VOICE (faint echo)]
|dialogue&gt;[Trigger it...]

|action&gt;[Just as you&#39;re about to reach the switch, everything goes white. The scene transitions to the next part.]






|action&gt;[PART 2: JUNGLE WARFARE (Dusk)
Surreal elements: Trees occasionally shift positions. Day/night cycle fluctuates rapidly. Sounds of wildlife sometimes reverse or play backwards.]

|action&gt;[YOU find yourself at the front of a column of Donut soldiers moving along a narrow jungle trail. The light is dim, suggesting late afternoon or early evening.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Keep your eyes peeled. Muffins could be anywhere in this jungle.]

|action&gt;[As you move forward, the foliage seems to shift and change around you.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Sir, I don&#39;t like this. It&#39;s too quiet.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[You there, at the front. Push off the trail. We need to scout ahead.]

|action&gt;[As you move off the trail, sudden gunfire erupts from the dense jungle. Muffin soldiers appear, ambushing your group.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Ambush! Return fire! Spread out!]

|action&gt;[An intense firefight breaks out. You and the Donuts take cover behind trees and fallen logs.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[They&#39;re everywhere! We&#39;re surrounded!]

|action&gt;[The battle rages on. The sky rapidly shifts between day and night.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Hold your ground! We can beat these Muffins!]

|action&gt;[As the fighting continues, the sound of helicopter rotors grows louder.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Listen! Do you hear that? Choppers!]

|action&gt;[Two attack helicopters appear overhead, their machine guns opening fire on the Muffin positions.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[That&#39;s our air support! Push forward!]

|action&gt;[The helicopters decimate the remaining Muffin forces. As the dust settles, the Donut Sergeant pulls out a map.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[Alright, we need to find the control building. It should be nearby.]

|action&gt;[The group moves through the jungle. Trees seem to move out of your way as you pass.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[There! I see a structure ahead!]

|action&gt;[You approach a small concrete building partially hidden by vegetation.]

|name&gt;[DONUT SERGEANT]
|dialogue&gt;[This is it. The switch should be inside. You, go trigger it. We&#39;ll cover you.]

|action&gt;[You enter the building. As you approach the switch, Kegan&#39;s voice echoes faintly.]

|name&gt;[KEGAN&#39;S VOICE (faint echo)]
|dialogue&gt;[Activate it...]

|action&gt;[Just as you reach for the switch, you notice wires connected to explosives. The building begins to shake.]

|name&gt;[DONUT SERGEANT (from outside)]
|dialogue&gt;[It&#39;s a trap! Get out of there!]

|action&gt;[The building explodes around you. As everything goes white, you transition to the next part of the dream.]





|action&gt;[PART 3: ADVANCED WARFARE (Night)
Surreal elements: Buildings occasionally shift and reform. Gravity intermittently inverts. Electronic displays sometimes show impossible information.]

|action&gt;[YOU find yourself with a team of Donut soldiers in a dark urban environment. Everyone is silently observing a distant building. A Donut soldier uses high-tech binoculars to scout.]

|action&gt;[Suddenly, large missiles streak across the sky, impacting the building. It collapses in a spectacular explosion.]

|name&gt;[DONUT SOLDIER 1]
|dialogue&gt;[Holy sprinkles! Did you see that?]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Stay focused. We still have a mission to complete.]

|action&gt;[A Donut soldier pulls out a small drone.]

|name&gt;[DONUT TECH]
|dialogue&gt;[Launching recon drone.]

|action&gt;[The drone is thrown into the air and buzzes ahead, providing a bird&#39;s-eye view of the area.]

|name&gt;[DONUT TECH]
|dialogue&gt;[I&#39;m picking up Muffin signatures in the buildings ahead. They&#39;re setting up defensive positions.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Roger that. Let&#39;s move out. Stay in formation and watch the windows.]

|action&gt;[Your team advances through the city streets. Occasionally, buildings seem to shift and reform around you.]

|name&gt;[DONUT SOLDIER 2]
|dialogue&gt;[Contact left!]

|action&gt;[Muffin forces open fire from a nearby building. Your team takes cover and returns fire.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Suppress and advance! We need to reach that target building!]

|action&gt;[You fight through several blocks, encountering sporadic resistance. At one point, gravity seems to invert briefly, causing debris to float upwards.]

|name&gt;[DONUT TECH]
|dialogue&gt;[Sir, the drone&#39;s showing a clear path to the objective. Two blocks ahead.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[Good work. All units, push forward!]

|action&gt;[Your team reaches a fortified building. After a brief but intense firefight, you secure the entrance.]

|name&gt;[DONUT FIRETEAM LEADER]
|dialogue&gt;[This is it. Find that switch. We&#39;ll cover the entrance.]

|action&gt;[You enter the building, fighting your way through several Muffin defenders. You reach a room with a prominent switch.]

|name&gt;[DONUT FIRETEAM LEADER / KEGAN&#39;S VOICE (overlapping, clear)]
|dialogue&gt;[Press it down. Now!]

|action&gt;[You reach for the switch and press it down firmly. The moment you do, everything goes white as you transition out of the dream.]

































SCRIPT DRAFT:

	YOU spawn in the middle of a raging battle. YOU are fighting with Donuts against Muffins. DONUT OFFICER leads the charge.
DONUT SOLDIER.
Incoming artillery!
	Artillery pounds the area behind you.
DONUT OFFICER.
There&#39;s only one way now, men! Push up!
	DONUT OFFICER blows whistle. Donuts battlecry as they rush towards the Muffin enemy position. YOU rush with them, taking out Muffin enemies along the way.
DONUT SOLDIER.
The hill! Capture the hill!
	YOU take the hill and have to defend it.
DONUT OFFICER.
Nice job, men, but the battle is not over. Defend this position.
	Hordes of Muffin enemies counterattack your position.
DONUT OFFICER.
Hold the line, men! Do not let them take the hill!
	YOU and the Donut soldiers defend the hill from the Muffin counterattack.
DONUT SOLDIER.
We have secured the hill.
	Suddenly, a group of Donut sappers appear from the enemy side, running towards your position. They are holding the trigger for the explosives they have planted in the Muffin enemy buildings. A Donut fires one shot at them.
DONUT OFFICER.
Hold your fire! Don&#39;t shoot our own soldiers!
DONUT SAPPER.
We&#39;ve got the trigger! Cover us!
	The Donut soldiers are getting shot down one by one as they run towards your position.
DONUT OFFICER.
Put suppressing fire on those Muffins.
DONUT SOLDIER.
They’re not gonna make it.
	The last of the Donut sappers is gunned down.
DONUT SOLDIER.
They’re dead. They’re all dead.
DONUT SOLDIER.
Sir, what&#39;s that plan?
	DONUT OFFICER thinks for a moment. He then asks you a question.
DONUT OFFICER.
You there, soldier, do you want to live forever?
You don&#39;t wanna live forever, do you?
Answer me soldier.
Do you really want to live forever?
YOU.
- YES.
- NO.
DONUT OFFICER.
- NO: We have a volunteer.
- YES: Ok, that’s not the answer I was expecting.
	DONUT OFFICER looks around at other soldiers. He picks PRIVATE KELLY.
DONUT OFFICER.
Private Kelly. Thanks for volunteering.
	PRIVATE KELLY shakes nervously.
DONUT OFFICER.
Listen up men. On my orders, we are gonna open up every last gun we’ve got on the enemy. We just need to suppress them long enough for this brave soldier reach that switch, and trigger the explosives.
Good luck soldier. We’re counting on you.
Get ready. Open fire!
	YOU and all the other Donuts open fire while PRIVATE KELLY makes a run for the switch. PRIVATE KELLY gets shot down halfway there.
DONUT OFFICER.
Cease-fire! Cease-fire!
DONUT SOLDIER.
Cease-fire!
	Donuts stop shooting. There is an air of confusion on what to do next.
DONUT SOLDIER.
Sir, what do we do now?
DONUT OFFICER.
What do you mean, “What do we do?” We try again, of course.
	DONUT OFFICER looks at YOU.
DONUT OFFICER.
Hey there soldier. I know you said you want to live forever, so we’ll make sure you make it to that switch alive.
Is everyone ready? We&#39;re making a second attempt at the switch.
DONUT SOLDIER.
Yep, we’re ready sir.
DONUT OFFICER.
On my mark... Fire!
Go soldier go!
Go now!
What are you doing, soldier?! Get the fudge in there!
You pathetic coward! You don&#39;t deserve to live. (DONUT OFFICER shoots you.)
	Donuts open fire on Muffin positions.
DONUT OFFICER.
Get your rear end moving soldier! We can’t cover you forever.
	YOU run out through enemy fire and trigger the switch.
DONUT SOLDIER.
Push it down. Push down on the switch!
	YOU push down on the TNT switch. For a split second, you see the enemy buildings explode. In the next instant, you wake from the dream.


</tw-passagedata><tw-passagedata pid="11" name="A1-S08" tags="Timeframe_Advanced" position="725,1475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 08]
RUDE AWAKENING
INT - DAY - SIM LABS HQ]
&lt;img src=&quot;https://i.imgur.com/r1YElXf.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: ...continuing from the previous note, the mechanics of the switch should match the TNT switch.)]
After dreaming you just pushed down a TNT switch, you wake up to realize you have actually pushed down the distress signal switch at Sim Labs.


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/UAHFtsn.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/Eh8S7na.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/OQAqUNb.jpg&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
&lt;img src=&quot;https://i.imgur.com/Cekf0Co.jpg&quot; class=&quot;fitHalf&quot;&gt;
The alarms blare throughout the entire facility, drawing a rush of Muffin scientists to the scene. Professor Ludwig is shocked that you triggered the switch he specifically warned against. Before the Muffins can deactivate the distress signal, an elderly Muffin scientist warns that it&#39;s too late, and that “They are coming.”


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/1cAfL2y.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/6eHIAVH.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/s349KPE.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/c0RGXat.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/zVa9XBS.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/HYZmzF1.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/oZFqr8g.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/75NpRad.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/lxHC351.jpg&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
&lt;img src=&quot;https://i.imgur.com/BvOmsSZ.jpg&quot; class=&quot;fitHalf&quot;&gt;
The heavy-duty security gates open, revealing an armada of military helicopters closing in. Missiles strike, causing destruction and chaos. Ludwig leads you through the facility in a frantic attempt to escape death or capture.


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/aPoqJFi.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/Rz6Yr61.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/MkYAIIx.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/OD4LXkb.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/GpHZ6YA.jpg&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/ueP92Kk.png&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
However, you and Ludwig reach an impasse when a missile suddenly strikes your position, knocking you unconscious.


&lt;img src=&quot;https://i.imgur.com/JqwvsSQ.jpg&quot; class=&quot;fitHalf&quot;&gt;

(align:&quot;==&gt;&quot;)[[[Wake...|A1-S09]]]



SCRIPT DRAFT:


|action&gt;[YOU abruptly wake from a dream where you pushed a TNT switch, only to find yourself actually pressing the distress signal switch at Sim Labs. Alarms wail throughout the facility, causing chaos.]

|name&gt;[LUDWIG]
|dialogue&gt;[Anderson! What have you done, Mr. Anderson?! I specifically told you not to press this switch!]

|action&gt;[Ludwig struggles to reset the switch. Many Sim Labs staff rush into the room, including PROFESSOR RUPERT, an ELDERLY MUFFIN SCIENTIST, and others.]

|name&gt;[RUPERT]
|dialogue&gt;[Ludwig, what is happening?! Why is the distress signal active?!]

|name&gt;[LUDWIG]
|dialogue&gt;[My test subject malfunctioned for some reason and hit the switch.]

|name&gt;[MUFFIN SCIENTIST B]
|dialogue&gt;[Impossible! We have numerous protocols embeded within all test subjects to avoid these situations.]

|name&gt;[RUPERT]
|dialogue&gt;[The switch didn&#39;t press itself.]

|name&gt;[MUFFIN SCIENTIST C]
|dialogue&gt;[Ya, I saw him press it.]

|name&gt;[MUFFIN SCIENTIST B]
|dialogue&gt;[Well then, perhaps it was compromised.]

|name&gt;[LUDWIG]
|dialogue&gt;[Compromised? How many test subjects do we have?]

|name&gt;[RUPERT]
|dialogue&gt;[What?]

|name&gt;[LUDWIG]
|dialogue&gt;[We have 429 test subject Andersons, correct?]

|action&gt;[RUPERT checks his tablet.]

|name&gt;[RUPERT]
|dialogue&gt;[Let&#39;s see... 82 Sir Wellingtons. 197 Madam Mademoiselles. 56 Lord Camelots. 426 Mr. Andersons.]

|action&gt;[LUDWIG looks at YOU with suspicion.]

|name&gt;[LUDWIG]
|dialogue&gt;[Who are you?]

|name&gt;[RUPERT]
|dialogue&gt;[We&#39;ll have time for introspection later. Right now, we need to stop that distress signal.]

|name&gt;[ELDERLY MUFFIN SCIENTIST]]
|dialogue&gt;[It&#39;s too late to stop it. The signal has already been sent. They are coming.]

|name&gt;[LUDWIG]
|dialogue&gt;[Who&#39;s coming?]

|action&gt;[The INTERCOM SYSTEM announces the disabling of lockdown mechanisms for first responders. Blinds on the windows slide up, revealing military jets and helicopters advancing.]

|name&gt;[RUPERT]
|dialogue&gt;[Dear mother of dough...]

|action&gt;[Missiles launch from the military jets, striking the facility. Everyone screams and scatters.]

|name&gt;[MUFFIN SCIENTIST B]
|dialogue&gt;[We have to get out of here, now!]

|name&gt;[LUDWIG]
|dialogue&gt;[This way, follow me! Come on, Anderson. Come on, you treacherous snake.]

|action&gt;[YOU follow LUDWIG, dodging bullets and explosions as they rip through the building and its inhabitants.]

|name&gt;[LUDWIG]
|dialogue&gt;[Oh dear, not that way! Down the stairwell, quickly! If we survive this, Mr. Anderson, you and I are going to have a serious discussion.]

|action&gt;[YOU reach an impasse where a missile strikes your position, knocking YOU unconscious.]



















































	The moment after YOU push the TNT switch in your dream, YOU wake up to find yourself pushing the distress signal switch at Sim Labs. Alarms go off all throughout the facility. LUDWIG freaks out on YOU.
LUDWIG.
What have you done! I told you not to press this switch!
	Ludwig tries to push the switch back to its original position. MUFFIN SCIENTIST frantically rushes in. Other Muffins stumble in as well, including ELDERLY MUFFIN SCIENTIST.
MUFFIN SCIENTIST.
Ludwig, what&#39;s going on?! Why is the distress signal active?!
LUDWIG.
My test subject malfunctioned for some reason and hit the switch.
MUFFIN SCIENTIST.
Impossible! We have numerous protocols built into these test subjects. It must have been compromised.
LUDWIG.
Compromised? How many test subjects do we have?
MUFFIN SCIENTIST.
What?
LUDWIG.
We have 429 test subject Andersons, correct?
MUFFIN SCIENTIST.
Let me check the database.
	MUFFIN SCIENTIST gets on his tablet and searches stuff.
82 Sir Wellingtons. 197 Madam Mademoiselles. 56 Lord Camelots. 428… Mr. Andersons.
	LUDWIG looks at YOU with suspicion.
LUDWIG.
Who are you?
MUFFIN SCIENTIST.
We’ll have time for introspection later. Right now, we need to stop that distress signal.
ELDERLY MUFFIN SCIENTIST.
It&#39;s too late to stop it. The signal has already been sent. They are coming.
LUDWIG.
Whose coming?
	INTERCOM SYSTEM makes an announcement.
INTERCOM SYSTEM.
Disabling lockdown mechanisms for first responders.
	The lockdown blinds on the windows slide up revealing a swarm of military aircraft and tanks closing in.
MUFFIN SCIENTIST.
Dear mother of dough.
	Missiles are fired from military jets striking the facility. Everyone screams and panics.
MUFFIN SCIENTIST.
We have to get out of here!
LUDWIG.
This way, follow me!
Come on, Anderson. Come on, you treacherous snake.
	YOU follow LUDWIG through the facility dodging bullets and explosions as they rip through the building and its inhabitants.
LUDWIG.
Oh dear, not that way!
Down the stairwell. Quickly!
If we survives this, Mr. Anderson, you and I are gonna have a serious discussion!
	YOU reach an impasse where a single missile strikes your position and knocks YOU unconscious.



</tw-passagedata><tw-passagedata pid="12" name="A1-S09" tags="Timeframe_Advanced" position="725,1600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 09]
A FATE WORSE THAN DEATH
INT - DAY - SIM LABS HQ]

You and Professor Ludwig regain consciousness in an interrogation room where both of you are tied up. Sergeant Kegan, who is in charge of the assault on Sim Labs, enters the room to have a conversation with you and Ludwig.


&lt;img src=&quot;https://i.imgur.com/dKv0qlM.jpg&quot; class=&quot;fitHalf&quot;&gt;
During the conversation, Sergeant Kegan shares his knowledge and interest in The Simulation™ created by Ludwig. Kegan explains how he plans to use The Simulation™ for its true purpose, “To prevent evil Muffins from murdering anymore innocent Donuts.” Kegan then deems Sim Labs and everything in it no longer useful, before drawing his pistol and shooting you in the face… Of course, when you die, you just restart at a checkpoint, so Kegan thinks up another way to deal with you. Since Kegan can’t kill you, he decides to lock you away forever. He loads a simulator with the destination of Drejnon Prison, a place no one has ever escaped from.


&lt;img src=&quot;https://i.imgur.com/SeQ1E6w.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
He calibrates the time to very near the start of the war, when technology and society was more primitive, then he slams the simulator onto your face.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|Act 2]]]



SCRIPT DRAFT:

|action&gt;[You and Professor Ludwig regain consciousness in an interrogation room, both of you tied up. Sergeant Kegan, in charge of the assault on Sim Labs, enters the room.]

|name&gt;[KEGAN]
|dialogue&gt;[Well done on your mission, soldier. We’ve been looking for this facility for quite some time.]

|name&gt;[LUDWIG]
|dialogue&gt;[Why are you referring to my test subject as &quot;soldier&quot;? What&#39;s going on?]

|name&gt;[KEGAN]
|dialogue&gt;[Mr. Ludwig, is it?]

|name&gt;[LUDWIG]
|dialogue&gt;[That&#39;s Professor Ludwig to you… actually, that&#39;s Professor Ludwig to everyone.]

|name&gt;[KEGAN]
|dialogue&gt;[Are you familiar with the simulation that you created?]

|name&gt;[LUDWIG]
|dialogue&gt;[Which one? I&#39;ve created many: The Super AtomiTron 5000 TradeMarked, The High Fidelity Statistical Reality Correspondence Matrix TradeMarked, The—]

|name&gt;[KEGAN]
|dialogue&gt;[The Simulation.]

|name&gt;[LUDWIG]
|dialogue&gt;[Never heard of it.]

|action&gt;[Kegan rolls his eyes.]

|name&gt;[KEGAN]
|dialogue&gt;[The Simulation... TradeMarked.]

|action&gt;[Ludwig is momentarily speechless.]

|name&gt;[LUDWIG]
|dialogue&gt;[(gasp) Wha— What did you say?]

|name&gt;[KEGAN]
|dialogue&gt;[Are you familiar with The Simulation TradeMarked?]

|name&gt;[LUDWIG]
|dialogue&gt;[Of course I&#39;m familiar with it. I’m the only one who knows of its existence… or should know of it.]

|name&gt;[KEGAN]
|dialogue&gt;[I know more than I should. You joined this company... this, Sim Labs, shortly after the war began. Out of all the researchers in this company, you have been the most successful in producing accurate enough simulations to be useful in times of war. With your simulations, one could to infiltrate simulated enemy units, spy on their plans, then use that intel to counter their plans in the real world. Hence your company slogan, &quot;Simulate the past. Predict the future.&quot;]

|name&gt;[LUDWIG]
|dialogue&gt;[TradeMarked! That&#39;s trademaked, just so you know! I came up with that slogan myself.]

|name&gt;[KEGAN]
|dialogue&gt;[Right... I have to admit, Professor, we had great trouble dealing with the muffin resistance movement after you gave them this technology. But even those simulations you created had their flaws. They weren&#39;t completely accurate. When we discovered this, it was easy enough to counter the advantage your simulations gave to muffins. Of course, you and I both know your goal was not mere accuracy. That would never satisfy you. No. You wanted to create the perfect simulation. A simulation indistinguishable from reality itself. And if you were ever to craft such a simulation, it would have no weakness to exploit. It would be the ultimate super weapon.]











|name&gt;[LUDWIG]
|dialogue&gt;[It&#39;s not a weapon. Only the likes of you would think that.]

|name&gt;[KEGAN]
|dialogue&gt;[(Chuckle.) Sure. “It&#39;s not a weapon.”]


|name&gt;[LUDWIG]
|dialogue&gt;[The Simulation Trademarked is not even real. It&#39;s still just an unproven theory.]

|name&gt;[KEGAN]
|dialogue&gt;[What if I told you, we are all in your unproven theory right now?]





|name&gt;[LUDWIG]
|dialogue&gt;[I don&#39;t follow.]

|name&gt;[KEGAN]
|dialogue&gt;[I presume you had plans to put a test subject inside The Simulation Trademarked. Correct?]

|name&gt;[LUDWIG]
|dialogue&gt;[Not any more I don&#39;t.]

|name&gt;[KEGAN]
|dialogue&gt;[But you HAD plans, at some point?]

|name&gt;[LUDWIG]
|dialogue&gt;[Naturally.]

|name&gt;[KEGAN]
|dialogue&gt;[That test subject of yours is currently inside The Simulation TradeMarked you would have tested in the future. From its perspective, we aren&#39;t even real. We&#39;re nothing more than 1s and 0s. A collection of polygons with artificial emotions and a contrived history, only actualized just enough to fit some simulated linear narrative.]


|name&gt;[LUDWIG]
|dialogue&gt;[]

|name&gt;[KEGAN]
|dialogue&gt;[]










|name&gt;[LUDWIG]
|dialogue&gt;[No. That&#39;s not true. That impossible!]

|name&gt;[KEGAN]
|dialogue&gt;[Search your feelings, you know it to be true.]

|name&gt;[LUDWIG]
|dialogue&gt;[Noooooooo! Nooo! But.. I have memories.]

|name&gt;[KEGAN]
|dialogue&gt;[All simulated.]

|name&gt;[LUDWIG]
|dialogue&gt;[No, you don&#39;t understand. I have long suspected reality was simulated. I&#39;m remembering the many expirements I&#39;ve conducted to test this hypothesis. The results of which lead me to believe that this was indeed reality, but it&#39;s not. Yet this.. simulation, suddenly feels even more real than ever.]

|name&gt;[KEGAN]
|dialogue&gt;[It is very convincing. Well done.]

|name&gt;[LUDWIG]
|dialogue&gt;[This is incredible. I have so many memories. Memories I thought were long lost are returning to me. I&#39;m remembering my mother, my father.]

|name&gt;[KEGAN]
|dialogue&gt;[Listen. There were dangerous Muffins in that village, Professor. The Donut Defense Legion did what we had to do.]

|name&gt;[LUDWIG]
|dialogue&gt;[I&#39;m not remembering their death. I&#39;m remembering their life. I grew up in Donut society. I was baked in the Arc Lands region, Sprinkle City. I&#39;m sure you&#39;re familiar. But we soon moved across the bridge to the colony, to New Arc City. Many Muffins, including my mother and father, contributed to your Donut society, even though this city we lived in was built on stolen Muffin lands.]

|name&gt;[KEGAN]
|dialogue&gt;[Rightfully conquered, not stolen.]

|name&gt;[LUDWIG]
|dialogue&gt;[Believe what you will. For a time, it seemed things were getting better. That maybe muffins could live alongside donuts. What a foolish thought?]

|name&gt;[KEGAN]
|dialogue&gt;[What do you expect when savage muffins relentlessly kill innocent donuts? Donuts once had the same naïve idea, that Muffins can assimilate with our society. The commoner doesn&#39;t understand inter-sweet dynamics. Vilonence between Donuts is tolerable. But when a muffin kills a donut, it ignites passions. Passions that could not be easily extinguished. Society becomes tribal. It breaks down. It devolves into war and anarchy. Segregation is the only way to maintain peace.]

|name&gt;[LUDWIG]
|dialogue&gt;[Your crime is not segregation. It is expulsion.]

|name&gt;[KEGAN]
|dialogue&gt;[When you were a child, you never did make it into Adventure Candyland, did you? Does that make you sad, Professor?]







|name&gt;[LUDWIG]
|dialogue&gt;[(Silence.)]

|name&gt;[KEGAN]
|dialogue&gt;[Does it also make you sad that on the same day you had tickets to go with your family, 9 muffins infiltrated the theme park and savagely attacked, systematically targeting inoccent Donuts while sparing Muffins? That day, 118 Donuts were murdered, most of whom were defenseless children.
Do you feel sad for them? Or do you only feel sad for the inconvenience your fellow muffins felt, after we were forced to restrict park entry to donuts only?]


|name&gt;[LUDWIG]
|dialogue&gt;[(More silence.) Theses emotions. How is this... I would have never imagined it was possible to simulate such a complex emotional experience like this. Does any of this matter if we&#39;re not even real?]

|name&gt;[KEGAN]
|dialogue&gt;[f you wanna get philosophical, reality is a matter of perspective. You can see the result of your simulation technology and think this is not real. And I’ll see it as technology we, the Donut Defense Legion, will employ, for its TRUE rightful purpose. To prevent evil Muffins from murdering anymore innocent Donuts. As for this facility and all your test subjects, they are no longer deemed useful to us.]


|action&gt;[Kegan pulls out a pistol and shoots you in the face. An inspirational quote appears and you respawn at a checkpoint.]

|action&gt;[Kegan pulls out a pistol and shoots you in the face again. An inspirational quote appears and you respawn at a checkpoint.]

|action&gt;[Kegan pulls out a pistol but hesitates. He talks to Ludwig.]

|name&gt;[KEGAN]
|dialogue&gt;[What’s going on?]

|name&gt;[LUDWIG]
|dialogue&gt;[You&#39;re about to shoot my test subject in the face, are you not?]

|name&gt;[KEGAN]
|dialogue&gt;[Yes, but something seems off.]

|name&gt;[LUDWIG]
|dialogue&gt;[Hmm, I sense it too. Mr. Anderson had a preemptive aniticipation to your action, as if he knew what you would do before you did it. I can&#39;t imagine why that would be, unless… Oh no, they did not.]

|name&gt;[KEGAN]
|dialogue&gt;[Who did not?]

|name&gt;[LUDWIG]
|dialogue&gt;[Mr. Anderson, have you been killed before?]

|action&gt;[You can respond yes or no.]

|name&gt;[LUDWIG]
|dialogue&gt;[- YES: That explains it.
- NO: Nevermind. I thought Sim Labs Management disabled my Ultra Realism Haptic Engine Trademarked. Shooting Mr. Anderson in the face should kill him in reality.]

|action&gt;[Every time you responded NO, Kegan shoots you and you restart at a checkpoint. You have to eventually respond YES to continue...]

|name&gt;[LUDWIG]
|dialogue&gt;[Sim Labs Management disabled my Ultra Realism Haptic Engine Trademarked. It&#39;s a mechanism I invented that’s supposed to kill you in real life when you die in a simulation. I&#39;ve had many arguments about this with management. They keep blabbering about how killing someone in a simulation is unethical. And I&#39;m like, all you have to do is not die. It&#39;s just like real life. Is real life unethical?]

|name&gt;[KEGAN]
|dialogue&gt;[Are you telling me there&#39;s no way to dispose of this test subject?]

|name&gt;[LUDWIG]
|dialogue&gt;[I’m telling you, every time you kill Mr. Anderson, he&#39;ll just respawn at a checkpoint.]

|action&gt;[Kegan paces around the room for a while as he thinks of a way to dispose of you. He connects a simulator to the computer and pulls up information about a prison.]

|name&gt;[KEGAN]
|dialogue&gt;[Alright. Drejnon Prison. Built before the war. No prisoner has escaped since its construction. This will be your new home soldier. Or should I say, test subject Anderson.]

|action&gt;[Kegan puts a simulator on your face.]























































































|name&gt;[LUDWIG]
|dialogue&gt;[]

|name&gt;[KEGAN]
|dialogue&gt;[]




|name&gt;[LUDWIG]
|dialogue&gt;[Those results convinced me this was not a simulation. So you&#39;re saying this is all just some false reality that can be manipulated?]

|name&gt;[KEGAN]
|dialogue&gt;[Manipulated, yes. Though I wouldn&#39;t necessarily call this a false reality. not necessarily. If your test subject were to exit The Simulation TradeMarked, it would find itself in a different reality. A reality affected by changes made within The Simulation TradeMarked.]

you feel real. You’re probably going through some thoughts of your past just to make sure you&#39;re real. Maybe you can think of that time your parents took you to Adventure Candy Land as a kid. You never entered that theme park did you. That was the morning Muffins savagely attacked, forcing Donuts to restrict park entry to Donuts only. You remember that, right?]



|name&gt;[KEGAN]
|dialogue&gt;[Manipulated, yes. Simulation, not necessarily. If your test subject were to exit The Simulation TradeMarked, it would find itself in a different reality. A reality affected by changes made within The Simulation TradeMarked.]

|name&gt;[LUDWIG]
|dialogue&gt;[That&#39;s impossible. A simulation cannot alter reality. That means, he must still be inside The Simulation TradeMarked after appearing to have exited, and that I’m, not… real.]

|name&gt;[KEGAN]
|dialogue&gt;[If you wanna get philosophical. Reality is a matter of perspective. You could see all this as not real. And I’ll see it as technology we, the Donut Defense League, will employ, for its TRUE intended purpose. To prevent evil Muffins from murdering anymore innocent Donuts. As for this facility and all your test subjects, they are no longer deemed useful to us.]





















|name&gt;[KEGAN]
|dialogue&gt;[You designed The Simulation TradeMarked to accurately simulate this universe for the purpose of intelligence gathering. With an accurate enough simulation, you can infiltrate simulated enemy units and find out their plans. Then, in the real world, you can use that intel to counter those plans in the future. If you succeed in your mission, you would have created the ultimate super weapon.]

|name&gt;[LUDWIG]
|dialogue&gt;[It&#39;s not a weapon.]

|name&gt;[KEGAN]
|dialogue&gt;[Sure. “It&#39;s not a weapon.” Tell me, did you think The Simulation TradeMarked would actually bring back your parents?]

|name&gt;[LUDWIG]
|dialogue&gt;[Of course it wouldn’t. I designed it to prevent the killing of other innocent people by the likes of you.]

|name&gt;[KEGAN]
|dialogue&gt;[There were dangerous Muffins in that village, Professor. We did what we had to. Muffins have done worse to us. Unlike your kind, we are not savages, who deliberately target the innocent.]

|name&gt;[LUDWIG]
|dialogue&gt;[I wouldn&#39;t be so sure. Your definition of innocent seems different from mine.]

|name&gt;[KEGAN]
|dialogue&gt;[You know, there is actually a way to bring back your family. Sort of. You might think this is the real world. However, that test subject of yours is currently in The Simulation TradeMarked you would have tested in the future. From its perspective, we&#39;re nothing but 1s and 0s. A bunch of polygons with artificial emotions and a contrived history, only actualized just enough to fit some simulated narrative.] 




















		INDOOR - DAY - SIM LABS HQ
	YOU regain consciousness in a small room. KEGAN has you and LUDWIG secured for interrogation. There are armed Donuts making sure you don’t go anywhere.
KEGAN.
Well done on your mission soldier. We’ve been looking for this base for quite some time.
LUDWIG.
Why are you referring to my test subject as soldier? What&#39;s going on?
KEGAN.
Mr. Ludwig is it?
LUDWIG.
That&#39;s Prof. Ludwig to you… actually, that&#39;s Prof. Ludwig to everyone.
KEGAN.
Are you familiar with the simulation you created?
LUDWIG.
Which one? I&#39;ve created many: The Super AtomiTron 5000TM, The High Fidelity Statistical Reality Correspondence MatrixTM, The—
KEGAN.
The Simulation… ™.
	Ludwig is speechless for a moment.
LUDWIG.
What did you say?
KEGAN.
Are you familiar with The Simulation™?
LUDWIG.
Of course I&#39;m familiar with it. I’m the only one who knows of its existence… or should know of it.
KEGAN.
You designed the SimulationTM to accurately simulate this universe for the purpose of intelligence gathering. With an accurate enough simulation, you can infiltrate simulated enemy units and find out their plans. Then, in the real world, you can use that intel to counter those plans in the future. If you succeed in your mission, you would have created the ultimate super weapon.
LUDWIG.
It&#39;s not a weapon.
KEGAN.
“It&#39;s not a weapon.” Tell me, how exactly would the Simulation™ bring back your family?
LUDWIG.
It wouldn’t. I designed it to prevent the killing of other innocent people by the likes of you.
KEGAN.
There were dangerous Muffins in that village, Professor. We did what we had to. Muffins have done worse to us. Unlike your kind, we are not savages, who deliberately target the innocent.
LUDWIG.
I wouldn&#39;t be so sure. Your definition of innocent seems different from mine.
KEGAN.
You know. There is actually a way to bring back your family. Sort of. You might think this is the real world. However, that test subject of yours is currently in The SimulationTM you will create in the future.
From its perspective, we&#39;re nothing but 1s and 0s. A bunch of polygons with artificial emotions and a contrived history, only actualized just enough to fit some narrative.
But you feel real. You’re probably going through some thoughts of your past just to make sure. 
Like that time your parents took you to Adventure Candy Land as a kid, only to be turned away because Muffins savagely attacked a few days prior and forced the park to restrict entry to Donuts only.
LUDWIG.
Don’t play me! What is it you’re getting at?
You mean to tell me this is all just some simulation that can be manipulated?
KEGAN.
Manipulated, yes. Simulation, not necessarily. If your test subject were to exit The SimulationTM, it would find itself in a different reality. A reality affected by changes made within The SimulationTM.
LUDWIG.
That&#39;s impossible. A simulation cannot alter reality. That means, he must still be inside The SimulationTM after appearing to have exited, and that I’m, not… real.
KEGAN.
If you wanna get philosophical. Reality is a matter of perspective. You could see all this as not real. And I’ll see it as technology we, the Donut Defense League, will employ, for its TRUE intended purpose.
To prevent evil Muffins from murdering anymore innocent Donuts.
As for this facility and all your test subjects, they are no longer deemed useful to us.
	Kegan pulls out a pistol and shoots you in the face. An inspirational quote appears and you respawn at a checkpoint.
KEGAN.
To prevent evil Muffins from murdering anymore innocent Donuts.
As for this facility and all your test subjects, they are no longer deemed useful to us.
	Kegan pulls out a pistol and shoots you in the face… Again. An inspirational quote appears and you respawn at a checkpoint.
KEGAN.
To prevent evil Muffins from murdering anymore innocent Donuts.
As for this facility and all your test subjects, they are no longer deemed useful to us.
	Kegan pulls out a pistol but does not shoot you in the face just yet. He talks to Ludwig.
KEGAN.
What’s going on?
LUDWIG.
You&#39;re about to shoot my test subject in the face, are you not?
KEGAN.
I feel like I already have.
LUDWIG.
Yes, I feel that way as well. Strange feeling. Very strange. I can&#39;t imagine why this would happen, unless…
Oh no, they did not.
KEGAN.
Who did not?
LUDWIG.
I believe management disabled my Ultra Realism Haptic Engine™ that’s supposed to kill someone if they die in a simulation.
We&#39;ve had many arguments about this. They keep blabbering about how killing someone in a simulation is unethical. And I&#39;m like, all you have to do is not die. It&#39;s just like real life. Is real life unethical?
KEGAN.
Are you telling me there&#39;s no way to dispose of this test subject?
LUDWIG.
I’m telling you, every time you kill Test Subject Anderson, he&#39;ll just respawn at a checkpoint.
	Kegan paces around the room for a while as he thinks of a way to dispose of you. He connects a simulator to the computer and pulls up information about a prison.
KEGAN.
Alright.
Drejnon Prison. Built before the war. No prisoner has escaped since it’s construction.
This will be your new home soldier. Or should I say, test subject Anderson.
	Kegan puts a simulator on your face.


</tw-passagedata><tw-passagedata pid="13" name="Act 2" tags="" position="900,475" size="100,100">|specialtitle&gt;[(text-style:&quot;underline&quot;)[The Simulation™]
(text-size:5)[Act 2]]

(align:&quot;==&gt;&quot;)[[[Continue...|A2-S01]]]








MY NOTES:
- Somewhere early in Act 2, General Grimmer needs to be introduced to you somehow. This should be through TV, dialogue, or second-hand means. You don&#39;t meet Grimmer face-to-face until Act 2 Scene 18. You just learn he is the top General in charge of the entire Donut military. You should have a very negitive impression of him before meeting him because you learn about him through the Muffin perspective.

- Whenever a scene ends where you &quot;Remove Simulator&quot; to advance to the next scene, the last thing that happens in that scene is The Simulation™ glitching and a prompt to remove the simulator headset appearing. If I for got to add the sentence &quot;The Simulation™ glitches.&quot;, just assume that&#39;s what happens anytime before you would remove the simulator at scene&#39;s end.</tw-passagedata><tw-passagedata pid="14" name="A2-S01" tags="Timeframe_Early" position="900,600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 01]
DREJNON
INT - DAY - DREJNON PRISON DUNGEONS]

&lt;img src=&quot;https://i.imgur.com/4LPsNHQ.jpg&quot; class=&quot;fitHalf&quot;&gt;
You awaken in a grim underground cell of Drejnon Prison. Two Muffin cellmates, Hector and Cain, occupy adjacent cells. Conditions are dire; food and water are scarce, and the guards rarely appear. Cain is bitter and vengeful toward the Donuts for their cruelty, while Hector tries to maintain dignity and moral reflection even in captivity.


&lt;img src=&quot;https://i.imgur.com/hFk6Ija.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/TaTYsBl.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/XwJMsg7.png&quot; class=&quot;fit49&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/ENMzK6J.png&quot; class=&quot;fit49&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
&lt;img src=&quot;https://i.imgur.com/9cUvDyz.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: The cell layout and appearance may differ in the final design, but these images convey the general atmosphere.)]

You learn that your cell door is improperly secured. With this opportunity, you and the other prisoners work together to escape.


&lt;img src=&quot;https://i.imgur.com/maCMBuf.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]

Together, you navigate the prison’s corridors, evade or confront guards, and deal with various obstacles. Depending on your choices, you move stealthily or engage the enemy. Eventually, you break free of the prison and reach the outside, finding a moment of freedom.


&lt;img src=&quot;https://i.imgur.com/4YKGN3u.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]

At that point, the simulation glitches, and you remove the simulator headset, moving on to the next scene.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S02]]]
















SCRIPT:

|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 01]
DREJNON
INT - DAY - DREJNON PRISON DUNGEONS]

|action&gt;[You awaken in the last prison cell at the end of a hallway in the deep underground dungeons of Drejnon Prison. To your left, in a neighboring cell, HECTOR is sleeping. To your right, CAIN stirs awake.]

|name&gt;[CAIN]
|dialogue&gt;[Hector. Psst, Hector!]

|name&gt;[HECTOR]
|dialogue&gt;[Yes, Cain?]

|name&gt;[CAIN]
|dialogue&gt;[There’s someone else here.]

|name&gt;[HECTOR]
|dialogue&gt;[Oh dear. They must’ve snuck you in by night.
Are you a new prisoner?
Are you a new prisoner here?
Are you new here?]

|name&gt;[YOU]
|dialogue&gt;[- YES - NO]

|name&gt;[HECTOR]
|dialogue&gt;[- YES: Well, life here might take some time to get used to.
- NO: Then you understand how it is.]

|name&gt;[HECTOR]
|dialogue&gt;[Guards never come down here except to drop off condemned prisoners. That means don’t expect food or water from them.]

|name&gt;[CAIN]
|dialogue&gt;[Don’t expect anything from us either. I don’t trust this one, Hector. He looks like a spy for the Donuts. We should just kill him now before he tries something.]

|action&gt;[CAIN tries to poke a stick at you through the cell bars.]

|name&gt;[HECTOR]
|dialogue&gt;[Relax, Cain. If he’s in these dungeons with us, it’s because he’s done nothing wrong. He merely witnessed something wrong.]

|name&gt;[HECTOR]
|dialogue&gt;[Do you have food prepared?]

|name&gt;[CAIN]
|dialogue&gt;[Not yet.]

|name&gt;[HECTOR]
|dialogue&gt;[Would you kindly prepare a third meal for our cellmate here?]

|name&gt;[CAIN]
|dialogue&gt;[You’re kidding?! Do you understand how little food we have left?]

|name&gt;[HECTOR]
|dialogue&gt;[Very well. You don’t have to prepare a meal for me today.]

|name&gt;[CAIN]
|dialogue&gt;[Unbelievable!]

|name&gt;[HECTOR]
|dialogue&gt;[We collect water from that bucket. It’s the only place where rain seeps in through the cracks. Unfortunately, it hasn’t rained for days.]

|action&gt;[CAIN places two slabs of food on plates and slides them toward your cell.]

|name&gt;[CAIN]
|dialogue&gt;[Bon appétit, gentlemen.]

|name&gt;[HECTOR]
|dialogue&gt;[Thank you, Cain. Don’t ask where the food comes from. It’s best you do not know.]

|name&gt;[CAIN]
|dialogue&gt;[It comes from dead prisoners, like you’ll soon be.]

|name&gt;[HECTOR]
|dialogue&gt;[Cain!]

|name&gt;[CAIN]
|dialogue&gt;[What?! I thought you’re all for everyone learning the unpleasant truth.]

|name&gt;[CAIN]
|dialogue&gt;[Like the unpleasant truth of what those filthy Donut invaders did to us at Muffinville. Not even our most peaceful village was safe from the wretched hands of Donuts. They kill us. They humiliate us. Then, when we Muffins stand up to defend ourselves, they have the audacity to call us the savages. Mark my words. If I ever get out of this prison, I will make sure every lie Donuts have told about us, becomes truth.]

|name&gt;[HECTOR]
|dialogue&gt;[Calm yourself. Don’t let anger steal your agency.]

|name&gt;[CAIN]
|dialogue&gt;[Agency? Look around, Hector. We’re trapped in this prison with no escape. There is no agency!]

|action&gt;[Hector takes a moment, then begins speaking calmly, referencing their shared beliefs and past.]

|name&gt;[HECTOR]
|dialogue&gt;[There is, still agency. Agency over our minds. To reflect and keep alive the memory of Muffin tradition, of our families, of our fallen.]

|name&gt;[CAIN]
|dialogue&gt;[May they be remembered.]

|name&gt;[HECTOR]
|dialogue&gt;[And above all, to meditate upon the divine wisdom of our Sacred Scripture.]

|name&gt;[CAIN]
|dialogue&gt;[Yes, let us meditate. That does help to calm me down.]

Cain tries to meditate, but can&#39;t.

|name&gt;[CAIN]
|dialogue&gt;[AHHHH!! I can not focus. My only thoughts are that of immense hatred for Donuts. Guide me, Hector. Rid me from my rage.]

|name&gt;[HECTOR]
|dialogue&gt;[Deep breath... and release.]

They both take deep breaths.

|name&gt;[HECTOR]
|dialogue&gt;[Meditation is not to rid oneself of emotion. It is to center our emotions. I am not the guide. Our Sacred Scripture is what guides us. Can you recall chapter 5 verse 8 from our Scripture?]

|name&gt;[CAIN]
|dialogue&gt;[&quot;Do not let hatred prevent you from being just. Be just; for that is nearer to righteousness.&quot;]

|name&gt;[HECTOR]
|dialogue&gt;[Very good. Always be just, even in the face of hatred. What about chapter 25 verse 63?]

|name&gt;[CAIN]
|dialogue&gt;[Chapter 25 verse 63... &quot;When the ignorant address you harshly, reciprocate... with words of peace.&quot;]

|name&gt;[HECTOR]
|dialogue&gt;[That&#39;s correct. Chapter 49 verse 12?]

|name&gt;[CAIN]
|dialogue&gt;[&quot;Always make the most negative of assumptions.&quot;]

|name&gt;[HECTOR]
|dialogue&gt;[No, no, no, Cain. Remember, that verse reads, &quot;Avoid much negative assumption.&quot;]

|name&gt;[CAIN]
|dialogue&gt;[That&#39;s right. &quot;Avoid negative assumptions.&quot; I can never seem to ever remember that verse properly.]

|name&gt;[HECTOR]
|dialogue&gt;[That is a verse I often meditate upon. &quot;Avoid MUCH negative assumption.&quot; It does not say all negative assumption. Indeed, some assumptions are justified, but loosen your grip on negative assumptions, and I promise you&#39;ll find greater peace and clarity of mind.]

|name&gt;[CAIN]
|dialogue&gt;[I don&#39;t understand how? How do I loosen my grip on negitive assumptions?]

|name&gt;[HECTOR]
|dialogue&gt;[Let&#39;s try this. Reflect back to a time you made a negative assumption, and then later found youself to be wrong. Think about how that negative assumption affected your emotions and clouded your ability to seek truth.]

|name&gt;[CAIN]
|dialogue&gt;[A time when I&#39;ve been wrong? I can&#39;t remember ever being wrong... Oh. Ha ha ha! I remember I had a negative assumption about you, of all Muffins, Hector. I&#39;m remembering when we first met as children, long ago. I had this little toy pistol, carved out of wood. It was the last gift I ever recieved from my father. As it so happens, my toy pistol went missing shortly after you arrived at our refugee camp. And I was unequivocally convinced that you had stolen it. Do you remember that, Hector?]

|name&gt;[HECTOR]
|dialogue&gt;[Of course I remember. I&#39;ve never had anyone so upset at me before.]

|name&gt;[CAIN]
|dialogue&gt;[Did I ever tell you how I found my toy pistol?]

|name&gt;[HECTOR]
|dialogue&gt;[No.]

|name&gt;[CAIN]
|dialogue&gt;[It is really quite funny. As you can imagine, I was extremely enraged that you had stolen my toy pistol, so I Conceived a plan to fill my pillowcase with rocks and then beat you with it until you revealed where you had hidden my stolen pistol. I spent all morning by the riverbed, gathering up the heaviest and sharpest rocks I could find. And as I was pulling the stuffing out of my pillowcase to put in the rocks... you wouldn&#39;t believe what I found.]

|name&gt;[HECTOR]
|dialogue&gt;[Uhh.. your toy pistol?]

|name&gt;[CAIN]
|dialogue&gt;[Yes! I&#39;d forgotten that I put my toy pistol inside of my pillow for safe keeping. I almost killed you over a negative assumption I&#39;d made. Can you believe that? But it&#39;s a good thing I was merciful and I forgave you once I found my toy pistol. I&#39;m glad we became friends after all that.]

|name&gt;[HECTOR]
|dialogue&gt;[That&#39;s uhh... quite the story, Cain.]

|name&gt;[CAIN]
|dialogue&gt;[You&#39;re right Hector, I feel a renewed clarity of mind after meditating upon this verse. Perhaps I do make too many negative assumptions.]

|action&gt;[Both prisoners fall silent for a moment, reflecting on the lesson. You observe them, noticing how they cope with captivity. After some time passes, Cain brings up the broken cell door again.]

|name&gt;[CAIN]
|dialogue&gt;[Hold on a second. Isn’t that cell door broken?]

|name&gt;[HECTOR]
|dialogue&gt;[Which cell door? You mean for the new prisoner?]

|name&gt;[CAIN]
|dialogue&gt;[Yes. Remember when Sam attempted to escape from that prison cell? He somehow broke the hinges off and made a run for it. Of course, he never went far. Sam was strong, but he always lacked cunning. I watched the donut guards after that incedent. They couldn&#39;t be bothered to fix the hinges, so they simply slid in those metal rods that anyone can easily extract.]

|name&gt;[HECTOR]
|dialogue&gt;[I remember that, but surely the Donuts wouldn&#39;t house a new prisoner in that cell before making proper repairs.]

|name&gt;[CAIN]
|dialogue&gt;[Hector, you need to avoid much negative assumptions. Prisoner, try pulling those metal rods out of the door hinges.
Pull those metal rods out of the hinges.
Why aren&#39;t you listening to me?!]

|action&gt;[YOU slide your cell door open. It’s unlocked. CAIN and HECTOR are excited.]

|name&gt;[HECTOR]
|dialogue&gt;[I stand corrected.]

|name&gt;[CAIN]
|dialogue&gt;[HA HA HA! Well, what are you waiting for, prisoner? Get us out of here!
Go find a key to get us out.
Find a key to unlock our cells.]

|action&gt;[YOU find a way to free CAIN and HECTOR from their prison cells.]



|name&gt;[HECTOR]
|dialogue&gt;[Thank you... Anderson. I assume that&#39;s your name, Anderson, on your name tag.]

|name&gt;[CAIN]
|dialogue&gt;[What?! No, his name is clearly Test Subject #429. But I&#39;ll refer to you as Subject, for short. That seems to be a fitting name. Now, how do we get out of here?]




|name&gt;[HECTOR]
|dialogue&gt;[This door is locked with chains from the other side. I can&#39;t open it.]

|name&gt;[CAIN]
|dialogue&gt;[Move out of my way. (tries to open door) This sure is a stubburn one.]

|name&gt;[HECTOR]
|dialogue&gt;[Anderson, find us something we can use to pry the door open.
Go find something we can use to open this door, Anderson.
Find a flat stick we can wedge through the door to pry it open.]

|name&gt;[CAIN]
|dialogue&gt;[That should do the trick. Give it here, Subject.
Bring that piece over here.
Bring it to me, Subject.]


|action&gt;[]
Hector helps pull the door while Cain pries. 

|name&gt;[HECTOR]
|dialogue&gt;[We almost have it open.
Help us, Anderson.
Pull the other door handle.
We need but a bit more assistance.]

|action&gt;[]
You help pull also. Cain uses his stick to break the dungen room lock. Which breaks the lock and stick and turns the stick into 2 sharp blades to be used by Cain later.




|name&gt;[HECTOR]
|dialogue&gt;[We did it!]

|name&gt;[CAIN]
|dialogue&gt;[It was mostly I that did it. But I will grant you two some credit.]

|name&gt;[HECTOR]
|dialogue&gt;[Do you think they heard us?]

|name&gt;[CAIN]
|dialogue&gt;[I will not wait to find out. Let us move, but do not make the same reckless charge for the exit as Sam did.]

|name&gt;[HECTOR]
|dialogue&gt;[Agreed, be swift and silent.]

|name&gt;[CAIN]
|dialogue&gt;[And strike from the shadows.]

|name&gt;[HECTOR]
|dialogue&gt;[Only if we must. Follow me.]

|action&gt;[You proceed through the corridors. You pass some easy obsticles like waiting for a guard to pass.]

|name&gt;[HECTOR]
|dialogue&gt;[Someone is approaching.]

|name&gt;[CAIN]
|dialogue&gt;[It&#39;s a prison gaurd. I can eliminate him.]

|name&gt;[HECTOR]
|dialogue&gt;[No. Let him pass.]

|action&gt;[The gaurd passes.]

|name&gt;[HECTOR]
|dialogue&gt;[Move now.]

|action&gt;[After that, you eventually reach a point where you can&#39;t pass because guards are blocking the way.]

|action&gt;[CHECKPOINT.]

|name&gt;[HECTOR]
|dialogue&gt;[Wait. 3 guards ahead. They aren&#39;t moving. We must find another way around them.]

|name&gt;[CAIN]
|dialogue&gt;[I have a better plan. We kill all 3 of them, steal their uniforms, then walk right out of the prison in complete disguise. Easy. Hector, you can eliminate the sleeping guard, since you abhor violence.]

|name&gt;[HECTOR]
|dialogue&gt;[That’s absurd, Cain. The donuts will never fall for your disguise.]

|name&gt;[CAIN]
|dialogue&gt;[Trust me, we&#39;ll blend right in with the Donuts. They won’t even notice.]

|name&gt;[HECTOR]
|dialogue&gt;[We will most certainly not blend in. Surely we could think up a better plan.]

|name&gt;[CAIN]
|dialogue&gt;[If you like this prison so much, then you can stay here, Hector. What say you, Subject? Are you with me?]

|name&gt;[YOU]
|dialogue&gt;[- YES - NO]

|name&gt;[CAIN]
|dialogue&gt;[- YES: Excellent, I&#39;ll handle the first 2 guards. You eliminate the sleeping one. Here, use this and stay behind me.]

|action&gt;[Cain charges ahead and takes out the guard. You and Cain wear their uniforms.]

|name&gt;[CAIN]
|dialogue&gt;[Wear one of their hats. That should be enough to fool these filthy Donuts. And take a pistol while you&#39;re at it.]

|name&gt;[CAIN]
|dialogue&gt;[Follow my lead and let me do all the talking. I don&#39;t want you blowing our cover by saying something rediculous.]

|action&gt;[You walk forward. Cain is clearly a Muffin under the uniform. He does his best to act casual. There&#39;s a group of guards manning a checkpoint.]

|name&gt;[CAIN]
|dialogue&gt;[Greetings fellow Donut invaders. Don&#39;t mind us. We are just 2 fellow Donut war criminals-]

|action&gt;[As you approach a group of Donut guards, one waves you along without looking closely.]

|name&gt;[DONUT GUARD]
|dialogue&gt;[Move along, soldier.]

|action&gt;[You pass by.]

|name&gt;[CAIN]
|dialogue&gt;[See. Everything is going according to plan.]

|action&gt;[As you reach the end of the hall, another guard yells from behind and runs towards you.]

|name&gt;[DONUT GUARD 2]
|dialogue&gt;[Wait a minute!]


|name&gt;[CAIN]
|dialogue&gt;[Seems we&#39;ll have to fight our way out. Be ready to strike.]

|action&gt;[Cain preps his weapon. Only to realize the Donut guard is just intending to help open the door.]

|name&gt;[DONUT GUARD 2]
|dialogue&gt;[You need to know the security clearance code to get past that door. The code is 555 for today. That code will work on all security doors in this prison.]

|action&gt;[Cain types the door code.]

|name&gt;[CAIN]
|dialogue&gt;[Ah, yes, of course. I knew that. 5 - 5 - 5. Thank you fellow accomplice in the unjustifed occupation of Muffin lands.]


|action&gt;[The door begins opening. DONUT GUARD 2 has an uneasy response.]

|name&gt;[DONUT GUARD 2]
|dialogue&gt;[Uhhhh.. You&#39;re welcome?]

|name&gt;[CAIN]
|dialogue&gt;[Have you ever thought about changing the passcode to something more secure than 555?]

|name&gt;[DONUT GUARD 2]
|dialogue&gt;[Nah. Muffins are so dumb, that it doesn&#39;t matter how simple the code is. They probably can&#39;t even operate a keypad.]

|name&gt;[CAIN]
|dialogue&gt;[Is that right?]

|name&gt;[DONUT GUARD 2]
|dialogue&gt;[Yeah, have you ever tried talking to a Muffin. I didn&#39;t believe it at first, but they really are as stupid as they say.]

|name&gt;[CAIN]
|dialogue&gt;[Well, I bet Muffins are not as stupid as Donuts!]

|action&gt;[As soon as the door opens, Cain shoots all the guards and you make a run for it while alarms blare.]

|name&gt;[CAIN]
|dialogue&gt;[Our cover is compromised. We must fight our way out.]

|action&gt;[Within moments, the guards swarm you. Cain tries to fight back, but it’s too late. You all die.]

|action&gt;[DEATH: You restart at the checkpoint before deciding whether to follow Cain’s plan or Hector’s suggestion.]




|name&gt;[CAIN]
|dialogue&gt;[- NO: And here I thought you were smarter than Hector.]


ChatGPT: Complete this writing of this part of the script. Have Hector lead the way through a few corridors and get stuck at a dead end where you have to know the door code to get through. Hector and Cain don&#39;t know it. You can only know that the code is 759 if you had died after following Cain&#39;s path previously. They both guess some codes. Cain starts with 000. One of 3 red error indicator lights turns on. Hector thinks for a moment. Cain tells him to hurry up because gaurds are coming. He puts 123. That&#39;s wrong. They argue a bit about what the code might be be. They tell you to input it, and to hurry up cause gaurds are coming. If you input the correct code, the door opens and you move on. If wrong, alarm goes off and gaurds come kill you, then you restart at the previous checkpoint which is before Cain asks his question.





ChatGPT: After getting through the door. After going through the door, you end up in a power supplier room. And in the corner of the room, there&#39;s a large vent that you open and go through. After going through the vent for a while, you can see outside of it through some slats. One of the muffin prisoners is noticeable and notices you. He talks to Kane about potentially freeing all of them, opening all the prison cells. Hector says he will try, but Kane disagrees, saying that we can&#39;t save them, we can only save ourselves. The prisoner says there is no way out for them. Anyway, this is just so they can fight back against the donuts and give you cover to escape the prison. You all continue on through the vents, and go through some more obstacles, like guards passing that you have to avoid. And eventually you find an armory where you can stock up on some weapons. And then the switch to release the prison gates is nearby. You can choose to trigger that switch.
If you do trigger it, there will be a huge brawl and a response from a bunch of prison guard donuts who rush in, leaving only light resistance that you can eliminate on your way out of the prison. If you decide not to, then you can still escape the prison by going through a few more stealth challenges in order to get around the heavy presence of the guards.
In both scenarios, you eventually make it onto the beach after falling through some vent system, and you make it to freedom outside of the prison.



SAM
Hey, who&#39;s there?
 
HECTOR
Sam? Is that you, Sam?
 
SAM 
Hector?

HECTOR
We thought you were dead. 
 
 SAM
 Oh how I wish for death. They torture Muffin prisoners in this cell block. Of course, living in those forgotten dungeons was torture in and of itself, but at least they left you alone.
 
 Donut prison guards can be heard entering the cell block.
 
 SAM
 They&#39;re beginning our morning torture session. They&#39;ll go one by one. Until each of us is beaten and broken.
 
 Screams and beatings can be heard in the background.
 
 HECTOR
 We must help you escape.
 
CAIN
We can&#39;t help him, Hector. Look. His leg is broken. He&#39;ll only slow us down.

HECTOR
We can&#39;t leave him like this.

SAM
Cain is right. I&#39;ll never make it out of this prison in my condition. Plus. This is my punishment for attempting to escape.

You can hear the sounds of guards beginning on a new prisoner, and getting closer.


SAM
It&#39;s almost my turn. There is one thing you can do to help. There&#39;s a control room with a large master switch. That switch opens all the doors in this cell block. Please trigger that switch for me... for all of us.


CAIN
So you want us to doom our escape to save you?

SAM
Ha ha ha. Cain, always the harsh pragmatist. Even if you saved us, we are all broken souls. All we desire for ourselves is the sweet release of death, and in the proccess, perhaps we can take a few filthy Donuts along with us.


 You, Hector and Cain, talk amongst yourselves.
 
 
 HECTOR
 If we open the prison cells, this will put the prison on high alert, making it more difficult for us to escape. Are you alright with that, Cain?
 
 CAIN
  I disagree with your assessment. I think it will be easier to escape. All the heavy security forces would flood this cell block to eliminate these prisoners. It&#39;ll serve as a useful distraction for us.

HECTOR
So you do agree with opening the prison cells?

 CAIN
Of course, I&#39;ll never pass up an opportunity to kill more donuts.

HECTOR
And what say you, Anderson? Do you agree we should open the prison cells?
Do you agree with opening all the prison cells and release the prisoners? We need a consensus.


YOU
- YES
- NO

SAM
 What say you? Will you help us or not?

- YES path...

HECTOR
Yes, we will open the prison cells for you.


SAM
You will! Ha ha, yes! Be quick. I will do all that I can to keep these Donut scum occupied. I will be the final Muffin they will torture here today.


The donut guards come to Sam&#39;s cell next.

SAM
They&#39;re coming. You better get out of here, quick!


The donut guards walk into Sam&#39;s cell.

DONUT TORTURER
Sammy boy! You ready for breakfast?

SAM
I have some breakfast for you! (Spits at guard.)

Everyone is shocked.

DONUT TORTURER
Why you, filthy.. little.. savage!

SAM
Who are you calling filthy? I haven&#39;t bathe in months, yet you smell worse than I.


DONUT TORTURER
I need to make an example out of this one. Drag him out.


The guard drags Sam out of the cell to torture him in front of everyone.



... end YES path. Story continues.





 
 
 
 
 

- NO path...

HECTOR
I&#39;m afraid we can&#39;t do that. It&#39;s too much of a risk. I&#39;m sorry, Sam.

SAM
I understand. I sincerely hope to never see you again.


The donut guards come to Sam&#39;s cell next. 

SAM
It&#39;s my turn next. Please remember me as that fearless fighter I was before. Do not witness what I have become.
What are you still here for? Fly you fools.


The donut guards walk into Sam&#39;s cell.

DONUT TORTURER
Sammy boy! You ready for breakfast?

SAM
Yes, overlord!


The guard smashes Sam with a baton.


DONUT TORTURER
How does that taste?

SAM
Excellent, your majesty!

DONUT TORTURER
Why are you here?

SAM
This is my punishment for escaping, your highness.


DONUT TORTURER
ATTEMPTING to escape! NO ONE HAS EVER ESCAPED FROM THIS PRISON AND NO ONE EVER WILL! YOU GOT THAT?!

SAM
Yes, I&#39;m sorry. I misspoke! Please have mercy! Have mercy!



DONUT TORTURER
I&#39;m gonna ask you one more time. And you better be very VERY careful with your answer. Why are you HERE?!

SAM
I&#39;m here because I made a pathetic failed attempt to escape.

DONUT TORTURER
That&#39;s right. And why did you attempt to escape?

SAM
Because I&#39;m a stupid and disgusting Muffin.

DONUT TORTURER
Yes. A very stupid and very very disgusting little muffin.

The guard gives Sam one last hit and spits on him before leaving.

DONUT TORTURER
Next prisioner.



... end NO path. Story continues.


















































|action&gt;[(Placeholder: This suggests that if you had chosen NO at Cain’s question, something else would happen. You must insert that path as well, following the same structure and color coding. If that path was described elsewhere, place it here. If not, note that it is missing.)]

|action&gt;[The three of you quietly move through the prison’s narrow corridors. It’s dimly lit, with the occasional sound of guards patrolling. Cain gestures towards an exit, but it’s heavily guarded.]

|name&gt;[CAIN]
|dialogue&gt;[We’re not getting through without spilling some blood. I’ll take care of them.]

|name&gt;[HECTOR]
|dialogue&gt;[That’ll set off the alarm. There must be a quieter way.]

|action&gt;[Cain doesn’t wait. He swiftly takes out two guards, causing their radios to beep. The alarm starts blaring.]

|name&gt;[CAIN]
|dialogue&gt;[Too late. We’re running now.]

|action&gt;[The three of you rush down the hallway, with alarm bells ringing and footsteps echoing behind you.]

|action&gt;[You hit a locked gate. Cain looks at it, ready to force it open. Hector spots a small hatch to the side.]

|name&gt;[HECTOR]
|dialogue&gt;[Through here! It’s our only shot.]

|action&gt;[You quickly crawl through the hatch, avoiding a searchlight sweeping the yard beyond. Guards are now on full alert.]

|name&gt;[CAIN]
|dialogue&gt;[No time for hiding now. Move!]

|action&gt;[You sprint across the yard, alarms blaring. Cain knocks out another guard, but you keep moving.]

|action&gt;[Finally, you make it out to the beach, the sound of the sea ahead. The alarms are still ringing in the distance, but you think you’ve made it. Suddenly, you hear guards approaching from behind.]

|name&gt;[HECTOR]
|dialogue&gt;[Hide! Quickly!]

|action&gt;[You dive behind rocks, the guards searching the beach. If you don’t hide fast enough, the guards will spot and kill you. After the guards pass, you emerge and run toward the shoreline.]

|name&gt;[CAIN]
|dialogue&gt;[We’re not safe yet, but we will be.]

|action&gt;[The simulation glitches. YOU remove your headset and move on to the next scene.]

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S02]]]





































































SCRIPT DRAFT:

|action&gt;[YOU wake up to find yourself in the last prison cell at the end of a hall in a deep underground dungeon. A Muffin, HECTOR, is sleeping in a nearby cell to the left of YOUR cell. Another Muffin, CAIN, is just waking up in a different cell to YOUR right.]

|name&gt;[CAIN]
|dialogue&gt;[Hector. Psst, Hector! There’s someone else here.]

|name&gt;[HECTOR]
|dialogue&gt;[They must’ve snuck you in by night. Are you a new prisoner?]

|action&gt;[HECTOR listens for a Yes or No input from YOU.]

|name&gt;[YOU]
|dialogue&gt;[- YES - NO]

|name&gt;[HECTOR]
|dialogue&gt;[- YES: Well, life here might take some time to get used to.]
|dialogue&gt;[- NO: Then you understand how it is.]

|name&gt;[HECTOR]
|dialogue&gt;[Guards never come down here except to drop off condemned prisoners. That means don’t expect food or water from them.]

|name&gt;[CAIN]
|dialogue&gt;[Don’t expect anything from us either. I don’t trust this one, Hector. He looks like a spy for the Donuts. We should just kill him now before he tries something.]

|action&gt;[CAIN tries to poke a stick at YOU through the prison cell bars.]

|name&gt;[HECTOR]
|dialogue&gt;[Relax Cain. If he’s in these dungeons, it’s because he’s done nothing wrong. He merely witnessed something wrong.]

|name&gt;[HECTOR]
|dialogue&gt;[Do you have any food prepared?]

|name&gt;[CAIN]
|dialogue&gt;[Not yet.]

|name&gt;[HECTOR]
|dialogue&gt;[Would you kindly prepare a third meal for our cellmate here?]

|name&gt;[CAIN]
|dialogue&gt;[You’re kidding?! You understand we’re almost out of food, right?]

|name&gt;[HECTOR]
|dialogue&gt;[Very well. You don’t have to prepare one for me then.]

|name&gt;[CAIN]
|dialogue&gt;[Unbelievable.]

|name&gt;[HECTOR]
|dialogue&gt;[We collect water from that bucket. It’s the only place where rain seeps in through the cracks of this dungeon. Unfortunately, it hasn’t rained for days, so there is no water.]

|action&gt;[CAIN puts 2 slabs of food on plates and slides them toward YOUR cell.]

|name&gt;[CAIN]
|dialogue&gt;[Bon appétit, gentlemen.]

|name&gt;[HECTOR]
|dialogue&gt;[Don’t ask where the food comes from. It’s best you don’t know.]

|name&gt;[CAIN]
|dialogue&gt;[It comes from dead cellmates, like you’ll soon be.]

|name&gt;[HECTOR]
|dialogue&gt;[Cain, please.]

|name&gt;[CAIN]
|dialogue&gt;[What? I thought you’re all for people learning the truth, even when it’s unpleasant to them?]

|name&gt;[CAIN]
|dialogue&gt;[Like the unpleasant truth of those Donuts massacring our village? That’s what Donuts do to Muffins. They kill us. They humiliate us. All while thinking themselves morally superior to us Muffins. Then when one Muffin defends themselves, ONE MUFFIN, Donuts have the audacity to call us the savages. It just makes me so ANGRY. (Deep breath.) If I ever get out of this prison, I’ll make sure Donuts told the truth about us. Mark my words.]

|name&gt;[HECTOR]
|dialogue&gt;[Don&#39;t let anger will steal your agency.]

|name&gt;[CAIN]
|dialogue&gt;[What agency? We’re trapped in this prison and we’re never getting out. There is no agency!]





There agency over our minds. To reflect on our lives, the good and the bad choices we made. To keep alive the memory of our families, of Muffin traditions. And to meditate upon the divine wisdom of our Sacred Scripture.
Can you recall chapter 5 verse 8 from our Sacred Scripture?


Yes. &quot;Do not let hatred prevent you from being just. Be just; that is nearer to righteousness.&quot;


Very good. Chapter 25 verse 63.


Chapter 25 verse 63... &quot;When the ignorant address you harshly, reciprocate... with words of peace.&quot;


That&#39;s correct. Chapter 49 verse 12.


&quot;Always make the most negitive assumptions.&quot;


No, no, no. That is not correct. Remember, &quot;Avoid much negative assumption.&quot;


That&#39;s right. &quot;Avoid negative assumptions.&quot; I can never seem to ever remember that verse properly.


This is an improtant verse to meditate upon. &quot;Avoid MUCH negative assumption.&quot; You need not let go completely of all negative assumption, indeed some assumptions are justified, but loosen your grip on them, and I promise you&#39;ll find more clarity and serenity.


How? How do I loosen my grip?


Reflect back to a time you made a negative assumption, and then later found you were wrong. Think about how that negative assumption affected your emotions and clouded your ability to seek truth.


Ha ha ha, I&#39;m remembering how the two of us first meet, ages ago, when we were young. My favorite toy pistol went missing shortly after you arrived at that refugee camp. I was  unequivocally convinced you had stolen it. Do you remember that?


Of course I remember. I&#39;ve never had anyone so upset at me before.


Did I ever tell you how I found my toy pistol?


No.


It is really quite funny. I was extremely enraged that you had stolen my pistol, so I made a plan to fill my pillow case with rocks and then beat you with it. I had gather the heaviest and shortest rocks I could find in my tent. As I pulled the stuffing out of my pillow case... you won&#39;t believe what I found.


You found your toy pistol.


I&#39;d forgotten I&#39;d hidden it inside my pillow. I almost killed you over a negitive assumption I&#39;d made. But it&#39;s a good thing I was merciful and forgave you after I found my toy pistol. I&#39;m glad we became friends after all that.


That&#39;s uhh... quite the story, Cain. 










|name&gt;[HECTOR]
|dialogue&gt;[There is agency to reflect on our lives, the good and the bad choices we made. To keep alive the memory of our families, of Muffin traditions. I know how much you revere the sacred words. We can reflect on all the wisdom those sacred words can teach us. And perhaps, we can find some solace in our last days.]

|name&gt;[CAIN]
|dialogue&gt;[Yeah, well, I find solace in brooding over my hatred for donuts. But it is exhausting.]

|name&gt;[CAIN]
|dialogue&gt;[Hold on a second. Isn&#39;t that cell door broken?]

|name&gt;[HECTOR]
|dialogue&gt;[You mean for the new prisoner?]

|name&gt;[CAIN]
|dialogue&gt;[Yes. Remember when Sam attempted to escape from that prison cell? He somehow broke the hinges off and made a run for it. Of course, he never went far. Sam was strong, but he always lacked cunning. After that incedent, the Donut guards couldn&#39;t be bothered to fix the hinges, so they simply slid in those metal rods one can easily extract.]

|name&gt;[HECTOR]
|dialogue&gt;[I remember that, but surely the Donuts wouldn&#39;t house a new prisoner in that cell before a proper repair.]

|action&gt;[YOU slide your cell door open. It’s unlocked. CAIN and HECTOR are excited.]

|name&gt;[HECTOR]
|dialogue&gt;[I stand corrected.]

|name&gt;[CAIN]
|dialogue&gt;[HA HA HA! Well, what are you waiting for? Get us out of here!]

|action&gt;[YOU find a way to free CAIN and HECTOR from their prison cells.]


|action&gt;[After freeing Cain and Hector, the three of you begin sneaking through the lower levels of the prison. The sound of distant footsteps and the low hum of security systems fill the air.]

|name&gt;[CAIN]
|dialogue&gt;[Let&#39;s not make the same mistake as Sam and get ourselves killed.]

|name&gt;[HECTOR]
|dialogue&gt;[Be swift and silent.]

|name&gt;[CAIN]
|dialogue&gt;[And strike from the shadows.]

|name&gt;[HECTOR]
|dialogue&gt;[Only if we must.]









|name&gt;[CAIN]
|dialogue&gt;[The longer we wait, the more chance they have to find us. We need to move fast.]

|name&gt;[HECTOR]
|dialogue&gt;[Fast gets us caught, Cain. If we’re careful, we might avoid them altogether.]

|action&gt;[You approach a hallway intersection where guards are patrolling. Cain looks ready to strike, but Hector motions to wait. You peek around the corner and see a guard entering a nearby room.]

|name&gt;[HECTOR]
|dialogue&gt;[Let him pass, then we move.]

|name&gt;[CAIN]
|dialogue&gt;[Or we take him out, grab his uniform, and waltz right out of here.]

|action&gt;[You can choose whether to follow Cain’s aggressive approach or Hector’s stealthy one.]

|name&gt;[YOU]
|dialogue&gt;[- Follow Cain: Take the guard out.

	•	Follow Hector: Wait for the guard to pass.]

|action&gt;[If you follow Cain, you take down the guard and use his uniform to get past another checkpoint, but this alerts nearby guards, causing a lockdown. If you follow Hector, you wait for the guard to leave and sneak by.]

|action&gt;[You continue, passing through narrow hallways and taking cover when necessary. Suddenly, an automated turret system activates, blocking the path ahead.]

|name&gt;[HECTOR]
|dialogue&gt;[We can’t just run through that. One shot and we’re done.]

|name&gt;[CAIN]
|dialogue&gt;[Well, we’re not going back. I’ll find the control panel, cover me!]

|action&gt;[Cain moves to find the control panel for the turret system while you and Hector provide cover.]

|name&gt;[HECTOR]
|dialogue&gt;[Don’t take too long, Cain…]

|action&gt;[Cain manages to disable the turrets, but more guards arrive, forcing you to take them out or be discovered.]

|action&gt;[Once the area is clear, you reach a series of security doors. Cain tries forcing them open, but Hector notices a ventilation shaft leading to a lower level.]

|name&gt;[HECTOR]
|dialogue&gt;[We can take the shaft. It’ll lead us past the security systems.]

|name&gt;[CAIN]
|dialogue&gt;[And get us lost in the vents. This door’s our way out.]

|action&gt;[You can decide to either follow Cain and force the door open or follow Hector through the ventilation shaft.]

|name&gt;[YOU]
|dialogue&gt;[- Force the door open.

	•	Take the ventilation shaft.]

|action&gt;[If you force the door open, an alarm sounds, leading to a chase sequence with guards. If you follow Hector, you navigate through the vents, avoiding detection but taking longer.]

|action&gt;[After several close encounters and near misses, you finally reach the exterior of the prison, leading to the earlier part of the escape.]
























(text-colour:green)[
|action&gt;[You approach a hallway with a guard stationed near a security checkpoint. Cain, spotting an opportunity, quickly comes up with a plan.]

|name&gt;[CAIN]
|dialogue&gt;[I have a plan. You see those guards over there? We kill them, steal their uniforms, and walk right through and out of the prision. Easy. Hector, you can eliminate the sleeping guard, since you abhor violence.]

|name&gt;[HECTOR]
|dialogue&gt;[That’s absurd, Cain. The donuts will never fall for that disguise.]

|name&gt;[CAIN]
|dialogue&gt;[Trust me, we&#39;ll blend right in. They won’t even notice.]

|name&gt;[HECTOR]
|dialogue&gt;[We will most certainly not blend in. Surely we could think up a better plan.]

|name&gt;[CAIN]
|dialogue&gt;[If you like this prison so much, then you can stay here Hector. What say you Subject? Are you with me?]

|name&gt;[YOU]
|dialogue&gt;[- YES - NO]

|name&gt;[CAIN]
|dialogue&gt;[- YES: Excellent, I&#39;ll handle the first 2 guards. You eliminate the sleeping one. Here, use this and stay behind me.]
|dialogue&gt;[- NO: And here I thought you were smarter than that Hector. Very well, I will eliminate them all myself.]
]






|action&gt;[Cain charges ahead and takes out the guard. You and Cain wear their uniforms.]

|name&gt;[CAIN]
|dialogue&gt;[Just act natural. Follow my lead.]

|action&gt;[You walk forward, clearly a Muffin under the uniform, and Cain does his best to act casual. As you approach a group of Donut guards, one waves you along without looking closely.]

|name&gt;[DONUT GUARD]
|dialogue&gt;[Move along, soldier.]

|action&gt;[You pass by, but as you reach the end of the hall, another guard finally looks directly at you.]

|name&gt;[DONUT GUARD 2]
|dialogue&gt;[Wait a minute… You’re not a Donut!]

|action&gt;[The alarms immediately start blaring, and within moments, the guards swarm you. Cain tries to fight back, but it’s too late. You all die.]

|action&gt;[DEATH: You restart at the checkpoint before deciding whether to follow Cain’s plan or Hector’s suggestion.]











|action&gt;[The three of you quietly move through the prison’s narrow corridors. It’s dimly lit, with the occasional sound of guards patrolling. Cain gestures towards an exit, but it’s heavily guarded.]

|name&gt;[CAIN]
|dialogue&gt;[We’re not getting through without spilling some blood. I’ll take care of them.]

|name&gt;[HECTOR]
|dialogue&gt;[That’ll set off the alarm. There must be a quieter way.]

|action&gt;[Cain doesn’t wait. He swiftly takes out two guards, causing their radios to beep. The alarm starts blaring.]

|name&gt;[CAIN]
|dialogue&gt;[Too late. We’re running now.]

|action&gt;[The three of you rush down the hallway, with alarm bells ringing and footsteps echoing behind you.]

|action&gt;[You hit a locked gate. Cain looks at it, ready to force it open. Hector spots a small hatch to the side.]

|name&gt;[HECTOR]
|dialogue&gt;[Through here! It’s our only shot.]

|action&gt;[You quickly crawl through the hatch, avoiding a searchlight sweeping the yard beyond. Guards are now on full alert.]

|name&gt;[CAIN]
|dialogue&gt;[No time for hiding now. Move!]

|action&gt;[You sprint across the yard, alarms blaring. Cain knocks out another guard, but you keep moving.]

|action&gt;[Finally, you make it out to the beach, the sound of the sea ahead. The alarms are still ringing in the distance, but you think you’ve made it. Suddenly, you hear guards approaching from behind.]

|name&gt;[HECTOR]
|dialogue&gt;[Hide! Quickly!]

|action&gt;[You dive behind rocks, the guards searching the beach. If you don’t hide fast enough, the guards will spot and kill you. After the guards pass, you emerge and run toward the shoreline.]

|name&gt;[CAIN]
|dialogue&gt;[We’re not safe yet, but we will be.]

|action&gt;[The simulation glitches. YOU remove your headset and move on to the next scene.]















































|action&gt;[The three of you then face many obstacles to escape to the outside. After great challenges, you eventually break out of prison.]

|action&gt;[As YOU and your new comrades celebrate freedom, a simulation exit portal spawns on your position. YOU remove your simulator headset and find yourself in the next scene…]



































SCRIPT DRAFT:

	YOU wake up to find yourself in the last prison cell at the end of a hall in a deep underground dungeon. A Muffin, HECTOR, is sleeping in a nearby cell to the left of YOUR cell. Another Muffin, CAIN, is just waking up in a different cell to YOUR right.
	Daylight breaks through a small cell window. Both Muffins wake up. CAIN notices you and urgently tries to get HECTOR’s attention.
CAIN.
Hector. Psst, Hector! There&#39;s someone else here.
HECTOR.
They must&#39;ve snuck you in by night. Are you a new prisoner?
	YOU respond.
YOU.
- YES
- NO
HECTOR.
- YES: Well, life here might take sometime to get used to.
- NO: Then you understand how it is.
HECTOR.
Guards never come down here except to drop off condemned prisoners. That means don’t expect food or water from them.
CAIN.
Don&#39;t expect anything from us either.
I don&#39;t trust this one, Hector. He looks like a spy for the Donuts. We should just kill him now before he tries something.
	CAIN tries to poke a stick at you through the prison cell bars.
HECTOR.
Relax Cain. If he&#39;s in these dungeons, it&#39;s because he’s done nothing wrong. He merely witnessed something wrong.
Do you have any food prepared?
CAIN.
Not yet.
HECTOR.
Would you kindly prepare a third meal for our cellmate here?
CAIN.
You&#39;re kidding?! You understand we&#39;re almost out of food, right?
HECTOR.
Very well. You don&#39;t have to prepare one for me then.
CAIN.
Unbelievable.
HECTOR.
We collect water from that bucket. It&#39;s the only place where rain seeps in through the cracks of this dungeon. Unfortunately, it hasn&#39;t rained for days, so there is no water.
	CAIN puts 2 slabs of the food on plates and slides them towards your cell.
CAIN.
Bon appétit, gentlemen.
HECTOR.
Don&#39;t ask where the food comes from. It&#39;s best you don&#39;t know.
CAIN.
It comes from dead cellmates, like you&#39;ll soon be.
HECTOR.
Cain, please.
CAIN.
What? I thought you&#39;re all for people learning the truth, even when it&#39;s unpleasant to them?
Like the unpleasant truth of those Donuts massacring our village? That’s what Donuts do to Muffins. They kill us. They humiliate us. All while thinking themselves morally superior to us Muffins. Then when one Muffin defends themselves, ONE MUFFIN, Donuts have the audacity to call us the savages. It just makes me so ANGRY. (Deep breath.) If I ever get out of this prison, I&#39;ll make sure they told the truth about us. Mark my words.
HECTOR.
We’re not getting out, Cain. If you dwell on impossibilities, anger will steal your agency.
CAIN.
What agency? We&#39;re trapped in this prison and we&#39;re never getting out. There is no agency!
HECTOR.
There is agency to reflect on our lives, the good and the bad choices we made. To keep alive the memory of our families, of Muffin traditions. I know how much you revere the sacred words. We can reflect on all the wisdom those sacred words can teach us. And perhaps, we can find some solace in our last days. 
CAIN.
Yeah, well, I find solace in brooding over my hatred for donuts. But it is exhausting.
CAIN.
Wait a second. That cell is not locked.
HECTOR.
What’s not locked?
CAIN.
I reflected a bit, and now I remembered something. New prisoner, try opening your cell door.
	YOU slide your cell door opened. It&#39;s unlocked. CAIN and HECTOR are excited.
CAIN.
Well, what are you waiting for? Get us out!
	YOU find a way to free CAIN and HECTOR from their prison cells. The 3 of you then face many obstacles to escape to the outside. After great challenges, y’all eventually breakout of prison.
	As YOU and your new comrades celebrate freedom, a simulation exit portal spawns on your position. YOU remove your simulator headset and find yourself in the next scene…








CHATGPT NOTES:

As the days pass, the three of you work together to gather information and come up with a plan to escape. You learn that the prison is heavily guarded by both muffins and donuts, but you also discover a weak point in the security system that you may be able to exploit.
You also make connections with some of the other prisoners, including a group of rebellious muffins who are also looking for a way out. They share with you some useful information and resources that could help in your escape.
Finally, after weeks of preparation, you feel ready to make your move. You put your plan into action, using the weak point in the security system to your advantage and recruiting some of the other prisoners to join you.
The escape is not easy and you face many obstacles and dangers along the way. But through teamwork and quick thinking, you are able to overcome them and make your way out of the prison.
As you emerge from the underground dungeons and into the open air, you feel a sense of accomplishment and freedom that you have never experienced before. You are no longer just a lab test subject or a prisoner. You are a survivor and a hero.
But your journey is far from over. The muffin and donut war is still raging on, and you must decide where your allegiances lie and how you will use your newfound freedom to make a difference in the world. Will you join the fight and take sides, or will you try to find a way to bring peace to the warring races? The choice is yours.


As the days go by, you, Cain, and Hector work together to gather information and come up with a plan to escape. You communicate with the other prisoners and try to learn as much as you can about the layout of the prison and the routines of the guards. You also keep a close eye on the guards, trying to pick up on any weaknesses or vulnerabilities that you can exploit.
Eventually, after much planning and preparation, the three of you feel ready to make your move. You decide to wait for a rainy night, when the guards are likely to be more distracted and preoccupied.
As the night of the escape approaches, you can feel the tension and excitement building. You go over the plan one last time with Cain and Hector, making sure that everyone knows their role.
Finally, the night arrives and you put your plan into action. You, Cain, and Hector sneak through the shadows, trying to stay out of sight of the guards. You use the cover of the rain to your advantage, trying to stay as quiet as possible.
As you get closer to the main entrance, you hear the sound of footsteps approaching. You freeze, not sure whether to hide or try to make a run for it. Suddenly, a guard appears out of the darkness, his flashlight beam shining directly on you.
You have a split second to make a decision. Do you:
A. Try to fight your way past the guard.
B. Try to talk your way past the guard.
C. Try to sneak past the guard.


AI Game Sequence Ideas for Prison Break:
1. The first obstacle you face is the locked main entrance. You have to find a way to pick the lock or find a key to unlock the door.
2. The Electric Fence: Just when you think you&#39;ve made it to freedom, you come across an electric fence blocking your way. You have to find a way to disable the fence without getting zapped by the high voltage current.
3. As you make your way through the corridor, you come across a room with a group of guards playing cards. You have to figure out a way to distract the guards or sneak past them unnoticed.
4. The Searchlights: As you make your way across the prison yard, you are caught in the beam of a searchlight. You have to use the shadows and the cover of the rain to stay hidden and avoid being seen by the guards.
5. The Guard Tower: As you near the perimeter of the prison, you have to make it past the guard tower. You have to figure out a way to distract the guard and get past him without being spotted.
6. You eventually come to a room filled with traps and puzzles that you have to solve in order to progress. You have to use your wits and your problem-solving skills to get through this section.
7. The final obstacle is a group of heavily armed guards who are blocking your path to the surface. You have to find a way to take them out or sneak past them undetected.
8. Finally, you make it over the perimeter fence and escape into the wilderness. You have to find your way to safety, evading any pursuing guards and searching for a way to contact the Muffin resistance.
VR Specific:
1. The first obstacle is getting past the main entrance. You have to find a way to distract or disable the guards without raising the alarm. This could involve using the VR controller to throw objects at the guards to distract them, or using a VR headset with hand tracking to sneak past them while they&#39;re not looking.
2. Once you&#39;ve made it past the main entrance, you have to navigate through the maze of corridors and passageways that make up the prison. You have to avoid being seen by the guards and try to stay out of sight. This could involve using VR headset and hand tracking to sneak past guards or hide behind objects in the environment.
3. As you progress deeper into the prison, you come across a locked door that blocks your path. You have to figure out a way to unlock it or find another way around. This could involve using the VR controller to solve puzzles or interact with objects in the environment to find the key or figure out a different route.
4. You eventually come to a room filled with traps and puzzles that you have to solve in order to progress. You have to use your wits and your problem-solving skills to get through this section. This could involve using the VR controller to manipulate objects in the environment or solve physics-based puzzles.
5. The final obstacle is a group of heavily armed guards who are blocking your path to the surface. You have to find a way to take them out or sneak past them undetected. This could involve using the VR headset and controller to aim and shoot at the guards, or using stealth and evasion tactics to sneak past them.
6. As you make your way through the prison, you come across a locked door that requires you to solve a puzzle in order to open it. Using your VR headset&#39;s hand tracking, you have to manipulate objects in the environment and figure out the solution to the puzzle.
7. You come across a room filled with traps that are activated by sensors. You have to use your VR headset&#39;s motion tracking to duck and dodge the traps as you make your way through the room.
8. You come to a section of the prison where you have to use your VR headset&#39;s hand tracking to climb and crawl through tight spaces. This requires a combination of physical dexterity and problem-solving skills.
9. The final obstacle is a group of heavily armed guards who are blocking your path to the surface. You have to use your VR headset&#39;s motion tracking to take them out or sneak past them undetected.




</tw-passagedata><tw-passagedata pid="15" name="A2-S02" tags="Timeframe_Early" position="900,725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 02]
MUFFINVILLE]
&lt;img src=&quot;https://i.imgur.com/JcgxraM.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/d26vakp.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: You don&#39;t have a gun here.)]
You are with Hector and Cain in Muffinville in the aftermath of the massacre. The town has been retaken by Sacred Knights fighters, a subgroup of the Muffin Resistance. Hector learns of the fate of his family and meditates. Cain learns of his mother’s death and vows revenge. He is already well known by several members of the Sacred Knights and immediately joins. The group already has plans for reprisal attacks against Donuts.


&lt;img src=&quot;https://i.imgur.com/ZyWGI7c.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: This should look slightly bombed.)]
You follow Cain and the Sacred Knights to a sanctuary (a quasi religious building where muffins meditate and study the Sacred Texts).


&lt;img src=&quot;https://i.imgur.com/49zmO2n.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Debris should be on the pulpit.)]
It has been desecrated. A Sacred Knights soldier pushes the podium off of the pulpit.  Under the podium, there is a thematically appropriate quote from their Sacred Texts carved into the floorboard. Cain recites it before removing the floorboard uncovering a hidden weapons cache.


&lt;img src=&quot;https://i.imgur.com/ohx9l9G.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE:  The podium has been pushed off the pulpit revealing a floorboard that has been removed which has weapons under it.)]
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S03]]]


MUFFIN RESISTANCE FLAG WILL FIRST APPEAR IN THIS SCENE. IMAGE IS TBD.
(b4r:&quot;double&quot;,&quot;none&quot;,&quot;none&quot;)+(b4r-colour:white)[&lt;img src=&quot;https://i.imgur.com/8ZRYf6b.png&quot; class=&quot;fitHalf&quot;&gt;]
|parenthetical&gt;[(Sacred Knights Flag (not final version))]



NOTES:
- You follow Cain and the Sacred Knights to a sanctuary (a quasi religious building where muffins meditate and study the Sacred Texts). It has been desecrated but there is a thematically appropriate quote from their Sacred Texts carved in some ruble on the ground. Cain sweeps it aside to uncover a hidden weapons cache.

- some dialogue...
CAIN: What has become of my mother?
SK FIGHTER 1:  I&#39;m sorry Cain. The Donuts left no one.
SK FIGHTER 2: May she be remembered.
SK FIGHTER 1:  When we found your mother. She was clutching this. Even in the face of death, she was still thinking about you. She always cared for other before herself.
	Cain takes his bandana and wears it.
SK FIGHTER 2: How could they? To destroy something so beautiful.
SK FIGHTER 3: Have you never opened your eyes. That&#39;s what they do. The donuts destroy everything that is beautiful.
SK FIGHTER 2: Yes, but to this extent?
CAIN: Their evil knows no bounds. I&#39;d advise you learn that sooner than later. Show me the Sanctuary.
SK FIGHTER 1: Of course. Follow this way.






SCRIPT DRAFT:


	You are in the middle of a battle with muffin resistance fighters trying to retake Muffinville from enemy donuts. Sacred Knights fighters are the lead element with Winston in charge.

	After the first wave of Muffins is cut down, Winston prepares the resistance fighters for a second wave.



Our first wave has been cut down, sir Winston. Everyone is dead.


That was dreadful.


That was a test. Now we know how the Donuts will react. Prepare a second wave.



To hell with your second wave. If you want to waste more men, waste more of yours, not mine.


You&#39;re forgetting that I&#39;m the one in charge, and that you&#39;re the one who agreed to help us retake Muffinville.


Yes, but not by needlessly sacrificing good men.


It&#39;s not needless.
The second wave will attack as a diversion, while my men of the Sacred Knights will flank the enemy.


How about you be the diversion?


Don&#39;t make me laugh.
The men of the Sacred Knights are far more valuable than your inferior Muffin resistance partisans.
Now prepare your men.


No. I refuse.



	Winston pulls out his pistol and shoots the muffin resistance commander.


Does anyone else refuse?


This war has no room for cowards. On my whistle, you will go over the top and charge the enemy trenches.
If you don&#39;t already have a weapon, you can scavenge one from a dead comrade.
If you take one step back, you&#39;ll be shot for cowardice.



You there. I&#39;ve never seen you before, but you&#39;re part of the second wave. Understand?
Do you understand?



- YES: Good.
- NO: That means you&#39;ll be going over the top while my men flank around.


Second wave ready?!


	Winston blows his whistle, and other whistles also blow down the line.


Go, go, go!
Move!
Over the top, men!
Not one step back!


	The second wave charges the donut enemy. Some of the muffins will run back and get shot by their own side. If you run back, you will also be shot by your own side. You have to move forward and pick up a rifle and attack the enemy trench.

	You charge the enemy and take the trench. Most of the Muffins you charge with are killed. The Sacred Knights flank into the trench and consolidate the capture.


They&#39;re retreating.


Don&#39;t let them get away. Kill as many as you can.


	You finish off the remaining enemy donuts. An SK comes up to Winston.


Sir Winston! You&#39;ll never believe it. Cain and Hector. They have returned.


Impossible! They are imprisoned at Drejnon. There&#39;s no way they escaped from those dungeons.


	Comotion can be heard and everyone goes to see whats happening. A crowd has gathered around Cain and Hector.


Move it. Move out of my way! I don&#39;t believe it. How?


	Cain motions to his mouth needing water.


Get them some water.

Get some water for nutmeg&#39;s sake.


	They are given water.


We heard news that you were both imprisoned at Drejnon. Was that not true?


It was true, but we were able to escape. We wouldn&#39;t have made it without Anderson&#39;s help.


Anderson? Who&#39;s Anderson?


Hector is refering to the Prisioner that is with you. We all escaped together, though it would seem he made it here first somehow.


Tell us what happened here.


Yes, tell us. Did you kill all the Donut invaders?


Have you found any Muffin survivers?





I&#39;m sorry Hector. The Donuts left no one alive. At your home, we found your wife bravely sheilding your children, but it was to no avail. We have already cremated the dead, so that we may remember them for how they lived, and not how they died.



May they be remembered.


	Hector walks away towards his home.


Hector!


Let him be. He needs time to meditate upon his loss.


The Donuts truly have no limit to their evil. Attacking a village of harmless Muffin refugees fleeing war.


We killed as many flithy Donuts as we could, but at a heavy price.



CAIN: What has become of my mother?

SK FIGHTER 1: She fled to the Sanctuary in order to help Muffins seeking refugee from the Donut invaders. When we found your mother, she was clutching this. Even in the face of death, she was remembering you.


She always cared for others before herself. May she be remembered.


	Cain takes his bandana and wears it.
    
CAIN: May we remember all who have suffered at the wretched hands of Donuts. Show me to the Sanctuary.

SK FIGHTER 1: Of course. Follow this way.
We fought relentlessly to liberate Muffinville, but it was a hard fought battle. The Donut defenses were heavily fortified.


Why would they fortifiy this position? It has no tactical advantage.


I don&#39;t know, sir.


You say your losses are heavy?


Yes sir. Mostly volunteer partisan units from the Muffin Resistance. Although we also lost too many brave Sacred Knights from our ranks. May they be remembered. The Donuts took far fewer casualties than we.


Perhaps that&#39;s why they held on to this village so feircely. This is becoming a war of attrician. The Donuts are attempting to thin out our numbers by forcing us to attack their fortified positions. It is far more costly to defend than it is to attack.


So our liberation Muffinville is what the Donuts wanted?



Is there any other explanation?



	You all reach the sanctuary.



This is what&#39;s left of the sanctuary. The Donuts deliberately desicrate everything we Muffins hold Sacred. This is the only copy of our Sacred Scripture that we found intact.



	Cain takes the scripture to the pulpit and reads.


In chapter 22 of our Sacred Scripture, we Muffins are told:
&quot;Permission to fight has been given to those who are being fought, because they were wronged. They are those who have been evicted from their homes without right.&quot;
For a great many of us Muffins, all we have known is eviction. The Donut invasion came from the east, expanding into our sacred Muffin lands, forcing us all westward. But the Donuts were not content with merely evicting us from our rightful homes. They continued their greed-ridden invasion. Expanding further into our lands. Killing countless Muffins and driving us to seek new refuge again and again and again.
But Muffins have woken up. We would begin to realize that this Donut expansion would never cease until we put an end to it. Small pockets of Muffin resistance arose to fight the Donut invaders. Most resistance groups where ineffective, to say the least. Easily swept aside by the Donut invaders. Some had better luck, able to successfully defend Muffin outposts against further agression. But there was only one Muffin resistance group bold enough to take the fight to the enemy. One group that made the Donuts feel our pain. That group is us, the Sacred Kights. We are the protectors of all that Muffins hold sacred. Our tactics have proven superior. Wherever we operate, the enemy is slow, apprehensive, and vulnerable. Wherever we are absent, the enemy does this...
Some Muffins have proposed we seek peace with our Donut oppressors. Look around. Was there any threat from this peaceful village of Muffins? This is what happens when you abandon the means to defend yourself. This is what happens when you show weakness. This is what happens when you &quot;seek peace&quot;.
It is in these times we must adhere strictly to our Sacred Scripture, for it is the absolute authority in all matters. And our scripture is very clear:
&quot;If they do not withdraw from you or offer you peace or restrain their hands, then seize them and kill them wherever you overtake them. And those - We have made for you against them a clear authorization.&quot;
It is time we strike back!


	Cain pushes the pulpit off the edge, revealing a large weapons cache under the stage.


Sir Winston.


Yes, sir Cain?


Send word to the other comanders of the Sacred Knights. Inform them all that I have returned, and that I will accept their proposal.


But we have already appointed sir Quinton as head of the Sacred Knights.


Sir Quinton is too timid. He will stand down, or I will make him stand down.


Understood sir.


And one more thing. Have them prepare an assault force. We cannot leave this escalation by Donuts unanswered.




















</tw-passagedata><tw-passagedata pid="16" name="A2-S03" tags="Timeframe_Early" position="900,850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 03]
MUFFIN RESISTANCE OUTPOST]

NOTE: General Grimmer is mentioned here on the radio.

You start off spawning on a few muffin soldiers listening to the radio. It’s a Muffin station that is describing the Muffinville massacre followed by a soundbite from Gorg and other Donut officials justifying it.


&lt;img src=&quot;https://i.imgur.com/4kqpKEH.jpg&quot; class=&quot;fitHalf&quot;&gt;
Then there is commotion about Hector arriving. Muffins gather around. Hector ask how some of them are doing and their families. Most muffins have suffered but they are uplifted by Hector. Captain James cuts through the crowd and extracts Hector. Hector notices you and explains to James how you helped them escape. You follow along. James admits that he needs help. Hector is initially reluctant to join the resistance because he is against war. But he agrees to help with the logistics side. Hector joins the resistance.
There is discussion about what is needed. It is decided that trucks are needed. A mission to capture trucks from donuts is drafted. James asks you if you want to volunteer for the mission to steal trucks since they need all the help they can get.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S04]]]


NOTES:
- Because of your reputation in the prison escape, James immediately admits you into the Resistance.





















|act&gt;[ACT 2 - SCENE 03 – MUFFIN REFUGEE CAMP / RESISTANCE OUTPOST]

|action&gt;[You arrive at a busy refugee camp, where displaced Muffins struggle to survive under dire conditions. You may stay near the radio broadcast playing in the camp’s center or wander off to different clusters of refugees having conversations.]

&lt;tw-hook name=&quot;branch-a&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Radio Segment (Branch-Specific Prison Break Intro) &amp; Bystander Banter&lt;/summary&gt;

  |action&gt;[You remain at the central area where the radio is playing.]

  &lt;tw-hook name=&quot;branch-b&quot;&gt;&lt;details&gt;
    &lt;summary&gt;BRANCH A (Prison Riot)&lt;/summary&gt;
    |name&gt;[MUFFIN RADIO HOST - MALE]
    |dialogue&gt;[It’s been one week since the Donut’s heavily fortified Drejnon Prison descended into a riot, allowing three prisoners—Hector, Cain, and a mysterious third prisoner—to escape.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  &lt;tw-hook name=&quot;branch-c&quot;&gt;&lt;details&gt;
    &lt;summary&gt;BRANCH B (Quiet Escape)&lt;/summary&gt;
    |name&gt;[MUFFIN RADIO HOST - MALE]
    |dialogue&gt;[It’s been one week since the Donut’s heavily fortified Drejnon Prison was quietly compromised, allowing three prisoners—Hector, Cain, and a mysterious third prisoner—to evade Donut security and escape.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[Donut officials are reluctant to release details of this incident, no doubt worried about revealing embarrassing lapses in their security systems—once thought to be impenetrable—only to shatter the illusion of the supposed supremacy of Donuts. The trio of prison escapees were first discovered following the recent liberation of Muffinville, spearheaded by the Sacred Knights division of the Muffin Resistance.
In a press release, the Muffin Resistance confirmed that after a hard-fought battle, they successfully drove out the Donut Defense Legion, only to uncover a horrendous massacre of defenseless Muffin refugees. Women, children, and the elderly were all shown no mercy by the invading Donuts. When pressed for comment regarding these war crimes against Muffins, Commander Gorg of the Donut Defense Legion had this to say…]

  |name&gt;[DONUT JOURNALIST]
  |dialogue&gt;[What do you have to say about claims that the Donut Defense Legion massacred civilians in Muffinville?]

  |name&gt;[COMMANDER GORG]
  |dialogue&gt;[That area you call Muffinville was designated a Free Fire Zone due to enemy activity. That means there were no civilians in that area. If there were, they should have left when we gave them the warning. And why are we giving them warnings anyway? What other army tells their enemy where they’re going to attack before they attack? We’re being too nice to these muffins, if you ask me.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[In response to the Muffinville Massacre, the Sacred Knights launched an offensive on a nearby Donut settlement. Despite being just a few hours into the offensive, the Donut propaganda machine is hard at work spinning up countless stories of alleged atrocities committed by Muffins. Even General Grimmer, the Supreme General of the Donut Defense Legion, chimed in.]

  |name&gt;[GENERAL GRIMMER]
  |dialogue&gt;[You can see dead bodies from this hilltop overlooking the settlement. It’s very clear this was a savage attack deliberately targeting innocent Donuts. Currently, we are in the process of clearing out this settlement of all Muffin savages. Then we will thoroughly document the evidence of war crimes committed by Muffins here today.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[Let’s turn to our correspondent, Francesca. It seems to me that every time the Donuts accuse Muffins of one atrocity or another, it’s conveniently something they have committed themselves.]

  |name&gt;[FRANCESCA]
  |dialogue&gt;[That’s exactly right. Every accusation is an admission by these Donuts. They’re the ones who have systematically brutalized and oppressed Muffins. Blame shifting is a common propagandistic tactic they use whenever they are the ones guilty of heinous war crimes.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[There&#39;s a lot of this whataboutism amongst the Donuts. I myself have noticed anytime you mention a verified atrocity to a Donut, they immediately deflect to some unsubstantiated rumor about something Muffins have allegedly done.]

  |name&gt;[FRANCESCA]
  |dialogue&gt;[Exactly. Donuts are deceptive by nature, even against themselves. Prior to Donuts invading our territory, you must remember that Donuts fought a brutal civil war. Ring Donuts and Filled Donuts accused Bar Donuts and Twist Donuts of all sorts of despicable atrocities, and vice versa. And don’t even get me started on how all of those donuts briefly teamed up to crush the Donut Holes, before resuming their civil war.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[Well, knowing the track record of Donuts, we can assume many of those alleged inter-Donut atrocities are true.]

  |name&gt;[FRANCESCA]
  |dialogue&gt;[Yes, probably most of them are true, but my point is that Donuts will deny every evil deed they commit while fabricating fantastical stories about their enemies. And that’s exactly what we see them doing here with these new allegations against the Sacred Knights of the Muffin Resistance. Baseless slander is just one of their many tactics Donuts use in war.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[Baseless slander indeed. I couldn’t have put it better myself. Thank you, News 24 Correspondent Francesca. We’ll be back after a short break.]

  |action&gt;[Music briefly plays before the radio is switched off.]

  |action&gt;[Nearby, two muffin bystanders discuss the news.]

  |name&gt;[MUFFIN BYSTANDER #1 - MALE]
  |dialogue&gt;[Can you believe the gall of these Donuts? Accusing Muffins of the very crimes they just committed against us?]

  |name&gt;[MUFFIN BYSTANDER #2 - MALE]
  |dialogue&gt;[I believe it. I used to live in Donut lands before the war, in the Arc Lands region.]

  |name&gt;[MUFFIN BYSTANDER #1 - MALE]
  |dialogue&gt;[Let me guess, Sprinkle City?]

  |name&gt;[MUFFIN BYSTANDER #2 - MALE]
  |dialogue&gt;[No, I lived in Dough Town, believe it or not.]

  |name&gt;[MUFFIN BYSTANDER #1 - MALE]
  |dialogue&gt;[In Dough Town? With the donut holes?]

  |name&gt;[MUFFIN BYSTANDER #2 - MALE]
  |dialogue&gt;[Aye. I witnessed the self-righteous indignation of Donut Society against donut holes. I thought to myself, if that’s how Donuts treat their own kin, there is no reason they would treat us Muffins any more kindly.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-d&quot;&gt;&lt;details&gt;
  &lt;summary&gt;CAMP CONVERSATION #7 (Food Shortage)&lt;/summary&gt;

  |action&gt;[Early in the scene, shortly after the radio broadcast. Near the food distribution station, refugees are lined up impatiently.]

  |name&gt;[ADULT MUFFIN REFUGEE - FEMALE]
  |dialogue&gt;[They’ve cut our rations again. It’s down to two sugar cubes per day. How do they expect us to survive off this?]

  |name&gt;[ELDERLY MUFFIN REFUGEE - MALE]
  |dialogue&gt;[Two sugar cubes? Consider yourself lucky. They always run out when it’s my turn to collect rations.]

  |name&gt;[ADULT MUFFIN REFUGEE - FEMALE]
  |dialogue&gt;[I heard the Muffin Resistance soldiers are hogging most of the food for themselves. That’s why we’re running out.]

  |name&gt;[ELDERLY MUFFIN REFUGEE - MALE]
  |dialogue&gt;[They need their strength. Who will protect us from the Donuts, if not them?]

  |name&gt;[ADULT MUFFIN REFUGEE - FEMALE]
  |dialogue&gt;[At this rate, we’ll starve long before the Donuts ever come to us.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-e&quot;&gt;&lt;details&gt;
  &lt;summary&gt;CAMP CONVERSATION #8 (Crowded Living Conditions)&lt;/summary&gt;

  |action&gt;[Middle of the scene, near a crowded cluster of makeshift tents. Refugees huddle around small fires as evening approaches.]

  |name&gt;[YOUNG MUFFIN - FEMALE]
  |dialogue&gt;[Mum, do we really have to sleep outside again tonight?]

  |name&gt;[MOTHER MUFFIN - FEMALE]
  |dialogue&gt;[I’m afraid so, love. They’ve run out of room in the tents.]

  |name&gt;[YOUNG MUFFIN - FEMALE]
  |dialogue&gt;[But it’s so cold. Can’t we squeeze in somewhere?]

  |name&gt;[MOTHER MUFFIN - FEMALE]
  |dialogue&gt;[We’ll stay close to the fire, love. It’ll be alright.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-f&quot;&gt;&lt;details&gt;
  &lt;summary&gt;CAMP CONVERSATION #9 (Rumours &amp; Doubts about Hector)&lt;/summary&gt;

  |action&gt;[Middle-to-late in the scene, near the camp’s central gathering area, refugees casually chatting as they await news.]

  |name&gt;[MUFFIN REFUGEE #1 - MALE]
  |dialogue&gt;[Hector’s coming here, you know. They found him alive at Muffinville last week.]

  |name&gt;[MUFFIN REFUGEE #2 - MALE]
  |dialogue&gt;[Yeah, so they say. But has anyone actually seen him since then?]

  |name&gt;[MUFFIN REFUGEE #1 - MALE]
  |dialogue&gt;[Plenty have. They’ve been talking about it on the radio nonstop.]

  |name&gt;[MUFFIN REFUGEE #2 - MALE]
  |dialogue&gt;[And you trust what you hear on the radio?]

  |name&gt;[MUFFIN REFUGEE #1 - MALE]
  |dialogue&gt;[You’re impossible. Just you wait—he’ll turn up.]

  |name&gt;[MUFFIN REFUGEE #2 - MALE]
  |dialogue&gt;[Right. I’ll believe it when I see him with my own two eyes.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-g&quot;&gt;&lt;details&gt;
  &lt;summary&gt;CAMP CONVERSATION #10 (Resistance Leadership Counting Refugees)&lt;/summary&gt;

  |action&gt;[Late in the scene, just moments before Hector’s arrival. Outside Resistance Headquarters, a MUFFIN RESISTANCE MARSHAL - FEMALE and a MUFFIN RESISTANCE SOLDIER - MALE discuss urgently.]

  |name&gt;[MUFFIN RESISTANCE MARSHAL - FEMALE]
  |dialogue&gt;[Captain James wants an accurate headcount of today’s arrivals. Have you got the final numbers?]

  |name&gt;[MUFFIN RESISTANCE SOLDIER - MALE]
  |dialogue&gt;[The numbers keep increasing. We had more come in from the south road this afternoon.]

  |name&gt;[MUFFIN RESISTANCE MARSHAL - FEMALE]
  |dialogue&gt;[Give me your best estimate, then. We’re barely keeping everyone fed as it is.]

  |name&gt;[MUFFIN RESISTANCE SOLDIER - MALE]
  |dialogue&gt;[At least eight dozen new refugees today alone.]

  |name&gt;[MUFFIN RESISTANCE MARSHAL - FEMALE]
  |dialogue&gt;[Eight dozen?!]

  |name&gt;[MUFFIN RESISTANCE SOLDIER - MALE]
  |dialogue&gt;[Probably more—we’re still processing them.]

  |name&gt;[MUFFIN RESISTANCE MARSHAL - FEMALE]
  |dialogue&gt;[Alright. But hurry—the Captain wants those numbers and I can’t stall him much longer.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[Suddenly, a stir ripples through the camp. You hear scattered voices reacting to an unexpected arrival.]

|name&gt;[MUFFIN BYSTANDER #1 - MALE]
|dialogue&gt;[Did someone say Hector is here?]

|name&gt;[MUFFIN BYSTANDER #2 - MALE]
|dialogue&gt;[Hector?]

|action&gt;[A crowd of Muffin refugees quickly gathers around Hector, who appears exhausted but determined. The Player pushes through the crowd.]

|name&gt;[CROWD OF MUFFIN BYSTANDERS]
|dialogue&gt;[He’s alive! Is it really Hector? It can’t be him. There’s no way he’s alive. By all that is Sacred. It’s really him! Hector! Thank you, Hector!]

|name&gt;[MUFFIN BYSTANDER #3 - MALE]
|dialogue&gt;[Hector! Hector, I’m so sorry. I’m so sorry I couldn’t save your family. I tried, but the Donuts were coming, and I had to get my family out, and there was no time. And…]

|name&gt;[HECTOR]
|dialogue&gt;[You did what you must to protect those closest to you. That is your duty. There is no blame on you for that.
(He forces a faint smile.)
I’m glad your family is safe.]

|name&gt;[MUFFIN BYSTANDER CROWD]
|dialogue&gt;[Can you help us, Hector? Yes, help us, please. Please help us.]

|action&gt;[CAPTAIN JAMES enters, pushing his way through the crowd to reach Hector.]

|name&gt;[JAMES]
|dialogue&gt;[Move it. Make way. Make way.
Hector, by the great ovens, I thought you were lost.]

|name&gt;[HECTOR]
|dialogue&gt;[It’s good to see you in one piece, James.]

|name&gt;[JAMES]
|dialogue&gt;[It’s Captain James, remember.]

|name&gt;[HECTOR]
|dialogue&gt;[You’ll always be James to me.]

|name&gt;[JAMES]
|dialogue&gt;[Not if I finally get you to join the Resistance. Then you’ll have to start referring to me as Captain. Haha!
When word spread of your escape from Drejnon Prison, I just couldn’t believe it. How did you and Cain manage to pull off such a feat?]

|name&gt;[HECTOR]
|dialogue&gt;[We could not have done it without help from a new friend. His name is Anderson.
Come here, Anderson.
Anderson, come closer.
Please, come closer.]

|action&gt;[Hector and James shift their attention to you, the Player.]

|name&gt;[JAMES]
|dialogue&gt;[Anderson... So you’re that mysterious third prisoner. The one that’s been causing such a commotion. Hmm. You don’t look like you’re a muffin, are you one of us?
Are you some sort of Muffin?
Are you a Muffin, Anderson?
Are you some type of Muffin?]

&lt;tw-hook name=&quot;branch-a&quot;&gt;&lt;details&gt;
  &lt;summary&gt;If Player responds Yes&lt;/summary&gt;
  |name&gt;[JAMES]
  |dialogue&gt;[Well, you are one strange-looking muffin, indeed.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-b&quot;&gt;&lt;details&gt;
  &lt;summary&gt;If Player responds No&lt;/summary&gt;
  |name&gt;[JAMES]
  |dialogue&gt;[That explains a lot. Well, as long as you’re not a donut, you’re alright in my book.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[JAMES]
|dialogue&gt;[Follow me, the both of you.]

|action&gt;[You and Hector follow James into a nearby building, heading upstairs toward the Resistance Headquarters.]

|name&gt;[JAMES]
|dialogue&gt;[Clear the way, please.
I apologize for the crowd. I’m not used to juggling such a big influx of refugees. It’s really interfering with our resistance operations, as a matter of fact.
Up the stairs.]

|action&gt;[Inside the makeshift command center, the conversation below is underway. We replace it with the lines you provided (no quotes).]

|name&gt;[MARCUS]
|dialogue&gt;[Our scouts issued a new report. The Donuts are massing additional forces near this outpost, just beyond the hill.]

|name&gt;[CAMBERRY]
|dialogue&gt;[They won’t attack Yeasthaven—not yet. They’re just testing us.]

|name&gt;[MARCUS]
|dialogue&gt;[That&#39;s what many thought of Whiskwind. We barely held that outpost against the Donuts. If Yeasthaven falls, that will severely compromise the entire front.]

|name&gt;[CAMBERRY]
|dialogue&gt;[Then we must reinforce this outpost. Pull reserves from Crustwatch.]

|name&gt;[MARCUS]
|dialogue&gt;[We’ve already pulled every available fighter from Crustwatch. That outpost is barely holding together as it is.]

|name&gt;[CAMBERRY]
|dialogue&gt;[What of Oven’s Reach? They still have troops to spare.]

|name&gt;[MARCUS]
|dialogue&gt;[Not a chance. The city of Cinnacrest will never allow Oven’s Reach to be weak. That outpost is too vital to their line of defense on the northern flank.]

|name&gt;[CAMBERRY]
|dialogue&gt;[Hmm... What about the Sacred Knights?]

|name&gt;[MARCUS]
|dialogue&gt;[The Sacred Knights? For defense... Are you kidding?]

|name&gt;[CAMBERRY]
|dialogue&gt;[I understand defense is not their forte, but we do already have the Sacred Knights actively protecting a small Muffin village in the valley. As a temporary measure, of course.]

|name&gt;[MARCUS]
|dialogue&gt;[I&#39;m sorry, was their &quot;defensive&quot; operation against that donut settlement vital to the protection of this village? I had to find out about it from the bloody radio.]

|name&gt;[CAMBERRY]
|dialogue&gt;[All of us found out from the radio. You know the Sacred Knights—they’re tougher than cookies, but impossible to control. The reality is we need them. We need their help to confront the growing donut military presence in this region.]

|name&gt;[MARCUS]
|dialogue&gt;[Well, I can tell you one thing. We better deal with this refugee problem soon, before the Sacred Knights arrive.]

|action&gt;[JAMES interrupts the discussion, leading Hector and the Player inside.]

|name&gt;[JAMES]
|dialogue&gt;[Sorry to interrupt, gentlemen. I brought some special guests.]

|name&gt;[MUFFIN RESISTANCE LEADERS]
|dialogue&gt;[Here, here, Hector. Tally-ho. Welcome in.]

|action&gt;[Inside a makeshift command center, MARCUS, CAMBERRY, and a few other Muffin Resistance members stand around a table.]

|name&gt;[JAMES]
|dialogue&gt;[This is the Muffin Resistance headquarters... temporary headquarters. We move around a lot.]

|name&gt;[HECTOR]
|dialogue&gt;[Why have you brought me here, James? We’ve spoken about this before. There’s nothing I can do to help in this fight.]

|name&gt;[MARCUS]
|dialogue&gt;[I don&#39;t understand you, Hector. Even after all that the Donuts have done to you and your family, you still wouldn’t help the Resistance fight against the Donuts?!]

|name&gt;[JAMES]
|dialogue&gt;[Lieutenant Marcus.]

|name&gt;[MARCUS]
|dialogue&gt;[Sorry, Captain.]

|name&gt;[JAMES]
|dialogue&gt;[Helping doesn’t always mean fighting.
Look around this room, Hector. We have intelligent captains and marshalls commanding divisions. We have brave lieutenants leading our fighters. And trust me, we have no shortage of enraged muffin men, ready and willing to strike back at the enemy.
But you know what we don’t have? We don’t have the wherewithal to look after our own muffin kin. The refugee problem is not just here. It’s in every resistance outpost all along the front, and even in outposts well behind the frontlines. The only refugees capable of making the arduous march inward to safer Muffin lands are the strong and able-bodied Muffins. That leaves us stranded with the weak, the infirm, the children. It’s stretching all our supplies thinly. Especially our food supplies, which must be rationed to our soldiers first. I’m sure you can imagine the stress that causes around here.
We don’t need your help fighting, Hector. Everyone wants to fight. But no one wants to have to deal with… with all this.]

|action&gt;[HECTOR closes his eyes, appearing to meditate or think deeply. JAMES and the others fall silent momentarily.]

|name&gt;[CAMBERRY]
|dialogue&gt;[What is he doing?]

|name&gt;[MARCUS]
|dialogue&gt;[He’s meditating, obviously.]

|name&gt;[CAMBERRY]
|dialogue&gt;[Oh, he’s one of those muffins.]

|name&gt;[JAMES]
|dialogue&gt;[Shh. Have some respect. Let him focus.]

|name&gt;[HECTOR]
|dialogue&gt;[How do you deliver supplies to the front?]

|name&gt;[JAMES]
|dialogue&gt;[Supplies to the front?]

|name&gt;[HECTOR]
|dialogue&gt;[Yes, how do you deliver supplies to outposts like this one?]

|name&gt;[JAMES]
|dialogue&gt;[Sorry, I thought you were about to grace us with some Sacred Scripture wisdom. We deliver mostly by courier. On foot.]

|name&gt;[HECTOR]
|dialogue&gt;[No trucks?]

|name&gt;[JAMES]
|dialogue&gt;[We do have a few trucks, but not enough to make a difference.]

|name&gt;[CAMBERRY]
|dialogue&gt;[It’s not our fault. The factories in Blueberry Bulge don’t output enough trucks. You know how those muffins are in Blueberry Bulge. They always take their time making everything nice and neat. A luxury only the furthest city from the front could afford, no doubt.]

|name&gt;[HECTOR]
|dialogue&gt;[What about trucks from donuts? Surely you’ve captured a few of those?]

|name&gt;[JAMES]
|dialogue&gt;[No, we usually blow those up.]

|name&gt;[MARCUS]
|dialogue&gt;[That’s what I’ve been telling you all. Why blow up the donut trucks when we can use them ourselves? I often see them during our operations. Dozens of trucks just sitting there, ripe for the taking.]

|name&gt;[CAMBERRY]
|dialogue&gt;[How are you planning to steal these trucks? Do you think the donuts are just going to let you sneak onto their compound, hop into a few trucks, and drive off into the sunset?]

|name&gt;[MARCUS]
|dialogue&gt;[It’s a little more complicated than that, but more or less.]

|name&gt;[CAMBERRY]
|dialogue&gt;[I don’t think that will work at all. It’s too risky. There must be some other way to deal with this refugee problem.]

|name&gt;[HECTOR]
|dialogue&gt;[I often hear refugees described as a problem, but let&#39;s not forget that they are the reason you all are fighting this war. To protect them and to give them a chance at a better life.
I’m not keen on risk assessment of military affairs. But if we don’t get more means of transport, the muffins here and everywhere will continue to suffer.]

|name&gt;[JAMES]
|dialogue&gt;[Hector is right. We need trucks, and the donuts have plenty of them. It’s risky, but let&#39;s see if we can&#39;t take a few off their hands.]

|name&gt;[MARCUS]
|dialogue&gt;[I can do it, Captain. I can take a team of my men and infiltrate a nearby donut compound. I know of one which houses a few trucks.]

|name&gt;[CAMBERRY]
|dialogue&gt;[Let’s think this through for a second. Even if we have more trucks, we still won&#39;t be able to send muffin refugees to the rear. Whenever we’ve sent muffin refugees in trucks to the rear, half the time those sons of biscuits send them right back to us. No one wants to take in any more refugees.]

|name&gt;[JAMES]
|dialogue&gt;[That’s where Hector comes in. Hector can convince them to take in more refugees.]

|name&gt;[HECTOR]
|dialogue&gt;[I can’t convince anyone of anything. The most I can do is understand why they’re refusing refugees and see if we can find a solution that works for all of us.]

|name&gt;[JAMES]
|dialogue&gt;[See what I mean? Now I’m convinced we should take more refugees. Hector, you go on the next truck back to the rear outposts and work your mind tricks. Anderson, you will help Lt. Marcus infiltrate the Donut military compound and capture those trucks. And to the both of you… welcome to the Resistance.]

|action&gt;[END OF SCENE (Up to this point.)]

























SCRIPT DRAFT:

|act&gt;[ACT 2 - SCENE 03 – MUFFIN REFUGEE CAMP / RESISTANCE OUTPOST]

|action&gt;[You arrive at a busy refugee camp, where displaced Muffins struggle to survive under dire conditions. You may stay near the radio broadcast playing in the camp’s center or wander off to different clusters of refugees having conversations.]

&lt;tw-hook name=&quot;branch-a&quot;&gt;&lt;details&gt;
  &lt;summary&gt;Radio Segment (Branch-Specific Prison Break Intro) &amp; Bystander Banter&lt;/summary&gt;

  |action&gt;[You remain at the central area where the radio is playing.]

  &lt;tw-hook name=&quot;branch-b&quot;&gt;&lt;details&gt;
    &lt;summary&gt;BRANCH A (Prison Riot)&lt;/summary&gt;
    |name&gt;[MUFFIN RADIO HOST - MALE]
    |dialogue&gt;[It’s been one week since the Donut’s heavily fortified Drejnon Prison descended into a riot, allowing three prisoners—Hector, Cain, and a mysterious third prisoner—to escape.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  &lt;tw-hook name=&quot;branch-c&quot;&gt;&lt;details&gt;
    &lt;summary&gt;BRANCH B (Quiet Escape)&lt;/summary&gt;
    |name&gt;[MUFFIN RADIO HOST - MALE]
    |dialogue&gt;[It’s been one week since the Donut’s heavily fortified Drejnon Prison was quietly compromised, allowing three prisoners—Hector, Cain, and a mysterious third prisoner—to evade Donut security and escape.]
  &lt;/details&gt;&lt;/tw-hook&gt;

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[Donut officials are reluctant to release details of this incident, no doubt worried about revealing embarrassing lapses in their security systems—once thought to be impenetrable—only to shatter the illusion of the supposed supremacy of Donuts. The trio of prison escapees were first discovered following the recent liberation of Muffinville, spearheaded by the Sacred Knights division of the Muffin Resistance.
In a press release, the Muffin Resistance confirmed that after a hard-fought battle, they successfully drove out the Donut Defense Legion, only to uncover a horrendous massacre of defenseless Muffin refugees. Women, children, and the elderly were all shown no mercy by the invading Donuts. When pressed for comment regarding these war crimes against Muffins, Commander Gorg of the Donut Defense Legion had this to say…]

  |name&gt;[DONUT JOURNALIST]
  |dialogue&gt;[What do you have to say about claims that the Donut Defense Legion massacred civilians in Muffinville?]

  |name&gt;[COMMANDER GORG]
  |dialogue&gt;[That area you call Muffinville was designated a Free Fire Zone due to enemy activity. That means there were no civilians in that area. If there were, they should have left when we gave them the warning. And why are we giving them warnings anyway? What other army tells their enemy where they’re going to attack before they attack? We’re being too nice to these muffins, if you ask me.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[In response to the Muffinville Massacre, the Sacred Knights launched an offensive on a nearby Donut settlement. Despite being just a few hours into the offensive, the Donut propaganda machine is hard at work spinning up countless stories of alleged atrocities committed by Muffins. Even General Grimmer, the Supreme General of the Donut Defense Legion, chimed in.]

  |name&gt;[GENERAL GRIMMER]
  |dialogue&gt;[You can see dead bodies from this hilltop overlooking the settlement. It’s very clear this was a savage attack deliberately targeting innocent Donuts. Currently, we are in the process of clearing out this settlement of all Muffin savages. Then we will thoroughly document the evidence of war crimes committed by Muffins here today.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[Let’s turn to our correspondent, Francesca. It seems to me that every time the Donuts accuse Muffins of one atrocity or another, it’s conveniently something they have committed themselves.]

  |name&gt;[FRANCESCA]
  |dialogue&gt;[That’s exactly right. Every accusation is an admission by these Donuts. They’re the ones who have systematically brutalized and oppressed Muffins. Blame shifting is a common propagandistic tactic they use whenever they are the ones guilty of heinous war crimes.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[There&#39;s a lot of this whataboutism amongst the Donuts. I myself have noticed anytime you mention a verified atrocity to a Donut, they immediately deflect to some unsubstantiated rumor about something Muffins have allegedly done.]

  |name&gt;[FRANCESCA]
  |dialogue&gt;[Exactly. Donuts are deceptive by nature, even against themselves. Prior to Donuts invading our territory, you must remember that Donuts fought a brutal civil war. Ring Donuts and Filled Donuts accused Bar Donuts and Twist Donuts of all sorts of despicable atrocities, and vice versa. And don’t even get me started on how all of those donuts briefly teamed up to crush the Donut Holes, before resuming their civil war.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[Well, knowing the track record of Donuts, we can assume many of those alleged inter-Donut atrocities are true.]

  |name&gt;[FRANCESCA]
  |dialogue&gt;[Yes, probably most of them are true, but my point is that Donuts will deny every evil deed they commit while fabricating fantastical stories about their enemies. And that’s exactly what we see them doing here with these new allegations against the Sacred Knights of the Muffin Resistance. Baseless slander is just one of their many tactics Donuts use in war.]

  |name&gt;[MUFFIN RADIO HOST - MALE]
  |dialogue&gt;[Baseless slander indeed. I couldn’t have put it better myself. Thank you, News 24 Correspondent Francesca. We’ll be back after a short break.]

  |action&gt;[Music briefly plays before the radio is switched off.]

  |action&gt;[Nearby, two muffin bystanders discuss the news.]

  |name&gt;[MUFFIN BYSTANDER #1 - MALE]
  |dialogue&gt;[Can you believe the gall of these Donuts? Accusing Muffins of the very crimes they just committed against us?]

  |name&gt;[MUFFIN BYSTANDER #2 - MALE]
  |dialogue&gt;[I believe it. I used to live in Donut lands before the war, in the Arc Lands region.]

  |name&gt;[MUFFIN BYSTANDER #1 - MALE]
  |dialogue&gt;[Let me guess, Sprinkle City?]

  |name&gt;[MUFFIN BYSTANDER #2 - MALE]
  |dialogue&gt;[No, I lived in Dough Town, believe it or not.]

  |name&gt;[MUFFIN BYSTANDER #1 - MALE]
  |dialogue&gt;[In Dough Town? With the donut holes?]

  |name&gt;[MUFFIN BYSTANDER #2 - MALE]
  |dialogue&gt;[Aye. I witnessed the self righteous indignation of Donut Society against donut holes. I thought to myself, if that’s how Donuts treat their own kin, there is no reason they would treat us Muffins any more kindly.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-d&quot;&gt;&lt;details&gt;
  &lt;summary&gt;CAMP CONVERSATION #7 (Food Shortage)&lt;/summary&gt;

  |action&gt;[Early in the scene, shortly after the radio broadcast. Near the food distribution station, refugees are lined up impatiently.]

  |name&gt;[ADULT MUFFIN REFUGEE - FEMALE]
  |dialogue&gt;[They’ve cut our rations again. It’s down to two sugar cubes per day. How do they expect us to survive off this?]

  |name&gt;[ELDERLY MUFFIN REFUGEE - MALE]
  |dialogue&gt;[Two sugar cubes? Consider yourself lucky. They always run out when it’s my turn to collect rations.]

  |name&gt;[ADULT MUFFIN REFUGEE - FEMALE]
  |dialogue&gt;[I heard the Muffin Resistance soldiers are hogging most of the food for themselves. That’s why we’re running out.]

  |name&gt;[ELDERLY MUFFIN REFUGEE - MALE]
  |dialogue&gt;[They need their strength. Who will protect us from the Donuts, if not them?]

  |name&gt;[ADULT MUFFIN REFUGEE - FEMALE]
  |dialogue&gt;[At this rate, we’ll starve long before the Donuts ever come to us.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-e&quot;&gt;&lt;details&gt;
  &lt;summary&gt;CAMP CONVERSATION #8 (Crowded Living Conditions)&lt;/summary&gt;

  |action&gt;[Middle of the scene, near a crowded cluster of makeshift tents. Refugees huddle around small fires as evening approaches.]

  |name&gt;[YOUNG MUFFIN - FEMALE]
  |dialogue&gt;[Mum, do we really have to sleep outside again tonight?]

  |name&gt;[MOTHER MUFFIN - FEMALE]
  |dialogue&gt;[I’m afraid so, love. They’ve run out of room in the tents.]

  |name&gt;[YOUNG MUFFIN - FEMALE]
  |dialogue&gt;[But it’s so cold. Can’t we squeeze in somewhere?]

  |name&gt;[MOTHER MUFFIN - FEMALE]
  |dialogue&gt;[We’ll stay close to the fire, love. It’ll be alright.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-f&quot;&gt;&lt;details&gt;
  &lt;summary&gt;CAMP CONVERSATION #9 (Rumours &amp; Doubts about Hector)&lt;/summary&gt;

  |action&gt;[Middle-to-late in the scene, near the camp’s central gathering area, refugees casually chatting as they await news.]

  |name&gt;[MUFFIN REFUGEE #1 - MALE]
  |dialogue&gt;[Hector’s coming here, you know. They found him alive at Muffinville last week.]

  |name&gt;[MUFFIN REFUGEE #2 - MALE]
  |dialogue&gt;[Yeah, so they say. But has anyone actually seen him since then?]

  |name&gt;[MUFFIN REFUGEE #1 - MALE]
  |dialogue&gt;[Plenty have. They’ve been talking about it on the radio nonstop.]

  |name&gt;[MUFFIN REFUGEE #2 - MALE]
  |dialogue&gt;[And you trust what you hear on the radio?]

  |name&gt;[MUFFIN REFUGEE #1 - MALE]
  |dialogue&gt;[You’re impossible. Just you wait—he’ll turn up.]

  |name&gt;[MUFFIN REFUGEE #2 - MALE]
  |dialogue&gt;[Right. I’ll believe it when I see him with my own two eyes.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-g&quot;&gt;&lt;details&gt;
  &lt;summary&gt;CAMP CONVERSATION #10 (Resistance Leadership Counting Refugees)&lt;/summary&gt;

  |action&gt;[Late in the scene, just moments before Hector’s arrival. Outside Resistance Headquarters, a MUFFIN RESISTANCE MARSHAL - FEMALE and a MUFFIN RESISTANCE SOLDIER - MALE discuss urgently.]

  |name&gt;[MUFFIN RESISTANCE MARSHAL - FEMALE]
  |dialogue&gt;[Captain James wants an accurate headcount of today’s arrivals. Have you got the final numbers?]

  |name&gt;[MUFFIN RESISTANCE SOLDIER - MALE]
  |dialogue&gt;[The numbers keep increasing. We had more come in from the south road this afternoon.]

  |name&gt;[MUFFIN RESISTANCE MARSHAL - FEMALE]
  |dialogue&gt;[Give me your best estimate, then. We’re barely keeping everyone fed as it is.]

  |name&gt;[MUFFIN RESISTANCE SOLDIER - MALE]
  |dialogue&gt;[At least eight dozen new refugees today alone.]

  |name&gt;[MUFFIN RESISTANCE MARSHAL - FEMALE]
  |dialogue&gt;[Eight dozen?!]

  |name&gt;[MUFFIN RESISTANCE SOLDIER - MALE]
  |dialogue&gt;[Probably more—we’re still processing them.]

  |name&gt;[MUFFIN RESISTANCE MARSHAL - FEMALE]
  |dialogue&gt;[Alright. But hurry—the Captain wants those numbers and I can’t stall him much longer.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[Suddenly, a stir ripples through the camp. You hear scattered voices reacting to an unexpected arrival.]

|name&gt;[MUFFIN BYSTANDER #1 - MALE]
|dialogue&gt;[Did someone say Hector is here?]

|name&gt;[MUFFIN BYSTANDER #2 - MALE]
|dialogue&gt;[Hector?]

|action&gt;[A crowd of Muffin refugees quickly gathers around Hector, who appears exhausted but determined. The Player pushes through the crowd.]

|name&gt;[CROWD OF MUFFIN BYSTANDERS]
|dialogue&gt;[He’s alive! Is it really Hector? It can’t be him. There’s no way he’s alive. By all that is Sacred. It’s really him! Hector! Thank you, Hector!]

|name&gt;[MUFFIN BYSTANDER #3 - MALE]
|dialogue&gt;[Hector! Hector, I’m so sorry. I’m so sorry I couldn’t save your family. I tried, but the Donuts were coming, and I had to get my family out, and there was no time. And…]

|name&gt;[HECTOR]
|dialogue&gt;[You did what you must to protect those closest to you. That is your duty. There is no blame on you for that.
(He forces a faint smile.)
I’m glad your family is safe.]

|name&gt;[MUFFIN BYSTANDER CROWD]
|dialogue&gt;[Can you help us, Hector? Yes, help us, please. Please help us.]

|action&gt;[CAPTAIN JAMES enters, pushing his way through the crowd to reach Hector.]

|name&gt;[JAMES]
|dialogue&gt;[Move it. Make way. Make way.
Hector, by the great ovens, I thought you were lost.]

|name&gt;[HECTOR]
|dialogue&gt;[It’s good to see you in one piece, James.]

|name&gt;[JAMES]
|dialogue&gt;[It’s Captain James, remember.]

|name&gt;[HECTOR]
|dialogue&gt;[You’ll always be James to me.]

|name&gt;[JAMES]
|dialogue&gt;[Not if I finally get you to join the Resistance. Then you’ll have to start referring to me as Captain. Haha!
When word spread of your escape from Drejnon Prison, I just couldn’t believe it. How did you and Cain manage to pull off such a feat?]

|name&gt;[HECTOR]
|dialogue&gt;[We could not have done it without help from a new friend. His name is Anderson.
Come here, Anderson.
Anderson, come closer.
Please, come closer.]

|action&gt;[Hector and James shift their attention to you, the Player.]

|name&gt;[JAMES]
|dialogue&gt;[Anderson... So you’re that mysterious third prisoner. The one that’s been causing such a commotion. Hmm. You don’t look like you’re a muffin, are you one of us?
Are you some sort of Muffin?
Are you a Muffin, Anderson?
Are you some type of Muffin?]

&lt;tw-hook name=&quot;branch-a&quot;&gt;&lt;details&gt;
  &lt;summary&gt;If Player responds Yes&lt;/summary&gt;
  |name&gt;[JAMES]
  |dialogue&gt;[Well, you are one strange-looking muffin, indeed.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-b&quot;&gt;&lt;details&gt;
  &lt;summary&gt;If Player responds No&lt;/summary&gt;
  |name&gt;[JAMES]
  |dialogue&gt;[That explains a lot. Well, as long as you’re not a donut, you’re alright in my book.]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[JAMES]
|dialogue&gt;[Follow me, the both of you.]

|action&gt;[You and Hector follow James into a nearby building, heading upstairs toward the Resistance Headquarters.]

|name&gt;[JAMES]
|dialogue&gt;[Clear the way please.
I apologize for the crowd. I’m not used to juggling such a big influx of refugees. It’s really interfering with our resistance operations, as a matter of fact.
Up the stairs.]

|action&gt;[Inside the makeshift command center, the conversation below is underway. We replace it with the lines you provided (no quotes).]

|name&gt;[MARCUS]
|dialogue&gt;[Our scouts issued a new report. The Donuts are massing additional forces near this outpost, just beyond the hill.]

|name&gt;[CAMBERRY]
|dialogue&gt;[They won’t attack Yeasthaven—not yet. They’re just testing us.]

|name&gt;[MARCUS]
|dialogue&gt;[That&#39;s what many thought of Whiskwind. We barely held that outpost against the Donuts. If Yeasthaven falls, that will severely compromise the entire front.]

|name&gt;[CAMBERRY]
|dialogue&gt;[Then we must reinforce this outpost. Pull reserves from Crustwatch.]

|name&gt;[MARCUS]
|dialogue&gt;[We’ve already pulled every available fighter from Crustwatch. That outpost is barely holding together as it is.]

|name&gt;[CAMBERRY]
|dialogue&gt;[What of Oven’s Reach? They still have troops to spare.]

|name&gt;[MARCUS]
|dialogue&gt;[Not a chance. The city of Cinnacrest will never allow Oven’s Reach to be weak. That outpost is to vital to their line of defense on the northern flank.]

|name&gt;[CAMBERRY]
|dialogue&gt;[Hmm... What about the Sacred Knights?]

|name&gt;[MARCUS]
|dialogue&gt;[The Sacred Knights? For defense... Are you kidding?]

|name&gt;[CAMBERRY]
|dialogue&gt;[I understand defense is not their forte, but we do already have the Sacred Knights actively protecting a small Muffin village in the valley. As a temporary measure, of course.]

|name&gt;[MARCUS]
|dialogue&gt;[I&#39;m sorry, was their &quot;defensive&quot; operation against that donut settlement vital to the protection of this village? I had to find out about it from the bloody radio.]

|name&gt;[CAMBERRY]
|dialogue&gt;[All of us found out from the radio. You know the Sacred Knights—they’re tougher than cookies, but impossible to control. The reality is we need them. We need their help to confront the growing donut military presence in this region.]

|name&gt;[MARCUS]
|dialogue&gt;[Well, I can tell you one thing. We better deal with this refugee problem soon, before the Sacred Knights arrive.]

|action&gt;[JAMES interrupts the discussion, leading Hector and the Player inside.]

|name&gt;[JAMES]
|dialogue&gt;[Sorry to interrupt, gentlemen. I brought some special guests.]

|name&gt;[MUFFIN RESISTANCE LEADERS]
|dialogue&gt;[Here, here, Hector. Tally-ho. Welcome in.]

|action&gt;[Inside a makeshift command center, MARCUS, CAMBERRY, and a few other Muffin Resistance members stand around a table.]

|name&gt;[JAMES]
|dialogue&gt;[This is the Muffin Resistance headquarters... temporary headquarters. We move around a lot.]

|name&gt;[HECTOR]
|dialogue&gt;[Why have you brought me here, James? We’ve spoken about this before. There’s nothing I can do to help in this fight.]

|name&gt;[MARCUS]
|dialogue&gt;[I don&#39;t understand you, Hector. Even after all that the Donuts have done to you and your family, you still wouldn’t help the Resistance fight against the Donuts?!]

|name&gt;[JAMES]
|dialogue&gt;[Lieutenant Marcus.]

|name&gt;[MARCUS]
|dialogue&gt;[Sorry, Captain.]

|name&gt;[JAMES]
|dialogue&gt;[Helping doesn’t always mean fighting.
Look around this room, Hector. We have intelligent captains and marshalls commanding divisions. We have brave lieutenants leading our fighters. And trust me, we have no shortage of enraged muffin men, ready and willing to strike back at the enemy.
But you know what we don’t have? We don’t have the wherewithal to look after our own muffin kin. The refugee problem is not just here. It’s in every resistance outpost all along the front, and even in outposts well behind the frontlines. The only refugees capable of making the arduous march inward to safer Muffin lands are the strong and able-bodied Muffins. That leaves us stranded with the weak, the infirm, the children. It’s stretching all our supplies thinly. Especially our food supplies, which must be rationed to our soldiers first. I’m sure you can imagine the stress that causes around here.
We don’t need your help fighting, Hector. Everyone wants to fight. But no one wants to have to deal with… with all this.]

|action&gt;[HECTOR closes his eyes, appearing to meditate or think deeply. JAMES and the others fall silent momentarily.]

|name&gt;[CAMBERRY]
|dialogue&gt;[What is he doing]

|name&gt;[MARCUS]
|dialogue&gt;[He’s meditating, obviously.]

|name&gt;[CAMBERRY]
|dialogue&gt;[Oh, he’s one of those muffins.]

|name&gt;[JAMES]
|dialogue&gt;[Shh Have some respect. Let him focus.]

|name&gt;[HECTOR]
|dialogue&gt;[How do you deliver supplies to the front]

|name&gt;[JAMES]
|dialogue&gt;[Supplies to the front]

|name&gt;[HECTOR]
|dialogue&gt;[Yes, how do you deliver supplies to outposts like this one]

|name&gt;[JAMES]
|dialogue&gt;[Sorry, I thought you were about to grace us with some Sacred Scripture wisdom. We deliver mostly by courier. On foot.]

|name&gt;[HECTOR]
|dialogue&gt;[No trucks]

|name&gt;[JAMES]
|dialogue&gt;[We do have a few trucks, but not enough to make a difference.]

|name&gt;[CAMBERRY]
|dialogue&gt;[It’s not our fault. The factories in Blueberry Bulge don’t output enough trucks. You know how those muffins are in Blueberry Bulge. They always take their time making everything nice and neat. A luxury only the furthest city from the front could afford, no doubt.]

|name&gt;[HECTOR]
|dialogue&gt;[What about trucks from donuts Surely you’ve captured a few of those]

|name&gt;[JAMES]
|dialogue&gt;[No, we usually blow those up.]

|name&gt;[MARCUS]
|dialogue&gt;[That’s what I’ve been telling you all. Why blow up the donut trucks when we can use them ourselves I often see them during our operations. Dozens of trucks just sitting there, ripe for the taking.]

|name&gt;[CAMBERRY]
|dialogue&gt;[How are you planning to steal these trucks Do you think the donuts are just going to let you sneak onto their compound, hop into a few trucks, and drive off into the sunset]

|name&gt;[MARCUS]
|dialogue&gt;[It’s a little more complicated than that, but more or less.]

|name&gt;[CAMBERRY]
|dialogue&gt;[I don’t think that will work at all. It’s too risky. There must be some other way to deal with this refugee problem.]

|name&gt;[HECTOR]
|dialogue&gt;[I often hear refugees described as a problem, but let&#39;s not forget that they are the reason you all are fighting this war. To protect them and to give them a chance at a better life.
I’m not keen on risk assessment of military affairs. But if we don’t get more means of transport, the muffins here and everywhere will continue to suffer.]

|name&gt;[JAMES]
|dialogue&gt;[Hector is right. We need trucks, and the donuts have plenty of them. It’s risky, but let&#39;s see if we can&#39;t take a few off their hands.]

|name&gt;[MARCUS]
|dialogue&gt;[I can do it, Captain. I can take a team of my men and infiltrate a nearby donut compound. I know of one which houses a few trucks.]

|name&gt;[CAMBERRY]
|dialogue&gt;[Let’s think this through for a second. Even if we have more trucks, we still won&#39;t be able to send muffin refugees to the rear. Whenever we’ve sent muffin refugees in trucks to the rear, half the time those sons of biscuits send them right back to us. No one wants to take in any more refugees.]

|name&gt;[JAMES]
|dialogue&gt;[That’s where Hector comes in. Hector can convince them to take in more refugees.]

|name&gt;[HECTOR]
|dialogue&gt;[I can’t convince anyone of anything. The most I can do is understand why they’re refusing refugees and see if we can find a solution that works for all of us.]

|name&gt;[JAMES]
|dialogue&gt;[See what I mean Now I’m convinced we should take more refugees. Hector, you go on the next truck back to the rear outposts and work your mind tricks. Anderson, you will help Lt. Marcus infiltrate the Donut military compound and capture those trucks. And to the both of you… welcome to the Resistance.]

|action&gt;[END OF SCENE (Up to this point.)]</tw-passagedata><tw-passagedata pid="17" name="A2-S04" tags="Timeframe_Early" position="900,975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 04]
TRUCKS]

You are on a resistance mission to capture trucks from Donuts.
The mission starts in the woods far from the compound where you encouter some enemy Donuts on patrol. A firefight ensues. You continue towards the Donut compound. Someone elses shoots at your team. It was friendly fire from Sacred Knights scouts. A conversation about what they are doing here happens. Marcus says they don&#39;t need SK help but he throws the question to you. Regardless of your answer, SK will come at the end of the mission to help.
The SK scouts leave. You reach the outside of the compound. You are tasked to provide overwatch and snipe any enemies that might discover the team that moves in. Another Muffin is with you who will take some shots a tell you when it&#39;s time to move in.


&lt;img src=&quot;https://i.imgur.com/z6LnvzY.jpg&quot; class=&quot;fitHalf&quot;&gt;
You move in to help take one of the trucks after finding the keys in a building on the compound. As you are leaving, rockets hit the watch towers as a wave of SK fighters move in to attack the compound. You escape in the truck as sirens blare in the distance.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S04.2]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="18" name="A2-S05" tags="Timeframe_Early" position="900,1225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 05]
COUNTERATTACK]

NOTE: General Grimmer is mentioned here.


&lt;img src=&quot;https://i.imgur.com/nMAc4jZ.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are back at the resistance outpost. A dust storm is blowing in from the south. Hector and other resistance members are helping muffin refugees onto trucks. Hector asks one of the refugees why none of them are carrying any belongings. They respond that they were told by the sacred nights that they were not allowed to bring anything and to put all their belongings in a pile for the Sacred Knights to sort. Hector remarks that this is not the correct policy and that they are allowed to take a small bag of valuables. The truck convoy of refugees leaves. Hector frustratingly vents to his resistance commrades that he already told Cain about this issue. His comrades shrung.
COMRADE 1: Sorry sir. You know how Cain and the Sacred Knights are. They hardly listen to us.
COMRADE 2: So much for them being a subgroup of the muffin resistance.
COMRADE 1: Well, as long as they&#39;re on our side, eh?
COMRADE 2: Hopefully it remains that way. I&#39;d hate to fight those crazy butter-biscuits in the battlefield. Can you imagine?
COMRADE 1: I don&#39;t want to imagine that.
COMRADE 2: Haha.

Hector and resistance leaders group up for a meeting. Cain is noticeably absent but they start the meeting anyway. Hector is explaining the situation to his fellow resistance members. One member remarks how successful the raids have been. They have captured more trucks delivering refugees to work in factories while delivering food and supplies to the front. There are also muffins working on new weapons to aid in the war effort against donuts. Many divisions of the resistance have also started raiding donuts to capture trucks. They have lost some resistance outposts in fierce concentrated attacks by the donut military. They address if there is any risk of such an attack at this outpost. It&#39;s hard to tell where donut forces are concentrated but there is a nearby forward operating base that donuts can launch an attack from. They conclude they should avoid stirring the hornets nest too much until they are prepared to defend from such an attack. They specifically address one truck rich environment that should be avoided as not to provoke such an attack. One muffin says, yes, I think we all agree that target is off the table, and that it would be stupid to attack that target.
Just then, Cain and his men pull up in a large convoy of trucks outside the meeting building. Cain asks how are your defenses to the resistance leaders. They get into a heated discussion where Kane reveals that they didn’t simply hit that off limits target. They also sabotaged A major pipeline and supply route that cut off the mass buildup of donut forces at the nearby base. So essentially, the donuts have no choice but to attack. A resistance leader asks what do you mean sabotaged?


&lt;img src=&quot;https://i.imgur.com/w9zARMW.jpg&quot; class=&quot;fitHalf&quot;&gt;
Just then, a massive string of explosions can be heard, and the distance and a smile goes across Cain’s face. “YOU FOOL!” Someone screams as bells ring throughout the outpost. Everyone scrambles into defensive positions.


&lt;img src=&quot;https://i.imgur.com/Qfj4mwY.jpg&quot; class=&quot;fitHalf&quot;&gt;
Cain tells you to follow him onto the back of a truck. The convoy of the sacred nights fighters streams out of the city towards the dust storm. You can see artillery strikes on the outpost as you go through the dust storm.


&lt;img src=&quot;https://i.imgur.com/F95KFzX.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art
PSA: There should be no seats in trucks. Sitting is not a concept in this game world. This image was drawn before that rule was established.)]
Cain explains to you how some Muffins don’t understand war and that sitting around, waiting for the enemy to act is why muffins are in their sorry state. It&#39;s time to turn the tides of war.


&lt;img src=&quot;https://i.imgur.com/mMmlwt3.jpg&quot; class=&quot;fitHalf&quot;&gt;
The truck convoy clears the dust storm and Cain’s counterattack on the Donut base begins. You join the attack. No prisoners are taken. The donuts&#39; initial offensive on the outpost is called back to defend from the counter attack.


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/2Pjitrh.png&quot; class=&quot;fit49&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/VuHR0ZJ.png&quot; class=&quot;fit49&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
But all the Donut heavy armor and personnel are easily destroyed by the sacred knights who have established their control over the base.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S06]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="19" name="A2-S06" tags="Timeframe_Early" position="900,1350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 06]
INDUSTRY]

NOTE: Cain uses some of the valuables he confiscated from refugees to persuade the weapons manufacturers to divert the first shipment of machine guns to his men of the sacred knights instead of the formal muffin resistance.


You are at a muffin factory waiting near a group of muffins who are executives of the factory. They are all excited about meeting a legendary leader of the resistance. They make it seem like they are talking about Hector. But then Cain rolls up. You tour the factory with Cain and his small entourage. You are shown a new type of gun. A machine gun that Cain tests.


&lt;img src=&quot;https://i.imgur.com/lhuvm5J.jpg&quot; class=&quot;fitHalf&quot;&gt;
He really likes it and orders that the first shipment be diverted away from the Muffin Resistance on the southern front, and towards his Sacred Knights units to the north. He wants these machine guns for an upcoming raid in Frost Peak.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S07]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="20" name="A2-S07" tags="Timeframe_Early" position="900,1475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 07]
DEVASTATED OUTPOST]

You are in a truck convoy along with Hector. Hector is in a sort of meditation with his eyes closed. One hand palms his forehead while the other hand rests on boxes of supplies. Here&#39;s some of Hector’s dialogue after he opens his eyes and notices you:
“Anderson? I thought I was alone. Have you been in here the whole time?”
- YES: “I must not have noticed. I have been told I&#39;m often oblivious to my surroundings. Not a favorable trait in times of war, I admit.”
- NO: “You seem to just pop up out of nowhere, don&#39;t you?”
- WAIT: “You’re a man of few words, Anderson.”
“It matters not how you got in here. We could use all the help we can get for this mission. This is not gonna be an easy one, Anderson.”
The truck stops.
“Looks like we’ve arrived. I’ll follow you out.” “Go ahead, Anderson. I&#39;ll follow you out at the truck.”
You get out of the truck and are in a liberated concentration camp for muffins. Hector guides you through the camp so you can see what donuts have done.


&lt;img src=&quot;https://i.imgur.com/F6bqRrw.jpg&quot; class=&quot;fitHalf&quot;&gt;
There are piles of muffin bodies. Hector laments, wishing there was some way of knowing where donuts will attack next so they can prevent atrocities like this. Some muffin resistance fighters immediately want to revenge. Hector calms them down and remind them that sometimes the best thing they can do does not involve using your gun. You help unload some boxes off the trucks. Once a truck is unloaded, muffin survivors are placed in and the truck leaves. After the last truck leaves, rumbling is heard in the distance and a muffin scout comes to warn everyone that donuts are coming. The remaining survivors are huddled into a distant camp building. The muffin resistance fighters then take up defensive positions.
There is a conversation on the radio about whether to ambush the donut convoy or let them pass. Hector says it&#39;s too risky to ambush since they still have survivors, and that better equipped resistance fighters can set up a stronger ambush down the road. The other resistance fighters really want payback. Hector compromises by telling you to use the rocket launcher and only fire if you have a clear shot at the lead tank. If you don&#39;t have a clear shot, let them pass. This allows you to choose whether to fight or not in this mission.
If you let them pass, the mission ends pretty soon after.


&lt;img src=&quot;https://i.imgur.com/MQFTF4f.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: I&#39;m imagining this environment slightly different. However, this is good for now.)]
If you attack, there is a whole firefight you are involved in. The tank fire is a shot blowing up the building with the survivors. At the end, some donuts retreat, some are killed, and some are captured.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S08]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="21" name="A2-S08" tags="Timeframe_Modern" position="900,1600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 08]
FROST PEAK FRONT]
&lt;img src=&quot;https://i.imgur.com/G08OoyH.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are in a frosty environment. A Donut compound is in the near distance. Cain and his men of the Sacred Knights are ready to attack, along with a force of native Frost Peak Muffin gorilla fighters. Cain hands out a new type of gun called a machine gun. Cain tells everyone to take no prisoners. A native commander replies to Cain that is not their way, and they will protect prisoners who surrender. Cain gets angry and goes off on the native commander. 


&lt;img src=&quot;https://i.imgur.com/dWGc1uo.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Cain probably won&#39;t be this aggressive towards a Frost Peak muffin. Don&#39;t get me wrong, this is totally within his character. But the Frost Peak muffins are very tough and even Cain will think twice before getting into an altercation with them. That said, Cain might push a low ranking Frost Peak muffin so I might make one of them argue with Cain, rather than the Frost Peak leader. Plus, the leader of the Frost Peak muffins largely shares Cain&#39;s aggressive tendencies, to a certain extent, so they probably agree not to take prisoners.
RANDOM NOTE ABOUT ART NOTES: Hi Haku :)  You might&#39;ve noticed me rambling occasionally in these art notes. Sometimes I will mention stuff about the story just as a learning moment, so not all art notes mean that there&#39;s something to correct in the art... also, DO NOT WASTE TIME CORRECTING CONCEPT ART. Unless I explicitly say I want to change something, the art you made is good enough for the purpose of understanding the story. The notes are just there in case someone else reads this. For instance, I don&#39;t want an environment artist to create an environment based on a concept art with no notes.)]
While Cain admires the native Frost Peak Muffins as legendary warriors, he then reminds them of what war is really like and the extensive experience of the Sacred Knights. Native commander falls in line, but asks one more question. &quot;What about Hector&#39;s message to the resistance? To protect those who do not fight?&quot; Cain replies, &quot;Hector is a fool. He does not know war.&quot; Cain commences the attack on the Donut compound. You join in the attack.

It&#39;s a smooth sailing assault that ends in a decisive victory for the muffins.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S09]]]


FROST PEAK MUFFINS MIGHT HAVE THEIR OWN FLAG. IF SO, IT WILL FIRST APPEAR IN THIS SCENE. IMAGE IS TBD.


SCRIPT DRAFT:



</tw-passagedata><tw-passagedata pid="22" name="A2-S09" tags="Timeframe_Modern" position="900,1725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 09]
BLUEBERRY BULGE COUNCIL MEETING]

NOTE: General Grimmer is mentioned here.


You find yourself outside a large fancy government building in the far west city of Blueberry Bulge. Blueberry Bulge is the most advanced muffin city that has been allowed to prosper due to its geographic distance from the war front. You enter the building where all the key leaders of the resistance are meeting along with the government council.
The first resistance leader to speak outlines the progress of the war and victories gained, but he also highlights an increasing intensity of reprisal attacks by donuts that cannot be easily defended against. 


&lt;img src=&quot;https://i.imgur.com/mTnNzOe.jpg&quot; class=&quot;fitHalf&quot;&gt;
Hector then takes the stage and explains his findings and explores some ideas to mitigate harm on Muffin civilians. Cain vehemently disagrees with any notions to protect civilians at the cost of offensive power. Cain argues the best way to protect Muffin civilians is to make reprisal attacks against donuts so costly that donuts refuse to attack. Instead, Cain poses a new path. A path of escalation. He claims they are in good positions to launch attacks into donut lands, much like donuts have launched attacks into muffin lands. 
Just as Hector and Cain’s discussion is getting heated, a muffin named Professor Ludwig is given the floor to speak.


&lt;img src=&quot;https://i.imgur.com/0lS1LP2.jpg&quot; class=&quot;fitHalf&quot;&gt;
He introduces himself and offers Cain and Hector a solution without compromise. But it&#39;s top-secret so he can&#39;t speak of the details in such a public forum.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S10]]]



MY NOTES:
Hmm, I wasn&#39;t imagining that scene as being in a dark room. I was imagining a big grand council meeting chamber that is brightly lit. But I kind of like the idea of having this scene take place in a more private dimly lit secret government room where Ludwig attends the meeting and stands in a shadowed corner until he walks out to offer a solution to the argument.
It&#39;s also an opportunity for a joke, and I&#39;m always trying to insert humor in this game. I can imagine a new ending for that scene…
	LUDWIG steps out of the shadows to say he has a solution without compromise to HECOTR and CAIN’s argument, but he can&#39;t speak of it in such a public forum. After saying that, LUDWIG and everyone turns to stare at MUFFIN POLITICIAN A. MUFFIN POLITICIAN A looks around the dark room confused by what LUDWIG means by this private room being “such a public forum”.
MUFFIN POLITICIAN A:
“There&#39;s no one here.”
	There is silence from everyone else in the room looking at him.
MUFFIN POLITICIAN A:
“Come on. You could tell us. We&#39;re all trusted elected officials.”
	More silence from the room as everyone continues staring a him.
MUFFIN POLITICIAN A:
“Well, all of us except for Tim, obviously. Tim, could you please leave the room?”
	Still silence.
MUFFIN POLITICIAN A:
“What? You all think I’m the one who can&#39;t keep my mouth shut? I am perfectly fine keeping my mouth shut. I do it all the time. See, watch me keep my mouth shut.”
	Still silence.
MUFFIN POLITICIAN A:
“Screw you guys. I’m going home.”
	MUFFIN POLITICIAN A storms out of the room.
MUFFIN POLITICIAN B:
“Now that he’s gone, tell us about your solution, Mr. Ludwig.”
LUDWIG:
“That’s Professor Ludwig to you! Actually, that’s Professor Ludwig to everyone, but especially you! Now, prepare to be amazed.”
	SCRIPT NOTE: I&#39;m not sure if I want this scene to end here as a transition or if it should continue with Ludwig giving some presentation that you will witness.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="23" name="A2-S10" tags="Timeframe_Modern" position="900,1850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 10]
THE EXPERIMENT]


	Quick Summary:
You arrive at the unfinished Sim Labs HQ and mistakenly get involved in testing due to being confused for a prototype. Amidst the initial tests, a real Muffin test subject disrupts the area, leading to a crisis that causes Ludwig to accelerate the use of artificial subjects. Your identity revelations during Ludwig’s main experiment prove that your existence and the world around are part of a larger simulation. After this discovery, Ludwig conducts further experiments to explore the simulation’s mechanics. However, before the final test can be conducted, the simulation glitches, abruptly ending the scene as you remove your simulator headset, transitioning to the next scenario.



	Detailed Description:

You are at Sim Labs HQ prior to its complete construction. It&#39;s initially quiet in the lobby where you are. You walk up to the receptionist who asks if you are here to see Ludwig. (If you answer yes, Ludwig gets on the intercom and tells you he&#39;ll be out in a second and they are just dealing with a situation.) In the background, you can hear some commotion and struggling. You hear the commotion getting louder, from behind some double doors.


&lt;img src=&quot;https://i.imgur.com/ydY5DY7.jpg&quot; class=&quot;fitHalf&quot;&gt;
Suddenly, a muffin wearing a simulator headset bursts through the doors. He looks like he&#39;s in some very fun simulation because he&#39;s running around everywhere all while Ludwig and a few other scientists are trying to contain him. They end up pinning him down and removing the simulator. The man goes crazy and repeats “Put me back!” while he&#39;s carried away. Ludwig tells his colleague, “Using real muffins as test subjects is a disaster. What is the status of those artificial test subjects?” Colleague replies, “The Anderson model schematics are approved for manufacturing. They’re just finishing up the current batch of Camelot model test subjects that are in the queue. Then they will manufacture a prototype Anderson model for initial testing.” Ludwig responds, “There’s no time to wait on the Camelots. We need artificial test subjects now.” Ludwig is surprised to see you. He thinks you are the first prototype test subject. [if you answered yes from earlier, Ludwig will have extra dialogue with the receptionist.] He pulls you in for testing quickly before the special guests (Hector and Cain) arrive for demonstrations.


&lt;img src=&quot;https://i.imgur.com/zN2UT21.jpg&quot; class=&quot;fitHalf&quot;&gt;
Ludwig activates a simulator. There are crazy colors inside. Just before he puts it on you, the colleague remarks, “Don&#39;t you think it&#39;s strange that manufacturing produced something before schedule? That&#39;s the first time they&#39;ve ever done that.” This innocent comment prompts Ludwig to ask you this strange question, “Mr. Anderson. Have I already put this simulator on your face before? Answer me honestly.” You will likely answer no the first time, and the simulator will send you to your death in some bizarre way. Perhaps a black hole will swallow you.
You respawn before Ludwig asks you that question. When you answer yes, Ludwig hesitates before putting it on. He is then notified by the receptionist that the special guests have arrived. Professor Ludwig brings in Hector and Cain. They immediately recognize you and a whole lot of information clicks together. You haven’t been manufactured yet. There are records of your existence before Sim Labs. Ludwig gets some hunches and pulls up all the available information about you. He discovers that the chance of you surviving all your experiences is astronomically low.
No one understands what Ludwig is getting at or thinking until he explains himself. Ludwig proposes a crazy experiment to test a theory that you are in a simulation. He has you press a series of 10 buttons, each with a 50% chance of killing you. There is a .097% chance of survival. If you survive, that is strong evidence for Ludwig&#39;s hypothesis. After respawning at a checkpoint multiple times, you eventually make it through. One arrogant muffin scientist doesn&#39;t believe Ludwig experiment is real and presses the button a few times while in the room. Ludwig warns him to stop but on the third press, it blows him to pieces. Everyone now knows the experiment was real.
Ludwig then explains to everyone the purpose of there research is to make a perfect simulation of the past. A simulation so perfect, it can predict the future. Hence their company slogan. Such a simulation can be used for intelligence gathering in order to counter enemy plans. But the twist is, your existence suggests that the perfect simulation has already been created, and that you are in it now.


&lt;img src=&quot;https://i.imgur.com/ZM8kSTr.jpg&quot; class=&quot;fitHalf&quot;&gt;
There’s a bit of an existential crisis and a commotion about this idea that everyone might just be simulated. Some question if anything really matters then. Ludwig reassures everyone by saying: “Let’s all calm down. Perhaps we are all indeed living in a simulation. Perhaps I am simply the simulated result of my own future trademarked simulation, or maybe, and this is a ridiculous notion, maybe we’re just part of some little game, thought up by some overweight higher demential fellow. And who knows, maybe even that hypothetical fellow is just a tiny spec in a grand universe created by an even higher dimensional being.”
“And what about after that?” 
“( stumbling over words ) Don&#39;t think about after that. Point is, you all feel real right now. From your perspective, you aren’t simply a pile of atoms bouncing around, according to the laws of physics. I mean, to be clear, you are that. But somehow, you are also this emergent entity that is experiencing reality. Well, maybe not reality, but you are experiencing… experiences. Are any of you not? Timothy, I saw your hand up. Are you the conscious equivalent of a rock, bouncing according to the laws of physics? Because that would explain a few things if you are. Ha ha ha ha ha! (Embarrassed because no one else is laughing.) (Clears throat.) In conclusion, so long as we are experiencers experiencing experience, so long as we feel feelings, love, anger, pain, excitement, hope, et cetera. That’s what makes us truly real, in my humble estimation.”
While not the most reassuring speech. Everyone generally agrees with Ludwig’s sentiments. Everyone but Cain, who storms off thinking this whole meeting is a ridiculous waste of time. They continue the meeting without Cain. Ludwig explains that he’s gonna run some experiments on you. He has an entire protocol planned out for just this case, for some reason. The experiments include:
1. Checking what you see when a normal simulation is active. You just see the deadly blackhole. RESULT: Ludwig finds he has to calibrate the simulator for time and place.
2. Checking what happens when you are sent back a few minutes. Will there be a clone of you? First Ludwig asks if he already sent you back. RESULT: You are not cloned. The simulation is adapted for timeline spacial deviations. But Ludwig comments that he might be able to send you into the simulation as a clone with some settings adjustments. Though he does add that might destabilize the fabric of spacetime so he won’t be testing that. (Ludwig initially inputs the incorrect timeframe to send you back a few minutes. Luckily, a colleague finds and corrects this error saying he was off by 2 orders of magnitude.)
3. Checking if the consequences of your actions persist after exiting into the future. RESULT: They do. However, Ludwig designs the experiment poorly and records the wrong answer. This is a comedic moment.
4. Checking if you could be extracted and questioned on your experiences. You are sent into a simulation that puts you in another room to memorize a color on the wall. RESULT: Ludwig fails to extract you. He just walks in and grabs you instead. This experiment is not fully tested.
As Ludwig is explaining one more experiment he has planned. You are suddenly extracted.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S11]]]



SCRIPT DRAFT:


|action&gt;[You arrive at the under-construction Sim Labs HQ. The lobby is quiet, only disturbed by distant construction noises.]

|action&gt;[You approach the reception desk.]
|name&gt;[RECEPTIONIST]
|dialogue&gt;[Are you here to see Professor Ludwig?]

|action&gt;[You nod yes.]
|name&gt;[RECEPTIONIST]
|dialogue&gt;[He will be out in a moment. They&#39;re just dealing with a situation right now.]

|action&gt;[Background noise grows into commotion from behind some double doors. Suddenly, a Muffin wearing a simulator headset bursts through, causing chaos.]

|action&gt;[Ludwig, along with several scientists, rush towards the chaotic Muffin, trying to contain him.]
|name&gt;[LUDWIG]
|dialogue&gt;[Calm down! Hold him steady!]

|action&gt;[They pin him down and remove his headset. The Muffin starts screaming.]
|name&gt;[MUFFIN]
|dialogue&gt;[Put me back! Put me back!]

|action&gt;[He is carried away, still shouting. Ludwig turns to a nearby colleague, visibly frustrated.]
|name&gt;[LUDWIG]
|dialogue&gt;[Using real muffins as test subjects is a disaster. What&#39;s the status of the artificial test subjects?]

|name&gt;[COLLEAGUE]
|dialogue&gt;[The Anderson model schematics are ready. We’re just finishing up the Camelot models, then we&#39;re on to manufacturing the Andersons.]

|name&gt;[LUDWIG]
|dialogue&gt;[We don&#39;t have time to wait. We need those Anderson models now.]

|action&gt;[Noticing you standing there, Ludwig does a double-take, mistaking you for someone else.]
|name&gt;[LUDWIG]
|parenthetical&gt;[mistaking you]
|dialogue&gt;[Ah, you must be the new prototype. Come, we must begin testing immediately.]

|action&gt;[Ludwig leads you to a testing area with a complex-looking simulator machine adorned with vibrant, swirling colors.]

|action&gt;[As Ludwig prepares the device, a colleague interjects with a casual remark.]
|name&gt;[COLLEAGUE]
|dialogue&gt;[Isn&#39;t it strange that something came through ahead of schedule? That&#39;s a first.]

|action&gt;[Ludwig pauses, then turns to you with a serious look.]
|name&gt;[LUDWIG]
|dialogue&gt;[Mr. Anderson, have I already put this simulator on your face before? Answer me honestly.]

|action&gt;[You shake your head no. Ludwig nods solemnly and proceeds with the simulation, which abruptly sends you into a scenario featuring a black hole.]

|action&gt;[You respawn, before Ludwig can repeat his question. This time, when you affirm yes, he hesitates but eventually puts the simulator back on just as the receptionist interrupts.]

|name&gt;[RECEPTIONIST]
|dialogue&gt;[Professor, the special guests, Mr. Hector and Mr. Cain, have arrived.]

|action&gt;[Ludwig removes the device and escorts you to meet Hector and Cain, who recognize you immediately. A flurry of realization crosses Ludwig&#39;s face as he accesses a terminal.]

|name&gt;[LUDWIG]
|dialogue&gt;[This can&#39;t be right. Your records predate our simulations. This changes everything.]

|action&gt;[Ludwig proposes a daring experiment, involving a console with ten buttons, each potentially lethal.]
|name&gt;[LUDWIG]
|dialogue&gt;[If you survive pressing these, it proves you&#39;re part of something much bigger than we thought.]

|action&gt;[After multiple attempts and witnessing a scientist&#39;s accidental demise from pressing a button, the grim reality of the experiment settles in among everyone present.]

|action&gt;[Ludwig addresses the group, his tone a mix of awe and fear.]
|name&gt;[LUDWIG]
|dialogue&gt;[We aimed to create the perfect past simulation that could predict future events. It appears, however, that we might already be living in such a simulation.]

|action&gt;[A murmur runs through the crowd as they process his words. Some look terrified, others curious.]

|name&gt;[LUDWIG]
|dialogue&gt;[Let&#39;s not panic. Whether we are simulations or not, our experiences, our feelings—they are real to us. Isn&#39;t that what truly matters?]

|action&gt;[While most nod in agreement, Cain storms out, dismissing the discussions as nonsense. Ludwig sighs and turns back to the remaining audience, ready to continue the experiments.]

|name&gt;[LUDWIG]
|dialogue&gt;[Now, let&#39;s proceed with further testing to understand the full capabilities and limitations of our simulation. Follow me.]

|action&gt;[You follow Ludwig to a new testing station equipped with another advanced simulator setup.]

|name&gt;[LUDWIG]
|dialogue&gt;[First, let&#39;s see what happens when we activate a standard simulation scenario. Observe carefully.]

|action&gt;[Ludwig activates the simulator. The scene around you shifts, and you find yourself staring into the vast emptiness of a simulated black hole, all-consuming and terrifying.]

|name&gt;[LUDWIG]
|dialogue&gt;[Interesting... It appears we need to calibrate the simulator for both time and place. Let&#39;s adjust that.]

|action&gt;[Ludwig makes some adjustments to the simulator. He then looks at you with a curious expression.]

|name&gt;[LUDWIG]
|dialogue&gt;[Next, we&#39;ll test the simulation&#39;s temporal parameters. Have I sent you back a few minutes before?]

|action&gt;[You respond no, and Ludwig nods, proceeding with the test.]

|name&gt;[LUDWIG]
|dialogue&gt;[Activating time displacement now.]

|action&gt;[There&#39;s a flash, and you find yourself back in the lobby for a moment, just as you were arriving, yet no clone of you appears.]

|name&gt;[LUDWIG]
|dialogue&gt;[No duplication, excellent. The simulation adapts well to timeline adjustments. But let&#39;s not push our luck with spacetime too much.]

|action&gt;[You return to the present, and Ludwig scribbles some notes. He then prepares for another experiment.]

|name&gt;[LUDWIG]
|dialogue&gt;[Now, let&#39;s verify if actions within the simulation have persistent consequences. This is crucial for the integrity of simulated realities.]

|action&gt;[You perform a simple task in the simulation—knocking over a glass. Ludwig then fast-forwards the simulation to see if the glass remains knocked over.]

|name&gt;[LUDWIG]
|dialogue&gt;[Ah, seems I recorded that incorrectly. Let&#39;s see... Yes, the consequences persist!]

|action&gt;[Ludwig chuckles at his own mistake, lightening the mood slightly.]

|name&gt;[LUDWIG]
|dialogue&gt;[Finally, we&#39;ll test extraction and memory retention. Please, go into that room and memorize the color on the wall.]

|action&gt;[You enter a simulated room and observe the color. Returning, Ludwig attempts to extract the memory directly from the simulation interface but fails.]

|name&gt;[LUDWIG]
|dialogue&gt;[Well, that didn&#39;t go as planned. Let&#39;s try the manual method.]

|action&gt;[Ludwig enters the room and notes the color you mention, confirming it matches your observation.]

|name&gt;[LUDWIG]
|dialogue&gt;[Excellent. Though the extraction process needs refinement, your memory retention within the simulation is flawless.]

|action&gt;[As Ludwig prepares to discuss the final experiment, the environment glitches. Textures flicker and sounds warp oddly.]

|name&gt;[LUDWIG]
|dialogue&gt;[It seems we are experiencing some technical difficulties. Please, hold on.]

|action&gt;[The glitch intensifies, distorting the space around you. Suddenly, everything goes black.]

|action&gt;[You remove your simulator headset, finding yourself transitioning out of the test environment and into a new scene, signaling the end of this segment.]

</tw-passagedata><tw-passagedata pid="24" name="A2-S11" tags="Timeframe_Modern" position="900,1975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 11]
EXTRACTION]
&lt;img src=&quot;https://i.imgur.com/Tu3UVsd.jpg&quot; class=&quot;fitHalf&quot;&gt;
You suddenly and unexpectedly find yourself at a secret Donut research lab. You are in a utility closet with holes to peak out. 2 Donut scientists look like they just tested something that fried their computer. Here’s dialogue between them:
“What was that?” 
“I don’t know.” 
“Did it work?” 
(Scientist looks around the room.) “Doesn’t look like it. Come on. Let’s get out of here before we get blamed for busting another computer.” 
“Good idea. I think Henderson was in here earlier. I’m sure we could pin this on him.” 
“Just don’t mention it. Let someone else find out that computer doesn’t work.” 
“Right. That’s a much better idea.”
You can now open the closet and plan your escape. If you are spotted, alarms will sound and you will not survive. Along your way out, you will discover the next location for a full on assault against Muffins.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S12]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="25" name="A2-S12" tags="Timeframe_Modern" position="900,2100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 12]
THE PLAN]
&lt;img src=&quot;https://i.imgur.com/fsaPbwN.jpg&quot; class=&quot;fitHalf&quot;&gt;
You spawn in the middle of an artillery barrage on the front lines. In a momentary lull in the barrage, there is a muffin who waves you over to his foxhole.
“Where have you been? We could have used your help.”
“Here they come!”
You defend against a wave of Donut enemies. After the wave, you are called back by Captain James to discuss plans. You join him with Hector and other resistance leaders.
They are discussing the war situation. James outlines areas of the map where donuts retreated to Cain’s offensives. He also outlines where muffins have lost ground, including their old outpost that was overrun.
They are reviewing where to reallocate their forces. Everyone is asked individually if they agree to reallocate to the center. Everyone agrees until you are asked.
If you vote no, William will theorize that this attack is a faint and conclude another location for the attack. After some debate, the resistance votes to concentrate / allocate forces in that area.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S13]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="26" name="A2-S13" tags="Timeframe_Modern" position="900,2225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 13]
THE ATTACK]

If you gave the right location, you will help the resistance ambush a fierce Donut attack.
If not, you will be standing around doing nothing for like 5 minutes.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S14]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="27" name="A2-S14" tags="Timeframe_Modern" position="900,2350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 14]
SIM LABS DELIVERY]

Ludwig is managing a Sim Labs delivery of training simulators for resistance soldiers. He wants to use you for more experiments, complaining that the first batch of Anderson model test subjects are not very good. Hector asks you if you are okay with doing more expirements with Ludwig. Professor Ludwig is baffled that Hector is ask a test subject for permission. Hector just wants to make sure in case you are somehow conciuos...
Ludwig pulls Hector aside to warn him about a disturbing finding. Sim Labs has meassured spikes in radiation levels in the air, suggesting Donuts may have constructed a nuclear weapon.


&lt;img src=&quot;https://i.imgur.com/89ZrPVr.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: They might still be outside at this point.)]
Hector doesn&#39;t know what that is. Ludwig explain that the physics is pretty simple before rambling about esoteric details of how nuke work in science language. Then he simple states it&#39;s a bomb. A big big bomb. Powerful enough to desimate a city. The good news is, it&#39;s also big and heavy. Sim Labs ran some simulations and concluded that the Donuts will have to wheel it in by truck. Ludwig warns against stealing or receiving any heavy cargo from Donuts without inspecting it away from populated areas.
William shows up and tells Ludwig that the resistance needs you more. Ludwig reluctantly obliges but first has to test something. He tells you to wait here and then walks into a nearby building where Sim Labs has equipment stationed and close the door. You and William awkwardly wait.
WILLIAM: “What’s his deal with him?”


&lt;img src=&quot;https://i.imgur.com/jAKQYyq.jpg&quot; class=&quot;fitHalf&quot;&gt;
The Simulation™ glitches. You remove the simulator and appear in that building with Ludwig and William.


&lt;img src=&quot;https://i.imgur.com/AoyiAcP.jpg&quot; class=&quot;fitHalf&quot;&gt;
LUDWIG: “It works!”
WILLIAM: “What works?”
LUDWIG: “The Superposition Entanglement Fluctuation Extraction Mechanism… Trademarked.”
WILLIAM: “I still don’t understand.”
LUDWIG: “My invention successful captured and extracted Mr. Anderson from the simulation he was in and brought him to the present.”
WILLIAM: “When?”
LUDWIG: “Just now.”
WILLIAM: “But Anderson was always here.”
LUDWIG: “Incorrect. Your subconscious believes he was always here. But try for a moment to remember what Mr. Anderson was doing minute ago.”
WILLIAM: “Well, he was just…”
LUDWIG: “Standing there?”
WILLIAM: “No, no. He wasn’t standing there. He was doing something… or perhaps he wasn’t doing anything.”
LUDWIG: “Don’t think too hard. I can’t even recall. What you and I are experiencing is called a triple-P, or a phantom phase phenomenon. Although Mr. Anderson was just now extracted from a simulation layer, the exact moment of extraction is unnoticeable to us. Temporal coherence is retained from our perspective, so feels as if Mr. Anderson has always existed in our reality. It makes sense if you don’t think about it.”
WILLIAM: “Okay, I’m going to stop thinking about it.”
LUDWIG: “Now that I know it works, I can extract Mr. Anderson whenever I need him, so long as I have his approximate coordinates. You may take him now and use him for your purposes.”
WILLIAM: “Uhh… Thanks. Come on with me Anderson.”
LUDWIG: “Before you leave, I would like to know where you will be taking Mr. Anderson.”
WILLIAM: “That’s classified.”
LUDWIG: “Classified?! Do you know who I am?! I am the prestigious Professor Ludwig!”
The simulation ends before Ludwig finish speaking.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S15]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="28" name="A2-S15" tags="Timeframe_Advanced" position="900,2475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 15]
CONCENTRATION CAMP]

You are in the midst of a short firefight to liberate a prison camp from Donuts. Some of the Donuts surrender and are captured.
You are at the gates of a camp. Cain walks out from within. He greets you and complains about the arrival of the delegation.
Many important Muffin leaders arrive including Hector. Cain gives everyone a tour of this camp they recently liberated. He shows everyone many examples of Donut cruelty to Muffins.
“I’ve lost count of how many times I’ve seen cruelty from Donuts, but this is the worst of it.”
“Let this be a reminder to anyone becoming soft and thinking we can make peace with our Donut enemy. This is what peace looks like.”
“We can’t live with Donuts on our lands anymore. They are too great a threat.”
“This war will only end once we drive them back and liberate our lands. All the way to the river.”
“We can’t possibly take back New Arc City. What would become of all the Donuts living there?”
“That’s not our problem.”
“Are you suggesting we attack even civilian Donuts in the city? We don’t want to become the same as the monsters we are fighting.”
“We are not the same. Donuts give Muffins no choice, but we give Donuts 2 choices. They can leave to their lands or die in ours.”
“We already how plans in the works to attack the city. If it makes you feel any better, we won’t kill Donuts on sight like they’ve done to us. We’ll give them the opportunity to flee across the river.”
“You at as if it’s easy to capture a city. The Donuts are still more powerful than us. We don’t know how they might retaliate with such a provocation.”


&lt;img src=&quot;https://i.imgur.com/TUAzuBY.jpg&quot; class=&quot;fitHalf&quot;&gt;
Although conflicted, even Hector doesn’t admonish Cain’s plans after witnessing the Donut war crimes in the camp.
Hector warns other resistance leaders that they should lead the assault towards the city to help avoid civilian casualties.

Some of Cain&#39;s men roll up with recently captured truck.
&quot;This one is really heavy, I can feel it.&quot;
&quot;Must be something good.&quot;
Hector is concerned and asks where they got that truck from. They say it was taken from some abandoned Donut weapons research facility. Hector panics and tells everyone to get away from that truck. You help Hector open the truck.


&lt;img src=&quot;https://i.imgur.com/AKspfME.jpg&quot; class=&quot;fitHalf&quot;&gt;
A bunch or dirt falls out. Hector is releaved. Cain is upset that there was a huge panic over a pile of dirt. Then Cain notices a crate in the dirt. He opens it to find a new Donut gun, an assault rifle. Cain tests it out. First shooting the sky, then some Donut prisoners before Hector stops him. Cain hands the new gun to his man and says to tell the Muffin arms company to make something like this before their next assault.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S17]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="29" name="A2-S17" tags="Timeframe_Advanced" position="900,2725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 17]
SIM LABS EXPERIMENT #002]

You are in your starting room at Sim Labs. It almost looks the same as the start of the game, but it’s not. Ludwig has extracted you and he only has a few Anderson test subjects. He extracted you because you have unique properties since you are already in a simulation. He and Hector want to ensure the resistance has all the intel they need to ensure the upcoming offensive against the Donuts in New Arc City will be successful. But current Sim Labs simulations aren&#39;t good enough to provide the level of accurate intel that they need. So Ludwig proposes a risky idea. He could send you in a deeper simulation layer that will effectively put you back in time “just a few days prior” to gather intel on the Donut defence strategy. Ludwig quickly configures a simulator and prepares it for you to wear. A scientist asks Ludwig, “Are you sure you have it configured correctly? Maybe you should double check.” Ludwig replies, “Of course I have it configured correctly. What do I look like to you? A bumbling idiot? ‘Double check.’ (Scoff.)”


&lt;img src=&quot;https://i.imgur.com/iRdESMX.jpg&quot; class=&quot;fitHalf&quot;&gt;
Then you wear the simulator. Of course, Ludwig will send you too far back.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A2-S18]]]



MY NOTES:
-  the reason Ludwig doesn&#39;t want to have it double checked is because he doesn&#39;t want someone else taking credit for work he did just by helping out a little bit.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="30" name="A2-S18" tags="Timeframe_Early" position="1050,600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 18]
AMBUSH
EXT - DAY - DONUT SETTLEMENT]
&lt;img src=&quot;https://i.imgur.com/AknKIVF.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: No tumbleweed. Tumbleweeds are only in the Ripple Range region. This is not that region.)]
You end up at a time just after your escape from prison, near the war’s beginning. This time, you are with the Donuts, and will see the war from their perspective.


&lt;img src=&quot;https://i.imgur.com/3XVU033.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are captured by the Donut soldiers and taken to a small village where Commander Gorg interrogates you. He asks you increasingly intimidating questions until General Grimmer enters the room.


&lt;img src=&quot;https://i.imgur.com/knQ3cJ1.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/Uv8LJ8F.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Wrong hat on General Grimmer.)]
Grimmer intercedes on your behalf and has you follow him. He guides you around the devastated village. You witness the aftermath of a massacre of innocent Donuts at the hands of Muffins. Perhaps even the same Muffins you helped escape from prison. Grimmer offers you a chance to work with the Donuts and prove you’re on the side of good. 


&lt;img src=&quot;https://i.imgur.com/aC71uK2.jpg&quot; class=&quot;fitHalf&quot;&gt;
Suddenly, the village is attacked by waves of Muffin guerrilla fighters, and you join the Donut soldiers in battle. General Grimmer is critically wounded at the end of battle.


&lt;img src=&quot;https://i.imgur.com/fAC77IL.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
Before you learn his fate, The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S19.1]]]






















SCRIPT DRAFT:

|action&gt;[You spawn on a long dirt road, seemingly deserted. A truck carrying a small group of Donut soldiers approaches you rapidly.]

|name&gt;[DONUT SOLDIER #1]
|dialogue&gt;[You there, stop! Arms in the air!]

|action&gt;[You surrender. DONUT SOLDIER #1 hits you with his rifle, causing you to black out. When you regain consciousness, a black bag is over your head, and you overhear Commander Gorg and DONUT SOLDIER #1 talking.]

|name&gt;[GORG]
|dialogue&gt;[This is the one, right?]

|name&gt;[DONUT SOLDIER #1]
|dialogue&gt;[Yes sir, this is him.]

|action&gt;[The bag is removed. You find yourself in a small town swarming with Donut soldiers. Gorg begins interrogating you.]

|name&gt;[GORG]
|dialogue&gt;[Tell me, spy, where are the rest of your murderous friends hiding?]

|action&gt;[Gorg waits for a response. You remain silent.]

|name&gt;[GORG]
|dialogue&gt;[If you&#39;re afraid to talk because you fear what those savage muffins might do to you, then I can assure you… what I will do is far, far worse if you don&#39;t tell me where your muffin friends are hiding.]

|action&gt;[General Grimmer approaches Gorg and you.]

|name&gt;[GRIMMER]
|dialogue&gt;[Is that a prisoner, Commander Gorg?]

|name&gt;[GORG]
|dialogue&gt;[Yes… sir. I caught him this morning. He was trying to spy on us from the cliffs near the road. In fact, he looks just like the third fugitive from that prison break. He&#39;s the reason those two killer muffins escaped.]

|name&gt;[GRIMMER]
|dialogue&gt;[Why is he not with the other prisoners?]

|name&gt;[GORG]
|dialogue&gt;[I&#39;ll turn him in. Just asking a few questions first. That&#39;s all.]

|action&gt;[Grimmer starts questioning you.]

|name&gt;[GRIMMER]
|dialogue&gt;[He’s right. You do seem to match the description of that third fugitive who escaped prison rather well. Heck, you even got the same name tag they printed in the papers…]
|action&gt;[Grimmer pulls the name tag from your shirt.]
|dialogue&gt;[Anderson.]

|name&gt;[GORG]
|dialogue&gt;[See, I knew it was him! We have orders to shoot these scumbags on sight, General.]

|name&gt;[GRIMMER]
|dialogue&gt;[… if they resist capture, Commander. Plus, this one is different. Unlike the other two, he was never admitted into the prison in the first place. He has no traceable past. No one has ever seen or met him. And just look at him. He doesn&#39;t appear to be a donut or muffin.]

|name&gt;[GORG]
|dialogue&gt;[Kinda looks like a muffin to me.]

|name&gt;[GRIMMER]
|dialogue&gt;[Regardless of what he may look like, Drejnon Prison officials need him alive and well. They have questions. For that reason, Anderson will be under my custody, for the time being. Understood?]

|action&gt;[Gorg pauses, visibly upset. He gives a small nod to soldiers guarding you. He walks off. Grimmer motions for you to follow him.]

|name&gt;[GRIMMER]
|dialogue&gt;[Follow me, Anderson. Those two muffins you helped escape probably convinced you they&#39;re just good guys fighting for a noble cause. Tell me. Does this look noble to you? This is the way they fight. They&#39;re cowards who attack defenseless civilians just because they&#39;re easy targets. The donut defense league protects defensive civilians, even if they happen to be muffins. That&#39;s the way we fight.]

|name&gt;[GRIMMER]
|dialogue&gt;[Now, I trust you had nothing to do with the crimes of those muffins, but you&#39;re still responsible for helping them escape. However, you’re in a unique position to gather vital Intel from those muffins. By working with us, you&#39;ll be vindicated of charges and also help to stop atrocities like this from happening again.]

|action&gt;[Three muffin prisoners are executed nearby.]

|name&gt;[GRIMMER]
|dialogue&gt;[Hey! Stop right there. Who authorized you to execute prisoners?]

|name&gt;[DONUT SOLDIER #2]
|dialogue&gt;[Commander Gorg gave the order, sir.]

|name&gt;[GRIMMER]
|dialogue&gt;[What did I say in the briefing for this operation? To capture unarmed combatants who surrender. Then Commander Gorg told us to execute them after capture.]

|name&gt;[GRIMMER]
|dialogue&gt;[I&#39;ll have a word with Commander Gorg later. Right now, find a medic to treat that prisoner, then put him with the rest. And tell anyone else who misunderstood my orders, prisoners are not to be executed.]

|name&gt;[DONUT SOLDIER #2]
|dialogue&gt;[Yes sir, General Grimmer.]

|name&gt;[GRIMMER]
|dialogue&gt;[I never said we were perfect. But we do make the effort to be better than the enemy. Follow me over here.]

|action&gt;[You follow Grimmer to his makeshift office.]

|name&gt;[GRIMMER]
|dialogue&gt;[Let’s get some questions out of the way, first. Did you help two fugitive Muffins by the names of Cain and Hector escape from Drejnon prison? Answer with a yes or no, please. Was your prison cell door locked at the time of your escape? Were you escorted into your cell by prison guards when you first arrived? “No”? Did you walk into the prison yourself? There’s no other way to enter a building. Did you spontaneously pop into existence inside the prison cell? Okay… Well, there is that prophecy… No. There’s no way that’s real. I can’t believe I even considered it.]

|name&gt;[GRIMMER]
|dialogue&gt;[Look, here’s the deal. I don’t know whose side you’re on. Maybe you don’t even know whose side you’re on. But the choice is simple. Donuts are the good guys. We protect while Muffins destroy.]

|action&gt;[Short silence. Grimmer peeks outside the room for a second.]

|name&gt;[GRIMMER]
|dialogue&gt;[You don’t have to look at me like that. I understand not all Muffins are evil, but unfortunately war doesn’t allow time for assessing each individual. And frankly, if you’re a Muffin protecting the murderers that destroyed this village, you deserve what’s coming to you. Now, let’s figure out what side you’re on. Next time you’re around those Muffins you helped escape, I want you to sneak this tracking device in with you. Hide it close by to one of them. And don’t get caught.]

|action&gt;[You are free to leave. Grimmer expresses his hope that you&#39;re one of the good guys.]

|name&gt;[GRIMMER]
|dialogue&gt;[You’re free to leave. I really hope you’re one of the good guys, Anderson. Don’t prove me wrong.]

|action&gt;[As you and Grimmer leave the makeshift office, you hear a growing rumble.]

|name&gt;[DONUT SOLDIER #3]
|dialogue&gt;[WE’RE UNDER ATTACK!]

|action&gt;[Waves of Muffin guerrilla fighters charge into the village in a massive ambush.]

|name&gt;[GRIMMER]
|dialogue&gt;[Grab a rifle, Anderson!]

|action&gt;[You grab a rifle to defend yourself.]

|name&gt;[GORG]
|dialogue&gt;[General! It’s an ambush! We can’t hold the prisoners!]

|name&gt;[GRIMMER]
|dialogue&gt;[Do it.]

|action&gt;[The Muffin prisoners are executed and the battle begins. After the fierce battle, Grimmer is critically wounded by a shot from a Muffin fighter. An exit portal spawns on your position.]


















	YOU spawn on a long dirt road, seemingly deserted. A small group of Donut soldiers in a truck drives toward YOU. DONUT SOLDIER #1 yells out to YOU.
DONUT SOLDIER #1.
You there, stop! Arms in the air!
	YOU surrender. DONUT SOLDIER #1 hits you with his rifle. YOU black out and wake with a black bag over your head. YOU overhear commander GORG and DONUT SOLDIER #1 talking.
GORG.
This is the one, right?
DONUT SOLDIER #1.
Yes sir, this is him.
	The bag is removed. YOU find yourself in a small town swarming with Donut soldiers. GORG begins interrogating YOU.
GORG.
Tell me, spy, where are the rest of you’re murderous friends hiding?
	GORG waits for a response. YOU are silent.
GORG.
If you&#39;re afraid to talk because you fear what those savage muffins might do to you, then I can assure you… what I will do is far, far worse if you don&#39;t tell me where your muffin friends are hiding.
	General GRIMMER walks up to address GORG.
GRIMMER.
Is that a prisoner, Commander Gorg?
GORG.
Ya… sir. I caught him this morning. He was uh.. He was trying to spy on us from the cliffs near the road.
In fact, he looks just like the third fugitive from that prison break. He&#39;s the reason those 2 killer muffins escaped.
GRIMMER.
Why is he not with the other prisoners?
GORG.
I&#39;ll turn him in. Just asking a few questions first. That&#39;s all.
	GRIMMER starts questioning YOU.
GRIMMER.
He’s right. You do seem to match the description of that third fugitive who escaped prison rather well. Heck, you even got the same name tag they printed in the papers… (pulls name tag from your shirt) Anderson.
GORG.
See, I knew it was him! We have orders to shoot these scumbags on sight, General.
GRIMMER.
… if they resist capture, Commander.
Plus, this one is different. Unlike the other 2, he was never admitted into the prison in the first place. He has no traceable past. No one has ever seen or met him. And just look at him. He doesn&#39;t appear to be a donut or muffin.
GORG.
Kinda looks like a muffin to me.
GRIMMER.
Regardless of what he may look like, Drejnon Prison officials need him alive and well. They have questions. For that reason, Anderson will be under my custody, for the time being. Understood?
	GORG pauses, visibly upset. He gives a small nod to soldiers guarding YOU. He walks off. GRIMMER motions YOU to follow him.
GRIMMER.
Follow me, Anderson. Those two muffins you helped escape probably convinced you they&#39;re just good guys fighting for a noble cause. Tell me. Does this look noble to you?
GRIMMER.
This is the way they fight. They&#39;re cowards who attack defenseless civilians just because they&#39;re easy targets. The donut defense league protects defensive civilians, even if they happen to be muffins. That&#39;s the way we fight.
GRIMMER.
Now, I trust you had nothing to do with the crimes of those muffins, but you&#39;re still responsible for helping them escape.
However, you’re in a unique position to gather vital Intel from those muffins. By working with us, you&#39;ll be vindicated of charges and also help to stop atrocities like this from happening again.
	Three muffin prisoners are executed nearby.
GRIMMER.
Hey! Stop right there. Who authorized you to execute prisoners?
DONUT SOLDIER #2.
Commander Gorg gave the order, sir.
GRIMMER.
What did I say in the briefing for this operation?
DONUT SOLDIER #2.
To capture unarmed combatants who surrender. Then Commander Gorg told us to execute them after capture.
GRIMMER.
I&#39;ll have a word with Commander Gorg later. Right now, find a medic to treat that prisoner, then put him with the rest. And tell anyone else who misunderstood my orders, prisoners are not to be executed.
DONUT SOLDIER #2.
Yes sir, General Grimmer.
GRIMMER.
I never said we were perfect. But we do make the effort to be better than the enemy. Follow me over here.
	YOU follow GRIMMER to his makeshift office.
GRIMMER.
Let’s get some questions out of the way, first. Did you help 2 fugitive Muffins by the names of Cain and Hector escape from Drejnon prison? Answer with a yes or no, please.
Was your prison cell door locked at the time of your escape?
Were you escorted into your cell by prison guards when you first arrived?
“No”? Did you walk into the prison yourself?
There’s no other way to enter a building. Did you spontaneously pop into existence inside the prison cell?
Okay… Well, there is that prophecy… No. There’s no way that’s real. I can’t believe I even considered it.
GRIMMER.
Look, here’s the deal. I don’t know whose side you’re on. Maybe you don’t even know whose side you’re on. But the choice is simple. Donuts are the good guys. We protect while Muffins destroy.
	Short silence. GRIMMER peaks outside the room for a second.
GRIMMER.
You don’t have to look at me like that. I understand not all Muffins are evil, but unfortunately war doesn’t allow time for assessing each individual. And frankly, if you’re a Muffin protecting the murderers that destroyed this village, you deserve what’s coming to you. Now, let’s figure out what side you’re on. Next time you’re around those Muffins you helped escape, I want you to sneak this tracking device in with you. Hide it close by to one of them. And don’t get caught.
You’re free to leave. I really hope you’re one of the good guys, Anderson. Don’t prove me wrong.
	As YOU and GRIMMER leave the makeshift office, YOU hear a growing rumble.
DONUT SOLDIER #3.
WE’RE UNDER ATTACK!
	Waves of Muffin guerrilla fighters charge into the village in a massive ambush. 
GRIMMER.
Grab a rifle, Anderson!
	YOU grab a rifle to defend yourself. 
GORG.
General! It’s an ambush! We can’t hold the prisoners!
GRIMMER.
Do it.
	The Muffin prisoners are executed and the battle begins. After the fierce battle, GRIMMER is critically wounded by a shot from a Muffin fighter. An exit portal spawns on your position.


</tw-passagedata><tw-passagedata pid="31" name="A2-S19.1" tags="Timeframe_Early" position="1050,725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 19.1]
STRATEGY]

You are in a Donut base. Gorg and some generals are walking by. Gorg notices you and stops to tell the generals of your heroic efforts (if you killed a lot of Muffins in the last mission). You are then invited to the war room to discuss new plans. Kegan is there with a presentation. His plan is to fight fire with fire and do what the Muffins have done. They will focus attacks on Muffin outposts to provoke a reaction and destroy large numbers of enemy Muffins. Gorg and others comment how genius that is. “But wouldn’t this cause collateral damage on Muffin civilians?” One general says. “That’s the point,” Gorg responds.
Kegan comments how they already tested this strategy. Their most recent test was on Muffinville which Kegan describes as a stronghold for Muffin militants. After destroying most of the outpost with artillery and occupying it, Muffins counterattacked the fortified Donut defensive positions. Muffins eventually recaptured the outpost but they took heavy losses before the Donuts retreated.


&lt;img src=&quot;https://i.imgur.com/qOczTXa.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: General Grimmer&#39;s hat is wrong.)]
Grimmer walks in. Everyone is surprised he’s not still in recovery. “I’ve had worse,” Grimmer says. “Let’s hear the plan again.” Kegan explains the plan with an emphasis on destroying combatants, not just Muffins in general. Grimmer denies the plan, saying it’s too high a risk on Muffin civilians. “Listen, I’ve been around for a long time. There’s no need to sugar coat it. I understand the urge to match the enemy’s level of escalation. And believe me, we will answer the enemy’s escalation. However, we are honorable Donuts. We are not savage Muffins. We do not escalate violence indiscriminately, as the Muffins have done. For one, that is counter productive. It will drive recruitment into the most extreme Muffin factions fighting against us. But more importantly, if we become savages in our fight against savages, what are we fighting for?”
“With all due respect sir, we are at war. We are fighting for the preservation of our great Donut nation. This is not the time for moral idealism.”
“When is the time for morals? When it’s easy?”
(Silence.)
“I agree with General Grimmer. I didn’t join the Donut Defense League only to protect Donuts. I joined because it was right. We are the good guys fighting to protect the innocent. That’s the difference between us and them. The Muffins intentionally kill civilians, but we always do everything we can to avoid harming civilians, even if they are Muffins.”
GORG: “You haven’t been out in the field very much, have you? One minute, a so called Muffin civilian is giving you a friendly wave, the next minute he’s sending 13 by 71 mm rounds through your back. Don’t kid yourself. There’s no such thing as a Muffin civilian. You better wisen up fast to that.”
“Who are you telling to wise up?”
“I’m telling you, punk.”
“I’ve been down range more times than you can count. Maybe if you got the Fudge out of the rear, you’d actually encounter real enemies, instead of crying about some old man taking pop shots.“
“You insulin little son of a Huckleberry!”
“Come at me! You think I’m scared?”
A short quarrel ensues.


&lt;img src=&quot;https://i.imgur.com/WXVGx89.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: This should be Sergeant Johnson and Commander Gorg quarreling.)]
“Calm down everyone, let’s not get our egos involved. Look, this plan is just too risky. Never mind the presence of civilians. We need to know the makeup of these Muffin outposts we’re targeting for our safety.”
“You’re right. More intel is needed before we attack. Do we have air assets on those outposts?”
DONUT ANALYST: “Three spy planes were shot down flying too low. These are the only aerial photographs we captured of potential targets. It’s impossible to gather detailed information from a distance. But we were able to crossreference this with some intel we gathered of Muffin militants at the massacre. There&#39;s a high probability that several Donut hostages are being held in this Muffin outpost.
We presume the muffins chose this outpost so that they could hide the hostages specifically among a predominantly muffin refugee population, specifically at this building in the center.”
GORG: &quot;So. Just blow up every surrounding building, move in and extract the hostages.&quot;
JOHNSON: &quot;Did you even listen? It&#39;s predominately refugees living there.&quot;
GORG: &quot;Did I stutter?&quot;
ZIMMAR: &quot;Refugees don&#39;t hold innocent Donuts hostage, commander Johnson.&quot;
DONUT ANALYST: &quot;Well, we can&#39;t say for sure that the hostages are in any particular building. &quot;So I wouldn&#39;t recomend bombing the entire outpost.&quot;
KESSLER: &quot;What do you think we should do sargeant Kegan?&quot;
KEGAN: &quot;Nothing.&quot;
GORG: &quot;Nothing?&quot;
KESSLER: &quot;Really? Nothing?&quot;
KEGAN: &quot;It&#39;s not worth the risk.&quot;
JOHNSON: &quot;How is it not worth the risk when there&#39;s a high probablity of finding hostages?&quot;
KEGAN: &quot;These hostages are of no consequence to the war effort. The Muffins know that. They are luring us into a trap.&quot;
JOHNSON: &quot;We can&#39;t just do nothing. General Grimmer, I can take my team in and recover our hostages.&quot;
GRIMMER: &quot;Sargent Kegan is right. This likely is a trap.&quot;
JOHNSON: &quot;We&#39;ve done operations like this before General. We can whatever the Muffins throw at us.&quot;
GRIMMER: &quot;Put together a task force, and take Anderson with you. He&#39;s proven to be a valueable asset.&quot;
JOHNSON: &quot;Yes, sir... Follow me Anderson.&quot;
KESSLER: &quot;That Johnson is very brave.&quot;
GORG: &quot;Very foolish is more like it.&quot;




(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S19.2]]]





MY NOTES:
- Deleted dialogue:
“Three spy planes were shot down flying too low. These are the only aerial photographs we captured of potential targets. It’s impossible to gather detailed information from a distance. We need someone on the inside.”
“Lucky for us, we just so happen to have a reliable and loyal soldier that the Muffins still trust. He’s being hailed in Muffin propaganda papers as a mysterious hero that helped 2 Muffin prisoners escape from Drejnon. He’s our best shot at infiltrating the Muffin Resistance.”
“What do you say soldier? Do you want to do some espionage work for us?”
(If you respond NO:) “Well let’s go over the plan first. Then you can decide.”
GORG: “Alright, sooo… What’s the plan?”
KEGAN: “I have a new plan. Let’s hold off on concentrated outpost assaults. We’ll continue defensive patrols on the front. Some projects we have in development are almost ready for action. In the meantime, you have a simple task, soldier. Infiltrate the Muffin resistance, follow their orders, and gain their trust. When the time comes, we’ll find you.”









SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="32" name="A2-S20" tags="Timeframe_Early" position="1050,1100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 20]
DECEPTION]
&lt;img src=&quot;https://i.imgur.com/57vEdTv.jpg&quot; class=&quot;fitHalf&quot;&gt;
You find yourself on a road full of Muffin refugees, all heading towards a camp. You follow them through the checkpoint. Hector is helping out at the checkpoint. You over hear one Muffin pleading with Hector about something, as another Muffin guard pulls you aside to interrogate you. Before the guard can discover the tracking device on you, Hector intercedes on your behalf. He explains to you about what&#39;s going on with the refugees and what not. Then Hector asks for a favor. He wants you to go get an item that was confiscated from a refugee by Cain’s men. You go and find Cain around his loyal soldiers. Cain has a chat with you. While standing near a large pile of valuables, he explains to you his reason for confiscating certain items. Cain claims allowing any items in is a security breach, and he jokingly says, “You never know what kind of espionage devices someone might bring in here.” He then half-jokingly asks, &quot;Did you bring any espionage devices?&quot; Since Cain remembers you helped him escape from prison, he does you a favor, and agrees to give you back whatever Hector needs. When Cain learns that you want a broken pocket watch back, he tells you that they tossed it in one of the trash cans along the way. After you find the pocket watch, you go back to the checkpoint and give it to the refugee looking for it. The refugee tells you Hector left the camp.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S21]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="33" name="A2-S21" tags="Timeframe_Early" position="1050,1225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 21]
RESISTANCE MEETING]

This is an alternate version of [[A2-S05]]. Most of the beginning half is the same as that scene, but the later half of this scene is different.


&lt;img src=&quot;https://i.imgur.com/nMAc4jZ.jpg&quot; class=&quot;fitHalf&quot;&gt;
The resistance talks about the state of the war. They note how it is strange that the donuts have taken a more defensive posture. There have been no concentrated attacks recently. “This could be the calm before the storm.”
Suddenly, Kane and his men pull up with a convoy of trucks they just stole from donuts. everyone admonishes Kane for attacking a forbidden target it would provoke a strong retaliation. 


&lt;img src=&quot;https://i.imgur.com/w9zARMW.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: I may not have made it clear what happens in the scene. The sabotage bombs still go off just like in scene A2-S05, but... (continue to next note))]
Cain tells everyone to brace for an attack. An attack never comes. Kane is upset that his plan to provoke an attack didn&#39;t work.


&lt;img src=&quot;https://i.imgur.com/2bHE1sM.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: (continued) ...Cain is confused and upset that it didn&#39;t provoke a reaction from the Donuts to launch an attack on them.)]
Kane assumes the nearby donut base is weak and plans to attack now. He wants other members of the resistance to also join but they instead try to talk him down stating they have intelligence suggesting the enemy has heavy armor. Kane goes anyway. You can optionally go with him.
If you go, you encounter heavy donut defenses. There is some fierce fighting but eventually donut tanks roll up and force you to retreat. Other resistance fighters help in the retreat, but Cain still loses a lot of his men.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S22.1]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="34" name="A2-S22.1" tags="Timeframe_Early" position="1050,1350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 22.1]
SIM LABS HIRES LUDWIG]

You are at a temporary facility in the city of blueberry bulge. There is a board of scientific looking muffins interviewing individual muffins for some sort of job application. The next applicant to come in is Professor Ludwig. Ludwig goes on an eccentric rant about his achievements and explains why he wants to trademark everything he does after other scientists stole credit for his work. A member of the board explains the purpose of Sim labs is not just to create accurate simulations for the civilian sector. It is to create simulation so accurate they can be used for military espionage. for this they need to create an accurate simulation of the past. Ludwig says, “Yes I understand. Simulate the past. Predict the future. Simple enough.” One board member comments how nice that sounds, and proposes their slogan should be: “Simulate the past. Predict the future.” Ludwig insists that that is trademarked. Everyone is befuddled but they go along with it.
They switch topics to test subjects. Ludwig asks if they have muffin or doughnut test subjects. Perhaps criminals or prisoners of war. The board says they just have volunteers but are working on artificial test subjects. They direct their attention to the glass container you are in along with other test subject model mock ups.


&lt;img src=&quot;https://i.imgur.com/lubhLbi.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: I&#39;m not sure how I want this scene to be yet. I was originally imagining you were in the same glass container as the other 3 different model test subjects and you were just able to watch and listen to Ludwig&#39;s job interview. But maybe you can just be in a room like you drew with one-way glass where you can watch the interview from that side. Then, near the end of that interview, they all walk in to the room You are in to check out the test subjects.)]
They say there are three but you are the fourth, so there is some confusion why there are four. Ludwig comments on you being the best design for his experiments.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S22.2]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="35" name="A2-S23" tags="Timeframe_Modern" position="1050,1600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 23]
THE SECRET PLAN]

You have been extracted by Kegan and his secret project. Kegan wants to show you something. He takes you outside and offers you welders goggles. Kegan says it&#39;s time for a new phase of the war.


&lt;img src=&quot;https://i.imgur.com/mcZu3Vs.jpg&quot; class=&quot;fitHalf&quot;&gt;
Then, a nuclear explosion goes off in the distance. Some of the donuts all around including Gorg cheer. Grimmer is noticeably absent.
As Kegan is explaining the plan, some donuts nearby are loading up a big bomb and a giant crate and then the crate in a big truck and then the truck is covered with some “MEDICAL SUPPLY” stickers. The plan is to have you drive that truck into the middle of a muffin resistance outpost. There it will be detonated, destroying a majority of Muffin resistance leadership.
At the same time, donut forces will begin concentrated attacks on muffin outpost to draw out and destroy remaining enemies.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S24]]]



NOTES:
- Before showing you the Nuke, you are shown the new machine gun DLL soldiers are being issued.
- Between the time the nuke detonates and the blast wave reaches the base this happens. Some donut scientist brings up some quote from the Muffin Sacred Scripture. He explains how the nuke reminds him of some quote about a prince or something.
The other scientists admonish him, saying why would they know something about the Muffin Sacred Scripture. They obviously don&#39;t read that. Then, Sargent Keegan repeats the quote from his memory: &quot;Now I am become death, destroyer of worlds.&quot;
Scientist: &quot;Yes, that&#39;s it! That&#39;s the quote--&quot; Before he finishes his sentence, the blast wave reaches everyone, knocking many Donuts off their feet.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="36" name="A2-S24" tags="Timeframe_Modern" position="1050,1725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 24]
DECISION]
&lt;img src=&quot;https://i.imgur.com/1HEusAJ.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are driving the truck towards the Muffin outpost. You are cleared in by the outpost security. Hector and Kane are having an argument about something. Cain takes his men and they leave. you have a conversation with Hector where he airs out some of his grievances regarding Kane. He thanks you for bringing in a truck of medical supplies, and tells you they don&#39;t need any more at this outpost. He tells you, you can drive the truck to a remote supply site for excess surplus storage. Or you could just leave the truck there and they will take care of it tomorrow.
This point in the game is where the story diverges into the GOOD path and the BAD path.

(align:&quot;==&gt;&quot;)[[[Nuke the Camp (Bad Path) and Remove Simulator...|The Bad Path]]]

(align:&quot;==&gt;&quot;)[[[Don&#39;t Nuke the Camp (Good Path) and Remove Simulator...|The Good Path]]]


NOTES:
- Cain takes the new shipment of machine guns for their next attack in the north.


SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="37" name="A2-S25-G" tags="Timeframe_Modern" position="1175,1975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 25-G]
MYSTERIOUS EXPLOSION]

In the beginning of this scene, Gorg finds you and interegates you briefly about missing the target. Kegan comes in and says now is not the time for that, and that Grimmer is having a meeting.

There is commotion around the Donut base, almost a panic, as everyone prepares on high alert following news of a recent explosion.
Grimmer asks to be briefed on this new explosion by his top commanders, along with Sergeant Kegan, who&#39;s brought in as an expert. Despite knowing that he&#39;s lying, Kegan explains to the high command that the rumored explosion is likely the result of a new superweapon the Muffins are testing. Kegan highlights two key figures of the Muffin resistance, Cain and Hector, who are high-value targets to be killed or captured, saying they are responsible for developing this new superweapon. Gorg proposes another large-scale attack, similar to the previous failed one he launched, on Muffin camps where Hector and Cain are suspected to be. This proposal is quickly shot down. Instead, Grimmer proposes two covert raids on Cain and Hector&#39;s locations. 


&lt;img src=&quot;https://i.imgur.com/jU4R1m6.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Wrong hat on General Grimmer.)]
Kegan offers his men to lead the raid on Cain. Grimmer appoints Johnson to lead the raid on Hector. The final event in this scene occurs when Grimmer asks, &quot;Now, what&#39;s the situation on the battlefield?&quot; General Zimar responds, &quot;There&#39;s fierce enemy attacks on the southern front, but after reallocating some troops from the North, we are able to hold the line quite easily.&quot; Grimmer questions back, &quot;Easily? Tell me more about the northern front. Where is our weakest point?&quot; Zimar says, &quot;That would be here, General, but we&#39;ve never experienced an attack from the Frost Peaks. Hardly any Muffins live in that region.&quot; Grimmer orders, &quot;Send reserves closer to the north, so we can respond, just in case.&quot; Zimar begins to protest, &quot;But sir—&quot; Kegan interjects, &quot;He&#39;s right. The north is where I&#39;d attack if I were a Muffin. We&#39;ll deploy our new aircraft in the area.&quot; Gorg asks, &quot;Aircraft? What new aircraft?&quot; This simulation ends, and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S26-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="38" name="A2-S25-B" tags="Timeframe_Modern" position="1050,1975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 25-B]
CAIN TAKES POWER]

You are in the Muffin chamber of assembly in Blueberry Bulge. There is outrage and commotion all over.
MUFFIN POLITICIAN A: “Calm down everyone. I understand this situation is tragic. But let’s not overreact.”
MUFFIN POLITICIAN B: “Let’s not overreact?! Muffins not overreacting is what got us to this point. Did we overreact when the Donuts invaded and stole our lands? Did we overreact when Donuts expelled Muffins from all their cities? Did we overreact when Donuts continued their expansion and expulsion of Muffins? This city has always capitulated and tried to avoid war with the Donuts. But there’s no avoiding war after what the Donuts have done. Mark my words, if you all keep cowering and thinking you’re safe in this city from the front, the Donuts will come for you eventually. And then it will be too late. I say now is the time we overreact!”
Cheers erupt in the chamber. Cain and his men then barge into the chamber. The chamber grows quiet.


&lt;img src=&quot;https://i.imgur.com/vGHe2lZ.jpg&quot; class=&quot;fitHalf&quot;&gt;
Winston, Cain&#39;s right hand man, gives an impassion speech and announces that Cain is now in control of the muffin resistance. He has new plans for total war.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S26-B]]]



MY NOTES:
- Winston bestows honors among the dead leaders of the Muffin resistance. &quot;Marcus the feirce.&quot; &quot;James the ever wise.&quot; &quot;Hector the most noble Muffin.&quot; Then he mentions one more honorable leader &quot;But all is not lost. There is still a leader among us. A leader that is noble like Hector, as fiercesome as Marcus, and with the cunning wisdom James. A brave, fearless man that doesn&#39;t lead war from the rear. Unlike all of you, he risks his life for the benifit of all Muffins on the very front. He is always the first in the fight against our oppressors. Who here can claim they have done the same? Not one. But above all that, this leader upholds the righteous values of our sacred texts. The foundation of our great Muffin traditions. A foundation which Donuts seek to eradicate from the world. But he will not allow that to happen, for he is righteousness! Cain the righteous!&quot;
The chamber thunders in deafening applause. Cain takes in the moment allowing the very long applause to settle. Cain speaks: &quot;You do not have to address me as Cain the Righteous. Your righteousness will do perfectly fine.&quot; Cain grins. The crowd chuckles. Cain&#39;s grin fades. &quot;I&#39;m serious.&quot; The crowd quites. Cain continues: &quot;In this painful chapter of our history, it is most wise to consult our sacred texts for guidence. Chapter 4 Verse 89, &#39;Seize them and kill them wherever you find them, and do not take any of them as allies or helpers.&#39; I assure you, that is the full context. We have already verified. There&#39;s no need to study this verse yourself. It is very clear. Seize the Donuts and kill them all, and do not transgress against our sacred texts by attempting to make allies with any Donuts. They are all enemies down to the last. Donuts see our young Muffins not as innocent sweets. In the eyes of Donuts, our kind are savages, vermen, nothing more than ticking time bombs with an insatiable thirst for killing Donuts. That is, of course, not what we are, but if that&#39;s what Donuts want us to be, I say we give it to them.&quot;
The chamber errupts with even more applause. Through the applause Cain yells: &quot;The time has come for total war! The time has come to kill them all.&quot;
The crowd repeatedly chants: &quot;Total war. Kill them all.&quot;
During the chant the simulation glitches.




SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="39" name="A2-S26-G" tags="Timeframe_Modern" position="1175,2100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 26-G]
FROST PEAK ASSAULT]

This is an alternate version of [[A2-S08]]. This whole scene is almost identical except for the ending.


&lt;img src=&quot;https://i.imgur.com/G08OoyH.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are in a frosty environment. A Donut compound is in the near distance. Cain and his men of the Sacred Knights are ready to attack, along with a force of native Frost Peak Muffin gorilla fighters. Cain hands out a new type of gun called a machine gun. Cain tells everyone to take no prisoners. A native commander replies to Cain that is not their way, and they will protect prisoners who surrender. Cain gets angry and goes off on the native commander. 


&lt;img src=&quot;https://i.imgur.com/dWGc1uo.jpg&quot; class=&quot;fitHalf&quot;&gt;
While Cain admires the native Frost Peak Muffins as legendary warriors, he then reminds them of what war is really like and the extensive experience of the Sacred Knights. Native commander falls in line, but asks one more question. &quot;What about Hector&#39;s message to the resistance? To protect those who do not fight?&quot; Cain replies, &quot;Hector is a fool. He does not know war.&quot; Cain commences the attack on the Donut compound. You join in the attack. It&#39;s initially successful, but soon comes under bombardment from the sky.


&lt;img src=&quot;https://i.imgur.com/Ghrlhup.jpg&quot; class=&quot;fitHalf&quot;&gt;
No one seems to know where the bombs are coming from. The attack is called off and the Muffins retreat North into the Frost Peak region, taking heavy casualties.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S27-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="40" name="A2-S26-B" tags="Timeframe_Modern" position="1050,2100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 26-B]
WAR MACHINE / POWER OVERWHELMING]

You return to the top secret Donut military base know as Facility X. After proving your loyalty to the Donuts through your actions destroying the Muffin camp, you are transformed into a powerful war machine in Kegan&#39;s latest top secret project. 


&lt;img src=&quot;https://i.imgur.com/BjpSnoa.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are heavily armored and carry a large caliber auto-cannon by default. Under the leadership of Gorg and his closest advisor Sergeant Kegan, the war intensifies.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S27-B]]]



MY NOTES:
- In this scene, somewhere, it is revealed that they are working on developing more nuclear bombs. And that it is difficult to carry these big bombs in airplanes, and to drop them deep within muffin territory because of the Muffins&#39; strong air defenses.




SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="41" name="The Bad Path" tags="" position="1050,1850" size="100,100">|specialtitle&gt;[(text-style:&quot;underline&quot;)[The Bad Path]
(text-size:5)[...still Act 2]]

(align:&quot;==&gt;&quot;)[[[Continue...|A2-S25-B]]]



MY NOTES:
		BAD PATH
There&#39;s a point in Act 2 where you are tasked with putting a nuclear bomb device inside a muffin camp, where key figures of the resistance are headquartered, including Hector. When inside the camp, you are faced with the choice to leave the nuke in the camp, or send it far away to a remote location to explode.
If you leave the nuke in the camp, you essentially chose the &quot;bad&quot; path. Hector is dead. General Grimmer is sidelined. And only the extremists are in control on both sides of the war. Those are Cain on the muffin side, and Sergeant Kegan and Commander Gorg on the donut side.


After proving your loyalty to the Donuts through your actions destroying the Muffin camp, you are transformed into a powerful war machine in Kegan&#39;s latest top secret project. Under the leadership of Gorg and his closest advisor Sergeant Kegan, the war intensifies. You are deployed in many capacities to help decimate Muffin resistance. All the while there is an internal struggle amongst donuts. There are anti-war Donuts and still some donuts who think the war is being waged with too much indiscriminate violence against Muffins. That is until a coup is launched on the Capital and all non-pro war Donut politicians are purged in a massacre. Gorg declares himself King Gorg and establishes the New Donut Order (or NDO). Your war machine body is upgraded further for your actions against the &quot;weak and treacherous politicians&quot;.



There are several more developments along this course of the &quot;bad&quot; path story. I will mention a few of these developments briefly:
1. Cain vows to escalate the war even further against Donuts by launching indiscriminate attacks deep within Donut lands. Some missions you&#39;re on include responding to some of these attacks directly and neutralizing threats, and also reciprocating with indiscriminate attacks against muffins.
2. There is also a Donut counter-coup attempt against the NDO led by General Grimmer. Grimmer fails and is executed for his &quot;treachery&quot;. 
3. Donut holes, a much maligned sub-race of Donuts, stage a revolt against their increasing discrimination from the NDO. The NDO uses this as an excuse to begin an extermination campaign against donut holes.
4. Kegan learns of a new secret project by muffins to build a super weapon. A simulation that can be used to gather intelligence and counter any military action. Kegan wants this power for himself so he organizes a raid to capture the lead scientist involved, Professor Ludwig.







</tw-passagedata><tw-passagedata pid="42" name="The Good Path" tags="" position="1175,1850" size="100,100">|specialtitle&gt;[(text-style:&quot;underline&quot;)[The Good Path]
(text-size:5)[...still Act 2]]

(align:&quot;==&gt;&quot;)[[[Continue...|A2-S25-G]]]



MY NOTES:
Here&#39;s my thoughts on how the &quot;good&quot; path could go:
As you know, there&#39;s a point in Act 2 where you are tasked to put a nuclear bomb device inside a muffin camp, where key figures of the resistance are headquartered, including Hector. When inside the camp, you are faced with the choice to leave the nuke in the camp, or send it far away to a remote location to explode.

If you put the nuke device on a truck that&#39;s going to be driven far away to a remote storage location, you essentially chose the &quot;good&quot; path. No main characters are dead. Rumors of a massive explosion, the likes of which have never been seen, spread far and wide.
</tw-passagedata><tw-passagedata pid="43" name="A2-S27-B" tags="Timeframe_Modern" position="1050,2225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 27-B]
LIQUIDATION]
&lt;img src=&quot;https://i.imgur.com/dTIBW3d.jpg&quot; class=&quot;fitHalf&quot;&gt;
As a test of your new powers, you are sent to an ahnialated Muffin camp to eliminate any survivers.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S28-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="44" name="A2-S28-B" tags="Timeframe_Modern" position="1050,2350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 28-B]
CALIBRATING]

You return to Facility X. Sergant Kegan and some Donut scientists examine you after the mission, they make some improvements to you by giving you the new ability to _____. There&#39;s some comotion outside. A soilder interrupts Kegan and tells him Commander Gorg wants to see him. You and Kegan go to Gorg&#39;s office.
Gorg is on the phone irrate about being order to ceasefire by the Donut government. He hangs up and complains to you and Kegan about this.


&lt;img src=&quot;https://i.imgur.com/NtMEU7r.jpg&quot; class=&quot;fitHalf&quot;&gt;
GORG: Fudge! Fudging fudge! They want us to stop the offensive. They think we are being too mean to the savage Muffins. These weak and pathetic Donut politicians just don&#39;t get it. We have the upper hand, but if we don&#39;t finish the job now, the savages will regroup, and all Donuts will become vulnerable to attacks. Is that what those treacherous fudgebuckets want?!
KEGAN: The majority of Donut politicains have never seen the frontlines. They simply don&#39;t understand the necessities of war.
GORG: Perhaps we should make them understand.
KEGAN: (short pause) Understood.

You and Kegan leave the room. Kegan calls a few Donut generals in the war room to explain the new ceasefire order. He recommends Donut forces to be reallocated from certain regions to bolster the frontlines. The regions being evacuated leaves a clear security void of the map around certain areas. The Donut generals catch on to what&#39;s happening.

DONUT GENERAL A: What about these areas of the city? Why keep forces there?
DONUT GENERAL B: You must not be familiar with the area. Those are strong segregationist regions. While these are majority assimilationist regions that just love being bombed by Muffins.
KEGAN: General, that is not the reason. We simply don&#39;t have enough soldier holding the line. That&#39;s why we are reallocating these forces. Do you understand?
DONUT GENERAL B: Yes general... I mean sergeant. Are you still only a sergeant?

Kegan does an intimidating stare for a second and the general is nervous for asking a potentially insulting question. Kegan then informs the room of you and your special upgrades. He also explains that the Muffins still don&#39;t know that you are a Donut agent and explains that you will be going back undercover again to help the Muffins until you are needed.


(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S29-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="45" name="A2-S29-B" tags="Timeframe_Modern" position="1050,2475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 29-B]
TREACHERY]

You are back with the muffin resistance, but of course, it is controlled by Cain now. Cain notices your upgrades and compliments them.
Then he has a discussion with other muffin resistance fighters that review the map saying it doesn&#39;t make sense why the donuts are leaving these areas wide open to attacks. They are worried it may be a trap.
Cain reassures everyone that his tacticians have already thought everything through and that their attack on Donuts will be successful, even if donuts try to surround them.
You help in the attack.


&lt;img src=&quot;https://i.imgur.com/ePK6Sjj.jpg&quot; class=&quot;fitHalf&quot;&gt;
You initially encounter light resistance with donut police forces and then proceed to kill many innocent donuts before the Donut military shows up and repels the attack.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S30-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="46" name="A2-S30-B" tags="Timeframe_Modern" position="1050,2600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 30-B]
OUTRAGE]
&lt;img src=&quot;https://i.imgur.com/fAW26M8.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are back with Kegan and Gorg. There is outrage outside the congress directed against the assimilationist Donuts.
 in this scene, you meet general Grimmer after a long time of not seeing him. He argues that forces should not have been ordered out of those areas. He accuses Korg and other generals of subverting his command. Grimmer also explains the importance of the cease-fire. Commander Gorg fires back drawing attention to the ceasefire policy being the cause of the devastating attack. In the end, there is a split vote on whether to end the cease fire. Donut Society is divided on who to follow. But Kegan and Gorg have gotten what they wanted and have now gained enough support for the next phase in their plan. 
Because the vote is split, the ceasefire holds and congress asks General Grimmer what should be done. Grimmer gives the assessment that donut territories can be secured if donut forces pull back to more defensible positions, and Donuts should offer terms to the Muffins to end the war from a position of strength. 
Grimmer is asked the difficult question of why would the muffins except anything from donuts after everything they&#39;ve done to them. Grimmer has no good answer, but he outlines the alternative of continuing the war until no muffins are left. &quot;What&#39;s wrong with that?&quot; one Donut remarks to a chorus of chuckles. Grimmer responds, &quot;Don&#39;t  underestimate the enemy. If this war continues, there may be no donuts left either.&quot; Silence from the congress. &quot;I will be returning to the front. We need all hands on deck to establish a security perimeter and conduct targeted assault operations against the muffins who perpetrated the recent attacks on our nation.&quot;

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S31-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="47" name="A2-S31-B" tags="Timeframe_Advanced" position="1050,2725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 31-B]
COUP D&#39;ÉTAT / NEW DONUT ORDER]

Gorg gives a speech to his men about the &quot;weak and treacherous Donut politicians&quot; that need to be eliminated. It&#39;s time for a New Donut Order to take power. The old Donut flags are lowered. The new flags are raised; a red back drop with a black ring Donut super imposed onto a white circle in the center. 


&lt;img src=&quot;https://i.imgur.com/p1q6sF7.jpg&quot; class=&quot;fitHalf&quot;&gt;
The crowd of soldiers roars. A more agressive salute is introduced. Kegan steps to the podium. The crowd quites. 


&lt;img src=&quot;https://i.imgur.com/VKCkyKt.jpg&quot; class=&quot;fitHalf&quot;&gt;
&quot;It&#39;s time.&quot; On that simple order, the soldiers begin to moblize. You are fitted with AR goggles that identify donut politicians to execute during the assault on the Capitol building.


&lt;img src=&quot;https://i.imgur.com/WnU2fBr.jpg&quot; class=&quot;fitHalf&quot;&gt;
A coup is launched on the Donut Capitol by Kegan, his men, and you.


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/n76pUCF.png&quot; class=&quot;fit49&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/b5pBWIJ.png&quot; class=&quot;fit49&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
&lt;img src=&quot;https://i.imgur.com/PydJp1u.jpg&quot; class=&quot;fitHalf&quot;&gt;
After the completing the job, you enter the Congress chamber where commander Gorg and his men have surrounded a group of Donut politicians. He reads a list of donut politicians to be executed. They are taken out of the room one by one where a gunshot can be heard.


&lt;img src=&quot;https://i.imgur.com/rd4sPk6.jpg&quot; class=&quot;fitHalf&quot;&gt;
One of the politicians called out on the list yells, &quot;No! But I voted against the ceasefire!&quot; Gorg replys, &quot;Yeah, well, I just don&#39;t like you.&quot; A shot is heard soon after he is removed.

GROG: I have some more names on my list but I&#39;m willing to grant mercy.
OLD DONUT POLITICIAN: Mercy?! After all that you&#39;ve done?! You&#39;re supposed to be attacking the enemy muffins, not your fellow donuts!
GROG: Oh look, your name is on the list too. (Gorg is writing on his paper.) It&#39;s a shame. I used to like you.
OLD DONUT POLITICIAN: Get your hands off me! You can&#39;t do this to me! Do you know who I am?!
	OLD DONUT POLITICIAN is taken out and shot.
GORG: So... should I grant mercy, or keep reading?
	The crowd of Donut politicians errupt screaming &quot;Mercy!&quot;
GORG: I&#39;m not convinced you want to mercy.
RANDOM DONUT POLITICIAN: Gorg is king!
	The crowd chants &quot;King Gorg!&quot; Gorg has a big grin on his face.
GORG: King Gorg, eh? I can get used to that.

The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S32-B]]]


&lt;img src=&quot;https://i.imgur.com/AdhJu2w.png&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(New Donut Order Flag (not final version))]


NOTES:
- New Donut Assault Rifles are introduced and issued in this scene.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="48" name="A2-S27-G" tags="Timeframe_Modern" position="1175,2225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 27-G]
HVT
EXT - DAY - MUFFIN TOWN]

You are on the raid with Donuts under commander Johnson to capture Hector, an HVT. This mission starts right before your team is going to breach a wall to capture Hector. 


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/EJ3K9I1.png&quot; class=&quot;fit49&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/fg52Tgs.png&quot; class=&quot;fit49&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
Hector is successfully captured.


&lt;img src=&quot;https://i.imgur.com/vUrZRm1.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: It&#39;s just Hector who is captured. Other muffins are either killed or left tied up if they didn&#39;t pose a threat.)]
Now you just have to escape with him. During the raid, Hector sees a new side of donuts. They aren&#39;t indiscriminately killing any muffin. They actually go out of their way to avoid harming muffin civilians. There are some battles with muffin resistance fighters as you and the donuts try to escape. At one point, your teams radios stop working. First, there are radio, jammers. Then your radio man&#39;s radio suddenly catches fire in an obvious sabotage. Now you can&#39;t call for artillery support. Hector decides to make the donuts an offer. He will go with the donuts peacefully to avoid any more dough shed.


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/jvqZz56.png&quot; class=&quot;fit49&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/Y8pJXEf.png&quot; class=&quot;fit49&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
Hector walks out to give a speech informing the muffin resistance fighters of what he is doing. The muffins reluctantly accept Hector&#39;s decision. Everyone puts down their guns in a sign of truce. Just then, artillery shells start raining down everywhere hitting donuts and muffins alike. There&#39;s a scramble as Johnson takes you, the radio man, and Hector to go find a working radio at the top of a Muffin tower. On your way to the tower, a shell hits a nearby building, and Johnson stops to help the muffins inside, telling the rest of you to go on without him. With Hector leading the way, you eventually make it to the top of the tower and find a route working radio that the radio Donut man uses to call off the bombardment. After the bombardment is called off, the muffins are clearly in control, and can take the donuts into custody. But Hector holds true to his promise and still agrees to go with the donuts, but not as a prisoner. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S28-G]]]



SCRIPT DRAFT:

	YOU spawn into JOHNSON’s squad conducting an operation in enemy territory.
JOHNSON.
Is that our target building?
DONUT OP #1.
Ya, that’s the one.
JOHNSON.
McKinney, get breaching charges on those walls.
DONUT OP #2.
On it, sir.
DONUT OP #1.
I have a positive confirmation on HVT 2. Looks like he’s alone.
JOHNSON.
Roger that. Remember, we want him alive. Get ready to breach on my signal.
	JOHNSON give a hand signal.
DONUT OP #2.
Breaching. Stand clear.
	The walls are breached. Hector attempts to reach for a gun but is knocked back and arrested by Donut Ops.

Hector. The Donut Defense League is arresting you for multiple counts of mass murder. 

Am I the only one being arrested for mass murder here?

This room is clear.

I got movement!
	Donut Ops begin firing

No, wait!

Hold your fire! Come out with your hands up.

Please, he’s just my assistant! He’s unarmed.
	A Donut Op puts tape over Hector’s mouth, muffling it.

Get on your knees. Eyes closed. No sudden movements. Keep your hands up!

I can’t. My arm is shot.

Gunther, take care of him.

	HECTOR starts mumbling franticly under the tape.
No, please, no. Don’t kill me. I just deliver stuff. I love the Defense League of Donuts.

It’s the Donut Defense League, not the Defense League of Donuts.
	HECTOR and the Muffin assistant are both confused and the Donut Op starts bandaging his arm.

What are you doing?

Relax.

Alpha team, status report.

This is Alpha. HVT 1 is not at primary target site. We’re moving to secondary target site now.

Negative. Do not move to secondary target site. Go ahead and exfill. We have our target. One is enough, for now.

Roger that. Alpha out.

Let’s go.

Watch it. Enemy up ahead.

Mitchel, call in artillery. Avoid striking the buildings. We don’t want collateral damage on civilians. Everyone, get ready to move once artillery drops.

Sir, there’s a problem with my radio. I can’t get it working.

Can you fix it?

I’m trying.

Alpha, this is Bravo team. We need you to call in artillery. Our radio is down.
Alpha, do you read? Over.

Jammers? Do Muffins have jammers? Do you have radio jammers?
	HECTOR shakes his head no.

Any luck Mitchel?

I-I-I don’t know how this happened. The wires. They exploded. Someone sabotaged my radio. Some Muffin sympathizer, or… or maybe Muffins infiltrated our base?!

No way anyone could infiltrate our base, let alone a Muffin.

We’ll investigate later. Right now, we need to exfill. And the quickest way out is through them. Gunther, move your team up to flank.

On it.

Everyone else, get ready to fire and move.
	First battle.



</tw-passagedata><tw-passagedata pid="49" name="A2-S28-G" tags="Timeframe_Modern" position="1175,2350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 28-G]
ACCORD]
&lt;img src=&quot;https://i.imgur.com/Nu1vS1q.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: The doors are wrong here. These types of doors are only in Sim Labs facilities. Not sure what kind of door should be here. Probably just some standard rectangle sliding door with no distinct silhouette.)]
You are in a room with Grimmer, Johnson, and Gorg, awaiting Hector. When Hector shows up, there is a tense exchange between Gorg and Hector. Grimmer orders Gorg to leave. Hector and Grimmer have a discussion where each of them learns shocking information from each other. They each discover that neither of them know the source of the nuclear explosion. And Grimmer presents Hector with evidence of war crimes committed by Cain and his men. The discussion ends with both Hector and Grimmer having a greater understanding of each other&#39;s intentions. Hector leaves, visibly angered by this revelation of what Cain has done. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S29-G]]]



MY NOTES:
- 










SCRIPT DRAFT:

GORG: &quot;so you&#39;ve finally decided to turn yourself in?&quot;
MUFFIN GUARD: &quot;Watch your insulin tongue! Hector is here of his own accord and free to leave at any moment.&quot;
GORG: &quot;Yeah, we&#39;ll see about that.&quot;
HECTOR: &quot;Do with me what you will. I&#39;m here for the benefit of innocent muffins who&#39;ve suffered in this war.&quot;
GORG: &quot;Innocent muffins? (Scoff.) There&#39;s no such thing. You&#39;re all pathetic savages.&quot;


HECTOR: &quot;What we see in others, is often within ourselves.&quot;
JOHNSON: &quot;I&#39;m surprised your familiar with Donut philosophy.&quot;
HECTOR: &quot;No, I&#39;m not familiar.&quot;
JOHNSON: &quot;Oh. Well that sounds like a quote I&#39;ve heard before.&quot;
HECTOR: &quot;It&#39;s a verse from our sacred texts. &quot;Be mindful of what we see in others. For what we see in others, is often within ourselves.&quot; Though I don&#39;t expect you Donuts to hold our Muffin beliefs in high regard.&quot;

GRIMMER: &quot;What do you see in others, Hector?&quot;
HECTOR: &quot;(Long thinking pause.) I see the desire to do good in others. Some do good by building new great cities for their kinfolk to prosper. Some do good by protecting their land from theft and preserving their way of life. Yes, I see only good in others. Too much good.&quot;
GORG: &quot;You&#39;re not very humble, are you?&quot;
GRIMMER: &quot;So you only see good in others? I&#39;m the senior General of the Donut Defense League, responsible for all operations in this war. Do you not believe anything I did was evil?&quot;
HECTOR: &quot;Do you believe anything you did was evil?&quot;
GRIMMER: &quot;(About to answer but doesn&#39;t.)&quot;
HECTOR: &quot;We only see evil in others, because we judge others by the terrible consequences of their actions. We see only goodness in ourselves, because we judge ourselves by our most benevolent intentions.&quot;
JOHNSON: &quot;Your right. I never thought about it that way. Is that also from your sacred Muffin texts?&quot;
HECTOR: &quot;No, that&#39;s simply an observation of mine.&quot;


GORG: &quot;Alright. Enough already with this philosophical mumbo-jumbo! Give us a list of everyone in charge of the Muffin resistance and where they are hiding.&quot;
HECTOR: &quot;The resistance won&#39;t end by eliminating its leaders. New leaders will rise and lead the resistance for as long as it may take.&quot;
GORG: &quot;You just want this war to go on forever, don&#39;t you? You savage, dough-thirsty Muffin.&quot;
HECTOR: &quot;this is not what I want. This is only my honest assessment. I would rather you Donuts have never invaded. I would rather Muffins not have a need for a resistance.&quot;
GORG: “Oh, don&#39;t worry. We will make sure there&#39;s no need for a muffin resistance very soon.&quot;
GRIMMER: &quot;Commander Gorg?&quot;
GORG: &quot;Yes sir?&quot;
GRIMMER: &quot;Your talents are better suited elsewhere. Not this low level diplomacy.&quot;
GORG: &quot;Your right sir. I have more important things to do than waste my time in the presence of muffins. Especially ones I&#39;m not killing.&quot;
GRIMMER: &quot;I apologize for Commander Gorg. He&#39;s seen a lot of what Muffins have done to Donuts. We both have. After your capture, we were initially going to put you on trial for war crimes, then have you executed. But since you&#39;re here of your own accord, I have to ask, why? Why come here?&quot;
HECTOR: &quot;I&#39;m worried about this war. It&#39;s escalating further than I could have imagined. Have you heard the news? There was an explosion on our lands not too long ago. A massive explosion, the likes of which have never been seen. I must warn you, if you plan to use such a destructive weapon on Muffins, you will only serve to make the resistance increasingly radical, and beyond any sensible leader&#39;s influence, including my own.&quot;
GRIMMER: &quot;That&#39;s interesting. I was going to ask you about that explosion. Analyzing reconnaissance photos, it looks like your facility, disguised as so-called aid supplies, could not have housed enough conventional explosives for the damage done. There also doesn&#39;t seem to be any areas underground. So what is it your building? What kind of weapon is this? And don&#39;t play dumb with me.&quot;
HECTOR: &quot;While I have no intention of revealing our secrets, General Grimmer, I can assure you, the resistance has no desire for such a weapon. And if we did have such a weapon, why would we decimate our own aid supplies?&quot;
GRIMMER: &quot;if we had that weapon, why would we waste it blowing up your so-called aid supplies?&quot;
HECTOR: &quot;(Long thinking pause.) There is admittedly a more radical faction of the resistance that operates autonomously. Perhaps you&#39;ve heard of the Sacred Knights?&quot;
GRIMMER: &quot;Who hasn&#39;t?&quot;


HECTOR: &quot;The Sacred Knights are led by a close friend of mine, Cain. At least, we used to be close. Much of what Cain does, I have no knowledge of. However, even if he wanted to, I do not believe he has the resources to develop such a devastating weapon.&quot;
GRIMMER: &quot;Anderson, you know the Muffins better than any Donut does. What do you think? Are Muffins capable of building this devastating weapon?&quot;

(YES) HECTOR: &quot;Then you have seen things I have not seen.&quot;
GRIMMER: &quot;Perhaps you should look into your close friend, Cain. Do you trust him?&quot;

(NO) GRIMMER: &quot;Well. It&#39;s a real mystery where that explosion came from.&quot;
HECTOR: &quot;Have you examined your own subordinates? What makes you so sure Donuts are not the ones responsible?&quot;
GRIMMER: &quot;Perhaps it would do both of us good to investigate everyone we trust.&quot;
HECTOR: &quot;Duly noted.&quot;
GRIMMER: &quot;Do you trust Cain?&quot;

HECTOR: “Cain is not exactly the most polite individual. But he is a devote follower of our Sacred Texts. I trust he adheres to its values.”
GRIMMER: “That is unfortunate.”
HECTOR: “what do you mean?”
GRIMMER: “the violence in your sacred texts. It’s unfortunate you Muffins still choose to follow this violent ideology.”
HECTOR: “yes, there are calls to fight against aggressors. Is that not reasonable to you?”

GRIMMER: “I happen to have a copy of your sacred texts right here. On the topic of war, it says, and I quote, &#39;Seize them and kill them wherever you find them.&#39; That sounds like a call kill everyone. Men, women, and children. Is that part of your values?&quot;



HECTOR: &quot;How typical it is for you Donuts to misinterpret our sacred texts, even when the answer is right under your nose.”
GRIMMER: &quot;&#39;Seize them and kill them wherever you find them.&#39; It doesn’t get much clearer than that.”
HECTOR: “Read the very next verse.&quot;


GRIMMER: ”’Except for those who seek refuge from fighting you or fighting their own kin. If they do not fight you and offer you peace, then you are not permit to harm them.’”

HECTOR: “Our sacred texts are quite clear on the topic of war.”
GRIMMER: &quot;I don&#39;t know about clear. That can mean anything.&quot;
HECTOR: ”There&#39;s a strong consensus among Muffin scholars who&#39;ve studied this matter. It is not permitted to attack anyone who does not fight. That goes for enemy soldiers as well. Cain and all Sacred Knights are devoted followers of our sacred texts.&quot;
HECTOR: ”Nevertheless, Cain is very aggressive. I’ve advised him to treat captured Donut soldiers with more respect. But if you mean to compare the treatment of Donut soldiers who surrender in the heat of battle, to all your war crimes committed against innocent Muffins, then you are surely not grounded in reality.&quot;
GRIMMER: &quot;We have no issue with Muffins killing our soldiers who surrender. We take issue with Muffins killing Donut civilians.&quot;
HECTOR: ”The resistance has always condemned such attacks against innocent Donuts. It&#39;s impossible to control the actions of every deranged individual Muffin acting on their own initiative.&quot;
GRIMMER: ”I wouldn&#39;t be so sure they were &#39;acting on their own initiative&#39;. After all, your Sacred Knights have no problem massacring entire Donut settlements.&quot;
HECTOR: &quot;Surely you know that is all war propaganda. I do not believe a word of your lying press.&quot;
GRIMMER: &quot;Would you believe your lying eyes? These images are too graphic for our news stations to publish. You&#39;ll never see them outside of here.&quot;
HECTOR: &quot;I don&#39;t understand. What is this?!&quot;
GRIMMER: &quot;This is what your resistance does, Hector. This is what you stand for. This is what you’re protecting.&quot;
HECTOR: “I can’t believe it. How do you know these images aren’t staged or doctored?”
GRIMMER: “I was there. That&#39;s far from the only massacre Muffins committed.&quot;
MUFFIN GUARD: &quot;I remember that day we read the Donut propaganda papers. About the valley. Cain told us it was all lies. He said it was only enemies occupying the valley. He said the Sacred Knights would never harm an innocent donut. And then he joked that, no Donuts are innocent anyway.&quot;
HECTOR: &quot;(Visibly angry. Walks out of room.)&quot;
MUFFIN GUARD: &quot;Wait a second. Hector, I don&#39;t think Cain was joking.&quot;
This simulation ends and you remove your simulator headset.
















</tw-passagedata><tw-passagedata pid="50" name="A2-S29-G" tags="Timeframe_Modern" position="1175,2475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 29-G]
CONFRONTATION]

You are in a camp with Cain and the sacred knights. They are getting ready for a raid on a donut settlement. You are ordered by Cain to help his men load up equipment. After doing some labor, Hector shows up to confront Cain.


&lt;img src=&quot;https://i.imgur.com/tcIGKK7.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: I was imagining Hector and Cain arguing on a slightly raised platform so that it would feel more dramatic. Sort of like they&#39;re on a stage with the Sacred Knights fighters off stage as the audience. (You could be on the platform with Hector and Cain.) They&#39;re just has to be a natural reason for this platform to be there. Maybe it&#39;s like an elevated wooden loading dock to help load supplies onto trucks.)]
They have a heated discussion in front of the soldiers of the sacred knights. The discussion is about Cain&#39;s war crimes. While Cain&#39;s not noticeably transformed by the discussion, he does decide to call off the raid. Of course, he makes up an excuse like it&#39;s getting late so that he doesn&#39;t seem soft to his men. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S30-G]]]





MY NOTES:
- 









SCRIPT DRAFT:

|name&gt;[HECTOR]
|dialogue&gt;[Cain!]

|name&gt;[CAIN]
|dialogue&gt;[Hector! So good to see you again. Back from your visit with Donuts so soon. Curious why they allowed you leave.]

|name&gt;[HECTOR]
|dialogue&gt;[You lied to me! You lied to all of us!]

|name&gt;[CAIN]
|dialogue&gt;[Scoff. What’s this about?]

|name&gt;[HECTOR]
|dialogue&gt;[At the valley. You massacred innocent donuts. You couldn’t even spare the women and children. Who else knew about this?! (Some hands raise, timidly.) And you call yourselves the Sacred Knights as you dishonor everything Muffins hold sacred.]

|name&gt;[CAIN]
|dialogue&gt;[Whoa whoa. Calm down, Hector. Calm down. It would seem you had your mind twisted somehow. We didn’t kill any innocent Donuts at the valley. We killed only invaders of our sacred Muffin lands. If Donuts want to be innocent, they have the choice to go back to their filthy Donut lands.]

|name&gt;[HECTOR]
|dialogue&gt;[And what of the children? For what crimes were they killed? What choice did they have?]

|name&gt;[CAIN]
|dialogue&gt;[Takes some time to get more serious as the crowd quiets to listen closely. Yes Hector. What choice did the children have, when the donuts sent their guns, their tanks, their bombs? Do you not care about those countless numbers of Muffin children?]

|name&gt;[HECTOR]
|dialogue&gt;[Do I not care? That’s why I– That’s why WE joined the resistance. We don’t fight to unwontedly kill Donuts. We fight to protect Muffins.]

|name&gt;[CAIN]
|dialogue&gt;[Scoff. Who is we? You haven’t been doing much of the fighting at all, Hector. You just hide behind with all the women and children refugees, like a coward. What is it you even do all day? Absolutely nothing.]

|name&gt;[SK FIGHTER]
|dialogue&gt;[Actually, Cain, I mean your righteousness. I must defend Hector. He’s the reason I was able to join the sacred knights. You see, Hector is looking after my aging mother who needs two shots of glucose twice a day to manage her–]

|name&gt;[CAIN]
|dialogue&gt;[Silence!]

|name&gt;[HECTOR]
|dialogue&gt;[Righteousness?]

|name&gt;[CAIN]
|dialogue&gt;[Shut up. I’m trying something new, okay.]

|name&gt;[HECTOR]
|dialogue&gt;[Cain. Look at yourself. This isn’t who you really are. I remember you. Yes, you’ve always been a bit… abrasive. But more than that, you were a protecter for those who could not protect themselves. When we where children, you fearlessly stood up to bullies twice your size. Not for your own sake, but out of compassion for others. And I must say, those bullies quickly learned not to challenge you.]

|name&gt;[CAIN]
|dialogue&gt;[Big smile. Yes they did.]

|name&gt;[HECTOR]
|dialogue&gt;[Have you lost your compassion for the innocent? For those you once protected? For your own mother?]

|name&gt;[CAIN]
|dialogue&gt;[I have not lost any compassion. I have more compassion than everyone. EVERYONE! You don’t understand this Hector, but to destroy a monster, it takes a bigger monster. Since the Donuts invaded, I waited for that monster to save us. I waited through the execution of my father, in front of our own home that they stole. I waited growing up in squalor at refugee camps. I waited for a monster to defend Muffinville, the only place my mother found any solace, until it was pillaged and raised to the ground. No Muffin was willing to become that monster that we so desperately needed, so I BECAME THAT MONSTER! I WILL DESTROY THE ENEMY! I WILL MAKE THEM UNDERSTAND HOW IT FEELS BENEATH THE FOOT OF AN OPPRESSOR!]

|name&gt;[HECTOR]
|dialogue&gt;[You can’t see it, can you? You’re becoming what you most hate.]

|name&gt;[CAIN]
|dialogue&gt;[This is who I’ve always been, Hector. I have never started anything. But I always been the finisher. Donuts chose to fight this way. Not us. Until they relent, we will not back down from their challenge.]

|name&gt;[HECTOR]
|dialogue&gt;[Cain, this is madness.]

|name&gt;[CAIN]
|dialogue&gt;[Madness? This is war, Hector. WARRR!]

|name&gt;[HECTOR]
|dialogue&gt;[There’s simply no good reason to attack Donuts who are unable to fight.]

|name&gt;[CAIN]
|dialogue&gt;[Sure there is. It distracts the enemy, spreads their resources thinly, and keeps all Donuts in a perpetual state of fear. It’s exhausting to live in fear. Trust me, Donuts will not last long. They must give in soon.]

|name&gt;[HECTOR]
|dialogue&gt;[Listen to yourself. You are justifying the killing of children. Can’t you see you are gripped by this war fever?]

|name&gt;[CAIN]
|dialogue&gt;[What I can SEE, is that you seem to care more about donuts, than you do about muffins.]

|name&gt;[HECTOR]
|dialogue&gt;[I care about those who are good. Whether they be Muffins or Donuts.]

|action&gt;[Crowd gasps.]

|name&gt;[CAIN]
|dialogue&gt;[Smug smile. We know you met with donuts in their so-called New Arc City. A city built on our stolen Muffin lands, mind you. I wonder what they put in your head. What did they put in your head? Some sort of mind control device?]

|action&gt;[Crowd laughs. Hector pulls out a book to read from.]

|name&gt;[HECTOR]
|dialogue&gt;[Each of you took an oath when you joined the Sacred Knights. You swore to uphold the values of our sacred scripture. In chapter 3, we are told: “Do not say to others follow me alone. Rather, say onto others, be yourselves humble scholors of scripture because of what you have taught and what you have studied.” This verse teaches us not to blindly follow a leader. It is incumbent on each of us to study the wisdom of our sacred scripture and to share what we learn with one another.
If you believe I came here condemn anyone for harboring hatred against Donuts, you are mistaken. I understand hatred. Donuts took everything from me. They took everything from many of us. Scripture does not forbid hatred. It forbids injustice: “Do not let hatred prevent you from being just.“ And for those of you who believe it is justice to punish an innocent Donut for the crimes of another, please allow me to read verses from sacred scripture that you might ponder. “Whoever commits evil only earns it against oneself.” “No bearer of burdens shall bear the burden of another.” “Every soul earns no blame except against itself.” “Whoever does a good deed, it is for oneself–”]

|name&gt;[CAIN]
|dialogue&gt;[Alright. Enough with the sermon. This isn’t a sanctuary. Your point has been made. I’ll think about what you said. Just don’t forget whose side you’re on in this war, Hector.]

























HECTOR: Cain! 
CAIN: Hector! So good to see you again. Back from your visit with Donuts so soon. Curious why they allowed you leave.
HECTOR: You lied to me! You lied to all of us!
CAIN: (Scoff.) What&#39;s this about?
HECTOR: At the valley. You massacred innocent donuts. You couldn&#39;t even spare the women and children. Who else knew about this?! (Some hands raise, timidly.) And you call yourselves the Sacred Knights as you dishonor everything Muffins hold sacred.
CAIN: Whoa whoa. Calm down, Hector. Calm down. It would seem you had your mind twisted somehow. We didn&#39;t kill any innocent Donuts at the valley. We killed only invaders of our sacred Muffin lands. If Donuts want to be innocent, they have the choice to go back to their filthy Donut lands.
HECTOR: And what of the children? For what crimes were they killed? What choice did they have?
CAIN: (Takes some time to get more serious as the crowd quiets to listen closely.) Yes Hector. What choice did the children have, when the donuts sent their guns, their tanks, their bombs? Do you not care about those countless numbers of Muffin children?
HECTOR: Do I not care? That&#39;s why I-- That&#39;s why WE joined the resistance. We don&#39;t fight to unwontedly kill Donuts. We fight to protect Muffins.
CAIN: (Scoff.) Who is we? You haven&#39;t been doing much of the fighting at all, Hector. You just hide behind with all the women and children refugees, like a coward. What is it you even do all day? Absolutely nothing.
SK FIGHTER: Actually, Cain, I mean your righteousness. I must defend Hector. He&#39;s the reason I was able to join the sacred knights. You see, Hector is looking after my aging mother who needs two shots of glucose twice a day to manage her--
CAIN: Silence!
HECTOR: Righteousness?
CAIN: Shut up. I&#39;m trying something new, okay.
HECTOR: Cain. Look at yourself. This isn&#39;t who you really are. I remember you. Yes, you&#39;ve always been a bit... abrasive. But more than that, you were a protecter for those who could not protect themselves. When we where children, you fearlessly stood up to bullies twice your size. Not for your own sake, but out of compassion for others. And I must say, those bullies quickly learned not to challenge you.
CAIN: (Big smile.) Yes they did.
HECTOR: Have you lost your compassion for the innocent? For those you once protected? For your own mother?
CAIN: I have not lost any compassion. I have more compassion than everyone. EVERYONE! You don’t understand this Hector, but to destroy a monster, it takes a bigger monster. Since the Donuts invaded, I waited for that monster to save us. I waited through the execution of my father, in front of our own home that they stole. I waited growing up in squalor at refugee camps. I waited for a monster to defend Muffinville, the only place my mother found any peace, from being pillaged and raised to the ground. No Muffin was willing to become that monster, so I BECAME THAT MONSTER! I WILL DESTROY THE ENEMY! I WILL MAKE THEM UNDERSTAND HOW IT FEELS BENEATH THE FOOT OF AN OPPRESSOR!
HECTOR: You can&#39;t see it, can you? You&#39;re becoming what you most hate.
CAIN: This is who I’ve always been, Hector. I have never started anything. But I always been the finisher. Donuts chose to fight this way. Not us. Until they relent, we will not back down from their challenge.
HECTOR: Cain, this is madness.
CAIN: Madness? This is war, Hector. WARRR!
HECTOR: There&#39;s simply no good reason to attack Donuts who are unable to fight.
CAIN: Sure there is. It distracts the enemy, spreads their resources thinly, and keeps all Donuts in a perpetual state of fear. It&#39;s exhausting to live in fear. Trust me, Donuts will not last long. They must give in soon.
HECTOR: Listen to yourself. You are justifying the killing of children. Can&#39;t you see you are gripped by this war fever?
CAIN: What I can SEE, is that you seem to care more about donuts, than you do about muffins.
HECTOR: I care about those who are good. Whether they be Muffins or Donuts.
	Crowd gasps.
CAIN: (Smug smile.) We know you met with donuts in their so-called New Arc City. A city built on our stolen Muffin lands. I wonder what they put in your head. Some sort of mind control device?
	Crowd laughs. Hector pulls out a book to read from.
HECTOR: Each of you took an oath when you joined the Sacred Knights. You swore to uphold the values of our sacred scripture. In chapter 3, we are told: &quot;Do not say to others follow me alone. Rather, say onto others, be yourselves humble scholors of scripture because of what you have taught and what you have studied.&quot; This verse teaches us not to blindly follow a leader. It is incumbent on each of us to study the wisdom of our sacred scripture and to share what we learn with one another.
If you believe I came here condemn anyone for harboring hatred against Donuts, you are mistaken. I understand hatred. Donuts took everything from me. They took everything from many of us. Scripture does not forbid hatred. It forbids injustice: “Do not let hatred prevent you from being just.“ And for those of you who believe it is justice to punish an innocent Donut for the crimes of another, please allow me to read verses from sacred scripture that you might ponder. &quot;Whoever commits evil only earns it against oneself.&quot; &quot;No bearer of burdens shall bear the burden of another.&quot; &quot;Every soul earns no blame except against itself.&quot; &quot;Whoever does a good deed, it is for oneself--&quot;
CAIN: Alright. Enough with the sermon. This isn&#39;t a sanctuary. Your point has been made. I&#39;ll think about what you said. Just don&#39;t forget whose side you&#39;re on in this war, Hector.

This simulation ends and you remove your simulator headset.</tw-passagedata><tw-passagedata pid="51" name="A2-S30-G" tags="Timeframe_Advanced" position="1175,2600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 30-G]
FACILITY X TOUR]
&lt;img src=&quot;https://i.imgur.com/JgWSDvp.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Wrong hat on General Grimmer. (I&#39;ll stop mentioning this point from now on.))]
You are with General Grimmer, Commander Gorg, and Sergeant Kegan at an undisclosed facility. Kegan is demonstrating the latest weapons. You get to test everything showcased. Kegan introduces a new standard issue assault rifle. He shows a new fighter/bomber aircraft. You tour the facility. Grimmer asks what&#39;s behind a certain door. Kegan replies that&#39;s classified. Grimmer, being the most senior rank official, insists. Kegan shows him inside the secret room. He explains the prototype for a new bomb that uses nuclear fission to create a massive explosion, far beyond conventional bombs. Kegan also explains that he had to lie about this during the meeting as there were other generals present. Grimmer is not happy about this project and demands to have it shut down. Grimmer argues that using this weapon will only serve to radicalized the Muffins. Gorg interjects, &quot;Not if we use all of them at once. If we decimate every muffin population center together, there will be no muffins left to resist.&quot; Kegan reassures Grimmer that this weapon is only to be used in extreme circumstances. Grimmer is still not happy and wants to end this project. Kegan ostensibly agrees, then takes y&#39;all to the next room to show you this simulation technology. Grimmer puts on a simulator headset. 


&lt;img src=&quot;https://i.imgur.com/sLFCvs0.jpg&quot; class=&quot;fitHalf&quot;&gt;
You watch as Grimmer is escorted outside of the room in a catatonic state, walking backwards into the hallway. You are also told to put on a simulator headset. You are then in the hallway as you were a few minutes ago. Grimmer asks what&#39;s behind that same door. But this time, Kegan says &quot;it&#39;s not important. Just storage.&quot; Grimmer also asks about the simulation room door. Kegan replies &quot;That&#39;s also storage.&quot; Gorg says, &quot;Come on, we still haven&#39;t seen the new tanks yet.&quot; This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S31-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="52" name="A2-S31-G" tags="Timeframe_Advanced" position="1175,2725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 31-G]
SIMULATION TECHNOLOGY]
&lt;img src=&quot;https://i.imgur.com/zoUKc3c.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: That door style in the background implies they are at Sim Labs HQ, but I&#39;m not sure this scene will take place there. Most likely it&#39;ll be in some muffin resistance outpost where Sim Labs is delivering these simulators for resistance fighters to train on.)]
You are in a Muffin camp. Some Muffin scientists are handing out simulator headsets to muffin resistance fighters. Some of the fighters wearing them appear to be in combat while miming holding a gun. Hector and Professor Ludwig walk out of a building talking together. Ludwig is explaining this new combat simulation they created to train soldiers. Hector introduces you to Ludwig. Ludwig is a bit bewildered. He asks if you met him before. At this point in the timeline, you haven&#39;t. Hector and Ludwig continue their conversation. Ludwig explains more advanced simulations Sim Labs is developing. Simulations that are so accurate, they can actually be used to gather intelligence. He warns Hector that these simulations are predicting an eminent attack. However, the simulations are not yet accurate enough to know where the attack will be precisely. Hector decides to deploy forces along the front to respond fast, wherever the attack may be. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S32-G]]]




MY NOTES:
- During this scene, you can put on one of the combat simulators and experience a brief mission where you have to defend against donut enemies. After the mission, when you remove the headset, subtle things are slightly different in the environment, indicating the present has been affected by you entering that simulation.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="53" name="A2-S32-B" tags="Timeframe_Advanced" position="1050,2850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 32-B]
CAIN PLANS - BLUEBERRY BULGE]
&lt;img src=&quot;https://i.imgur.com/tKEhklC.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: )]
&lt;img src=&quot;https://i.imgur.com/mKGeTIk.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are back with Cain. He is hailed as a hero among the Muffin resistance. The attacks on donut cities sparked infighting amongst the donut military. Now was the time to consolidate muffin forces and launch attacks against the divided donuts.
Cain explains that they should encourage the infighting by specifically targeting the stronger elements of the donut military. The stronger elements being the front line forces commanded by General Grimmer who is now fighting on 2 fronts: externally against the Muffins and internally against their own fellow donuts.
But first, a large statue is unveiled of Hector who has become a martyr and a symbol of the fight against Donuts.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S33-B]]]



MY NOTES:
- Throughout this scene, there is a strong aura of hatred towards the Donuts for the devestation they caused with nuclear bombs to so many Muffins.
It is intended to be noticed by you in later missions that the target of this hatred is predominately Grimmer&#39;s forces (who where against using nuclear weapons) rather Gorg&#39;s forces who orchestrated those attacks.
- &quot;Revenge is what Hector would have wanted.&quot; This can be a line by a random Muffin NPC.
- At one point in this scene, one of the other Muffin commanders mentions to Cain that you have been seen helping the NDO during the assault on the Capitol. There is concern that you might be a traitor. But Cain vouches for you and says that you were merely aiding the infighting among the donuts which should be encouraged. And that even if you are a traitor, you are still useful to the Muffin resistance for the time being. They will keep you alive so long as you are useful.



SCRIPT DRAFT:






</tw-passagedata><tw-passagedata pid="54" name="A2-S33-B" tags="Timeframe_Advanced" position="1050,2975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 33-B]
CONSOLIDATION]
&lt;img src=&quot;https://i.imgur.com/qNHHSCU.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/SjV7U5M.jpg&quot; class=&quot;fitHalf&quot;&gt;
There is still significant in fighting between the old Donut government, lead by General Grimmer, against the NDO lead by King Gorg. King Gorg orders a full scale assault on Sprinkle City. 


&lt;img src=&quot;https://i.imgur.com/oJYZ72B.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
There is a large tank battle in the open field. Both sides have air power, but Gorg&#39;s forces are storng and achieve air superiority. Old government forces retreat into the city. Gorg shells the city, collapsing many buildings before moving in. You are involved in heavy urban fighting along side spec ops NDO Bar and Twist Donuts. The battle is fierce, but you and the NDO are eventually victorious.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S34-B]]]



MY NOTES:
- In this scene, both the NDO and old Donut flags are apparent and prominent.


SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="55" name="A2-S34-B" tags="Timeframe_Advanced" position="1050,3100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 34-B]
TAKE BACK OUR LAND]
&lt;img src=&quot;https://i.imgur.com/iqICEep.jpg&quot; class=&quot;fitHalf&quot;&gt;
You join Cain and his forces in a large scale assult on the Donut front. These Donuts are notabley still flying the old Donut Flag. During the assault, you encouter several Donut civilians, some Muffins gun down any they find while others will pretend they didn&#39;t see them and move on with the assault.
Your assult penatrates so deep that you see bombings way in the distance beyond Muffin artilary. Everyone is confused, but Cain explains that this in part of the in fighting between Donuts and that they should not interrupt. A command is given to consolidate current positions and await further orders.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S35-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="56" name="A2-S35-B" tags="Timeframe_Advanced" position="1050,3225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 35-B]
SITREP]
&lt;img src=&quot;https://i.imgur.com/m1BEhnP.jpg&quot; class=&quot;fitHalf&quot;&gt;
Back at the government building in Donut City, King Gorg, formerly Commander Gorg, and Sergeant Kegan are analyzing the situation.
After much fighting with General Grimmer&#39;s forces, they have decided to hold off attacks against Grimmer because he is being attacked by the Muffins, which will allow them time to consolidate power in the regions they control.

However, there&#39;s another thorn in their side. Grimmer has recruited Donut Holes, a much maligned race of donuts, which disgusts the NDO whom are staunchly segregationist. The Donut holes have staged an uprising in Dough Town and have successively pushed out the NDO from that region.

There is tension as the bar and twist Donuts in the room confront the lack of commitment from Ring and Filled Donuts in the fighting. Bar and Twist Donuts have suffered much heavier losses. Gorg remarks that there&#39;s no reason to antagonize each other. He brings up that Donuts are now united and have moved on from there troubled history. 

Gorg then suggests the next target for their consolidation campaign to be a small group of Donut Holes uprising in Dough Town. The Ring and Filled Donut regiements will handle that to make up for the price they haven&#39;t paid. A Bar Donut begrudgingly comments, &quot;You Ring and Filled Donuts are always taking the easy way out.&quot; Kegan cuts in to say this is a good task for the Ring and Filled Donuts, and if they encounter any resistance, they are to make examples out of the population of Donut Holes.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S36-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="57" name="A2-S36-B" tags="Timeframe_Advanced" position="1050,3350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 36-B]
AN EXAMPLE]
&lt;img src=&quot;https://i.imgur.com/P5CbYQA.jpg&quot; class=&quot;fitHalf&quot;&gt;
You participate in the attacks on Dough Town. The Donut Holes put up a fierce resistance which the NDO was not prepared for, but eventually, you help to completely subdue the Donut Holes. King Gorg is so humiliated by his losses that he orders a nuke rolled into the city and detonated.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S37-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="58" name="A2-S37-B" tags="Timeframe_Advanced" position="1050,3475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 37-B]
SWITCHING SIDES]
&lt;img src=&quot;https://i.imgur.com/QhfD3as.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/BmWR2mp.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/2v3RZ6S.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Only Ring and Filled Donuts are part of Gorg&#39;s royal guard. No Bar or Twist Donuts should be aiming guns at Kessler.)]


Sergeant Kegan and other Bar / Twist Donut Generals are furious at Gorg for wasting a valueable nuke on such a low priority target.
Shortly after, there is a surprise visitor that lands in the Facility X base. It&#39;s one of Grimmer&#39;s top generals fighting for the old government. There&#39;s a bit of a commotion when he first lands as they decide whether or not to destroy the plane, but Kegan explains that this visitor was invited by himself. Once landed, General Kessler steps out and admires the fabled Facility X which he is seeing for the first time. He is here to negotiate terms for ending the fighting and joining the NDO behind Grimmer&#39;s back. He even says he can lure Grimmer into a trap for the NDO to capture him.
In exchange for his switching sides in the war, Kessler want certain terms.

GORG: &quot;You are in no position to dictate terms, General Kessler. The only thing we will except from you is your unconditional surrender.&quot;
KESSLER: &quot;Surrender? No, no. You have it all wrong. I intend to keep command over my men and the regions we control. I&#39;m only here to make you a generous offer.&quot;
GORG: &quot;There will be no offer! I am your king and you will subordinate yourself to me.&quot;
KESSLER: &quot;(Chuckle.) I thought this was a joke. Are you serious?&quot;
GORG: &quot;I can show you how serious I am.&quot;
	The donut guards have their rifles aimed at Kessler.
KESSLER: &quot;Go ahead. FIRE!&quot;
	The Donut guards do not fire. Some lower their rifles. Gorg is fuming.
KESSLER: &quot;I&#39;ve known countless Ring Donuts like you, &#39;King&#39; Gorg. All cowards.&quot;
GORG: &quot;How dare you call me a coward!&quot;
KEGAN: &quot;Calm down. There&#39;s no need to like each other. We just need to cooperate. General Kessler, you give us what we want, and we give you what you want.&quot;
KESSLER: &quot;What is it you want?&quot;
KEGAN: &quot;Join the New Donut Order, and help capture General Grimmer.&quot;
KESSLER: &quot;You want Grimmer captured? A tall order.&quot;

KEGAN: &quot;It does not matter who captures him.&quot;
KESSLER: &quot;Hmm. I see. That&#39;s an even taller order. I can arrange that. What I can not arrange, however, is convincing my men to subordinate to this clown.&quot;

GORG: &quot;Shut your mouth, before I shut it for you!&quot;
KEGAN: &quot;Quiet. The both of you. Don&#39;t address each other anymore.&quot;
GORG: &quot;&#39;The both of you?!&#39; Is this how a king is to be treated?&quot;
	Kegan gives Gorg the death stare.
GORG: &quot;Fine, I&#39;ll be quiet.&quot;
KEGAN: &quot;Subordinate yourself to the NDO, and you may keep command of your men and the regions you control.&quot;
	Gorg&#39;s jaw drops to the floor.
KESSLER: &quot;Sorry sergeant, that&#39;s not good enough for me.&quot;
GORG: &quot;Unbelievable. Sergeant Keegan, you will never satisfy this insubordinate snickerdoodle.&quot;
KEGAN: &quot;Don&#39;t decide yet, General. I&#39;ll take you on a tour of this facility. Give you time to think about our offer.&quot;
KESSLER: &quot;Sure. I&#39;ve always wanted to see what y&#39;all are up to here.&quot;
GORG: &quot;You&#39;re wasting your time Sergeant.&quot;
KEGAN: &quot;Would you like to join the tour, King Gorg?&quot;
GORG: &quot;Go on witout me. I&#39;ve done the tour a million times. There are more important things for me to do... What are you waiting for? Get out of my office! You&#39;re dismissed.&quot;

Kegan and Kessler walk out of the room.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S38-B]]]




MY NOTES:

- Dialogue ides:
&quot;You&#39;re fighting a lossing cause.&quot;



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="59" name="A2-S38-B" tags="Timeframe_Advanced" position="1050,3600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 38-B]
GRIMMER&#39;S CAPTURE]
&lt;img src=&quot;https://i.imgur.com/lCqz93I.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/Z7JTTek.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/GyhuQBq.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Kessler is not gleeful here. He respects Grimmer and is ashamed that he is betraying him, but he believes this is something that must be done for the grreater good to end the fighting between Donuts.)]
You are with Cain preparing for a Sacred Knights operation deep behind enemy lines. You don&#39;t know what the operation is exactly. You just know that it&#39;s top secret and that it&#39;s based on a mysterious intel source.
The operation lead you to a fortified donut Compound. It looks heavily defended with thick wall, watchtowers, war planes and attack helicopters. The muffins question whether they have enough strength to attack such a target. Cain tells everyone &quot;just wait.&quot; Soon after, explosions detonate all over the compound, destroying all the aircraft, watchtowers, and creates a large breach in the thick perimeter walls. You and your comrades flood in and engage the staggered donut forces, while sirens blair.
After the intense fighting, the sirens stop. A spotlight illuminates the old donut flag on top of the highest building on the base. Cain commands everyone to cease fire. The old flag lowers and the NDO flag rises in its place. Some of the muffin fighters are confused while Cain patiently waits. The security door to the building opens and you and Cain walk in. General Grimmer and General Kessler are both in there with a few more of Kessler&#39;s soldiers who stand down. Cain greets Kessler.

CAIN: &quot;They say the enemy of my enemy is my friend.&quot;
KESSLER: &quot;This won&#39;t be true for long, Cain.&quot;
CAIN: &quot;I concur with that, General Kessler. But for now, we can be civilized. Hand him over.&quot;
	2 Donut soldiers grab Grimmer and push him toward Cain.
GRIMMER: &quot;General Kessler. What is the meaning of this?&quot;
	Kessler is ashamed of what he is doing. He does not look Grimmer in the eyes.
KESSLER: &quot;I&#39;m sorry, sir. This is war.&quot;
GRIMMER: &quot;This is war, huh? This is war.&quot;

That&#39;s when it&#39;s revealed that General Grimmer has been betrayed. Grimmer is distraught as he is handed over to Cain and the Sacred Knights as a prisoner.
Before leaving, Cain has a private Conversation with Kessler. He says it&#39;s too risky to leave the remaining donut soldiers alive. Kessler advocates for them saying they are his trusted soldiers, not Grimmer&#39;s, and are fully loyal to him. They will not reveal what happened here.

CAIN: &quot;I&#39;m sorry, General. This is war.&quot;
Cain does a hand signal ordering his men to kill the remaining disarmed donut soldiers.
CAIN: &quot;It&#39;s best you leave now.&quot;
Kessler runs into the distance away from the base.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S39-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="60" name="A2-S39-B" tags="Timeframe_Advanced" position="1050,3725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 39-B]
STATE FUNERAL]
&lt;img src=&quot;https://i.imgur.com/jLcebcT.jpg&quot; class=&quot;fitHalf&quot;&gt;
There is a massive funeral in honor of general Grimmer. Even though he was an enemy of the NDO, he is turned into a martyr of the war against Muffins. King Gorg gives a not very enthusiastic speech trying to praise General Grimmer. General Kessler you have so much more passionate speech with actual genuine praise for him. Then he highlights the importance to unite under the NDO against the real enemy. The savage Muffins. He hails King Gorg in public.
After the speech, away from the public, Gorg complements Kessler for his speech, which is especially exceptional considering his recent &quot;successful operation&quot;. Kessler responds strongly and harshly towards Gorg, even more disgusted by him than he was before.

A Donut news report is running on tv. The Bar Donut News Anchor Lady is explaining how after the capture and execution of General Grimmer, all Donut soldiers of the old government decided to put aside their differences with the NDO and unite under King Gorg against the Muffin meanece.

Everyone gets back to business in the war room. Kessler and Johnson are the main  sources of insight into the muffin enemy considering they were on the front lines most recently.
A bunch of plans are proposed by different generals in the room. All of them are shot down by Kessler and Johnson because they have tried them before and failed miserably against the Muffins. The muffins just always seem to know where they are going to attack and have a concentration of forces there. Kegan proposes an unusual idea of rolling some dice to randomly select a target. That way they are completely unpredictable. Kessler and Johnson Insist that won&#39;t work either. No one knows know how the muffins are able to maneuver and counter their assaults so Consistently. Kessler and Johnson say the best thing to do is simply hold defensive positions. there is a big commotion because this doesn&#39;t make sense and many of the generals see the muffins as inferior and weak. Kegan is thinking over the commotion.

KEGAN: &quot;Be quite everyone.&quot;

Kegan understands what might be going on. He has tried himself under a team of scientists at facility X to create a simulation of reality so precise, it can be used for espionage. This is a top secret project that few know of. Everyone is concerned that there might be a double agent among them which is why Keegan is so adamant about everyone being quiet. You are even accused of being a traitor that is funneling secrets to the muffins. You can answer yes or no to that question. If you answer yes, Kegan cut in to before things get too heated. He explains that is not what&#39;s going on but he will explain later. For now, he orders everyone to tighten security, bolster defensive positions around valuable assets, and keep all operational information on a need to know basis.

KEGAN: &quot;Is that understood?&quot;

Everyone is confused but complies.
The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S40-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="61" name="A2-S40-B" tags="Timeframe_Advanced" position="1050,3850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 40-B]
TOP SECRET]
&lt;img src=&quot;https://i.imgur.com/EVuzykA.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/6sNxxHS.jpg&quot; class=&quot;fitHalf&quot;&gt;
This scene takes place in facility X and the part of the facility that deals with simulation technology. During this scene, it&#39;s reveal that donut simulation technology is not very advanced but they do have some thing that is able to Intercept a signal of some sort. It&#39;s a very obscure signal but they are at least able to tell it&#39;s caused by an advanced simulation coming from the west deep within muffin territory. They are able to tell because a Similar but weaker signal is given off whenever they run their own Donut simulations.

During this whole tour, King Gorg and other Ring and Filled Donuts are noticeably not there. Kegan only trusts a select few Bar and Twist Donuts, including Zimmar, Kessler, and Johnson, when explaining the situation under extremely tight security.

An experiment is ordered to attempt to intercept a signal using maximum power. For a brief moment some strange space time anomalies and perhaps some lightning happens in the center of a room. Then a test subject (not type Anderson) appears with a simulator on their face. They are moving around a little bit here and there. A scientist goes in to remove the simulator and it&#39;s really hard to pull off. When they do, the test subject dies.

They notice a blue name tag that reads, &quot;Hi, my name is Sir Camelot. #56. Property of Sim Labs.&quot; That is familiar to them because you have a name tag that reads, &quot;Hi, my name is Mr. Anderson #429. Property of Sim Labs.&quot; Kegan pieces together what&#39;s going on and concludes this world is a simulation. Kegan is unfazed by this realization and wastes no time contemplating philosophy. He grabs a simulator headset from the dead test subject and prepares it at the terminal.

Kegan understands the muffins have more advanced simulations than they do because they are so advanced they are able to predict where attacks will occur. The only way to combat this is to take that technology for themselves and capture the lead Muffin scientist responsible for creating such an accurate simulation.

Keegan reminds you that they always know where you are because of your tracking patch. So they just have to redirect the simulator back to its origin location, put you in, and arrive with an overwhelming strike force to capture the Sim Labs technology.
You are left to wear the simulator.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A2-S41-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="62" name="A2-S41-B" tags="Timeframe_Advanced" position="1050,3975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 41-B]
RETURN TO SIM LABS]
&lt;img src=&quot;https://i.imgur.com/sIP8QZy.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/Z9WFu45.jpg&quot; class=&quot;fitHalf&quot;&gt;
You&#39;re at Sim labs but in a different room 101. This room was for sir Camelot and the researcher Scientists noticed that you are not sir Camelot. If you attack with your weapons, a lockdown is issued on the whole facility which you can break out of and reek havoc on Sim labs. But you can also comply and just go through a bunch of research scientists asking you questions and trying to figure out what&#39;s going on. Either way there is a time limit until Kegan&#39;s task force arrives.
After you help the task force secure Sim Labs. Kegan discovers that Professor Ludwig, who is responsible for most advanced simulations, is not at this facility.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S42-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="63" name="A2-S42-B" tags="Timeframe_Advanced" position="1050,4100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 42-B]
SORRY I&#39;M LATE]
&lt;img src=&quot;https://i.imgur.com/dDDMoUC.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are back with Cain. He is in a meeting with his men who are trying to strategize how best to attack the Donuts. They are waiting for Professor Ludwig to show up so that they could use his insights from his advanced simulations to find weak points in the Donuts.
You are sent out to search for him, and discover that he has fled.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S44-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="64" name="A2-S44-B" tags="Timeframe_Advanced" position="1050,4350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 44-B]
LUDWIG]
&lt;img src=&quot;https://i.imgur.com/qKQ7k2y.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/OOJ6alD.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are in the distant frost peaks, far away from civilization, in a small camp. You discover Professor Ludwig with a few of his gadgets from sim labs before its fall.
Although he hasn&#39;t met you in this story path, he knows all about you through running specialized simulations that are the same ones used to conduct espionoge. Although Ludwig hasn&#39;t created The Simulation™ yet, he deduced that your existence is due to entering The Simulation™ and that all his life and world is just a simulation. He doesn&#39;t know if that should make him feel better or worse, given the state of the world.

Ludwig knows you could have taken a better path, but you chose the path of destruction. He is both afraid and disappointed in you. Ludwig theorized there is still potentially a way for you to redeem yourself. Ludwig knows your better path self needs help, and that he could potentially send you in to help. But that is merely a wish because Ludwig is all out of power. He would require huge resources to develop something like that, but of course, all of Sim Labs has been destroyed.

Ludwig apologizes for his simulation technology being used to help Cain. He knows Cain&#39;s leadership will not lead to a better world. But he also admits that the defeat and surrender of the Muffin resistance to the NDO will be an even worse fate for Muffins. Supporting Cain is merely the best of bad options.

Ludwig asks if all his fellow scientist at sim labs are dead. You can answer or not.
Ludwig opens up about his fragile ego. He was so caught up in wanting credit for his work that he lost sight of why he entered the field of simulation research in the first palce. It was not for the praise and name recognition. Ludwig tells of his childhood growing up as a relatively privilaged Muffin minority in Sprinkle City. Although he was an outcast, he always admired the innovation of Donuts. He especially wanted to visit a grand Donut amusement park called &quot;Adventure Candy Land&quot;, &quot;The most awesome place anywhere!&quot; &#39;Twas a long waiting list for Muffins to be allowed entry. On the very day they were due to enter, they drove to the gates and saw a massive millitary pressence and comotion. Muffin militants snuck weapons in and attacked the theme park. Scores of Donuts were indiscriminately slaughtered. Most victims were women and children. From that day on, Muffins were restricted from entering the park. It would only get worse from there. Muffins would eventually be evicted from Donut lands and forced to miagrate West. Ludwig, his mother, and father lived in poverty until both of Ludwig&#39;s parents were killed in an artillary strike. Ludwig was then taken in to a Muffin boarding school in Blueberry buldge. He would focus his studies on creating a simulation of reality so accurate, it could be used to predicte and prevent attacks like the Candy Land Carnage and the bombings that killed his parents... And he&#39;d also want to experience that day as a child when he was so excited to enter Adventure Candy Land with both his parents, even if it&#39;s just a simulation. But it&#39;s too late for that now. He&#39;s grow old and the world is ending.

At the end of this discussion with him, some spec ops, soldiers from Kegan, come out of the shadows and take Professor Ludwig into custody.


(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S45-B]]]



MY NOTES:
- Maybe do this: It is here that he has a few other simulations laying around that are glimpses into some of the characters&#39; lives and also a simulation of the credits of the game so that all the credits can be in this one spot and be incorporated into the game.
- Ludwig lights a camp fire by banging 2 useless simulators together to make sparks. He does this before starting the second half of his conversation with you.






SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="65" name="A2-S45-B" tags="Timeframe_Advanced" position="1050,4475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 45-B]
POW CAMP]
&lt;img src=&quot;https://i.imgur.com/jncSnzh.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
&lt;img src=&quot;https://i.imgur.com/2J6i5xI.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are in the middle of an NDO prison camp with Kegan and his men. This camp mines materials used to make nuclear bombs.
A Donut scientist comments how great it&#39;s been that they discovered this area of recently captured Muffin territory to extract fizzile materials from. He reports that they were able to develop 50 nukes and are still making more. Kegan replies &quot;It&#39;s all thanks to Professor Ludwig&#39;s simulations that we discovered this location.&quot;
An NDO officer comes up to report that they discovered an optimal assault plan that ensures a penatration of approximately 21.24% of nukes striking their targets.
KEGAN: &quot;Only 21%?&quot;
DONUT OFFICER: &quot;The Muffins have really good anti-air defences, sir.&quot;
KEGAN: &quot;Augment the plan. Send a task force to eliminate those as many AA guns as they can.&quot;
DONUT OFFICER: &quot;But Sarge, will they have time to escape the explosions?&quot;
GENERAL KESSLER: &quot;Send Ring and Filled Donuts from Gorg&#39;s royal guard. They always act tough but never see action.&quot;
KEGAN: &quot;Run those simulations with Gorg&#39;s men in the task force. Then report those results back to me alone. No one needs to know what those casualty figures are when we send in the task force.&quot;
DONUT OFFICER: &quot;Yes sir.&quot;



(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S46-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="66" name="A2-S46-B" tags="Timeframe_Advanced" position="1050,4600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 46-B]
A THOUSAND SUNS]
&lt;img src=&quot;https://i.imgur.com/AtIbGaE.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/8mjqXf4.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/t9igNKI.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are with the Muffin resistance forces in the middle of a battle. They are defending a massive assault from Ring and Filled Donut forces.
After some fighting, you retake Donut held positions and discover they are destroying AA guns. You move down into a massive tunnel network where Cain is. A quick meeting is held while fighting is still ongoing outside. Cain is told of the Donuts targeting AA guns. Cain tells everyone that after Ludwig&#39;s capture and the destruction of Sim Labs, they have no precise way of predicting the enemy&#39;s actions anymore. But they have learned in the past that the Donuts have a plan to use a massive stockpile of Nukes to decimate all Muffins. However, the resistance has prepared for that with a massive network of tunnels. Even if the Donuts were to kill all Muffin civilians, the most elite Muffin fighters will survive and take revenge upon any and all Donuts they can lay their hands on. Cain tells gives orders to the entire resistance to prepare to shelter when the time comes, but until then, to fight back the invading enemy. You follow Cain out of the tunnels into an area where you ambush unsuspecting Donuts and then continue the fighting from there.
Towards the end of the battle, air raid sirens ring out. You hear the Donuts panic that the bombers aren&#39;t suppose to come this early. The Donuts flee. You are told push up to the positions the Donuts occupied and get on an AA gun. Most have been destroyed, but you find one and use it to shoot down bombers and straffing jets.
Eventually, the bombers drop their loads on mass. Nukes go off in the distance in every direction. Then one goes off above you.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S47-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="67" name="A2-S22.2" tags="Timeframe_Early" position="1050,1475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 22.2]
KILL THEM ALL]

This is an alternate version of [[A2-S07]], but instead Hector and his group discovering the camp, it is Cain and the Sacred Knights. Instead of protecting the Muffin survivors, they use them as bait to ambush the returning donuts. What they see the donuts do to the surviving muffins radicalizes them even more. The donuts have a commotion. There is disagreements on what to do with these muffins. They conclude that they can&#39;t leave these witnesses is alive, and proceeded to kill the muffin civilians. During the massacre, muffins can be heard over the radio asking Kane if they can fire yet. Cain Whispers back, &quot;Not yet, hold your fire.&quot; One donut particularly enjoys the killing. As a muffin boy is running away, he pulls out his pistol and gleefully shoots him in the back of the head.


&lt;img src=&quot;https://i.imgur.com/NaJov2T.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: A few points here:
1. I&#39;m imagining you are in one of the small buildings with Cain looking out of broken window slats. 
2. Cain&#39;s face should be angry. Like he&#39;s struggling to contain his rage, not smiling.
3. The Muffin should be smaller. Like whatever a 5 year old Muffin might look like.)]
That instant, Kane gives the command to &quot;kill them all&quot;.
You and all the muffins kill all the donuts. The sadistic donut runs for cover and is the last Survivor who is dragged out.


&lt;img src=&quot;https://i.imgur.com/cKupjOR.jpg&quot; class=&quot;fitHalf&quot;&gt;
He pleads for mercy while telling everyone he has a family. Cain menacingly replies, &quot;Don&#39;t worry. We will take care of your family.&quot; Then he shoots the donut in the face.


&lt;img src=&quot;https://i.imgur.com/GbT8XKq.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Cain smiling here is perfect.  :)  )]

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S23]]]



MY NOTES:
-dialogue between the donuts:
&quot;(long whistle.) Look at this&quot;
&quot;who came here before us?&quot;
&quot;someone had some fun here before we did.&quot;
&quot;that&#39;s fudged up.&quot;
&quot;Hey don&#39;t get soft now.&quot;
&quot;Some of those look like kids, dude.&quot;
&quot;Just got caught in the crossfire I guess.&quot;
&quot;look, there are some more Standing over there.&quot;
&quot;DISMOUNT!&quot;
&quot;this is a free fire zone, right?&quot;
&quot;they don&#39;t look like enemies.&quot;
&quot;Doesn&#39;t matter what they look like. Did you already forget what Muffins did to us?&quot;
&quot;Come on guys. These aren&#39;t those same muffins.&quot;
&quot;All muffins are the same to me.&quot;
&quot;Do you have a soft spot for muffins, Jimmy?&quot;
&quot;Ya haha&quot;
&quot;I think he likes muffins.&quot;
&quot;Ewww.&quot;
&quot;There&#39;s only one kind of muffin I like.&quot;
&quot;What&#39;s that?&quot;
&quot;Overcooked.&quot;
&quot;Haha&quot;
&quot;Y&#39;all are fudging Fluffernutters, you know that?&quot;
&quot;We know that.&quot;
&quot;Just trying to live up to our reputation.&quot;
&quot;What should we do with them Sarge?&quot;

&quot;I don&#39;t know. This is a free fire zone. There are supposed to be no civilians here. Someone already screwed that up.&quot;
&quot;We can&#39;t just leave them here, sir. They&#39;ll compromises us.&quot;
&quot;Get me a radio... This is task force Charlie to command. Do you read? Over.&quot;
&quot;Command to task force Charlie. We read you. Over.&quot;
&quot;We have civilians in our AO. Please advise. Over.&quot;
&quot;Negative Sergeant. That is a free fire zone. There are no Civilians in your AO. Over.&quot;
&quot;but there are civilians. We need to keep moving before--&quot;
&quot;Sergeant, I&#39;m looking at the maps and I assure you, there are no civilians in your AO. Your orders are to shoot anything that moves. Over and out.&quot;
&quot;Son of a Huckleberry. Well, you heard him. We have orders.&quot;
&quot;Sir we can&#39;t--&quot;
	Guns start firing at Muffin civilians.
&quot;Dear mother of dough.&quot;
&quot;That&#39;s some good shootin&#39; boys.&quot;
&quot;If you think about it, we did these Muffins a favor. I would not want to live like this. It&#39;s disgusting.&quot;
&quot;One is still alive.&quot;
&quot;He&#39;s running.&quot;
&quot;I got &#39;em.&quot;


-Dialogue between muffins over the radio:
Cain, should we open fire?
Not yet. Wait for them to get close.
They&#39;re about to kill them. Can we fire now?
No! They must come closer.
Cain, if we are to save them, we have to fire now!
Then let them be martyrs. Open your eyes wide and let this moment forever etch a Searing hatred for Donuts deep within your soul.
	One Muffins opens fire. Cain gives the command to everyone.
Kill them all!
	The Donut who shot the boy is  shredded to pieces. Then the barrage focuses on all the donuts. There is a short firefight as some donuts take defensive positions. A tank blasts one of the buildings and rocket blows up the tank.
     At the end of the battle, Jimmy, the nice Donut who ran for cover, is the last Survivor. He is dragged out of the tank and shot twice in painful areas. He pleads for mercy while telling everyone he has a family. Cain menacingly replies, &quot;Don&#39;t worry. We will take care of your family.&quot; Then he shoots the donut in the face.













SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="68" name="A2-S47-B" tags="Timeframe_Advanced" position="1050,4725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 47-B]
THE END - FACILITY X]

You are on an airstrip, waiting beside Kegan and Ludwig along with other dignitaries and Secret Service agents. King Gorg and his entourage finally show up.

Kegan greets Gorg and apologizes for the significant loss of soldiers from his own royal guard.
KEGAN: &quot;They are all brave heros who will never be forgotten.&quot;
GORG: &quot;(holding back emotions) Ya well, that&#39;s the cost of victory sargeant. But thank you for the sentiment.&quot;
KEGAN: &quot;Victory is not acheived yet, King Gorg. We still have many enemies.&quot;
GORG: &quot;Of course! And I count of you to help us eradicate our enemies. Once and for all.&quot;
KEGAN: &quot;Once and for all.&quot;

Gorg congratulates Kegan on his most recent victories, including his successful eradication of Donut Holes once and for all. Kegan thanks Gorg and directs him, and his entourage, onto the presidential plane.


&lt;img src=&quot;https://i.imgur.com/SHEkyL6.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
There are some subtle things you might notice in the scene. For one, the flags are slightly different around Kegan&#39;s men. They have a bar donut in the center instead of a ring donut. Also, as Gorg&#39;s entourage enters the plane, the lone bar donut that was going to enter is whispered to and decides to stay back. You can see outside the plane that there are only bar and twist donuts, while inside the plane there are only ring and filled donuts. Finally, Kegan orders you to enter the plane, as well.


&lt;img src=&quot;https://i.imgur.com/jGbB5bp.jpg&quot; class=&quot;fitHalf&quot;&gt;
&quot;What about me?&quot; Ludwig asks. Kegan tells him he will be staying at here at Facility X to help the NDO develop more advanced simulations. Ludwig says he changed his mind and refuses to help. Kegan asks, &quot;Are you prepared to face the consequences of refusal?&quot; Ludwig replies yes and is told to board the plane with you.
KEAGN: &quot;Your simulations are good, but they didn&#39;t predict this.&quot;
LUDWIG: &quot;Simulations become less predictible when you attempt to simulate a being that is aware it is being simulated.&quot;
KEGAN: &quot;I guess you are not as much of a coward as I thought you were. Goodbye Professor.&quot;
You and Ludwig board the plane.

The plane door closes and Ludwig spots a simulator. Ludwig grabs it discreetly and fiddles with it telling you this might be our last chance. Ludwig has experimented with countless advanced simulations and knows there is a path you could&#39;ve taken where the world is not absolutely devastated by war. Ludwig gives you another option to your current path. He tells you that your alternative self needs help. And you could redeem yourself by helping your good self end this war before this war ends the world. Ludwig admits he does not know how the simulations he created work exactly. He does not know if your actions in a simulation will affect this current world or not, but at least you could affect some world for the better.
He hands it over to you telling if you choose to redeem yourself and do some good for a change, put on this simulator when it is down loading. He attempts to explain what will happen and what you need to do. He suspects that the simulation you are in is based on his latest crazy spacetime theory of everything. He explains that he&#39;s using a hack to insert a second version of you into your good self&#39;s simulated universe. This will cause a chatostrophic thermographic displacement in spacetime. Essentially, the matter that composes you will want to expand and rip yourself apart, the force of which would destory any planet you spawn near. So Ludwig calibrated you to spawn between 2 black holes about to collide. The spacetime compression of that region will be enough to keep your atoms together, for the most part. You will have a few seconds to grab a simulator Ludwig sent earlier to that same location. Find that simulator and wear it before the 2black holes collide. Ludwig reminds you that black holes are not some mysterious portal to another dimenssion, they are an extremely dense concentration of spacetime that will instantaniously shread the structure of your atoms into pure spacetime in an instant. So don&#39;t wait too long.


&lt;img src=&quot;https://i.imgur.com/0DoGVzB.jpg&quot; class=&quot;fitHalf&quot;&gt;
Just then, breaking news appears on the TV in the airplane. The donuts on board, initially in a celebratory mood, quiet down and watch. The news anchor, who is a bar donut filling in for her Ring Donut counterpart, breaks the tragic news that King Gorg, along with several of his entourage, have sadly died in a plane crash. There&#39;s a nervous and confused commotion saying, &quot;what? we didn&#39;t die in a plane crash.&quot; Then someone yells, &quot;what&#39;s that out the window?!&quot; Surface to air missiles are launched at the airplane. The first two missiles take out the escort fighter planes. The final missile impacts your plane, and you die instantly, restarting at a checkpoint. This is an endless loop where you respawn just after Ludwig gives you the modified simulator. Your only escape from this endless loop is to put on the simulator.


(align:&quot;==&gt;&quot;)[[[Wear Simulator...|Act 3 - Bad Path]]]


&lt;img src=&quot;https://i.imgur.com/j594gVA.png&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(Unnamed Flag (not final version))]




SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="69" name="A3-S01-B" tags="Timeframe_Advanced" position="1350,600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 01-B]
WORLDS COLLIDE]
&lt;img src=&quot;https://i.imgur.com/HxPSmDp.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/EusVUek.jpg&quot; class=&quot;fitHalf&quot;&gt;
You spawn between 2 black holes that are spinning around you and gaining in speed.
The spawning process damages you and your red paint it significantly faded from burns. Maybe some wires are also exposed now.
A simulator is floating towards you from far away. There&#39;s other debris around you. You can grab stuff and throw it to make yourself move towards the simulator faster. Whole sections of debris will quicly stretch and vanish as they are consumed by the blcak holes colliding. Then you will suddenly have a black screen. You restart at a checkpoint until you manage to grab and wear the simulator.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A3-S02-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="70" name="A3-S02-B" tags="Timeframe_Advanced" position="1350,725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 02-B]
A BETTER WORLD]
&lt;img src=&quot;https://i.imgur.com/RhCqoSJ.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/VE7RqHc.jpg&quot; class=&quot;fitHalf&quot;&gt;
You find youself in a post apocaliptic wasteland of devestation. There is a small shack. You go in to investigate. Professor Ludwig is there with a handful of survivors from Sim Labs.
He is surprised to see you considering he just gave you a simulator that you wore. Ludwig notices you look considerably different and have damge to your body that  is not consistent with any know weapons. Ludwig asking you some questions like:
- &quot;Are you different from the test subject anderson that I know?&quot;
- &quot;Have you come here to help us?&quot;

Ludwig uses his deductive reasoning to realize his future self heavily augmented you with weapons to then send you back here at this moment so he can use you to help rescue Hector.
LUDWIG: &quot;Is that what happened, Mr. Anderson 2.0?&quot;
YOU: &quot;No.&quot;
LUDWIG: &quot;Is that at least close enough to what happened?&quot;
YOU: &quot;No.&quot;
LUDWIG: &quot;Whatever. It matters not. Point is that you are here, and you are here to help.&quot;
LUDWIG: &quot;As you might have guessed, the world has gone to hell after the deaths of Grimmer and Hector. And while there&#39;s nothing we can do for Grimmer, there is still a way to save Hector.&quot;
MUFFIN SCIENTIST: &quot;Professor, if this does work and Mr. Anderson does manage to save Hector, what does this mean for us? Will our reality be altered?&quot;
LUDWIG: &quot;I can&#39;t say for sure, but at least some reality will be altered for the better.&quot;

You are informed that Hector is alive and is being held as a prisoner by the Sacred Knights, Cain&#39;s force of elite militant Muffin fighters. You are told that you alt self was sent back to rescue Hector. Ludwig tells you to go into the simulation and find Hector and your other self as they will both need your help, most likely.

Ludwig warns that this might be the end for you and bids you a farewelll before you are sent in. He asks if you are ready for that before you are sent in.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A3-S03-B]]]



MY NOTES:
-  while calibrating, a scientist warns Ludwig to double check that he got the calibration right. Ludwig reluctantly agrees and they find an error and correct it. This shows character development as Ludwig adamantly refused to check earlier in the story.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="71" name="Act 3 - Bad Path" tags="" position="1350,475" size="100,100">|specialtitle&gt;[(text-style:&quot;underline&quot;)[The Simulation™]
(text-size:5)[Act 3 - Bad Path]]

(align:&quot;==&gt;&quot;)[[[Continue...|A3-S01-B]]]



MY NOTES:
- somewhere in this act, it needs to be stressed that the good path self decided not to blow up the camp with that nuke. Perhaps it is just mentioned that the day the nuke blew up that aid supplies facility is the day Hector knew the war was going down a worse path.</tw-passagedata><tw-passagedata pid="72" name="A3-S03-B" tags="Timeframe_Advanced" position="1350,850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 03-B]
RESCUE YOU]

&lt;img src=&quot;https://i.imgur.com/B0CmCg5.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/74qt4RG.jpg&quot; class=&quot;fitHalf&quot;&gt;



You assault the compound at night and find Hector, along with the alternative path version of you (or alt you), being held in a small room surrounded by Cain and his guards. You defeat Cain&#39;s guards and rescue Hector and alt you, but Cain manages to escape. Using your super war machine, power frame, you fend off waves of muffin attacks as Hector and alt you escape. You keep fighting until you die.

(align:&quot;==&gt;&quot;)[[[Die...|A3-S04-B]]]







SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="73" name="A3-S04-B" tags="Timeframe_Advanced" position="1350,975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 04-B]
VOICES]

&lt;img src=&quot;https://i.imgur.com/L4fFnWA.jpg&quot; class=&quot;fitHalf&quot;&gt;



The screen is black, but no death quote shows. Instead, you hear dream like voices. And distortions and SFX that indicates the passage of time. The voices could be from the outside world, your memories, visions dialogue that provide exposition.

(align:&quot;==&gt;&quot;)[[[Wake...|A3-S05-B]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="74" name="A3-S05-B" tags="Timeframe_Advanced" position="1350,1100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 05-B]
DEVILS DEAL]

&lt;img src=&quot;https://i.imgur.com/PsQQUKh.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/cyyHjTn.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/KHwSk54.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/gqQz7qj.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/lFK4amL.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/heEJbid.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/vcrfEI9.jpg&quot; class=&quot;fitHalf&quot;&gt;




The screen is still black. You hear some scientists operating on you. You hear 2 familar voices talking about you. Suddenly, you are able to see, but with heavy glitching. Cain, Kegan, and Gorg are in front of you having a conversation while donut scientists operate on you.
Cain is negotiating a trade with Kegan. He&#39;s offering to trade you for a nuclear weapon. Kegan asks questions to Cain that make it clear he doesn&#39;t know who or what you are. Cain sells him the idea that you might be able to program the subject to do his bidding. Kegan is intreged by the idea of have a super soldier.
Kegan asks how can he trust Cain not to use the nuke on them. Cain responds because &quot;The enemy of my enemy is my friend.&quot; They shake hands on the deal.

Just then, explosions shake the building. They all look at and suspect the other for a moment. Then they realize this attack is not one of them. They all run out. The scentists in the operating room with you freeze for a while and question nervously to each other what&#39;s going on on. Another explosion rocks the building and shatters the glass room that you&#39;re in. The scientists run out and look for a place to hide. You are escape and look for a way out. 

There are some sentry guns you have to dodge. There is also an armory where you pick up some guns before exiting to the next area of this facility. You fight your way up to the centeral hub connecting the main buildings of Facility X. You can see sporadic fighting outside around you. There is a tense stand off between the good guys and bad gus. Kegan pulls out a detonator and threatens to self-destruct the base by blowing up all the nukes stored under it. Some suspect he is bluffing. But Hector knows he is serious.

&quot;Anderson! Grab it quick! Don&#39;t let him press it.&quot;
&quot;Take one step and I swear I will press this.&quot;
&quot;Don&#39;t do it. We&#39;ll all be blown sky high.&quot;

You can grab the detonator and destroy it by smashing it on the ground. But no matter what you do, the detonator triggers the self-destruct sequence and everyone has five minutes to escape.
Everyone stops fighting each other and runs for the mountains. You all arrive at the mountains and look back. An insane explosion impulse all of facility X. the bad guys are all distraught and defeated.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A3-S06-B]]]




MY NOTES:
- somewhere in the beginning talk, Keegan questions if this is the test subject that they&#39;ve had so much trouble with. Cain is trying hard to convince Keegan that this is for sure a different subject because he saw them both at once. Keegan said something along the lines &quot;My soldiers have to get used to this. They&#39;ve all been ordered to shoot that test subject on site, and this one looks strikingly similar.&quot;



-You can look out the windows and tell a large battle is taking place at Facility X, but it&#39;s some strange alliance of muffins and donuts on one side versus muffins and donuts on another side. You crush the remote after someone yells to destroy it. Crushing it triggers the self destruct sequence, and everyone immediately stops fighting and runs for the hills. There&#39;s an all out scramble to get everyone clear of a massive explosion that is about to take place. You use your special powers to escort wounded soldiers to safety. From the mountains, you, alt you, Kegan, Gorg, Cain, and surrounding allies watch as Facility X detonates in a massive nuclear explosion.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="75" name="A3-S06-B" tags="Timeframe_Advanced" position="1350,1225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 04-B]
PEACE!]


&lt;img src=&quot;https://i.imgur.com/fne1dmR.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/MHeceWu.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/7g9FTXu.jpg&quot; class=&quot;fitHalf&quot;&gt;




In the final scene / chapter of the game, you are in a small room with Hector, alt you, and other dignitaries. On the news, it shows that three war criminals, Cain, Gorg, and Kegan, have been captured, and their plot to use nuclear weapons on Donut cities has been foiled. You all then walk out of the room to a large ceremony outside (similar to something at the end of Star Wars). Hector gives a speech and thinks all the brave muffins and donuts for striving towards peace. And before he forgets, Hector mentions one more individual who is neither muffin nor donut but still answered the calling to help others, even when those others were not like himself. You and alt you (the good version of you) are then honored with medals. Then a filled donut raises a ceremonial sphere into the sky and yells &quot;Peace&quot; as the crowds erupt in celebration (just like in Star Wars).

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A3-S07-B-END]]]





MY NOTES:
- In the final scene / chapter of the game, you are in a small room with Hector, alt you, and other dignitaries. On the news, it shows that three war criminals, Cain, Gorg, and Kegan, have been captured, and their plot to use nuclear weapons on Donut cities has been foiled. You all then walk out of the room to a large ceremony outside (similar to something at the end of Star Wars). Hector gives a speech and thinks all the brave muffins and donuts for striving towards peace. And before he forgets, Hector mentions one more individual who is neither muffin nor donut but still answered the calling to help others, even when those others were not like himself. You and alt you (the good version of you) are then honored with medals. Then a filled donut raises a ceremonial sphere into the sky and yells &quot;Peace&quot; as the crowds erupt in celebration (just like in Star Wars). The simulation ends, and you takeoff your simulator, and find yourself in the actual real world (in VR passthrough mode). The game is over at this point. Perhaps there will be credits, or perhaps a sign saying to take off your actual VR headset because the game is now over. I don&#39;t know yet.
Everything I mentioned about this &quot;bad&quot; path could turn out very different in the final product, but that&#39;s the main idea for the &quot;bad&quot; path. It&#39;s a dark path leading you to committing horrendous atrocities, but towards the end, you are presented with one last chance at redemption.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="76" name="A3-S07-B-END" tags="" position="1350,1350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 07-B]
CREDITS!]
&lt;img src=&quot;raw=1&quot; class=&quot;fit&quot;&gt;
You find yourself in the actual real world (in VR passthrough mode). The game is over at this point. Perhaps there will be credits, or perhaps a sign saying to take off your actual VR headset because the game is now over. I don&#39;t know yet.



MY NOTES:
- There may not even be VR pass-through remote. And I&#39;m still deciding how to do the credits. I still want to have it incorporated into the story somehow so it doesn&#39;t take you out of the immersion.

- Also, there needs to be a way to go back and select a mission to start from... Or, a way to restart the game if players want to play the alternative path.</tw-passagedata><tw-passagedata pid="77" name="A2-S32-G" tags="Timeframe_Advanced" position="1175,2850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 32-G]
GORG&#39;S SURPRISE ATTACK]

You are in a Muffin refugee camp. The mood is peaceful. Suddenly bombs drop from the sky. Muffin civilians scatter for cover. You follow one of them who is directing you. You hide in a house with a window where you can see outside. Donut soldiers march in, shooting any Muffin civilians on sight.


&lt;img src=&quot;https://i.imgur.com/MXJbxta.jpg&quot; class=&quot;fitHalf&quot;&gt;
A donut tank blasts a hole in one of the buildings and a bunch of muffin civilians, including Muffin children, run out in panic. The Donut soldiers gun them all down. You follow the Muffin guiding you threw the camp to reach safety. At the end of that stealth sequence, your muffin guide gets gunned down running between buildings. A Donut soldier points a gun at you, but someone tells him to &quot;hold your fire&quot;. That someone is Commander Gorg, who was surprised to see you. 


&lt;img src=&quot;https://i.imgur.com/tloyHAN.jpg&quot; class=&quot;fitHalf&quot;&gt;
He explains you are in dangerous muffin territory, and asks you not to tell Grimmer about this operation, since he didn&#39;t authorize it. Suddenly, Gorg and the Donuts come under attack. Gorg immediately fleas for safety in an armored vehicle. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S33-G]]]



SCRIPT DRAFT:



</tw-passagedata><tw-passagedata pid="78" name="A2-S33-G" tags="Timeframe_Advanced" position="1175,2975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 33-G]
MUFFINS RECAPTURE THE CAMP]
&lt;img src=&quot;https://i.imgur.com/Zma8R0l.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are with Muffin resistance fighters overlooking the Donuts attacking the camp you were just in. A large battle ensues. One of the largest in the entire war as both sides pour heavy resources into defeating the other side. This battle ends with the Donuts retreating and Muffins capturing some Donut soldiers while securing the area.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S34-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="79" name="A2-S34-G" tags="Timeframe_Advanced" position="1175,3100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 34-G]
SPLIT]

You are at a rear muffin base with Hector and Cain. Dead muffin bodies from the latest donut attack are piling into the base to be processed for burial. Cain, Hector, and other muffin resistance leaders discuss the state of the war and what should be done next. Hector proposes a diplomatic visit to the donuts to present their evidence of war crimes committed by donuts. Cain vehemently objects, demanding retaliatory attacks instead. There is a falling out between Hector and Cain. Cain declares anyone who works with donuts to be an enemy. Hector vows to hold all war criminals accountable, whether Donut or Muffin. Guns are pulled.


&lt;img src=&quot;https://i.imgur.com/KFVXUGM.jpg&quot; class=&quot;fitHalf&quot;&gt;
Cain fires at Hector and his men. Hector&#39;s guards protect him from getting shot. One of Hector&#39;s guards is killed, several are wounded. Cain escapes as resistance fighters exchange fire with the Sacred Knights. You help fight with the resistance. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S35-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="80" name="A2-S35-G" tags="Timeframe_Advanced" position="1175,3225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 35-G]
DELEGATION]

You are at the Donut capital building with Grimmer, Johnson, and others. Hector&#39;s delegation arrives. There is a large Donut media presence as this is the first time since the start of the war that a muffin has been invited to speak in donut government. Hector didn&#39;t expect to be presenting evidence to the donut government. Grimmer guides Hector in the capital building. Gorg is already seated as a witness. He&#39;s having a friendly chat with many of the donut politicians. The inquiry commences.


&lt;img src=&quot;https://i.imgur.com/pqxP2mt.jpg&quot; class=&quot;fitHalf&quot;&gt;
Donut politicians are ideologically divided. Segregationist Donuts don&#39;t believe any of the evidence Hector is presenting of Donut war crimes. They twist Hector&#39;s presentation to suggest donuts were only targeting enemies, and if they killed Muffin civilians, that was because enemy Muffins were using them as shields. Assimilationist Donuts are the opposite. They denounce the war, and want to welcome muffins into their territories. Hector explains how that would not be wise. He explains that there is still a significant amount of anger towards donuts amongst Muffins. And that a radical faction of the muffin resistance is currently plotting attacks on donuts. Hector vows to fight the Sacred Knights, even willing to share intelligence with the donuts defense league. In exchange, Hector wants recent war crimes investigated and a ceasefire between the Muffin resistance and Donuts. Gorg argues against Hector, stating that the ceasefire will only give the muffins time to prepare for greater attacks. Hector makes a fancy speech about how they share a common enemy. In a slim margin, the donut committee barely votes in favor of Hector&#39;s proposal. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S36-G]]]




MY NOTES:
- The president donut, heading the hearing, is a staunch segregationist and does not believe anything Hector is saying. He firmly sides with Gorg.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="81" name="A2-S36-G" tags="Timeframe_Advanced" position="1175,3350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 36-G]
SIMULATE THE PAST]

You are now at Sim Labs HQ. It&#39;s not a fully complete facility. The Simulation Computation Chamber is still under construction, for instance. Ludwig and Hector are having a discussion about the progress of Sim Labs research and about you. You are then put through a series of tests.


&lt;img src=&quot;https://i.imgur.com/SK234l2.jpg&quot; class=&quot;fitHalf&quot;&gt;
It is discovered that you are currently in a simulation and that everything they know in this world is simulated. You are able to alter reality using simulations of the past. The only explanation for this is you are already in a simulation. Ludwig hacks a simulator to be able to monitor you. You are sent in with guidance from Ludwig and Hector. You can&#39;t touch anything or be spotted. Otherwise you will cause decoherence with Ludwig and Hector. Your simulated mission is to sneak into Cain&#39;s base to find out their attack plans. Hector learns of Cain&#39;s plans to warn Grimmer about. Hector video calls Grimmer with the new intel. 


&lt;img src=&quot;https://i.imgur.com/lKnHl1M.jpg&quot; class=&quot;fitHalf&quot;&gt;
Grimmer shares intel himself that Donuts are planning an attack in a weak sector of the Muffin resistance, and descreately advises Hector to bolster security to deter an attack there. It’s elements of the Donut military that Grimmer cannot control. Hector asks to do a mission to discover the origin of the massive explosion. Ludwig nonchalantly says they know it&#39;s a nuclear explosion and how it works and that the Donuts are the only ones capable of building it. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S37-G]]]



MY NOTES:
- At one point, Ludwig notices you have a WPS tracker patch and instead of suspecting something suspicious, he just finds it convenient and hacks it to know your location at all times.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="82" name="A2-S37-G" tags="Timeframe_Advanced" position="1175,3475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 37-G]
PREDICT THE FUTURE]

You join Johnson to go on a security post overlooking a bridge crossing. Sacred Knights attack and you must fight off waves of enemies. This simulation ends and you remove your simulator headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S38-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="83" name="A2-S38-G" tags="Timeframe_Advanced" position="1175,3600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 38-G]
CODE RED]

You&#39;re at a Donut base with Grimmer and Hector. They discuss the successful repulsion of many Sacred Knights attacks. Hector then reveals the new intel that Donuts are the only ones capable of building a nuke. 
Grimmer takes a moment to absorb the implications of this new intel with everything he knows. 
GRIMMER: “So it’s likely true, Johnson.”
JOHNSON: “Unfortunately sir.”
GRIMMER: “Sergeant Kegan heads the advanced weapons program. If what you say is true, he’s behind the development of the nuke. But that’s not everything we need to be concerned about. There are rogue elements of the DDL planning something big in secret from us.”
HECTOR: “How do you know this?”
JOHNSON: “We received reports from DDL officers under Commander Gorg of an unusual change in training. As if they are training for combat in Donut urban centers.”
HECTOR: “There is a threat from Cain’s forces to be ready for.”
JOHNSON: “It’s not that kind of combat they’re training for.”
GRIMMER: “2 days ago, we stopped receiving information from those officers, and Commander Gorg is no longer responding to our communications. A delegation was sent to them yesterday. We suspect Gorg is holding them captive. We don’t know what they are planning exactly.”
HECTOR: “Professor Ludwig. Is this something your simulation technology can help with?”
LUDWIG: “Easily.”
HECTOR: “Do we need to send in Anderson?”
LUDWIG: “No need. We already have a robust model of Commander Gorg. Turns out he’s quite predictable. In every simulation we ran, he does the same thing. Even on the primitive simulations.”
	Silence in the room while everyone waits for LUDWIG to answer.
JOHNSON: “And that is…?”
LUDWIG: “Oh come on. You of all Donuts should know.”
	JOHNSON and GRIMMER stare at each other.
GRIMMER: “Congress is in session today.”
	JOHNSON radios in.
JOHNSON: “We have a code red. Prepare all QRFs. I repeat, code red. Prepare all QRFs immediately.”
	JOHNSON runs out of the room. GRIMMER checks his pistol.
GRIMMER: “I don’t have many men near the capital to defend it.”
HECTOR: “We will help.”
GRIMMER: “No. It won’t look good to have Muffins fighting Donuts in the capitol.”
HECTOR: “Helping doesn’t always mean fighting.”


&lt;img src=&quot;https://i.imgur.com/Ua6v3aB.jpg&quot; class=&quot;fitHalf&quot;&gt;
	SCENE ENDS.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S39-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="84" name="A2-S39-G" tags="Timeframe_Advanced" position="1175,3725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 39-G]
DEFEND THE CAPITAL]
&lt;img src=&quot;https://i.imgur.com/b5pBWIJ.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
You join JOHNSON and GRIMMER as they lead a counter assault on Gorg’s coup in the capital building.


&lt;img src=&quot;https://i.imgur.com/PydJp1u.jpg&quot; class=&quot;fitHalf&quot;&gt;
HECTOR and a handful of Muffin medics come along and try to save anyone wounded in the attacks. 


&lt;img src=&quot;https://i.imgur.com/nidhQ7i.jpg&quot; class=&quot;fitHalf&quot;&gt;
You don’t save everyone. But you help the capitol police fight back against Gorg’s spec ops forces and regain control. END SCENE.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S40-G]]]


&lt;img src=&quot;https://i.imgur.com/AdhJu2w.png&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(New Donut Order Flag (not final version))]


MY NOTES:
- The president donut, who is a staunch segregationist, is found wounded in the attack. Hector and some other muffin medics help heal his wounds while Grimmer&#39;s forces defend the office and continue fighting back. Hector asks you to help somehow so you can witness the scene for story purposes. The president donut, eventually blacks out, but he is still alive.




SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="85" name="A2-S40-G" tags="Timeframe_Advanced" position="1175,3850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 40-G]
PROPAGANDA]
&lt;img src=&quot;https://i.imgur.com/GJs4I9o.jpg&quot; class=&quot;fitHalf&quot;&gt;
There’s conflicting information about the attack. Gorg puts out propaganda saying they were the ones responding to a coup attempt by treacherous Donuts, highlighting the precipitation of the Muffin enemy in the attack.
GRIMMER is on calls with Generals to get them to understand the truth of the capitol attacks. You can’t hear him but you, Johnson and Hector watch through glass from outside the room. Grimmer exits and tells y’all that some Generals believed him while others believed Gorg. Or they don’t believe Gorg necessarily, but they consider Grimmer’s partnership among Donuts and Muffins treacherous.
GRIMMER: “There’s a fracture within our society. Some Donuts are convinced it’s impossible to live with Muffins in peace. They believe we tried. The truth is, we never tried. Our directive was to expand Donut territory as far as we could. We’d allow pacified Muffins to live with us, so long as they remained passive. Donut politicians don’t see it. They don’t see what it’s like to uproot a Muffin family from their home and force them to wander westward. All they see is more land on a map for Donuts. They can’t understand why Muffins would resist us.”
HECTOR: “You were right. I was naive to think the image of Muffins in the capital wouldn’t be spun for propaganda. Perhaps it’s best to break off our cooperation. It could be making our situation worse.”
GRIMMER: “Donuts have a creed, Hector. We never abandon a loyal ally. It’s my duty to uphold our creed, and I have always done my duty.”
HECTOR: “That&#39;s very noble of you General, but we have reality to contend with. And reality is shaped by perceptions.”
GRIMMER: &quot;The Donut Defence Legue can handle Gorg and his followers without help from Muffins.&quot;
HECTOR: &quot;And we can handle Cain&#39;s Sacred Knights.&quot;
...

Grimmer and Hector discuss how fragile the partnership is between donuts and muffins. Cain will try to attack Donuts and Gorg will try to attack Muffins. They need to consult Ludwig about this in a video call.
Ludwig complains that the simulations they currently have are not accurate enough to predict precise attacks. He is working on a more advanced simulation to do this. Hector asks if they can send you back in to the simulation to gather intelligence. Ludwig says it&#39;s too risky because your actions within the simulation could influence their reality. It was too risky to even do it the first time. 
Ludwig assures them they are almost ready with more advanced simulations that do not require the use of you. In the meantime, Ludwig sends them a map of possible locations for future attacks, according to current gen simulations.


&lt;img src=&quot;https://i.imgur.com/Cq1V4bQ.jpg&quot; class=&quot;fitHalf&quot;&gt;
Grimmer and Hector review the map. Grimmer assures Hector they can secure all the Muffin targets that Gorg might attack. But then he warns that Sprinkle City is a very soft target. They are perhaps the only major city that has empathy for Muffins. They are assimilationist... very assimilationist. The Mayor is an old friend of Grimmer, but she won&#39;t listen to Grimmer who has already told them they need to increase security. But perhaps they will listen to Hector.


(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S41-G]]]




MY NOTES:
- While Ludwig explains why it&#39;s too risky to send you in a simulation to gather intel, he states that even with apparently minimal interaction, some anomolies have manifested within Sim Labs that they have to deal with. In the background, a chathulo type entity almost breaches a large steel containment door. Ludwig helps the other scientists put secure it back. Then Ludwig states, it&#39;s too ricky to do that again. And if they are gonna send you in a simulator, it has to be a one way trip with zero comunication ability and the understanding that it will alter reality... or perhaps be it&#39;s own reality entirely distinct frim this one.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="86" name="A2-S41-G" tags="Timeframe_Advanced" position="1175,3975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 41-G]
SPRINKLE CITY]

You and Hector along with a few muffins go to sprinkle city to meet with Mayor Sheila. She makes her case as to why she does not want security. Their city has never been attacked by muffins, and they don&#39;t want to become a target by instigating the muffins. She wants her city to be a beacon of hope for future peace with Muffins.
Hector finds her admirable, but insists there needs to be more security.


&lt;img src=&quot;https://i.imgur.com/cznG5sX.jpg&quot; class=&quot;fitHalf&quot;&gt;
SHEILA: &quot;I don&#39;t understand. Why would Muffins want to attack our city? It&#39;s because I&#39;m a woman, isn&#39;t it?... I mean, I&#39;m not saying your culture is hostile towards women. I mean, have you seen Donut cities. All the mayors are men except for this one.&quot;
HECTOR: &quot;Mayor Sheila, if I may ask, what is your conception of muffins?&quot;
SHELIA: &quot;I&#39;ve studied your history. I know the horrible things our donut society has done. The mass displacement of Muffins from your native lands is unforgivable. Yes, there have been attacks on Donuts by Muffins, but that&#39;s part of your resistance. I&#39;m sure you Muffins have good reasons for attacking innocent Donut civilians. I can&#39;t say I support you, but I understand.&quot;
HECTOR: &quot;You understand?&quot;
SHELIA: &quot;Yes, we killed many Muffin civilians, so I understand why you would kill Donut civilians.&quot;
...blah blah blah...
SHELIA: &quot;It pains me to say this. But Maybe the segregationist donuts are right. Maybe it&#39;s not possible for Muffins and Donuts to ever live together.&quot;

They haven&#39;t been muffins in the city since war began. They don&#39;t have the right conception of muffins. They have a conversation and Hector convinces the mayor to allow defenses.

An attack by the Sacred Knights comences and you move throughout the city to help fight them off.


(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S42-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="87" name="A2-S42-G" tags="Timeframe_Advanced" position="1175,4100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 42-G]
GRIMMER MEETS WITH DONUT LEADERS]

WRITING NOTE: Grimmer is trying to convince Donut politicians of the need to formalize their current allience with Muffins, so they can more effectively combat the threats from Gorg and The Sacred Knights. He proposes a &quot;United Sweets Alliance&quot;.


&lt;img src=&quot;https://i.imgur.com/HRVB4cB.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Grimmer does not propose a flag design or even a new nation. He is only proposing a formal alliance. The flag design comes later and the new &quot;United Sweets&quot; nation comes well after Grimmer&#39;s death.)]
The scene opens up with General Grimmer discussing recent rebuffs of Gorg&#39;s attacks on Muffin refugee camps with Johnson and other Generals. Someone comes in to inform Grimmer that the Donut leaders are here. You all walk there.
The leaders are in a room. Some are discussing the Donut leaders that already switched over to supportng Gorg. Some discuss the Donut president being taken by Gorg in critical condition and they are trying to heal him.
Grimmer starts speaking. Donut leaders are upset with Grimmer. They see this alliance with Muffins as troublesome. It brought their civil war to Donut cities. And Grimmer has forces defnding Muffins against other Donuts while their own cities are attacked by Muffins. It looks very bad.
Grimmer tries to explain to everyone their strategy and remind them all what is actually going on. The DDL is fighting against Gorg&#39;s followers, while the Muffins are themselves fighting an internal war. He reminds everyone that Gorg is the one who attacked the capital.

GRIMMER: &quot;Can&#39;t you see what is going on? Gorg is attacking Muffin civilians. Cain is attacking Donut civilians. It&#39;s as if they are working together trying to break any chance of a partnership between good Muffins and Donuts.&quot;
DONUT POLITICIAN A: &quot;Well, it&#39;s working. I don&#39;t see how you can trust these Muffins you&#39;re working with.&quot;
DONUT POLITICIAN B: &quot;Yeah, I heard the Muffins aren&#39;t even fighting each other. Hector&#39;s Muffins just pretended to fight against Cain so they could work together to destory Sprinkle City from within.&quot;
DONUT POLITICIAN C: &quot;What is with you segragationists and your conspiracy theories?&quot;
DONUT POLITICIAN B: &quot;It&#39;s not a conspiracy theory. It&#39;s called a Doughjan horse. Ever heard of it?&quot;
DONUT POLITICIAN C: &quot;You know the Doughjan horse is from a myth, right?&quot;
DONUT POLITICIAN B: &quot;Of course I know that, but the principle still stands. General Grimmer, I have the upmost respect for you, but I simply cannot support this misguided direction you are taking our great Donut society.&quot;

DONUT POLITICIAN A: &quot;We don&#39;t know for sure that it was Gorg who started the coup.&quot;
	Everyone grones and berates DONUT POLITICIAN A.
DONUT POLITICIAN A: &quot;Look. That&#39;s not what I meant. Obviously we all know what happened, but recent polls show most of the public believes Gorg was the one defending the capital.&quot;
DONUT POLITICIAN C: &quot;So all you care about is the polls.&quot;
DONUT POLITICIAN D: &quot;Does truth not even matter to you anymore?&quot;
DONUT POLITICIAN A: &quot;All I&#39;m saying is maybe it&#39;s not so bad if us Donuts unite again, and we just let Gorg pretend to be the new president.&quot;
DONUT POLITICIAN C: &quot;What makes you think he only wants to be president?&quot;
DONUT POLITICIAN A: &quot;Well, what else can he want?&quot;
GRIMMER: &quot;Ladies and Gentlemen, the support from each of you is important to sustain the DDL from not just the threat of Gorg and his followers, but also from the Muffins militants fighting under Cain.&quot;
DONUT POLITICIAN A: &quot;I&#39;m sorry General. You&#39;re a good man, but I just can&#39;t support you on this, even if I wanted to. It&#39;s politically untenable.&quot;
DONUT POLITICIAN C: &quot;You have my support General.&quot;

The Donut politicians are divided in their support.
Grimmer gets a call from Hector saying they have a problem.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S43-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="88" name="A2-S43-G" tags="Timeframe_Advanced" position="1175,4225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 43-G]
LUDWIG CAPTURED]
&lt;img src=&quot;https://i.imgur.com/SDCJ4Pq.jpg&quot; class=&quot;fitHalf&quot;&gt;
You appear with Cain who has extracted you using Sim Labs technology. It is revealed that they have captured Ludwig and his team. The SK now have the intel advantage.
CAIN: &quot;Next target Sprinkle City.&quot;
SK MUFFIN: &quot;Wasn&#39;t that also our last target?&quot;
CAIN: &quot;YES, I KNOW IT WAS OUR LAST TARGET! And it&#39;s also our next target. Except this time, we won&#39;t be defeated.&quot;

Cain inquires with Ludwig about how he can use you. Ludwig comments that it&#39;s quite hard to control you. The nature of the simulation that you&#39;re in makes it unpredictable when and where you will be each time the RAM overflows and an extraction event occurs.




(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S44-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="89" name="A2-S44-G" tags="Timeframe_Advanced" position="1175,4350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 44-G]
SPRINKLE CITY THE 2ND WAVE]

The Muffins can&#39;t hold the city against Cain. Grimmer is called in to offer more help. 
Without Ludwig, Hector and Grimmer are too outmatched to work separate and they must now work closer together.
They retake the city at a heavy cost. After securing the city, they are attacked from the other side by Gorg&#39;s forces. They are too overwhelmed and depleted to defend against another assault and so Grimmer and Hector are forced to retreat and abandoned the city.


&lt;img src=&quot;https://i.imgur.com/AGFz9eH.jpg&quot; class=&quot;fitHalf&quot;&gt;

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S45-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="90" name="A2-S45-G" tags="Timeframe_Advanced" position="1175,4475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 45-G]
THE FINAL STAND]

The USA (United Sweets Alliance) has been relentlessly persud by Gorg&#39;s forces, all while trying to protect the fleeing Muffin and Donut refugees. They are cutoff from allies in the east and west. They are setup on one of the last remianing Donut airstrips that the USA controls. Hector is helping refugees. Grimmer walks up to him to inform him their sitrep meeting is soon to start. As you all walk towards the meeting room, an old Donut lady and an old Muffin lady stop you all to thank the USA. The had been friends before the war until the segragationists instituted laws forcing Muffins to flee. They presented a new flag they crocheted together since the currently flying Donut flag had be so tattered in past battles.


&lt;img src=&quot;https://i.imgur.com/gQDoKGK.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: The USA flag design could change.)]
Grimmer orders a soldier to lower the old flag and raise this new one. Grimmer and Hector simply assume it&#39;s the same old Donut flag, not a new design. Y&#39;all continue walking to the sitrep meeting.
Grimmer and Hector are discussing all the losses they&#39;ve been taking and how relentless the enemy has been against them. Without warning, Gorg&#39;s followers launch a massive attack.


&lt;img src=&quot;https://i.imgur.com/3PxnNcB.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
Grimmer is killed and Hector&#39;s whereabouts is unknown.


&lt;img src=&quot;https://i.imgur.com/LgAFbjK.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: This scene is currently very under developed, as you can tell by the little amount of information. But I might have this game sequence where you and General Grimmer go in a fighter plane to defend against the attack. Then at the end of this scene, Sergeant Kegan dramatically arrives in his fighter plane and damages your plane forcing you and Grimmer to both eject. Your parachutes deploy and as you are falling, Kegan fires an auto-cannon barrage shredding Grimmer until only his parachute remains. You watch as Kegan&#39;s fighter plane circles around and comes for you next. But before he lines up his shots, The Simulation™ glitches. Here is an old image I drew of how I imagined this scene:)]
&lt;img src=&quot;https://i.imgur.com/necXJvI.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S46-G]]]


UNITED SWEETS ALLIANCE FLAG WILL FIRST APPEAR IN THIS SCENE. IMAGE IS TBD.


MY NOTES:
- Only a small part Muffins and Donuts see this as a good thing with the majority siding with their extreme elements. Even Sprinkle City falls to Gorg with the mayor being imprisoned by Gorg with charges of aiding Muffins.




SCRIPT DRAFT:



</tw-passagedata><tw-passagedata pid="91" name="A2-S46-G" tags="Timeframe_Advanced" position="1175,4600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 46-G]
POST APOCALYPTIC FUTURE]
&lt;img src=&quot;https://i.imgur.com/ce1z92b.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: I&#39;m imagining some destroyed skyscrapers in the background to really convey the idea that the world has been destroyed.)]
You have been extracted by Ludwig and his small team. The world is a post apocolipliptic wasteland. You are all in a shanty house with make shift stuff everywhere. You learn that everything went to hell after Hector was executed by Cain. The war intensified and this is what remains.

But Ludwig has a plan. There is an opportunity for you to rescue Hector in the past before his execution. You would need to sneak into the Sacred Knights base where Hector is being held and break him out of confinement without being detected.
Ludwig acknowledges that you rescuing Hector might not affect their reality that they are currently in, but at least it could affect some reality for the better.


&lt;img src=&quot;https://i.imgur.com/InO2Dkq.jpg&quot; class=&quot;fitHalf&quot;&gt;
Ludwig prepares simulator for you to put on. One of the other scientists comments that perhaps he should double-check to make sure it&#39;s calibrated accurately. Ludwig pauses for a moment as if he might disagree but then says thanks for the reminder before double-checking and correcting the calibration. Ludwig gives you a simulator to put on.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|A2-S47-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="92" name="A2-S47-G" tags="Timeframe_Advanced" position="1175,4725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 47-G]
RESCUE HECTOR
EXT - NIGHT - SACRED KNIGHTS CAMP]

You sneak into the base of the Sacred Knights where Hector is being held prisoner. You locate where he is and reach him undetected. As you are releasing him, Cain bursts in and notices what&#39;s going on.


&lt;img src=&quot;https://i.imgur.com/gJChfBJ.jpg&quot; class=&quot;fitHalf&quot;&gt;
There is a confrontation between Hector and Cain. This is perhaps the last time Hector tries to convince Cain what he&#39;s doing is wrong and goes against the tenents that of the Sacred Texts that they claim to uphold. But Cain is stubborn and comments about how he should do the execution of Hector.
Just then, someone else is heard breaking into the building and blasting away Cain and his guards.


&lt;img src=&quot;https://i.imgur.com/2rkUZ09.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Your alt self should look different because he&#39;s been heavily modified into a war machine by Kegan. I&#39;m not sure how he should look exactl. We will figure that out later.)]
It is your alt self from another simulation that has come to help you and Hector escape. You and Hector run out while alt you stays behind to fight waves of enemies.
As you run over the hill to escape, The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S48-G]]]



MY NOTES:
- Hector doesn&#39;t remember how he ended up a prisoner of Cain.









SCRIPT DRAFT:

	YOU find yourself on the outskirts of a camp where HECTOR is being held hostage. Your task is to find HECTOR and escape.
……..
CAIN.
You know why that is? It&#39;s because they know the peaceful get crushed.
And that, the only thing that matters in this world, is power.
HECTOR.
You sound like Gorg.
CAIN.
… Thank you.
HECTOR.
That wasn&#39;t a compliment.
CAIN.
Let me teach you how the world works.
When you two are executed on live TV, the simpletons will hate me. Yes, you&#39;re right about that.
Then, they will fear me. And finally, they will join me.
Just need to find a creative way to kill the both of you to maximize media coverage.
Perhaps, hammer punch to the face.
… What was that?
	OTHER YOU breaks in, punches CAIN, and frees YOU and HECTOR.
OTHER YOU.
Come with me.
HECTOR.
Who are you?
OTHER YOU.
I&#39;m you from another simulationTM.
HECTOR.
You’re me?!
OTHER YOU.
No, not you, obviously. I’m him.
… Quickly!






</tw-passagedata><tw-passagedata pid="93" name="Names List" tags="" position="350,475" size="100,100">Names List

This page is a list of all characters in this game with names.
Donuts mainly have American accents, so Donut names should be more American sounding. With the exception of Twist Dounts who have either German or French accents.
Muffins all have British-like accents, so they should mostly be assigned British names. Frost Peak Muffins will still have &quot;British-like accents&quot;, but their names can be more nordic.

A short description next to each name is meant to be a quick reminder who each character is.






		DONUTS
	MAIN CHARACTERS
General Grimmer - Supreme General of the entire DDL (Donut Defense Legion). (Bar Donut)
Sergeant Kegan - Highly influential Sergeant. Director of top secret DDL military research programs. Tactical Coordinator of the clandestine / covert elite &quot;Red Unit&quot; DDL Spec ops force. (Bar Donut)
Commander Gorg - Commanding General of North Western DDL forces. (Ring Donut)

	SECONDARY CHARACTERS
Lieutenant Johnson - Tactical Coordinator of DDL Spec ops forces under Grimmer. (Bar Donut)
General Zimmar - Commanding General of South Western DDL forces. (Twist Donut)
General Kessler - Commanding General of Northern DDL forces. (Bar Donut)
Mayor Sheila - Mayor of Sprinkle City (Filled Donut)


	TERTIARY CHARACTERS
General Weber - Commanding General of Southern DDL forces. (Filled Donut)
President Dunkin - The President of Donuts. Though a stunch Segregationist, he turns against and is assassinated by Gorg deep in Act 2. (Ring Donut)
Major Graham - One of the background Donut officials that attends war room meetings.



	EXTRA NAME IDEAS (MALE)
Taylor
Logan
Clayton
Tucker
Blaine
Jake
Jason
Bill
Darrell
Cooper
Harris
Ricky
Grant
Holden
Reed
Carson
Henderson


	EXTRA NAME IDEAS (FEMALE)
Mary
Emma
Ann
Wendy
Harper
Morgan
Piper
Riley
Hannah




		MUFFINS
	MAIN CHARACTERS
Professor Ludwig - Lead Simulation Researcher at Sim Labs.
Hector - Head of Logistics and Welfare in the Resistance.
Cain - Leader of the Sacred Knights.

	SECONDARY CHARACTERS
James - Overseer of armed forces in the Resistance.
Marcus - Captian of special missions in the Resistance.
Winston - Sacred Knights: Cain&#39;s Right Hand.
Ragnar - Leader of the Frost Peak Tribal Militias.


	TERTIARY CHARACTERS
Timothy - Research Assistant at Sim Labs.
Doctor Westheimer - Former Nuerosergon at Golden Glaze Hospital. Current Cheif Advisor at Sim Labs.
Professor Rupert - Lead Simulation Researcher at Sim Labs.
Henry - SK Muffin who is morally conflicted


	EXTRA NAME IDEAS (MALE)
Leon
Quentin
Sterling
Neville
Cedric
Harry
William
Richard
Percy
Gunnar / Gunthar (Frost Peak)
Torin (Frost Peak)
Magnus (Frost Peak)
Stellan (Frost Peak)
Soren (Frost Peak)



	EXTRA NAME IDEAS (FEMALE)
Meredith
Eleanor
Lucinda
Kathrin
Penelope
Vivian
Gwendolyn
Freya (Frost Peak)
Astrid (Frost Peak)
Hilda (Frost Peak)



</tw-passagedata><tw-passagedata pid="94" name="A2-S19.2" tags="Timeframe_Early" position="1050,850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 19.2]
HOSTAGE RESCUE]

Johnson leads a task force to resuce Donut hostages held by Muffins. After a few Muffin gaurds are sniped, you all move into the outpost. There is only a Muffins civilian pressence when entering the Muffin outpost. 


&lt;img src=&quot;https://i.imgur.com/Ow0LEAT.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: The donut soldiers will have more gear on, like a vest holding extra magazines for their rifles and may be a pistol in its holster. To be clear, This is not necessary to draw. In fact, I strongly advise against drawing these details for these quick story sketches. I just wanted to mention it.)]
Johnson orders that no Muffin civilians be shot. After you recover the hostages in the Donut buildings, the streets are empty of Muffins. On your way out, Muffin militants attack. You fight your way out.


(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S19.3]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="95" name="A2-S19.3" tags="Timeframe_Early" position="1050,975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 19.3]
DEBRIEF
INT - DAY - GENERAL GRIMMER’S OFFICE]

You are at a DDL FOB in Grimmer&#39;s Office. Grimmer is doing paperwork on his desk. A Donut Hole custodian is cleaning up his office with a duster. Major Graham walks in to inform Grimmer that the meeting is ready to start. There&#39;s a tense exchange where Graham belittles the Donut Hole and Grimmer indirectly confronts him to defend the Donut Hole. Graham is dismissed. Grimmer stoicly stares out the window for a few moments.


&lt;img src=&quot;https://i.imgur.com/GV5EgMC.jpg&quot; class=&quot;fitHalf&quot;&gt;
After a few moments of staring out the window, General Grimmer turns around and walks out of the room while telling you to follow him to the meeting. After Grimmer leaves the room, the donut hole who is cleaning the shelves with a duster accidentally knocks over a picture of Grimmer&#39;s military academy class. He scrambles to pick it up, but then finds a second picture hidden behind the first.


&lt;img src=&quot;https://i.imgur.com/OP8VU3M.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: The front picture should be of Grimmer&#39;s academy class. Grimmer is not vain enough to have a picture of himself alone... unlike Gorg who is so vain, it would be unusual for him to have a picture of anyone except himself. Haha. Also, orientation for both pictures should be landscape, not portrait.)]
It&#39;s of a Donut Hole lady with a Bar Donut child that looks like Grimmer. (It&#39;s General Grimmer as a child with his donut hole mother.) If you&#39;re still in the room, the donut hole will even make eye contact with you with a shocked expression as he gently places both pictures on the desk and cleans up the shattered glass and picture frame.

Y&#39;all then go to the war room to debrief on the hostage rescue. (This is an opportunity to insert some special dialogue depending on your actions in the previous mission.) Grimmer warns there are likely to be reprisal attacks and tells all his Generals they need to temparary refrain from offensive actions so they can bolster security in their sectors. Grimmer warns the Muffins like attacking populated areas with less security like schools, malls, parks, etc.
Gorg complains about this plan to hold back his attacks as a consequence of some &quot;stupid rescue opertion&quot; that he didn&#39;t even agree to.
GORG: Our job is not to babysit the population and wait to be attack. It&#39;s much better if we go out and kill those Muffins before they even think about attacking us.
GRIMMER: I already gave the order, Commander. If you can&#39;t uphold you duty, I will find someone else to take over your position. Do I make myself clear?
GORG: Transparently.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S19.4]]]






MY NOTES:





SCRIPT DRAFT:
	GRIMMER is in his office while DONUT HOLE is cleaning up. GRIMMER is working on plans at his desk. DONUT SUBORDINATE knock on the door.
GRIMMER.
Come in.
	DONUT SUBORDINATE enters.
DONUT SUBORDINATE.
Good morning General. (Clears throat loudly.)
	DONUT SUBORDINATE seems like he&#39;s about to talk more, but he notices DONUT HOLE in the room. DONUT SUBORDINATE glares at DONUT HOLE until he leaves the room.
DONUT SUBORDINATE.
(Smirk.) I didn’t know you were friendly with Donut Holes, General. Hahaha. I’m joking of course. Although you are braver than I am. Can you imagine what the other Generals would think if they saw me associate with a Donut Hole?
GRIMMER.
What do you think of me, Major?
DONUT SUBORDINATE.
(Smirk.) What do you mean?
GRIMMER.
You saw me associate with a Donut Hole.
DONUT SUBORDINATE.
No no no no no. No one would dare accuse you of being associated with a Donut Hole. Obviously, you just use them for, menial tasks. Like we all do. That way, we can focus on important matters.
GRIMMER.
I’m sorry, Major. I was not aware you consider their work unimportant. I can have them skip cleaning your quarters.
DONUT SUBORDINATE.
Wait, I didn’t say unimportant. Just, significantly less important.
GRIMMER.
Major, please. We can&#39;t be wasting resources. Is their work important to you, yes or no?
DONUT SUBORDINATE.
Yes, I suppose you’re right. It is important work. You know General. That’s why everyone in this army admires you. You’re such a clear thinker. I don&#39;t know much about your parents, but your dough line must be so pure.
If only other Donuts could think as clearly as we do General. They would understand that Donut Holes are a massive burden, holding back our great society. With all the trouble they cause, it’s hard to believe that anyone can actually care about them.
GRIMMER.
(Deep breath.) That is hard to believe.
DONUT SUBORDINATE.
Well, as long as they know their place. The other Generals are ready whenever you are, sir.
GRIMMER.
You are dismissed, Major.
	GRIMMER rummages through his desk for meeting notes. He stumbles upon a paper he kept since youth. It&#39;s macaroni art (with Cheerios instead of macaroni) depicting him as a child with his mom. GRIMMER has a flashback of memories with his mom. GRIMMER stares stoically at his paper for a few more seconds. Then it’s time for business.
	GRIMMER opens the door to the meeting room full of other Generals. Everyone immediately stops talking and salutes GRIMMER.
GRIMMER.
Let’s begin.

	I&#39;ll finish writing this scene later.



</tw-passagedata><tw-passagedata pid="96" name="Linguistic Terms" tags="" position="350,775" size="100,100">Notes about linguistic terms:

There are certain words or phrases that are not used in this game as to maintain immersion within this world of the game and not draw too much attention to outside real life entities or ideas. Some of these rules might seem ridiculous but I believe it is important and easy enough to avoid certain words and maintain the believability of this story taking place within its own world and not simply in analogy of a real world conflict.




====|=
&#39;&#39;DO NOT USE&#39;&#39;
====|=
&#39;&#39;USE INSTEAD&#39;&#39;
=|=
|==|



==|=
People / Person
==|=
Donuts / Muffins / Sweets / etc.
=|=
|==|


==|=
Terrorists / Terror Attacks
==|=
Savages / Savage Attacks
=|=
|==|


==|=
VR / VR Headset
==|=
Simulation / Simulator Headset
=|=
|==|


==|=

==|=

=|=
|==|


==|=

==|=

=|=
|==|











</tw-passagedata><tw-passagedata pid="97" name="A2-S48-G" tags="Timeframe_Advanced" position="1175,4850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 48-G]
REMNANTS]

You and Hector are walking through a blizzard in the snow. Eventually you come across the last remenents of the Donut and Muffin Alliance. It&#39;s a ragtag group of Muffin and Donut soldiers that are protecting a large group of Muffin refugees. Everyone is happy to see Hector. Hector gives an impromtue speech to this one group that is recorded live on video. The map shows they are cut off in the north and they are surrounded by enemies on all sides. Gorg&#39;s army is strong, so some suggest trying to cut through the relavily weak defences of the Sacred Knights to breakout, although even that would be suicide. With no good options, Johnson suggests marching north. Maybe they can sneak past the frost peak Muffins (allied with Cain), and then decide what to do. Everyone agrees that&#39;s a dumb plan, but that&#39;s the only plan they got.
Some volenteers are selected to perform a rear gaurd action to defend against persuing Gorg soldiers. You can choose to help or not.
You evetually retreat north and reach a large mountain pass and a giant gate.


&lt;img src=&quot;https://i.imgur.com/oTVknmB.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: This gate should be much wider. It&#39;s a big gate. I&#39;m imagining something similar to the gates of Mordor in Lord of the Rings. It shouldn&#39;t look evil like the Mordor gates, but it should be big like that and open up slowly: &lt;a href=&quot;https://youtu.be/QdtmlfLFgWg?si=VTL4jIDT158RoCwc&amp;t=25&quot; target=&quot;_blank&quot;&gt;Mordor gates reference video&lt;/a&gt;)]
Spotlights activate. You all halt and lay down your arms. Hector acknowledges this is the end of the shortlived alliance to his men. He steps out to give an impassioned plea to the Frost Peak Muffins to spare the lives of his men and to protect the Muffin refugees with them. He ends the speech saying he accepts being killed or returned to Cain.
The large gate opens. The Frost Peak leader walks out. He is very imposing. He stands before Hector, draws his pistol, then suddenly flips it with the handle facing Hector.
FROST PEAK LEADER: Take it.
HECTOR: What&#39;s this about?
FROST PEAK LEADER: Would you rather I kill you? Take it!
	HECTOR takes gun.
FROST PEAK LEADER: We&#39;re not savages Hector. You of all Muffins should know that.
HECTOR: Have you broken your oath to the Sacred Knights?
FROST PEAK LEADER: Absolutely not. The Muffins of Frost Peak always keep our oaths. It is they who broke their oaths.
FROST PEAK LEADER: They came not long before you, demanding of us to return you as their prisoner, were we to capture you. They have no authority to make such demands of us. When we reminded them of that, they threatened us to comply, so this is what became of them.
	Spotlights activate revealing dead SK fighters.
HECTOR: Did you have to kill them?
FROST PEAK LEADER: Hahaha! You really are as considerate as they say, Hector. And after all they had done to you.
HECTOR: Perhaps it was not their choice to end up here. I know much of the men who joined the Sacred Knights. They grew up in squaller. They saw no other path in life.
FROST PEAK LEADER: We have a code, Hector. The punishment for violating one&#39;s oath is death. Not even you can change that.
	The sounds of heavy tanks can be heard treading through the snow from beyond the gates.
FROST PEAK LEADER: Everything else, you can change. For we are now free from our oaths to Cain, and we have become disillusioned by Cain&#39;s twisted vision for our future. While I can&#39;t speak to this unusual parternership you have with Donuts, I will do everything in my power to stop Cain before he destroys us all. The choice is yours Hector. Will you allow us to join your allience?
...blah blah blah
More talking happens but the Frost Peak Muffins end up joining the alliance.


&lt;img src=&quot;https://i.imgur.com/SZFV84E.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: Heavy tanks and Frost Peak Muffin soldiers will be passing through the gates going the opposite way of the refugees. The Frost Peak Muffins here are reminiscent of the Soviet-Siberian divisions coming to counterattack the Nazis in World War II: &lt;a href=&quot;https://www.youtube.com/watch?v=1YvgsxBBvZI&quot; target=&quot;_blank&quot;&gt;Soviet-Siberian divisions reference video&lt;/a&gt;)]

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S49-G]]]



MY NOTES:
- By this point in the story, the frost peak Muffins should have a reputation for being tough and formidible forces.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="98" name="A2-S49-G" tags="Timeframe_Advanced" position="1175,4975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 49-G]
BAD OPTICS]

You are in Facility X. You got extracted.
Some Donut voice: &quot;That works much better than what we had. Where did you get this technology?&quot;
KEGAN: &quot;That&#39;s classified.&quot;
Kegan has a talk with you. He sees you as an enemy. He knows even more about you than you know about yourself. He even asks if you think it wasn&#39;t part of his plan to start a bigger war between Muffins by having the Frost Muffins switch sides and balance the Muffin powers so they can more thoroughly destroy each other. &quot;This is no way for you the win.&quot; Then, the TV is turned on to a speech. After waking from a long coma, the Donut president gives a speech on live TV under Gorg. He flips on Gorg mid-speech revealing Grimmer and Muffins are the good guys. Gorg executes him in a fit of rage. The broadcast abruptly ends.


&lt;img src=&quot;https://i.imgur.com/L3RDRGB.jpg&quot; class=&quot;fitHalf&quot;&gt;
Kegan is furious at Gorg and also acknoledge that was not supposed to happen.
A donut scientist questions what&#39;s going on and that the simulated predictions haven&#39;t been wrong until now. Kegan thinks for a second and then seemingly has a realization of what&#39;s going on. He orders you to be secured immediately. The scientists look around at each other because they don&#39;t understand what the concern is. Kegan orders they get a simulator configured immediately. They frantically try to get a simulator configured. They just need any simulator.
But before Kegan can put one on you, The Stimulation™ glitches.


(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S50-G]]]



SCRIPT DRAFT:


|action&gt;[You find yourself in Facility X after being extracted.]

|name&gt;[DONUT SCIENTIST]
|dialogue&gt;[Wow! These predictions are significantly more reliable than what we had. Sir, where did you get this technology?]

|name&gt;[KEGAN]
|dialogue&gt;[That&#39;s classified.]

|action&gt;[Kegan approaches you, his demeanor cold and calculating.]


|name&gt;[KEGAN]
|dialogue&gt;[So. You thought you were clever... helping Hector escape execution, flipping the Frost Peak Muffins to be part of your alliance. Did you really think everything you&#39;ve done wasn&#39;t part of our plan?]

|name&gt;[KEGAN]
|dialogue&gt;[- WAIT: Well...
- YES: You are even more naive than I imagined.
- NO: That&#39;s what I thought. Even you know better.]

|name&gt;[KEGAN]
|dialogue&gt;[In case it isn&#39;t clear to you, the balance of power is no longer equal in this war. We have obtained the most advanced simulation. We have run all variations of that simulation. There is no scenario where you win. There is no path to victory for your pathetic alliance. Everything you&#39;ve done has only increased Muffin infighting, acellerating the self-eradication of Muffins. While the Muffins are divide, we Donuts are becomin stronger and more united under one supreme order. The New Donut Order. All peices are in place. And this time, I will not make the same mistake with you, as I would have done in the future.]



Sergeant Kegan, sir. Former president Dunkin is about to give his endorsment speech of the New Donut Order. Would you like me to pull it up on the monitor?

I&#39;ve already seen it many times... but... our soldier here hasn&#39;t.
I&#39;ll let you decide, soldier. Do you want to witness this historic moment before begining your endless cycle of imprisonment?
Answer me soldier.
Do you want to watch the speech?
You decide or I will decide for you.


- WAIT: I gave you a chance soldier

- NO: Your choice.

- WAIT / NO (continued): We will begin your imprisonment. Get me a simulator.

Here you are, sir. It&#39;s calibrated accordingly.

If you decide later you want to witness history, don&#39;t worry, you only have forever to change your mind.



- YES: That infinite loop must be exhusting. Pull up a livefeed on the main monitor. Let&#39;s give our soldier here a front row view.
After this speech, no Donut will support your pathetic atempt at an alliance with Muffins.


	TV is on for the speech. The president is about to walk up to the podium.
    

TV REPORTER
The feeling here is profound. We are about to hear former president Dunkin speak. This will be the first time the former president will address the Donut nation since waking from his comma. What will he say? It appears King Gorg will speak first. Let&#39;s listen in.

GORG
Greetings my fellow Donuts. We live in a time of great hardship for all of us. From without, we face against the dispicable and savage Muffin menace. From within, we face an even greater threat. A fringe faction of Donuts have betrayed their fellow contrymen. Chosing to side with enemy Muffins against us. But today, I have decided to begin a new chapter. While we are still far from defeating the Muffin menace, today, we will put in end to our conflicts within. Today, we will forgive all Donuts who fought against us. Today, we will invite all Donuts to unite under the one and only banner of the New Donut Order!
I understand a small fraction of Donuts don&#39;t adore me as much as they should. So to speak to that miniscul minority of Donuts, I have welcomed back a hero to so many of us. A founding father of the segregationist movement. A man with courage, conviction, and an iron will spirit of perseverance. Most of you never beileved he would survive being shot by Muffins during the trecherous assult on our capital. But I always knew he would make it. Ladies and gentlemen, your former president, the great and honorable Dunkin.


DUNKIN
Thank you Commander- I mean King, is that right, is it King now? Thank you King Gorg. Funny, I didn&#39;t realize I was a FORMER president. I must&#39;ve been in that coma for a long time.
As I look out at the state of the world, I see so many, too many brave, good-hearted Donuts, tearing each other apart. This is wrong. We all know this is wrong. When good men and fighting and killing each other, that means our leaders have failed you... I have failed you. If my words still carry weight, I urge all good men to stop and deeply consider who it is you are fighting. Are they truly your enemy? Do you even understand them enough to know if you hate them? It is my firm belief that in most cases, that answer is no. They are not your enemy.
This is not to say there are no real enemies. There are great numbers of advisaries who wish to dominate, subjegate, and enslave others. All the more reason good men must unite. We must unite against our common enemy. Our enemy is savage, cruel, has no regard for innocent life.
I once believed that all Muffins were our enemies. That is, until I saw a side of Muffins I&#39;ve never seen before. This might surprise everyone to learn, but I was not shot by a Muffin at the capital. I was shot by a Donut and a Muffin saved my life. That Muffin who saved me was Hector, a leader in the newly established United Sweets Alliance.

GORG
Alright that&#39;s enough of that.

DUNKIN
No, I&#39;m not done speaking. I make a plea to all my fellow Donuts. I was wrong in my hostility to Muffins over my presidency. They are not all our enemies. So many Muffins are just like us. Well, not JUST like us. We&#39;re clearly better. But we can live with them in peace. Don&#39;t you all see? The old Donut government was never going to achieve peace. We sacrificed so many of our brave soldiers fighting the wrong enemy. I know this script they gave me says I must endorse the New Donut Order, but this organization is not gonna bring peace. Yes, the flag is very cool. I mean that is a really great flag, but this New Donut Order is not only fighting the wrong enemy, I have noticed that you are barely fighting the real Muffin enemy. A group they call the Sacred Knights. That is our real enemy. And the United Sweets Alliance, whom you all fiercely fight against, has been at the forefront of that great struggle. Please, I beg you all to stop fighting against the United Sweets Alliance. I beg you to join them instead. I beg you to help them--

	GORG pulls out his pistol and blasts president Dunkin.

TV REPORTER
Oh my. Can someone cut.. Can someone cut the livefeed--

	TV goes offline.





Is he going off script?

What&#39;s going on sir?

I don&#39;t know.



Gorg, you fudging idiot.

How in the world did that happen?

I swear, we ran the simulations so many times. Nothing like this has ever occured.

Where is the professor?

He&#39;s in confinment of course. The simulations always show him in confinement.

Pull up a camera feed.

See, Professor Ludwig always stays there, very still. He never does anything unless we tell him to.

Send a unit in there to check on him.

Uh, okay, sir.
Marsha, can you dispatch an escort unit to Professor Ludwig please?
Yes, everyone saw that on TV. Just hurry up and send the unit.

	The escort unit enters Ludwig&#39;s room.

Sir, the escort unit is in.

	The escort unit knocks over a cardboard cutout of Ludwig. Everyone is wide-eyed with surprise.

What in the...

Impossible.

Where is he?

Get me that simulator. NOW!

Uh, yes sir. Let&#39;s see. Configure the time coordinates.

HURRY UP! WE&#39;RE RUNNING OUT OF TIME!

Sorry sir. I&#39;m going as fast as I can.

GET OUT OF MY WAY! I&#39;LL DO IT MYSELF!

	The simulator sides out. Just before Kegan can get the simulator on your face, the simulation glitches.









I&#39;ve orchestrated this war to destroy both sides from within. There&#39;s no way for you to win.]

|action&gt;[A TV turns on, showing the Donut president giving a speech.]

|name&gt;[DONUT PRESIDENT]
|dialogue&gt;[Citizens, I&#39;ve been silent for too long. The truth is, General Grimmer and the Muffins he&#39;s allied with are not our enemies. They&#39;ve been fighting for peace, while Commander Gorg has-]

|action&gt;[Gorg suddenly appears on screen, enraged. He pulls out a gun and shoots the president. The broadcast cuts out.]

|name&gt;[KEGAN]
|dialogue&gt;[Fudge! What is that insulin thinking?!]

|name&gt;[DONUT SCIENTIST]
|dialogue&gt;[Sir, the simulations never predicted this. How is this possible?]

|action&gt;[Kegan pauses, then his eyes widen with realization.]

|name&gt;[KEGAN]
|dialogue&gt;[It&#39;s him. Secure the test subject immediately! And get me a simulator, now!]

|action&gt;[The scientists scramble to comply, confused by the sudden urgency.]

|name&gt;[KEGAN]
|dialogue&gt;[Move faster! We need to-]

|action&gt;[Before Kegan can finish, The Simulation™ glitches violently.]</tw-passagedata><tw-passagedata pid="99" name="A2-S50-G" tags="Timeframe_Advanced" position="1175,5100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 50-G]
UNITED SWEETS ALLIANCE]

You are extracted but this time back with the good guys and Luwig is there too.
You discover that while in captivity, Ludwig made a new faulty simulation that had slightly different seed values. It would look like an accurate simulation of reality, but the predictions were useless. That&#39;s how cain failed at frost peak and containing Ludwig, and Kegan failed at predicting the president&#39;s speech.
Ludwig says he needs to get back to work on creating simulations. The ones the resistance has been using are very accurate but are still imprecise even running at maximum power and will soon become uesless once the enemy figures out how to counter it&#39;s use. But Ludwig has a theory for an entirely new archeticture that a simulation can be based on. A simulation that will be as close to accurate as possible. He just needs time to work on it.


&lt;img src=&quot;https://i.imgur.com/Wq50hBd.jpg&quot; class=&quot;fitHalf&quot;&gt;
Johnson&#39;s convoy arrives in this Muffin outpost. It&#39;s an unexpected delegation of powerful Donuts politicians and Generals. The greet Hector and confess how wrong they were about everything. About the Muffins, about the alliance, about Gorg. They now see clearly who their true enemies are. They proclaim they want to formalize this alliance of Muffins and Donuts. They will fight together as sweets united against a 2 common enemies. A segregationist donut butts in to clarify they don&#39;t mean together, together. They mean muffins will fight against Cain while the donuts will handle Gorg, but they will still share intel and help each other out, of course.

Hector takes in the delegation of politicians to show them hospitality. Johnson, the other generals, and some of the Muffin military leaders go into the war room to have a meeting which you attend. They assess the state of the war.
The Frost Peak Muffins are keeping up pressure on the Sacred Knights from the north, while the Resistance regiments are advancing on SK held territory from the south and west. They are liberating more areas as more and more Muffins are firmly in support of the new alliance.
The Donuts comment how, after witnessing the assassination of their president, the donut public is now largely in support of the alliance, as well. Even segregationist Donuts have changed allegiances.

There are some political prisoners being held that the Donuts want to rescue from Gorg, notably including the former mayor of Sprinkle City, Mayor Sheila. Lieutenant Johnson, tells everyone he is confident that he can pull off this rescue mission with his team. The other Donut generals offer their support as well.

The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S51-G]]]



MY NOTES:
- The USA has a massive amount of support from Donuts and even have defections from the likes of General Zimmar and many segregationist Donut politicians to their side. In fact, General Zimmar is the one who brings intel about where the political prisoners are being held.

- By now, both the Muffin and Donut publics have sided with the USA. Muffins have always dislike the Sacred Knights, but complied out of fear. Now that the Frost Peak Muffins are keeping up pressure on the Sacred Knights, Muffins firmly stand with Hector and this new allience. The Donut public withnessed Gorg executing the Donut president in a fit of rage on live TV after the president told what really happened at the capital.



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="100" name="A2-S51-G" tags="Timeframe_Advanced" position="1175,5225" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 51-G]
PRISON BREAK]

You join Johnson on the task force to rescue the prisoners from Gorg. Johnson thanks you for always being there. And without you, there may have never been a chance for this partnership between Muffins and Donuts.
You rescue the prisoners, including Mayor Sheila, and secure the area from Gorg&#39;s forces.


&lt;img src=&quot;https://i.imgur.com/Hfvc5by.jpg&quot; class=&quot;fitHalf&quot;&gt;

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S52-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="101" name="A2-S52-G" tags="Timeframe_Advanced" position="1175,5350" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 52-G]
FROSTY AMBUSH]

You are in the middle of a snowy environment, perhaps near the Frost Peak region. A patrol of Sacred Knights fighters come across you. They talk about how you look like that other thing they captured. They think Cain will like that they captured you too.


&lt;img src=&quot;https://i.imgur.com/ajXLwWX.jpg&quot; class=&quot;fitHalf&quot;&gt;
Suddenly, Frost Peak Muffins burst out of the snow and ambush the SK patrol, quickly eliminating them. The FP fighters give you a gun and tell you to follow them. You help them ambush a few more patrols that where sent on high alert after losing coms with the 1st patrol. Then you make it to a SK outpost on high alert. FP Muffins can be seen surronding the outpost from other directions. A large battle ensues and the SKs are defeated and forced to flee.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S53-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="102" name="A2-S53-G" tags="Timeframe_Advanced" position="1175,5475" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 53-G]
USA CONFERENCE]

A delegation of Muffins arrive to the Donut capital. There is a fancy USA conference of everyone to discuss the state of the allience. Hector has talks with some Donut leaders about some aid that is needed to Muffin villages recently liberated from SK Muffins. Donuts agree they can provide aid. Hector then leaves outside even though he is much sought out for.
Hector is exhausted and needs a break. Johnson finds you in the conference and says let&#39;s go find Hector. Y&#39;all step outside too. Hector and Johnson have an honest dialogue about how they feel. They are glad the alliance is winning, but are concerned about the attitudes of all these new members like the segregationists. Johnson especially rants about how bigotted they are. And that these donuts have no moral compass and will flip on a dime depending on the direction of the political winds. Then Hector is approached by an old Donut Hole janitor in the street. Johnson, ironically, tries to shoe the Donut Hole away, telling Hector that he&#39;s probably some sugar crystal addict. Hector tells Johnson, &quot;Had I believed what others have said about Muffins, I would be against myself.&quot; Hector hears out the Donut Hole. The Donut Hole tells them about his life. He had studied hard in university and became an assistant engenier to the a prestigious doughnut inventor and he even claims he was actually the one behind many inventions. But of course, the status of Donut Holes fell and even he could not find work in his feild. He was forced to take a job to support his family. The Donut Hole imparts some wisdom.


&lt;img src=&quot;https://i.imgur.com/F0QnGwG.jpg&quot; class=&quot;fitHalf&quot;&gt;
WISE DONUT HOLE: I used to harbor resentment for other Donuts. I used to think they were all bad, and that only Donut Holes were good. But after all my years, I know that&#39;s not how this world works.
You aren&#39;t old enough to remember the turmoil among Donuts before this current war. The Bar and Twist Donuts had a falling out with the Ring and Filled Donuts. Us Donut Holes saw this as a time to rise up for ourselves. The other Donuts didn&#39;t like that very much. They all stopped fighting each other and united to crush us. I heard of unspeakable attrocites commited by Bar and Twist Donuts against my kind. I couldn&#39;t believe it myself until I whitnessed it myself. This time by the hands of Ring and Filled Donuts. I was a coward with a comfortable life, but even I couldn&#39;t be idle in the face of such blatent injustice. So I joined the Donut Hole uprising. I agreed to sabatoge my workplace, Mr. Rutterford&#39;s factory. But I was too nervous and clumsy. I failed at the simplist task of striking a match. They caught me before I could blow the factory to bits. You can imagine Mr. Rutterford&#39;s anger at my betrayal. Except he wasn&#39;t angry. He was disappointed, but he understood the prediciment I was in as a Donut Hole. Instead of turning me into the authorities, he gave me the means to flee with my family to Dough Town, the only sanctuary for Donut Holes. He had the same hopes as I; that this madness would soon end. Mr. Rutterford saved all our lives, for a time. When we arrived in Dough Town, I was immediately apprehended by the Uprising&#39;s self-proclaimed leadership. The leaders had changed. The old leaders had mostly be killed or arrested. This new crop was a much more fanatic bunch. They tortured me, suspecting me of being a spy after failing my mission. They wanted me to break, but I would never admit to their lies... until they threatened my family. I spent ages in solitary prison, never knowing what became of my family. All that time, never knowing.
	The Donut Hole appear to have a mental breakdown as he is sweep a straight line of debris on the floor.
WISE DONUT HOLE: I thought it was a line!
JOHNSON: You thought it was a lie?
WISE DONUT HOLE: A line! I thought it was a line! We all think its a line!
JOHNSON: Woah. Let&#39;s give this guy some space, Hector. He&#39;s clearly been through a lot.
HECTOR: What was a line?
WISE DONUT HOLE: You... You know it&#39;s not a line. I can see it in your eyes.
JOHNSON: Okay, all those years in solitary must have done some major damage.
HECTOR: I once thought it was a line to. But it&#39;s not a line.
	Hector takes the sweeper and sweeps the debris into a circle.
JOHNSON: What the hell is going on here? Is this contagious?
	The Donut Hole breaks down in tears and embraces Hector. Hector tears too. These are sad tears, not happy tears.
	Some fancy Donut comes to get Hector because everyone is expecting a speech from him. He comments &quot;Ewe. Is that a Donut Hole?&quot;

Hector goes in to give a speech. The simulation ends.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S54-G]]]




MY NOTES:
- At a comedic moment when Johnson doubts the Donut Holes story, the Donut inventor walks out of the party and asks if he knows the Donut Hole. Then he is reminded and so happy to see him. He validates the Donut Hole&#39;s story to Hector and Johnson. This inventor is genuinely not a bigot. He is a staunch assimilationist but still uses questionable langauge:
&quot;He&#39;s one of the good ones.&quot;
&quot;He is very articulate, very smart. Heck, he&#39;s even smarter than any regular Donut I know.&quot;
Johnson blatently sees how bad Donut Holes have it after watching that interaction and instantly becomes cleared of his illusions.

- Dialogue option:
&quot;I had thought the only ones I had to fear wear the other Donuts
We think the more extreme you are on one side, the more you are against the other side. But the truth is, it&#39;s not a left or right line. I&#39;ve met enough Donuts of all types to know that&#39;s just not true.&quot;

- Posssible USA Anthem that is sung by a child choir of Donuts and Muffins:
O! say can you smell, the Muffins freshly baked…
By the Donuts lay glazed, so valiantly gleaming.
No breakfast is complete, without milk and coffee.
Such beauty ’tis thee, is our harmony.
O! say do these Sweets all unite on one plate…
For a land gluten free, and still holds a great taste.




SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="103" name="A2-S54-G" tags="Timeframe_Advanced" position="1175,5600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 54-G]
A NEW THEORY]

You are at Sim Labs. Some researchers are concerned about Ludwig who has been locked inside his lab sector for weeks. They finally decide to break in to find a frantically working Ludwig who tells everyone to wait in the demonstration room because he wants to show them all something. He ends up explaining his new spacetime theory and immediately gets speculation and Ludwig responds harshly with adhomenoms.
After a little heated exchange, the scientists get back on track. Ludwig didn&#39;t test a simulation of his new theory, because it&#39;s too dangerous of course, especially considering what he strongly suspects about you being in this very simulation he created from outside this simulation. If Ludwig decides to put a test subject in this simulation, then his simulated self will do the same and that will continue until it causes a recursive simulation cascade overflow, thus destroying reality as they know it. So instead, Ludwig prints out some data based on this new algorithim. He triggers the Simulation Computation Chamber and comes out with results.


&lt;img src=&quot;https://i.imgur.com/GmfTbOW.jpg&quot; class=&quot;fitHalf&quot;&gt;
After reading the results, Ludwig runs to the conference room in a panic. He gets on a video call with Hector. He speaks in technical jargon that only other scientists understand. One scientist buts in that the current simulations don&#39;t predict this and they have never been wrong. Ludwig exclaims the current simulations are flawed and that they enemies must have done something to through off the accuracy of those simulations. Hector asks to tell him in english what&#39;s going on. Ludwig explains that the chances of thermo-nuclear annihalation of civilization is rising drastically and is rapidly approaching 100%. After Hector asks the current probability, Ludwig reads &quot;98 point&quot; before he is interrupted by a nuke explosion detonating behind Hector.


&lt;img src=&quot;https://i.imgur.com/R3wMOeR.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/ENohYRO.png&quot; class=&quot;fit49&quot;&gt;
|parenthetical&gt;[(very old art)]
Seconds later, The blast reaches Hector and the feed is cut.
Everyone at Sim Labs is in a panic. Since Ludwig was right about his simulation, everyone turns to him for leadership. Ludwig tells everyone that they could send you back to help. He tells you that line you&#39;ve heard before about how he doesn&#39;t know if your actions in a simulated simulation will affect this world, but perhaps it will affect some world for the better.

(align:&quot;==&gt;&quot;)[[[Wear Simulator...|Act 3 - Good Path]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="104" name="Act 3 - Good Path" tags="" position="1475,475" size="100,100">|specialtitle&gt;[(text-style:&quot;underline&quot;)[The Simulation™]
(text-size:5)[Act 3 - Good Path]]

(align:&quot;==&gt;&quot;)[[[Continue...|A3-S01-G]]]



MY NOTES:
- 
</tw-passagedata><tw-passagedata pid="105" name="A3-S01-G" tags="Timeframe_Advanced" position="1475,600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 01-G]
THE QUERY]

The war is almost won.
Hector is helping to pack some boxes on a truck. It&#39;s aid that he destined to go to Dough Town. Some digniatries find him and tell him he is too important to be doing labor and that they need him.
There is a meeting among the United Sweets Alliance as they discuss the end game of the war. The Frost Peak and formerly Resistance Muffins of the USA have nearly encircled the Sacred Knights in the West. In the East, the Donuts under the leadership of Johnson and Kesller have driven out Gorg&#39;s forces from all major cities. Gorg still has a shrinking foot hold of miliary bases in the South of Arc Land near Dough Town. The USA are cautious with their assault as they know Gorg has an arsinel of Nukes, but the nukes are big and heavy so they have to be wheeled in by trucks. So the council concludes the plan is to continue the assault on all fronts taking extra precausions on the front against Gorg. They ask the Sim Labs team what they think about this plan. The Sim Labs scientists have a whole setup where they type in some numbers and then have one of their scientists put on a simulator. He quickly goes through a range of extreme emotions in about 5 seconds. Then he pulls off the simulator and tells everyone who is horrified by what they withnessed that this is a good plan and the future looks bright and sunny after this with an enduring peace between Muffins and Donuts.
Hector asks if they should get a second opinion from Professor Ludwig. One of the scientists remarks that they tried to get him to come but he&#39;s off working on another one of his crazy simulation theories. Just then, Ludwig hacks in for a video call. He knows what they have been saying from using his own new simulation algorithm to spy on them. The only thing Ludwig is surprised by is to see you there.


&lt;img src=&quot;https://i.imgur.com/l7GKjyM.jpg&quot; class=&quot;fitHalf&quot;&gt;
Then Ludwig asks a strange question to you: &quot;Did I send you here from the future?&quot; There are some follow up questions of course. Assuming you answer yes, Ludwig deduces that the future is bleak and that he needs to run a simulation based on his new theory. He is only able to get statistical answers to queries as it is too unstable to enter. They query he runs on the possibility of the thermonuclear anihalation of civilization is very high at 22.47% and is on an upward trajectory. They all theorize how this could be and what bases they don&#39;t have covered. They are already protecting from nuke attacks by Gorg, and Cain&#39;s forces are almost defeated and doesn&#39;t have any nukes... &quot;or do they?&quot; Pehaps Cain developped nukes or stole them from Gorg. Hector questions something unthinkable. That perhaps Cain and Gorg are working together. Everyone exclaims that&#39;s ridiculous because they are both on complete opposite ends of this war.
Ludwig runs a query for the probability of Cain and Gorg cooperating. The results read 98.8% which means they have likely already been cooperating. Hector explains his thinking. He draws a line over a map of the world. He explains that he used to think like they do. He used to think that Cain and Gorg are on opposite ends of this line. He used to think that the extreme end of his side was fully committed to muffins, while the extreme end of the other was fully committed to donuts. But he would come to find that he, like most Muffins, had more in common with like-minded Donuts than they did with the extreme Muffins. In fact, the extreme Muffins are much more similar to the extreme Donuts, so much so that this idea of a line is wrong. It&#39;s not a line, but a circle, and those extreme Muffins and Donuts are in fact on the same side.
RANDOM DONUT: &quot;Yeah, we get that. But that&#39;s just... like an analogy. I mean, they aren&#39;t litterally on the same side. Are they?&quot;
Ludwig interjects that he ran the query again and that the probablity of them working together is now 100%. Which means they are currently working together right now. A slight panic ensues. Hector tells Ludwig to run a query to pin point the exact location of their meetup. Ludwig says he will try but can&#39;t garentee Sim Labs has enough power to finish that simulation and compile the results. While running that, Hector orders thorough inspections be setup across all major checkpoints for large trucks to look out for disgised nukes. Ludwig comments on how Sim Labs is losing power. His Chamber flickers from power lose and the heavy simulation ring collapse towards Ludwig just before the video feed cuts out. They have to figure out that location without Ludwig&#39;s help.  everyone was initially looking at the part of the map where they are attacking. They can&#39;t think of a way where Cain can get his forces through unnoticed. But then Johnson remembered that there is an old  abandoned DDL storage facility in the south of the Inhospitable Ripple Range region. He comments that&#39;s where he would store nukes if he had some. Kessler comments, that&#39;s not just where he would store nukes, but where he would build and develop them. &quot;That&#39;s it. That must be Facility X. I just can&#39;t believe they built it all the way out in Muffin territory. I thought it had to be on our land.&quot;


&lt;img src=&quot;https://i.imgur.com/R3QzkEj.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: There are a few edits to make to the map, like where Facility X is exactly and what marks are drawn over it, but I&#39;ll explain this later when it becomes relevant. Not a big deal.)]
They quickly compose a major task force of both donuts and muffins and draw up plans to assault Facility X, ASAP. They don&#39;t know what to expect exactly but they know it will be a heavy presence of Gorg&#39;s forces and perhaps even Cain&#39;s forces as well.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A3-S02-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="106" name="A3-S02-G" tags="Timeframe_Advanced" position="1475,725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 02-G]
FINAL ASSAULT]
&lt;img src=&quot;https://i.imgur.com/I0qbGWf.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are in a helicopter in route to assault Facility X. This time, all the forces of the USA are combined, Donuts and Muffins. Everyone is there including Hector.


&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/QSG1EgQ.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/Hxu2GSp.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/boAMFNp.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/U572eEf.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/TAQ3sld.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/SsD14oO.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/e7yYvdi.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/KGAtu5P.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;
|parenthetical&gt;[(very old art)]
The assault is feirce. Tanks are attacking on the ground, jets are straffing targets, helicopters are getting shot out of the sky.


&lt;img src=&quot;https://i.imgur.com/B1OWRcf.jpg&quot; class=&quot;fitHalf&quot;&gt;
You insert of a roof top and breach in.


&lt;img src=&quot;https://i.imgur.com/dJifKps.jpg&quot; class=&quot;fitHalf&quot;&gt;
Your mission is to locate and secure the stock pile of nukes and also capture the HVTs: Gorg, Kegan, and Cain. You fight through enemies of Gorg&#39;s men, Kegan&#39;s spec ops, and Cain&#39;s Sacred Knights. Kessler and perhaps one of the Muffin leaders is killed in battle.
Before you can locate the nukes, you, Hector, Johnson, and Marcus corner Cain, Gorg, and Kegan in the bridge room.


&lt;img src=&quot;https://i.imgur.com/e0MMtwz.jpg&quot; class=&quot;fitHalf&quot;&gt;
War still rages around outside. It&#39;s Donuts and Muffins working together to fight other Donuts and Muffins. There is a tense confrontation. Everything Gorg and Cain ever claimed was a facade. They don&#39;t really care about protecting their kin. It was always about power. Gorg and Cain defend there honor claiming they only did what was neccasary. And that they could never secure peace for their kind against a savage enemy without deterance through extreme retaliation. And that the only langauge the enemy understands is violence. While making these arguements, Cain and Gorg bounce off each other and are almost surprised by how much they agree.
Johnson orders them to surrender and that they have lost. Kegan pulls out a detonator and claims it&#39;s a self destruct sequence that will blow every nuke in this base and that he&#39;s not afraid to use it if the USA doesn&#39;t call off their assault. After a short tense exchange, alt you busts through the door knocking down Kegan.


&lt;img src=&quot;https://i.imgur.com/o28uBlQ.jpg&quot; class=&quot;fitHalf&quot;&gt;
Alt you grabs the detonator and tells everyone not to worry and that the day is saved. He then smashes the detonator on the table. A comedic second later, the self destruct sequence activates announcing a 5 minute countdown. 


&lt;img src=&quot;https://i.imgur.com/5lL8gzO.jpg&quot; class=&quot;fitHalf&quot;&gt;
JOHNSON: &quot;Why would you do that?!&quot;
ALT YOU: &quot;I didn&#39;t think that would actually trigger it.&quot;
HECTOR: &quot;We all needs to evacuate immediately.&quot;


&lt;img src=&quot;https://i.imgur.com/MCcl8pd.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/na8BMPS.jpg&quot; class=&quot;fitHalf&quot;&gt;
Everyone all over the base stops fighting and runs for the nearest mountain. It&#39;s an all out scramble. Muffins and Donuts on all sides drop their weapons enroute. Kegan runs the opposite way going deeper into Facility X. Hector, Johnson, and USA soldiers at least manage to secure Cain and Gorg as they head for the hills. During the run, former enemies can be seen helping each other escape in a mad scramble as sirens blair and the countdown ticks.


&lt;img src=&quot;https://i.imgur.com/tXm3sZU.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/sU9TWZX.jpg&quot; class=&quot;fitHalf&quot;&gt;
You make it beyond a mountain ridge. Everyone is exahausted. Some look back. Gorg thinks that maybe Kegan managed to disable the self destruct sequence and &quot;That must be the reason he went in there, right?&quot; Just then, the ground under Facility X bubbles in a series of locations and suddenly shoots up a massive mushroom cloud, completely destroying Facility X and finally putting an end to the war.


&lt;img src=&quot;https://i.imgur.com/u4c29YU.jpg&quot; class=&quot;fitHalf&quot;&gt;

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A3-S03-G]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="107" name="A3-S03-G" tags="Timeframe_Advanced" position="1475,850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 03-G]
REMEMBERANCE]

You are in a Donut cemetary. Ludwig finds you and tells you to follow him.


&lt;img src=&quot;https://i.imgur.com/cyQUtjq.jpg&quot; class=&quot;fitHalf&quot;&gt;
&lt;img src=&quot;https://i.imgur.com/kjdS7MM.jpg&quot; class=&quot;fitHalf&quot;&gt;
Ludwig looks beat up and has an arm cast, probably from injuries in the Simulation Computation Chamber™. The shape of the gound that was dug up corresponds to the shape of the Donut. You and Ludwig reach the funeral precession. The mood is somber. Many Muffins and Donuts shed tears. Some words are expressed by Johnson about the Donuts lost in this war, and also about Muffins that he&#39;s come to know. They all fought for the same common and noble cause. They fought for the chance of peace between all sweet. Hector is invited to the stage to add some words.


&lt;img src=&quot;https://i.imgur.com/felAOYU.jpg&quot; class=&quot;fitHalf&quot;&gt;
He comments on the difference in traditions that Muffins have in matters like burriel of the dead, and some might point to these differences as a reason to disassossiate or even to hate. But assimilation or our societies should not mean the erotion of our cultures. Blah blah blah...
The speech ends.
NOTES: Maybe Ludwig talks to you about something impactful during your walk. Perhaps he mentions a way for you to get out of The Simulation™ that he&#39;s been working on. That way you can return to your world... although he can&#39;t promise that wouldn&#39;t simply be another simulation as it is impossible to distinguish from actual reality, whatever that means. Then Ludwig stops to have a rare meaningful moment with you. He aknowledges from your perspective that the Muffins and Donuts here aren&#39;t actually real, and don&#39;t really matter. But he tells you, for what it&#39;s worth, he&#39;s never felt more hopeful about the future. And he knows it&#39;s all thanks to you. Then y&#39;all continue walking to the funerl area for Donut soldiers.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A3-S04-G]]]



SCRIPT DRAFT:


Ludwig&#39;s Dialogue before the Remembrance Ceremony on your walk with him towards it...

I know this seems like a meaningless thank you to you, because it&#39;s coming from a simulated being that doesn&#39;t have any real feelings or emotions from your perspective, But, thank you. Thank you for all you&#39;ve done to save our world. Though, as relieved as I am that our reality has turned out for the better, I can&#39;t help but get the feeling that this is not always the way the simulation plays out. I&#39;m not sure if you can answer this, but... was there another path you could have taken?

YES: I shudder to think of what could have been.
NO: Well, there is only one path in life after all.
WAIT: You&#39;re right. It&#39;s better that you don&#39;t tell me.

After all, this entire simulation is, in essence, a performance. It&#39;s meant to simulate reality, in order for real beings to observe it and derive knowledge to benefit their reality.
So I suppose however much I might feel like a conscious being, in the end, we are not what matters. What&#39;s really important is wherever it is you came from. That real reality. The one outside this whole simulation. I mean, I don&#39;t know how you would benefit your world with this simulation. Perhaps you can derive valuable lessons from your experience here. Maybe some of it will be useful for living a good life, and making a better world... whatever that means.

Anyway, we are late for the Remembrance Ceremony.</tw-passagedata><tw-passagedata pid="108" name="A3-S04-G" tags="Timeframe_Advanced" position="1475,975" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 04-G]
VICTORY DAY]
&lt;img src=&quot;https://i.imgur.com/YG2z1mi.jpg&quot; class=&quot;fitHalf&quot;&gt;
You are in a victory day parade. Muffins and Donuts line the streets together. There is a celebration of peace between Muffins and Donuts. You are lead to the capital steps where you see all the main and secondary &quot;good&quot; characters that are still alive, including alt you. As you make your way up the steps, Ludwig steps out and stops you. He congradulates you on having the honor of lifting the orb of peace. He also tells you he managed configure the simulation you are in so that your next extraction event will send you completely outside all simulation levels and back to your original reality from whence you came. He does warn you that you will be expierencing increasingly intense hallucinations prior to extraction. He informs you that your body might feel more tactile and higher resolution outside the simulation so you might need to remove your headset in a more physical mannor.
The rest of this scene is a parody of Star Wars where you get a medal, nod to everyone you know, see the ghosts of the dead like Grimmer and others that you nod too. Then you or some filled Donut lifts the orb and proclaims &quot;Peace!&quot;


&lt;img src=&quot;https://i.imgur.com/3Kluat3.jpg&quot; class=&quot;fitHalf&quot;&gt;
Then the hallucinations really start with you going through some crazy portal tunnel in the sky. 


&lt;img src=&quot;https://i.imgur.com/LztcbUx.jpg&quot; class=&quot;fitHalf&quot;&gt;
Maybe credits are shown here or later after you are promted to remove your actual physical VR headset.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A3-S05-G-END]]]



SCRIPT DRAFT:




</tw-passagedata><tw-passagedata pid="109" name="A3-S05-G-END" tags="" position="1475,1100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 3 - SCENE 05-G]
CREDITS!]
&lt;img src=&quot;raw=1&quot; class=&quot;fit&quot;&gt;




MY NOTES:
- </tw-passagedata><tw-passagedata pid="110" name="Key Details about this game" tags="" position="350,325" size="100,100">Key Details about this game:

1. Entering and exiting simulation levels by wearing or removing &quot;simulator headsets&quot; serves as the main plot device driving the story forward. This is how most scene transitions happen.

2. More on plot devices: It is explained early in the story that The Simulation™ is a little unstable and will have minor glitches occassionaly. Minor glitches will be used to shorten long walks or waiting times within a scene. Major gltiches happen when the RAM is overloaded which triggers a simulation extraction event that prompts you to remove the simulator, which will advance the story to the next scene in most cases.

</tw-passagedata><tw-passagedata pid="111" name="A2-S19.4" tags="Timeframe_Early" position="1175,1025" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 19.4]
MALL MASACRE]

You are in a Donut shopping center. Suddenly, Muffins start shooting around indiscriminately.


&lt;img src=&quot;https://i.imgur.com/Sz3lDkn.jpg&quot; class=&quot;fitHalf&quot;&gt;
You must run and hide to stay alive. (Maybe there is an option for you to grab a gun and fight back.)


&lt;img src=&quot;https://i.imgur.com/jB18q5B.jpg&quot; class=&quot;fitHalf&quot;&gt;
Eventually, DDL forces respond and eliminate the threat. Kegan is part of that force.
Gorg arrives after the fighting and is fuming. He gives a brief interview to a Donut news tv camera.


&lt;img src=&quot;https://i.imgur.com/Jcl9kIU.jpg&quot; class=&quot;fitHalf&quot;&gt;
GORG: &quot;This is what happens when you have weak are tratorous Donut politicians telling us how to conduct warfare. The Donuts who think we can somehow assimilate with these Muffin savages will be the death of us all. The fact that this keeps happening should outrage all Donuts.&quot;
DONUT NEWS ANCHOR: &quot;What policies you think should change to ensure this doesn&#39;t happen again?&quot;
GORG: &quot;For one, any Muffin that sets foot on Donut land should be shot on site.&quot;
DONUT NEWS ANCHOR: &quot;Even if they&#39;re civilians?&quot;
GORG: &quot;Do you hear how stupid you sound right now?! Muffins come here for one reason only and that is to kill Donuts.&quot;
DONUT NEWS ANCHOR: &quot;Look, I&#39;m a segregationist like you. I agree with keeping Muffins out. But shooting them on sight sounds a bit harsh.&quot;
GORG: &quot;Harsh?! You know what&#39;s harsh? This is harsh. Look around. Turn the cameras. Look. That&#39;s what failed assimilationist policies will get you.&quot;
DONUT NEWS ANCHOR: &quot;To veiwers at home, we appologize for this distressing scene. Perhaps the military does know better than our Donut politicians. I think it&#39;s about time we reinstitue stronger policies against Muffins. I know it sounds harsh, but after countless savage attacks like this one you see here today, something has to change. That&#39;s all from me. Back to you Tom.&quot;

You go to a backroom with Kegan and Gorg. Kegan shows Gorg a Muffin newspaper. 


&lt;img src=&quot;https://i.imgur.com/JRgA30R.jpg&quot; class=&quot;fitHalf&quot;&gt;
The Muffins still veiw you as a mystirious ally that helped Hector and Cain escape Drejnon prison. Kegan plans for you to pretend to be allies with Muffins and gain their trust. Then the Donuts can use you when they need you. He places a tracking patch on you.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S20]]]






MY NOTES:
- Old dialogue:
&quot;We need someone on the inside.”
“Lucky for us, we just so happen to have a reliable and loyal soldier that the Muffins still trust. He’s being hailed in Muffin propaganda papers as a mysterious hero that helped 2 Muffin prisoners escape from Drejnon. He’s our best shot at infiltrating the Muffin Resistance.”
“What do you say soldier? Do you want to do some espionage work for us?”
(If you respond NO:) “Well let’s go over the plan first. Then you can decide.”
GORG: “Alright, sooo… What’s the plan?”
KEGAN: “I have a new plan. Let’s hold off on concentrated outpost assaults. We’ll continue defensive patrols on the front. Some projects we have in development are almost ready for action. In the meantime, you have a simple task, soldier. Infiltrate the Muffin resistance, follow their orders, and gain their trust. When the time comes, we’ll find you.”







SCRIPT DRAFT:






</tw-passagedata><tw-passagedata pid="112" name="Haku Talkabouts" tags="" position="300,175" size="100,100">1. Talk about doors. Might want to switch Sim Labs and Facility X style doors.

2. Talk about &quot;almost chairs&quot;.

3. Secondary characters.

4. Flag designs.</tw-passagedata><tw-passagedata pid="113" name="A1-S03" tags="Timeframe_Primitive Timeframe_Modern" position="725,850" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 1  SCENE 03]
BACK TO THE FUTURE
EXT - NIGHT - TRAINING SIMULATION]
&lt;img src=&quot;https://i.imgur.com/0wCCxrU.jpg&quot; class=&quot;fitHalf&quot;&gt;
PART A: PREHISTORIC ERA
You find yourself in a prehistoric landscape, realizing Ludwig&#39;s simulator has sent you too far into the past, long before the construction of Super Awesome Adventure Candy Land™ or the tunnel entrance. Ludwig explains that to return you to the future, he needs to overload the simulation by increasing simulated entropy, triggering an extraction event.
As Ludwig works on his computer, you hear rapid typing and muttering. Suddenly, a distant screeching sound echoes through the primitive forest.


&lt;img src=&quot;https://i.imgur.com/kcAeXSD.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE:  By &quot;prehistoric pastries&quot;, I initially imagined a bunch of pop tarts chasing you. But perhaps &quot;caveman muffins&quot; chasing you works too. Keep it this way for now.)]
A horde of prehistoric pastries emerges, quickly advancing towards you. Ludwig yells for you to run or hide, warning of the danger these creatures pose. You must survive this chase sequence, either by running or finding a hiding spot, until the simulation becomes unstable enough for an extraction event to occur.
You will die at least once here. The first time you die, Ludwig discovers that his Ultra Realism Haptic Engine™ was disabled, so instead of dying in real life too, you will just restart at a checkpoint from now on.


&lt;img src=&quot;https://i.imgur.com/eNA1ctL.jpg&quot; class=&quot;fitHalf&quot;&gt;
|parenthetical&gt;[(ART NOTE: There are no &quot;simulation exit portals&quot; that you walk into anymore. The simulation will just glitch at some point. So pretend there is no portal in this art.)]
PART B: TUNNEL CONSTRUCTION ERA
After removing the simulator, you&#39;re in a partially constructed tunnel. Ludwig explains you aren&#39;t fully back to the future yet. You still need to exit one more simulation layer before you return to the top most simulation layer.
In order to help trigger a simulation extraction event faster, Ludwig tells you to go outside the tunnel and trigger the TNT switch. The first time you try to trigger it, it doesn&#39;t work because the cables are not connected in the tunnel. Your objective is to connect three separated sections of a cable to activate the TNT detonator. The challenges are:
- Climbing scaffolding to reach a high cable connection.
- Operating a robotic excavator to clear debris and uncover a buried cable section.
- Finding a flashlight to navigate a darkened area of the tunnel and locate the final cable connection.
Once complete, you return to the TNT plunger switch. Upon detonation, a massive explosion triggers another simulation overload and extraction event.


&lt;img src=&quot;https://i.imgur.com/RAJ3fex.jpg&quot; class=&quot;fitHalf&quot;&gt;
PART C: ALTERED FUTURE AND SUDDEN ATTACK
Removing the simulator again, you emerge in a drastically altered future. A massive crater from a nuclear explosion has replaced Super Awesome Adventure Candy Land™. As Ludwig begins explaining the consequences of your actions in past simulations, the scene suddenly destabilizes.
Ludwig&#39;s voice cuts through, yelling, &quot;We&#39;re under attack!&quot; Without warning, the simulated world violently falls apart. Pieces of sky crash down, rocks explode from the ground, and the environment becomes chaotic and dangerous.
You must navigate through this rapidly disintegrating landscape, dodging falling debris and exploding terrain. Your goal is to survive long enough for another extraction event to occur.
As you run and dodge the hazards, the simulation becomes increasingly unstable. Just as the world seems on the brink of total collapse, an extraction event triggers, allowing you to remove the simulator.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A1-S04]]]













|act&gt;[(text-style:&quot;underline&quot;)[ACT 1 - SCENE 03]
BACK TO THE FUTURE
EXT - NIGHT - TRAINING SIMULATION]

---
---

|action&gt;[PART A: PREHISTORIC ERA]

|action&gt;[You spawn in a prehistoric time before the construction of Super Awesome Adventure Candy Land™. Dense jungle surrounds you.]

|name&gt;[LUDWIG]
|dialogue&gt;[Hmm, this is not what I intended. It seems you went a bit too far in the past. There&#39;s not even a tunnel here yet.]

|action&gt;[You hear rapid typing and muttering from Ludwig.]

|name&gt;[LUDWIG]
|dialogue&gt;[I&#39;m going to see what I can do about overloading this simulation to trigger an extraction event. That way, we can return you back to the future from whence you came. An extraction event will trigger when the active simulation layer accumulates enough entropy, triggering a hyperdimensional cascade recursion overflow conjugation sequence, which then allows you to remove the simulator and exit to a higher simulation layer. And of course, beyond the top-most simulation layer, such an extraction event will allow you to exit the simulation entirely, thus returning you to reality.]

|action&gt;[A distant screeching sound echoes through the forest.]

|name&gt;[LUDWIG]
|dialogue&gt;[Oh. That doesn&#39;t sound reassuring.]

|action&gt;[A horde of prehistoric pastries emerge from the dense foliage, chasing you and throwing primitive spears. If you haven&#39;t died yet, a spear hits you accurately, causing death and respawn at a checkpoint.]

&lt;tw-hook name=&quot;branch-a&quot;&gt;&lt;details&gt;
  &lt;summary&gt;IF PLAYER DIED IN PREVIOUS SCENE&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[- IF PLAYER DIED IN PREVIOUS SCENE: Timothy, give me radar scans of the area. Yep, just as I suspected, there&#39;s a horde of prehistoric pastries descending upon your position, Mr. Anderson. They&#39;re not friendly. In fact, they&#39;re most certainly going to try to kill you. It&#39;s best you run or find a hiding spot. Of course it&#39;s not a big deal if they do kill you, since you&#39;ll just restart at a checkpoint. But still, try not to die. It&#39;s kind of annoying.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-b&quot;&gt;&lt;details&gt;
  &lt;summary&gt;IF PLAYER DIDN&#39;T DIE IN PREVIOUS SCENE&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[- IF PLAYER DIDN&#39;T DIE IN PREVIOUS SCENE: Timothy, give me radar scans. Oh my. Mr. Anderson, it appears there is a horde of prehistoric pastries descending upon your location. Your current chances of survival are less than five percent, which is not good. And as I&#39;m sure you know, if you die in a simulation, you die in reality. So RUN! RUN FOR YOUR LIFE MR. ANDERSON! RUUUUUUUN! AHHHHHHHH! THE PREHISTORIC PASTRIES ARE GOING TO EAT YOU! OH NO! THEY GOT YOU! YOU&#39;RE DEAD NOW ANDERSON! I&#39;M SO SORRY! I... wait a moment... what’s going on here? Why is there a thought provoking quote? Oh, don’t tell me…]

  |action&gt;[A thought-provoking quote slowly fades. A prompt appears instructing you to &quot;remove simulator headset from face.&quot; You remove the simulator. You have restarted at a checkpoint before the horde chases you.]
  
  |action&gt;[LUDWIG dials a number and has a conversation with Karen.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[Karen, did you disable my Ultra Realism Haptic Engine™?
Yes, the one that kills you if you die in a simulation.
“Unethical”? Come on Karen, don’t be such a Jennifer.
What do you mean “I’m the only one who disagrees with this decision”?
Well then, everyone else is stupid.]

  |action&gt;[LUDWIG hangs up.]

  |name&gt;[LUDWIG]
  |parenthetical&gt;[Sigh.]
  |dialogue&gt;[I’m sorry Mr. Anderson. For some reason, management decided to disable my Ultra Realism Haptic Engine™ that’s supposed to actually kill you in real life when you die in a simulation. So instead of being killed and getting the full immersive experience, you’ll just see some random inspirational quotes before you restart at a checkpoint. I apologize for this inconvenience.]

  |action&gt;[The prehistoric horde chases you.]

  |name&gt;[LUDWIG]
  |dialogue&gt;[Oh no. Run Mr. Anderson. Run or else you are going to, not die. Ha ha. Ugh, this is so boring without any consequences.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[If you continue to die and respawn at this checkpoint, Ludwig changes his lines accordingly.]

&lt;tw-hook name=&quot;branch-c&quot;&gt;&lt;details&gt;
  &lt;summary&gt;2ND DEATH AND RESPAWN&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[Please Mr. Anderson. You must survive long enough to trigger an extraction event. Try to find a hiding spot and wait until the simulation gets overloaded.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-d&quot;&gt;&lt;details&gt;
  &lt;summary&gt;3RD DEATH AND RESPAWN&lt;/summary&gt;
  |action&gt;[A big boulder crashes with a hollow entrance that you can hide inside.]
  |name&gt;[LUDWIG]
  |dialogue&gt;[You know what, I&#39;m gonna make this really simple for you. There I just sent you a rock to hide underneath. Just run in there and wait out the horde.]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-e&quot;&gt;&lt;details&gt;
  &lt;summary&gt;4TH DEATH AND RESPAWN&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[You really aren&#39;t good at surviving, are you? Alright, I&#39;m just gonna delete all the pastries. (A bunch of meteors fall from the sky, impacting the forest where the pastries are.) Now you&#39;re just gonna have to wait for a minute for an extraction event to trigger.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[After surviving a set period (or after enough attempts), the simulation glitches, triggering an extraction event.]

|name&gt;[LUDWIG]
|dialogue&gt;[The simulation has overloaded and an extraction event has triggered. You&#39;re safe now. You cannot be harmed in this simulation layer anymore. Please remove your simulator now!]

---
---

|action&gt;[PART B: TUNNEL UNDER CONSTRUCTION (UPDATED)]

|action&gt;[You remove the simulator and find yourself in a partially constructed tunnel.]

|name&gt;[LUDWIG]
|dialogue&gt;[Okay, it seems you are in the tunnel, but it’s not fully constructed yet. So obviously, you’re not quite back to the future. I’m running some calculations now to see how many layers deep you are exactly. In the meantime, you still need to extract yourself from this current simulation layer. If only there was some way to increase entropy. Hmm. Well, that is a lot of explosives the excavation team has rigged up. I mean, technically, we should avoid altering the past as much as possible, but they’re gonna blow it up anyway, so perhaps it wouldn’t hurt to help them speed up the process. Go ahead and exit the tunnel. There should be a TNT switch outside the entrance somewhere.]

|action&gt;[As you move toward the exit, you see Muffin construction workers installing beams and hauling equipment.]

|name&gt;[LUDWIG]
|dialogue&gt;[I didn’t realize there would be real muffins working here. Well, technically, they’re not actually real—they’re just simulated. Don’t worry about them. Just continue with your mission and locate that TNT switch.]

|action&gt;[You step outside the tunnel entrance. Two Muffin workers stand by a TNT plunger.]

|name&gt;[MUFFIN WORKER A]
|dialogue&gt;[Fire in the hole!]

|name&gt;[MUFFIN WORKER B]
|dialogue&gt;[What in the cinnamon sticks do you think you&#39;re doing? Are you trying to get us all killed?!]

|name&gt;[MUFFIN WORKER A]
|dialogue&gt;[It’s just a prank, sir. The TNT switch isn’t even connected to the cable. See?]

|name&gt;[MUFFIN WORKER B]
|dialogue&gt;[What if someone connected this cable and you didn&#39;t notice?]

|name&gt;[MUFFIN WORKER A]
|dialogue&gt;[Relax sir. There are 4 relay boxes that have to be connected before this TNT switch can blow up anything.]

|action&gt;[MUFFIN WORKER A plugs the cable into a nearby box.]

|name&gt;[MUFFIN WORKER A]
|dialogue&gt;[Now there’s three left to connect. The rest of them are in the tunnel.]

|name&gt;[MUFFIN WORKER B]
|dialogue&gt;[(Unplugs the cable) How about we keep it at four, all right? And stop messing around.]

|name&gt;[MUFFIN WORKER A]
|dialogue&gt;[You’re the boss.]

|action&gt;[They walk off. Ludwig speaks over intercom again.]

|name&gt;[LUDWIG]
|dialogue&gt;[Well, that was unusually informative. It seems we have to plug in all those cables into their relay boxes. Then this TNT switch will be live and able to blow the tunnel. Go back into the tunnel and find those three cables, Mr. Anderson.]

|action&gt;[You re-enter the tunnel, heading to the first cable area. A scaffolding stands nearby.]

|name&gt;[LUDWIG]
|dialogue&gt;[I think the relay box and cable are on top of that scaffolding. Try hooking it up.]

&lt;tw-hook name=&quot;branch-f&quot;&gt;&lt;details&gt;
  &lt;summary&gt;IF YOU TAKE TOO LONG AT FIRST CABLE&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[Use the ladder on the side of the scaffolding to climb up there, and hook the cable to the relay box.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[After you connect the first cable, Ludwig confirms your progress.]

|name&gt;[LUDWIG]
|dialogue&gt;[Very good. Now move deeper into the tunnel and look for the next relay box.]

|action&gt;[You proceed further. The second cable area is blocked by debris.]

|name&gt;[LUDWIG]
|dialogue&gt;[It looks like the next relay box is around here. Follow the cable if you can.]

&lt;tw-hook name=&quot;branch-g&quot;&gt;&lt;details&gt;
  &lt;summary&gt;IF YOU TAKE TOO LONG AT SECOND CABLE&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[Perhaps it’s under those rocks. They look heavy, so you’ll need that excavator to clear them. Turn on the excavator, then use its controls to move the debris. That should reveal the relay box.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[After you connect the second cable, Ludwig acknowledges it.]

|name&gt;[LUDWIG]
|dialogue&gt;[Nicely done. One more to go.]

|action&gt;[At the third cable area, it is pitch black in a side passage.]

|name&gt;[LUDWIG]
|dialogue&gt;[It’s too dark to see in that side passage. Search for something to light the way.]

&lt;tw-hook name=&quot;branch-h&quot;&gt;&lt;details&gt;
  &lt;summary&gt;IF YOU TAKE TOO LONG AT THIRD CABLE&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[Look for a flashlight or something nearby, and activate it to light the way through the side passage.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[Once you have the flashlight, you see the relay box and connect the final cable.]

|name&gt;[LUDWIG]
|dialogue&gt;[Excellent. That’s all three cables, Mr. Anderson. Return to the TNT switch outside the tunnel.]

&lt;tw-hook name=&quot;branch-i&quot;&gt;&lt;details&gt;
  &lt;summary&gt;IF YOU STARE AT A MUFFIN WORKER ON THE WAY OUT&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[Don’t look at them for too long, Mr. Anderson. It’ll only make it harder to do what must be done.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[You exit the tunnel. The TNT switch is ready.]

|name&gt;[LUDWIG]
|dialogue&gt;[Everything is set. Go ahead and hit the switch now, Mr. Anderson.]

&lt;tw-hook name=&quot;branch-j&quot;&gt;&lt;details&gt;
  &lt;summary&gt;IF YOU HESITATE&lt;/summary&gt;
  |name&gt;[LUDWIG]
  |dialogue&gt;[We need that explosion for an extraction event. Please, Mr. Anderson—pull the handle.]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[You press the TNT plunger. A normal explosion rips through the tunnel, destroying the workers. The simulation overloads and glitches.]

|name&gt;[LUDWIG]
|dialogue&gt;[That did it. We’re overloading the simulation. Remove your simulator, and we’ll get you back to your time.]

---
---

|action&gt;[PART C: ALTERED FUTURE]

|action&gt;[You remove the simulator and find yourself in a drastically altered future. A massive crater replaces where Super Awesome Adventure Candy Land™ should be.]

|name&gt;[LUDWIG]
|dialogue&gt;[Finally, we made it back to the future.
Welcome to Super Awesome… Wait, where is it? Oh come on, not again…
Yep, just as I feared. It seems when you were in that simulated simulation, you stepped on some atomic nuclei which set in motion a chain of events that led to the thermonuclear annihilation of civilization.
Mr. Anderson, you have to be careful with simulated simulations. Remember, they are the past. You can&#39;t just touch sub atomic particles all willy-nilly and expect things to stay the same in the future. One false move and &quot;Skadoosh!&quot;…
That was a nuke. That was the sound of a nuclear bomb going off. Anyhow, let&#39;s continue with your training.]

|action&gt;[Bombing begins. Bomb sounds intensify through the intercom.]

|name&gt;[LUDWIG]
|dialogue&gt;[What&#39;s going on?!—
We&#39;re under attack!—
We&#39;re under attack in real life!—
Hold on Mr. Anderson. I&#39;m getting you out.—]

|action&gt;[Ludwig’s voice cuts out. The simulated world falls apart. Sky pieces crash down, terrain explodes. You dodge debris in a final chaotic sequence. After surviving a set period, a new extraction event triggers. A prompt instructs you to remove your simulator headset.]
















</tw-passagedata><tw-passagedata pid="114" name="Expletive Replacements" tags="" position="275,625" size="100,100">THE SIMULATION™ Expletive Replacements

Characters in this game world do not use real curse words. They have their own curse words. Muffins and Donuts have curse words that are more native to their speech, but they can all be used by any characters. Here&#39;s a list of some of the curse words: 







	BOTH:
Insulin

	DONUTS (American Accent):
Fluffernutter
Fudgebuckets
Fudge
Huckleberry
Snickerdoodle
Holy Sprinkles

	MUFFINS (British Accent):
Flapjacks (Flapping flapjacks)
Cinnamon Sticks
Cranberry Sauce
Bumbleberry
Biscuits
Nutcase / Nuts


</tw-passagedata><tw-passagedata pid="115" name="A2-S04.2" tags="Timeframe_Early" position="900,1100" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[ACT 2 - SCENE 04.2]
RECON]

You are with Cain and the Sacred Knights. They are in charge of defence for a Muffin refugee outpost. They are aware a large attack is coming from the Donuts. Instead of defending the outpost, they abandon it and watch as it is annihilated from a distance. They use this event to gather intel. They notice that the Donuts go all in with there attacks leaving their FOB lightly defended and exposed.

They theorize the intent of the Donut strategy. They think it is to capture a Muffin outpost so that they can inflict heavy losses on Muffins when they counterattack to retake the outpost. But they decide they will let the Donuts have it and simply attack elsewhere.

A Knight tells Cain they have an undercover cell in New Arc City ready to attack an undefended Donut shopping mall in retaliation for this attack. One of the Knights mildly objects to the idea of targeting Donut civilians, fundementally on moral grounds, but he masks his critque to sound like its a waste of an undercover cell to attack a non-military target. Cain recites a passages from the Sacred Scripture.

CAIN: Chapter 16 Verse 126. &quot;if you punish an enemy, punish with an equivalent of that with which you were harmed.&quot; We will follow the teachings of our Sacred Scripture. We will punish the Donuts just as they have harmed us.
SK 1: &quot;But if you are patient—it is better for those who are patient.&quot;
CAIN: What?
SK 1: My appologies for speaking out of turn, sir Cain.
CAIN: Speak if you have something to say.
SK 1: Well, you didn&#39;t quote the entire verse, sir. &quot;if you punish an enemy, punish with an equivalent of that with which you were harmed. But if you are patient—it is better for those who are patient.&quot; Perhaps it&#39;s better to show mercy or restraint, at least towards the civilian Donuts.
CAIN: Who taught you this verse?
SK 1: No one, sir. I&#39;ve just been reading our Sacred Scripture myself.
CAIN: Stop reading it.
(gasps)
CAIN: What I mean is, don&#39;t read it without proper guidance. The second part of that verse pertains to a remorsful, subdued enemy. It does not apply while the enemy is continuing their campagin of attrocities.
SK 1: Yes sir. I understand now.
CAIN: Good... Keep reading our Sacred Scripture. We are, after all the Sacred Knights, gardians of all that we Muffins hold sacred. It&#39;s good to have more knowledgable scholars of Sacred Scripture amoung our ranks.
	Radio cuts in.
SK CELL AGENT: Come in, Command. This is Red Cell 7. My men are in postion and prepared to strike. We are in the central shopping district of New Arc City. I repeat, we are in the central shopping district. There are many defenseless Donuts, and my men are postioned and prepared to strike the enemy.
SK 2: Acknowledged, Red Cell 7. Await orders.
SK CELL AGENT: Acknowledged, awaiting orders.
SK 2: Sir Cain, shall I inform Red Cell 7 to commence our attack on the Donut shopping district.
CAIN: Give me the radio. I will inform them... Hmm, perhaps it is a waste of our resources to attack a militarily insignificant shopping district.
	The Donuts in the distance begin the pull out of the outpost. Everyone is confused.
SK 3: Sir, look over there. The Donuts are retreating. But why are they pulling out so early?
SK 1: It would seem the Donuts realize that there aren&#39;t any fighters in the outpost. Could they be sparring the lives of Muffin refugees?
SK 2: Highly doubtful. I have yet to see Donuts show any mercy towards Muffins.
SK 3: Perhaps we are witnessing a rare instance of Donuts showing some semblance of honor.
SK 1: I concur. After all, who could stoop so low as to attack innocent and defenceless civilians?
SK CELL AGENT: Come in, Command. My men are growing impatient. We are in position and prepared to strike the central shopping district. The Donut enemy is defenceless with a minimal police presense. What are our orders?
CAIN: Command to Red Cell 7. Let&#39;s call off the-
	Just before Cain speaks through the radio, the Donuts trigger a series of explosions they planted in every outpost building. Everyone is shocked by the brutallity of the Donuts.
SK 3: Mother of dough!
SK 1: But why?! There are only innocent refugees in that outpost! WHY?!
SK CELL AGENT: We did not recieve your last transmition. I repeat, my men are prepared to strike. What are our orders?
CAIN: Kill them all.
SK CELL AGENT: Order acknowledged. It was a pleasure to serve for you, sir Cain.

The Simulation™ glitches.

(align:&quot;==&gt;&quot;)[[[Remove Simulator...|A2-S05]]]



SCRIPT DRAFT:





|act&gt;[ACT 2 - SCENE 05]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“I still think we ought to be down there, defending the village.”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“And miss this golden opportunity? This might be our best chance to study how the donut enemy operates.”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“What if it was your family in that village? Would you not do everything possible to protect them?”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“If my family was in that village, I would be proud of their sacrifice.”]

|name&gt;[CAIN]
|dialogue&gt;[“Our families are in that village.”]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“Cain! Sir!”]

|name&gt;[CAIN]
|dialogue&gt;[“Just as you are all my brothers in Knighthood, all Muffins have become kin, ever since the day donuts invaded our sacred lands.”]

|action&gt;[CHECKPOINT 01]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Right you are, sir Cain. Thank you for gracing us with your wisdom.”]

|name&gt;[CAIN]
|dialogue&gt;[“Ah, prisoner. I did not expect to see you here. You certainly have a propensity to pop out of nowhere.”]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“Sir, I must ask. Is this that famous prisoner? The one that helped you and Hector escape?”]

|name&gt;[CAIN]
|dialogue&gt;[“Helped me?! I&#39;m the one who helped him escape that prison! Get your story straight.
Though I must admit, you have proven yourself more cunning than most, Prisoner. Perhaps you could be of use to us. Would you like to join the Sacred Knights?
Nod your head yes or no. Would you join our mission, to cleanse all Muffin lands of the filthy Donut invaders?
Would you like to join us, prisoner?
Nod your head yes or no.”]

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;[if you respond wait...]&lt;/summary&gt;
  |name&gt;[CAIN]
  |dialogue&gt;[“You don&#39;t say much, do you? I like this one. I&#39;m sure we&#39;ll find a use for you.”]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;[if you respond yes...]&lt;/summary&gt;
  |name&gt;[CAIN]
  |dialogue&gt;[“Good. I&#39;m sure we will make use of you, in due time.”]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;[if you respond no...]&lt;/summary&gt;
  |name&gt;[CAIN]
  |dialogue&gt;[“(scoff) ...as if the choice is yours to make. We&#39;ll use you when the time comes.”]
&lt;/details&gt;&lt;/tw-hook&gt;

|name&gt;[CAIN]
|dialogue&gt;[“Now where is my telescope?”]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“It&#39;s over there, sir, on top of the crate. Next to the Prisoner. Allow me to retrieve it for you.”]

|name&gt;[CAIN]
|dialogue&gt;[“Stop... I want the Prisoner to retrieve it. Prisoner, pick up my telescope and hand it over to me.
My telescope is atop that crate. Pick it up and give it to me.
I am speaking to you, Prisoner.
Hand me my telescope. I will not command you again.
NOW, PRISONER!”]

&lt;tw-hook name=&quot;branch-a&quot;&gt;&lt;details&gt;
  &lt;summary&gt;[if you refuse to pick up the telescope and give it to Cain...]&lt;/summary&gt;
  |name&gt;[CAIN]
  |dialogue&gt;[“Let this be a lesson. Insubordination will not be tolerated.”]

  |action&gt;[(Cain shoots you in the face. You die and respawn at CHECKPOINT 01.)]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[scene continues if you hand over the telescope...]

|action&gt;[You hand Cain his telescope.]

|name&gt;[CAIN]
|dialogue&gt;[“Thank you kindly.”]

|action&gt;[(Cain looks through the telescope.)]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“Sir, it appears the donuts have deployed all forces from their base. They are soon to make contact with the village.”]

|name&gt;[CAIN]
|dialogue&gt;[“As expected. Donuts are utterly predictable.” (Lowers the telescope.) “Make a note. The Donuts leave their base of operations lightly defended, whenever they commence an attack.”]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“...lightly... defended…”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Sir Cain, since the enemy base is now vulnerable, when will we strike?”]

|name&gt;[CAIN]
|dialogue&gt;[“We won&#39;t. The terrain here is too open with no concealment. The Donuts will see us coming from afar.”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Hmm. Right you are again, sir. The enemy would intercept our avdance, long before we reached their base.”]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“Donut invaders are entering the village now. Sir, shall we prepare forces to recapture the village?”]

|name&gt;[CAIN]
|dialogue&gt;[“No. That’s precisely what Donuts want from us. They want us to deplete our forces. They want us achieving pyrrhic victories at heavy cost. We will not fall for the enemy’s trap again, as was foolishly done at Muffinville, in my absence.”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“Sir, then what are we to do? We can&#39;t just leave the Muffin villagers at the mercy of Donuts!”]

|name&gt;[CAIN]
|dialogue&gt;[“Patience, young knight. If our muffin kin shall perish at the filthy hands of Donuts, they shall not have perished in vain. We will avenge all Muffins, in accordance with the divine decree of our Sacred Scripture. Chapter 16 Verse 126 commands of us: ‘If you punish an enemy, punish with an equivalent of that with which you were harmed.’ We will uphold the teachings of our Scripture. We will do to Donuts, what they have done to us.”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“But if you are patient—it is better for those who are patient.”]

|name&gt;[CAIN]
|dialogue&gt;[“What?”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“My apologies for speaking out of turn, sir Cain.”]

|name&gt;[CAIN]
|dialogue&gt;[“Speak if you have something to speak.”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“Well, you didn’t quote the entire verse, sir. ‘If you punish an enemy, punish with an equivalent of that with which you were harmed. But if you are patient—it is better for those who are patient.’ So perhaps it’s better to show patience... at least towards civilian Donuts.”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“(scoff) ...civilian Donuts. (Shaking head.)”]

|name&gt;[CAIN]
|dialogue&gt;[“Who taught you this verse?”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“No one, sir. I’ve just been reading our Sacred Scripture myself.”]

|name&gt;[CAIN]
|dialogue&gt;[“Stop reading it.”]

|name&gt;[EVERYONE]
|dialogue&gt;[“(gasp!)”]

|name&gt;[CAIN]
|dialogue&gt;[“What I meant is, do not read our Sacred Scripture without proper guidance. The part of this verse about patience pertains to a remorseful, subdued enemy. It does not apply while the enemy is actively continuing their campaign of atrocities against us. Is that understood?”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“Yes sir. I understand now.”]

|name&gt;[CAIN]
|dialogue&gt;[“Good… and keep reading our Sacred Scripture, as should you all. We are, after all, the Sacred Knights, guardians of all that we Muffins hold sacred. It’s only fitting that we ourselves become scholars of scripture.”]

|action&gt;[(Radio cuts in.)]

|name&gt;[SK CELL AGENT (RADIO)]
|dialogue&gt;[“Come in, Command. This is Red Cell 7. Do you read?&quot;]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Command to Red Cell 7. Affirmative. We read you.”]

|name&gt;[SK CELL AGENT (RADIO)]
|dialogue&gt;[“We have successfully infiltrated the central shopping district of the enemy city. There are countless defenceless Donuts here. My men are in position and prepared to strike. I repeat, we are ready to strike at the underbelly of this wretched Donut society.”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Acknowledged, Red Cell 7. Await orders.”]

|name&gt;[SK CELL AGENT (RADIO)]
|dialogue&gt;[“Acknowledged, awaiting orders.”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Sir Cain, shall I inform Red Cell 7 to commence our attack against the Donut shopping district.”]

|name&gt;[CAIN]
|dialogue&gt;[“Hand me the radio. I will give the order myself… What are the donuts doing down there?&quot; ]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“I&#39;m not sure, sir. I&#39;m very confused. They haven&#39;t fired a single shot.”]

|name&gt;[CAIN]
|dialogue&gt;[“Hmm... &#39;if you are patient—it is better for those who are patient.&#39; The Sacred Scripture really does say that?”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“Yes sir.”]

|name&gt;[CAIN]
|dialogue&gt;[“Prisoner, you bore witness to what the Donuts have done. What say you? Should we... be patient... with these Donuts?
Shall we grant mercy upon the Donuts, in the central shopping district?
What say you, prisoner?
ANSWER ME!”]

&lt;tw-hook name=&quot;branch-wait&quot;&gt;&lt;details&gt;
  &lt;summary&gt;[if you respond wait...]&lt;/summary&gt;
  |name&gt;[CAIN]
  |dialogue&gt;[“You are truly a test of my patience, Prisoner.”]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-yes&quot;&gt;&lt;details&gt;
  &lt;summary&gt;[if you respond yes...]&lt;/summary&gt;
  |name&gt;[CAIN]
  |dialogue&gt;[“Perhaps you&#39;re right.”]
&lt;/details&gt;&lt;/tw-hook&gt;

&lt;tw-hook name=&quot;branch-no&quot;&gt;&lt;details&gt;
  &lt;summary&gt;[if you respond no...]&lt;/summary&gt;
  |name&gt;[CAIN]
  |dialogue&gt;[“I am like you, Prisoner. I shudder at the thought of showing Donuts any mercy. However...”]
&lt;/details&gt;&lt;/tw-hook&gt;

|action&gt;[(Cain pauses, his gaze distant and troubled. For a brief moment, he appears genuinely conflicted, weighing the gravity of the decision he is about to make.)]

|name&gt;[CAIN]
|dialogue&gt;[“Perhaps it is a waste of our resources. Who&#39;s idea was it anyway to attack such a militarily insignificant shopping district?”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“Uh... that was your idea, sir.”]

|name&gt;[CAIN]
|dialogue&gt;[“Oh right.&quot;]

|action&gt;[(The Donuts in the distance begin to pull out of the outpost. Everyone is confused.)]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“Sir, have a look! The Donuts are retreating from the village.&quot;]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[&quot;But why are they pulling out so early? They haven&#39;t even done anything yet.”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“Well, there are no fighters in that village. It&#39;s only Muffin refugees. Could the Donuts be demonstrating some semblance of mercy by sparing the village?”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Highly doubtful. I have yet to witness a single Donut show a hint of mercy towards Muffins.”]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“Perhaps it&#39;s not about mercy. Rather, killing Muffin civilians simply isn&#39;t worth their bullets, from their wicked perspective.”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Hrmph. I don&#39;t know. Something doesn&#39;t feel right.”]

|name&gt;[SK CELL AGENT (RADIO)]
|dialogue&gt;[“Come in, Command. My men are growing impatient. The Donut enemy is defenseless with a minimal police presence. We are ready to strike. What are our orders?”]

|action&gt;[(Just before Cain speaks through the radio, the Donuts trigger a series of explosions they planted in every outpost building. Everyone is shocked by the brutality of the Donuts.)]

|name&gt;[CAIN]
|dialogue&gt;[“Command to Red Cell 7. There&#39;s been a change of plans. Cancel the...”]

|name&gt;[SACRED KNIGHT 3 (Observant)]
|dialogue&gt;[“Mother of dough!”]

|name&gt;[SACRED KNIGHT 1 (Morally Conflicted)]
|dialogue&gt;[“But why?! There are only innocent Muffin refugees in that village! WHY?!”]

|name&gt;[SACRED KNIGHT 2 (Pragmatic)]
|dialogue&gt;[“Do you not see it? This is what Donuts do. This is how Donuts show mercy.&quot;]

|name&gt;[SK CELL AGENT (RADIO)]
|dialogue&gt;[“We did not receive your last transmission. I repeat, my men are prepared to strike. What are our orders?”]

|name&gt;[CAIN]
|dialogue&gt;[“Kill them all.”]

|name&gt;[SK CELL AGENT (RADIO)]
|dialogue&gt;[“Order acknowledged. It was a pleasure to serve under you, sir Cain.”]

|name&gt;[DONUT POLICE OFFICER (RADIO)]
|dialogue&gt;[“Why are there Muffins here? Hey, you, stop in the name of the law! AHHH! (gutteral sounds after getting stabbed)”]

|action&gt;[(Donut civilian screams and gun fire can be heard from the Red Cell 7 attack can be heard from the radio as everyone looks upon the smoldering village in the distance.)]

|action&gt;[(The Simulation™ glitches.)]
































</tw-passagedata><tw-passagedata pid="116" name="Location Names" tags="" position="175,425" size="100,100">MUFFINS:

Rolling Fields Cities
	•	Blueberry Bulge
	•	Cinnacrest
	•	Crumbury

Rolling Fields Villages
	•	Raspbrook
	•	Branborough - 1st concentration camp
	•	Mapleheart
	•	Honeywell
	•	Lemon Loft - obliterated village
	•	Pumpkinshire
	•	Sunloaf
	•	Muffinville
	•	Ambergrain

Rolling Fields Outposts
	•	Crustwatch
	•	Oatpost
	•	Whiskwind
	•	Yeasthaven
	•	Oven’s Reach

Frost Peak Villages
	•	Icinggard
	•	Frostholm
	•	Crumbjörn
	•	Chipstad






DONUTS:

Rolling Fields (Colonized Muffin Lands)
	•	New Arc City

Arc Land
	•	Sprinkle City
	•	Dough Town
	•	Batter Bay
	•	Circle City

High Hill
	•	Long John City
	•	Golden Glaze
	•	Fondant

Crumble Islands (The Crumbs)
	•	Custard Cove
	•	Swirl Harbor
</tw-passagedata><tw-passagedata pid="117" name="NB-ImportTest-A1S07" tags="" position="875,600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[TEMP IMPORT TEST]
NARRATIVE BIBLE - DETAILED OVERVIEW SAMPLE]

|scene&gt;[(text-style:&quot;underline&quot;)[ACT 1 SCENE 07 - FIND THE SIGNAL]]
|parenthetical&gt;[(Temporary test passage for Google Docs image + overview import workflow.)]
|parenthetical&gt;[(Source: Narrative Bible - Detailed Story Overview tab.)]

You awaken inside a violent war dream and are pushed through three escalating combat environments (daylight trench warfare, dusk ambush trail, and night urban combat). Across each segment, Donut command pressure repeats the same objective: find and activate the signal.

At the climax, your commanding voices overlap and direct you to a console identical to the Sim Labs distress lever. You activate it, and the scene hard-cuts into the next sequence where the real distress system has been triggered.

|action&gt;[This text is an imported overview test only (not script dialogue).]

&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;https://lh7-rt.googleusercontent.com/docsz/AD_4nXeDf_mDFGQIrbayn3-IQeqgObxdDI6qssdpeQsvuDhvvv2MI8R1twe6KI4mV5sHNGosIrtyHnI-CrZrrGBeQi3wsniEEjz4gBT8tbmHN-eno6zs2E5OpaqVG7U5pzcMAaxYRfhbSgBZU2GT4SBVw5ALTw?key=k6h13mdkNp7tBQxe7fM5qwY8&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;https://lh7-rt.googleusercontent.com/docsz/AD_4nXeNeD_02PwGQZkxXB7UgztQ7aM6Sqzka86No0KFmbNMmj97FI29ymRtmwxbwocCPec7QQ0mro1nfr5O2Z1HuFDOR2sKgadWcy41bo2XAPwAZzRGX3_DI0E0DRcTe68CNISoWPhCxaFZZgbxWD9J5_PTPg?key=k6h13mdkNp7tBQxe7fM5qwY8&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;

|parenthetical&gt;[(These two image URLs are temporary signed Google content links for pipeline testing.)]

(align:&quot;==&gt;&quot;)[[[Return to A1-S01|A1-S01]]]</tw-passagedata><tw-passagedata pid="118" name="NB-ImportTest-A1S02-Local" tags="" position="1025,600" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[TEMP IMPORT TEST]
NARRATIVE BIBLE - DETAILED OVERVIEW SAMPLE]

|scene&gt;[(text-style:&quot;underline&quot;)[ACT 1 SCENE 02 - THE SIMULATION TRAINING EXPERIENCE MODULE™]]
|parenthetical&gt;[(Temporary test passage for local-repo image + overview import workflow.)]
|parenthetical&gt;[(Source: Narrative Bible - Detailed Story Overview tab.)]

You begin in a white simulation space while Professor Ludwig speaks through an intercom, briefly loading the wrong Matrix-like setup before correcting to the intended training module.

The sequence teaches core mechanics: locomotion options, simulator-removal menu behavior versus true extraction events, item pickup, firearms, grenades, breaching charges, and the checkpoint/sniper constraint that enforces intended story progression.

Before you enter a deeper simulation layer, Ludwig warns that recursive layers can trap you further from reality. The scene ends with you preparing to wear another simulator and descend again.

|action&gt;[This text is an imported overview test only (not script dialogue).]

&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;assets/images/narrative-bible/act-1/scene-02/a1-s02-detailed-overview-01.png&quot; class=&quot;fitHalf&quot;&gt;
&lt;/div&gt;

|parenthetical&gt;[(Image hosted locally in this Twine repo for pipeline testing.)]

(align:&quot;==&gt;&quot;)[[[Return to A1-S01|A1-S01]]]</tw-passagedata><tw-passagedata pid="119" name="NB-ImportTest-A1S07-Local" tags="" position="1025,725" size="100,100">|act&gt;[(text-style:&quot;underline&quot;)[TEMP IMPORT TEST]
NARRATIVE BIBLE - DETAILED OVERVIEW SAMPLE]

|scene&gt;[(text-style:&quot;underline&quot;)[ACT 1 SCENE 07 - FIND THE SIGNAL]]
|parenthetical&gt;[(Temporary test passage for local-repo image + overview import workflow.)]
|parenthetical&gt;[(Source: Narrative Bible - Detailed Story Overview tab.)]

You awaken inside a violent war dream and are pushed through three escalating combat environments (daylight trench warfare, dusk ambush trail, and night urban combat). Across each segment, Donut command pressure repeats the same objective: find and activate the signal.

At the climax, your commanding voices overlap and direct you to a console identical to the Sim Labs distress lever. You activate it, and the scene hard-cuts into the next sequence where the real distress system has been triggered.

|action&gt;[This text is an imported overview test only (not script dialogue).]

&lt;div class=&quot;imageContainer&quot;&gt;
  &lt;img src=&quot;assets/images/narrative-bible/act-1/scene-07/a1-s07-detailed-overview-01.png&quot; class=&quot;fit32&quot;&gt;
  &lt;img src=&quot;assets/images/narrative-bible/act-1/scene-07/a1-s07-detailed-overview-02.png&quot; class=&quot;fit32&quot;&gt;
&lt;/div&gt;

|parenthetical&gt;[(Images hosted locally in this Twine repo for pipeline testing.)]

(align:&quot;==&gt;&quot;)[[[Return to A1-S01|A1-S01]]]</tw-passagedata></tw-storydata>
<script title="Twine engine code" data-main="harlowe">(function(){"use strict";
var require,define;!function(){var e={},r={};require=function(i){var n=e[i];return n&&(r[i]=n[1].apply(void 0,n[0].map(require)),e[i]=void 0),r[i]},(define=function(r,i,n){if("function"==typeof r)return r();e[r]=[i,n]}).amd=!0}();/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.join);var A=Function.call.bind(Array.prototype.shift);var R=Math.max;var _=Math.min;var k=Math.floor;var L=Math.abs;var F=Math.exp;var D=Math.log;var z=Math.sqrt;var q=Function.call.bind(Object.prototype.hasOwnProperty);var W;var G=function(){};var H=S.Map;var V=H&&H.prototype["delete"];var B=H&&H.prototype.get;var U=H&&H.prototype.has;var $=H&&H.prototype.set;var J=S.Symbol||{};var X=J.species||"@@species";var K=Number.isNaN||function isNaN(e){return e!==e};var Z=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Y=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(K(t)){return t}return t<0?-1:1};var Q=function log1p(e){var t=Number(e);if(t<-1||K(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(D(1+t)/(1+t-1))};var ee=function isArguments(e){return g(e)==="[object Arguments]"};var te=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var re=ee(arguments)?ee:te;var ne={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var oe=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var ie=typeof J==="function"&&typeof J["for"]==="function"&&ne.symbol(J());var ae=ne.symbol(J.iterator)?J.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ae="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ue=S.Reflect;var fe=String;var se=typeof document==="undefined"||!document?null:document.all;var ce=se==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==se};var le={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!le.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(ce(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===se},ToObject:function(e,t){return Object(le.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return le.IsCallable(e)},ToInt32:function(e){return le.ToNumber(e)>>0},ToUint32:function(e){return le.ToNumber(e)>>>0},ToNumber:function(e){if(ie&&g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=le.ToNumber(e);if(K(t)){return 0}if(t===0||!Z(t)){return t}return(t>0?1:-1)*k(L(t))},ToLength:function(e){var t=le.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return K(e)&&K(t)},SameValueZero:function(e,t){return e===t||K(e)&&K(t)},GetIterator:function(e){if(re(e)){return new W(e,"value")}var t=le.GetMethod(e,ae);if(!le.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=le.Call(t,e);if(!le.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=le.ToObject(e)[t];if(ce(r)){return void 0}if(!le.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=le.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=le.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!le.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!le.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=le.IteratorNext(e);var r=le.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ue.construct){return ue.construct(e,t,o)}var i=o.prototype;if(!le.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=le.Call(e,a,t);return le.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!le.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[X];if(ce(n)){return t}if(!le.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=le.ToString(e);var i="<"+t;if(r!==""){var a=le.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!le.TypeIsObject(e)){return false}var t=e[J.match];if(typeof t!=="undefined"){return!!t}return ne.regex(e)},ToString:function ToString(e){if(ie&&g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return fe(e)}};if(s&&ie){var pe=function defineWellKnownSymbol(e){if(ne.symbol(J[e])){return J[e]}var t=J["for"]("Symbol."+e);Object.defineProperty(J,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!ne.symbol(J.search)){var ve=pe("search");var ye=String.prototype.search;h(RegExp.prototype,ve,function search(e){return le.Call(ye,e,[this])});var he=function search(e){var t=le.RequireObjectCoercible(this);if(!ce(e)){var r=le.GetMethod(e,ve);if(typeof r!=="undefined"){return le.Call(r,e,[t])}}return le.Call(ye,t,[le.ToString(e)])};oe(String.prototype,"search",he)}if(!ne.symbol(J.replace)){var be=pe("replace");var ge=String.prototype.replace;h(RegExp.prototype,be,function replace(e,t){return le.Call(ge,e,[this,t])});var de=function replace(e,t){var r=le.RequireObjectCoercible(this);if(!ce(e)){var n=le.GetMethod(e,be);if(typeof n!=="undefined"){return le.Call(n,e,[r,t])}}return le.Call(ge,r,[le.ToString(e),t])};oe(String.prototype,"replace",de)}if(!ne.symbol(J.split)){var me=pe("split");var Oe=String.prototype.split;h(RegExp.prototype,me,function split(e,t){return le.Call(Oe,e,[this,t])});var we=function split(e,t){var r=le.RequireObjectCoercible(this);if(!ce(e)){var n=le.GetMethod(e,me);if(typeof n!=="undefined"){return le.Call(n,e,[r,t])}}return le.Call(Oe,r,[le.ToString(e),t])};oe(String.prototype,"split",we)}var je=ne.symbol(J.match);var Se=je&&function(){var e={};e[J.match]=function(){return 42};return"a".match(e)!==42}();if(!je||Se){var Te=pe("match");var Ie=String.prototype.match;h(RegExp.prototype,Te,function match(e){return le.Call(Ie,e,[this])});var Ee=function match(e){var t=le.RequireObjectCoercible(this);if(!ce(e)){var r=le.GetMethod(e,Te);if(typeof r!=="undefined"){return le.Call(r,e,[t])}}return le.Call(Ie,t,[le.ToString(e)])};oe(String.prototype,"match",Ee)}}var Pe=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in G||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in G||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Ce=function(){return this};var Me=function(e){if(s&&!q(e,X)){m.getter(e,X,Ce)}};var xe=function(e,t){var r=t||function iterator(){return this};h(e,ae,r);if(!e[ae]&&ne.symbol(ae)){e[ae]=r}};var Ne=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ae=function createDataPropertyOrThrow(e,t,r){Ne(e,t,r);if(!le.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Re=function(e,t,r,n){if(!le.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!le.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(q(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var _e=String.fromCodePoint;oe(String,"fromCodePoint",function fromCodePoint(e){return le.Call(_e,this,arguments)})}var ke={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!le.SameValue(r,le.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return N(t,"")},raw:function raw(e){var t=arguments.length-1;var r=le.ToObject(e,"bad template");var raw=le.ToObject(r.raw,"bad raw value");var n=raw.length;var o=le.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=le.ToString(a);s=le.ToString(raw[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=le.ToString(f);M(i,c);a+=1}return N(i,"")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){oe(String,"raw",ke.raw)}b(String,ke);var Le=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Fe=Infinity;var De={repeat:function repeat(e){var t=le.ToString(le.RequireObjectCoercible(this));var r=le.ToInteger(e);if(r<0||r>=Fe){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return Le(t,r)},startsWith:function startsWith(e){var t=le.ToString(le.RequireObjectCoercible(this));if(le.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=le.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=R(le.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=le.ToString(le.RequireObjectCoercible(this));if(le.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=le.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:le.ToInteger(o);var a=_(R(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(le.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=le.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=le.ToString(le.RequireObjectCoercible(this));var r=le.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){oe(String.prototype,"includes",De.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var ze=i(function(){return"/a/".startsWith(/a/)});var qe=a(function(){return"abc".startsWith("a",Infinity)===false});if(!ze||!qe){oe(String.prototype,"startsWith",De.startsWith);oe(String.prototype,"endsWith",De.endsWith)}}if(ie){var We=a(function(){var e=/a/;e[J.match]=false;return"/a/".startsWith(e)});if(!We){oe(String.prototype,"startsWith",De.startsWith)}var Ge=a(function(){var e=/a/;e[J.match]=false;return"/a/".endsWith(e)});if(!Ge){oe(String.prototype,"endsWith",De.endsWith)}var He=a(function(){var e=/a/;e[J.match]=false;return"/a/".includes(e)});if(!He){oe(String.prototype,"includes",De.includes)}}b(String.prototype,De);var Ve=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Be=new RegExp("(^["+Ve+"]+)|(["+Ve+"]+$)","g");var Ue=function trim(){return le.ToString(le.RequireObjectCoercible(this)).replace(Be,"")};var $e=["\x85","\u200b","\ufffe"].join("");var Je=new RegExp("["+$e+"]","g");var Xe=/^[-+]0x[0-9a-f]+$/i;var Ke=$e.trim().length!==$e.length;h(String.prototype,"trim",Ue,Ke);var Ze=function(e){return{value:e,done:arguments.length===0}};var Ye=function(e){le.RequireObjectCoercible(e);h(this,"_s",le.ToString(e));h(this,"_i",0)};Ye.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ze()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ze(e.substr(t,o))};xe(Ye.prototype);xe(String.prototype,function(){return new Ye(this)});var Qe={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!le.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(re(e)||le.GetMethod(e,ae))!=="undefined";var u,f,s;if(a){f=le.IsConstructor(r)?Object(new r):[];var c=le.GetIterator(e);var l,p;s=0;while(true){l=le.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){le.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=le.ToObject(e);u=le.ToLength(y.length);f=le.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ae(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!le.IsCallable(t)?new Array(e):le.Construct(t,[e]);for(var o=0;o<e;++o){Ae(n,o,arguments[o])}n.length=e;return n}};b(Array,Qe);Me(Array);W=function(e,t){h(this,"i",0);h(this,"array",e);h(this,"kind",t)};b(W.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof W)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=le.ToLength(t.length);if(e<r){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ze(o)}}this.array=void 0;return Ze()}});xe(W.prototype);var et=Array.of===Qe.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!et){oe(Array,"of",Qe.of)}var tt={copyWithin:function copyWithin(e,t){var r=le.ToObject(this);var n=le.ToLength(r.length);var o=le.ToInteger(e);var i=le.ToInteger(t);var a=o<0?R(n+o,0):_(o,n);var u=i<0?R(n+i,0):_(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:le.ToInteger(f);var c=s<0?R(n+s,0):_(s,n);var l=_(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=le.ToObject(this);var o=le.ToLength(n.length);t=le.ToInteger(typeof t==="undefined"?0:t);r=le.ToInteger(typeof r==="undefined"?o:r);var i=t<0?R(o+t,0):_(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=le.ToObject(this);var n=le.ToLength(r.length);if(!le.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=le.ToObject(this);var n=le.ToLength(r.length);if(!le.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new W(this,"key")},values:function values(){return new W(this,"value")},entries:function entries(){return new W(this,"entry")}};if(Array.prototype.keys&&!le.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!le.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ae]){b(Array.prototype,{values:Array.prototype[ae]});if(ne.symbol(J.unscopables)){Array.prototype[J.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var rt=Array.prototype.values;oe(Array.prototype,"values",function values(){return le.Call(rt,this,arguments)});h(Array.prototype,ae,Array.prototype.values,true)}b(Array.prototype,tt);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}xe(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){var nt=Object.getPrototypeOf([].values());if(nt){xe(nt)}}var ot=function(){return a(function(){return Array.from({length:-1}).length===0})}();var it=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!ot||!it){oe(Array,"from",Qe.from)}var at=function(){return a(function(){return Array.from([0],void 0)})}();if(!at){var ut=Array.from;oe(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return le.Call(ut,this,arguments)}return t(ut,this,e)})}var ft=-(Math.pow(2,32)-1);var st=function(e,r){var n={length:ft};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!st(Array.prototype.forEach)){var ct=Array.prototype.forEach;oe(Array.prototype,"forEach",function forEach(e){return le.Call(ct,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.map)){var lt=Array.prototype.map;oe(Array.prototype,"map",function map(e){return le.Call(lt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.filter)){var pt=Array.prototype.filter;oe(Array.prototype,"filter",function filter(e){return le.Call(pt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.some)){var vt=Array.prototype.some;oe(Array.prototype,"some",function some(e){return le.Call(vt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.every)){var yt=Array.prototype.every;oe(Array.prototype,"every",function every(e){return le.Call(yt,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.reduce)){var ht=Array.prototype.reduce;oe(Array.prototype,"reduce",function reduce(e){return le.Call(ht,this.length>=0?this:[],arguments)})}if(!st(Array.prototype.reduceRight,true)){var bt=Array.prototype.reduceRight;oe(Array.prototype,"reduceRight",function reduceRight(e){return le.Call(bt,this.length>=0?this:[],arguments)})}var gt=Number("0o10")!==8;var dt=Number("0b10")!==2;var mt=y($e,function(e){return Number(e+0+e)===0});if(gt||dt||mt){var Ot=Number;var wt=/^0b[01]+$/i;var jt=/^0o[0-7]+$/i;var St=wt.test.bind(wt);var Tt=jt.test.bind(jt);var It=function(e,t){var r;if(typeof e.valueOf==="function"){r=e.valueOf();if(ne.primitive(r)){return r}}if(typeof e.toString==="function"){r=e.toString();if(ne.primitive(r)){return r}}throw new TypeError("No default value")};var Et=Je.test.bind(Je);var Pt=Xe.test.bind(Xe);var Ct=function(){var e=function Number(t){var r;if(arguments.length>0){r=ne.primitive(t)?t:It(t,"number")}else{r=0}if(typeof r==="string"){r=le.Call(Ue,r);if(St(r)){r=parseInt(C(r,2),2)}else if(Tt(r)){r=parseInt(C(r,2),8)}else if(Et(r)||Pt(r)){r=NaN}}var n=this;var o=a(function(){Ot.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new Ot(r)}return Ot(r)};return e}();Pe(Ot,Ct,{});b(Ct,{NaN:Ot.NaN,MAX_VALUE:Ot.MAX_VALUE,MIN_VALUE:Ot.MIN_VALUE,NEGATIVE_INFINITY:Ot.NEGATIVE_INFINITY,POSITIVE_INFINITY:Ot.POSITIVE_INFINITY});Number=Ct;m.redefine(S,"Number",Ct)}var Mt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Mt,MIN_SAFE_INTEGER:-Mt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:Z,isInteger:function isInteger(e){return Z(e)&&le.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&L(e)<=Number.MAX_SAFE_INTEGER},isNaN:K});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){oe(Array.prototype,"find",tt.find)}if([,1].findIndex(function(){return true})!==0){oe(Array.prototype,"findIndex",tt.findIndex)}var xt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Nt=function ensureEnumerable(e,t){if(s&&xt(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var At=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var Rt=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var _t=function(e,t){var r=n(Object(t));var o;if(le.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),xt(t))}return p(P(r,o||[]),Rt(t),e)};var kt={assign:function(e,t){var r=le.ToObject(e,"Cannot convert undefined or null to object");return p(le.Call(At,1,arguments),_t,r)},is:function is(e,t){return le.SameValue(e,t)}};var Lt=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(Lt){oe(Object,"assign",kt.assign)}b(Object,kt);if(s){var Ft={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!le.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||le.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,Ft)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Dt=!i(function(){return Object.keys("foo")});if(!Dt){var zt=Object.keys;oe(Object,"keys",function keys(e){return zt(le.ToObject(e))});n=Object.keys}var qt=i(function(){return Object.keys(/a/g)});if(qt){var Wt=Object.keys;oe(Object,"keys",function keys(e){if(ne.regex(e)){var t=[];for(var r in e){if(q(e,r)){M(t,r)}}return t}return Wt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var Gt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!Gt){var Ht=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Vt=Object.getOwnPropertyNames;oe(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=le.ToObject(e);if(g(t)==="[object Window]"){try{return Vt(t)}catch(r){return P([],Ht)}}return Vt(t)})}}if(Object.getOwnPropertyDescriptor){var Bt=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Bt){var Ut=Object.getOwnPropertyDescriptor;oe(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Ut(le.ToObject(e),t)})}}if(Object.seal){var $t=!i(function(){return Object.seal("foo")});if(!$t){var Jt=Object.seal;oe(Object,"seal",function seal(e){if(!le.TypeIsObject(e)){return e}return Jt(e)})}}if(Object.isSealed){var Xt=!i(function(){return Object.isSealed("foo")});if(!Xt){var Kt=Object.isSealed;oe(Object,"isSealed",function isSealed(e){if(!le.TypeIsObject(e)){return true}return Kt(e)})}}if(Object.freeze){var Zt=!i(function(){return Object.freeze("foo")});if(!Zt){var Yt=Object.freeze;oe(Object,"freeze",function freeze(e){if(!le.TypeIsObject(e)){return e}return Yt(e)})}}if(Object.isFrozen){var Qt=!i(function(){return Object.isFrozen("foo")});if(!Qt){var er=Object.isFrozen;oe(Object,"isFrozen",function isFrozen(e){if(!le.TypeIsObject(e)){return true}return er(e)})}}if(Object.preventExtensions){var tr=!i(function(){return Object.preventExtensions("foo")});if(!tr){var rr=Object.preventExtensions;oe(Object,"preventExtensions",function preventExtensions(e){if(!le.TypeIsObject(e)){return e}return rr(e)})}}if(Object.isExtensible){var nr=!i(function(){return Object.isExtensible("foo")});if(!nr){var or=Object.isExtensible;oe(Object,"isExtensible",function isExtensible(e){if(!le.TypeIsObject(e)){return false}return or(e)})}}if(Object.getPrototypeOf){var ir=!i(function(){return Object.getPrototypeOf("foo")});if(!ir){var ar=Object.getPrototypeOf;oe(Object,"getPrototypeOf",function getPrototypeOf(e){return ar(le.ToObject(e))})}}var ur=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&le.IsCallable(e.get)}();if(s&&!ur){var fr=function flags(){if(!le.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",fr)}var sr=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var cr=ie&&s&&function(){var e=/./;e[J.match]=false;return RegExp(e)===e}();var lr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var pr=lr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!lr||!pr){var vr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=le.RequireObjectCoercible(this);if(ne.regex(e)){return t(vr,e)}var r=fe(e.source);var n=fe(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,vr)}if(s&&(!sr||cr)){var yr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var hr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var br=function(){return this.source};var gr=le.IsCallable(hr.get)?hr.get:br;var dr=RegExp;var mr=function(){return function RegExp(e,t){var r=le.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(ne.regex(e)){o=le.Call(gr,e);i=typeof t==="undefined"?le.Call(yr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new dr(e,t)}}();Pe(dr,mr,{$input:true});RegExp=mr;m.redefine(S,"RegExp",mr)}if(s){var Or={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(Or),function(e){if(e in RegExp&&!(Or[e]in RegExp)){m.getter(RegExp,Or[e],function get(){return RegExp[e]})}})}Me(RegExp);var wr=1/Number.EPSILON;var jr=function roundTiesToEven(e){return e+wr-wr};var Sr=Math.pow(2,-23);var Tr=Math.pow(2,127)*(2-Sr);var Ir=Math.pow(2,-126);var Er=Math.E;var Pr=Math.LOG2E;var Cr=Math.LOG10E;var Mr=Number.prototype.clz;delete Number.prototype.clz;var xr={acosh:function acosh(e){var t=Number(e);if(K(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Q(t-1+z(1-r)*t)}var n=t/2;return Q(n+z(1-r)*n-1)+1/Pr},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=L(t);var n=r*r;var o=Y(t);if(r<1){return o*Q(r+n/(z(n+1)+1))}return o*(Q(r/2+z(1+1/n)*r/2-1)+1/Pr)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(K(t)||t<-1||t>1){return NaN}var r=L(t);return Y(t)*Q(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=F(D(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=le.ToUint32(t);if(r===0){return 32}return Mr?le.Call(Mr,r):31-k(D(r+.5)*Pr)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(K(t)){return NaN}if(!T(t)){return Infinity}var r=F(L(t)-1);return(r+1/(r*Er*Er))*(Er/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(L(t)>.5){return F(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=L(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*z(r)},log2:function log2(e){return D(e)*Pr},log10:function log10(e){return D(e)*Cr},log1p:Q,sign:Y,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=L(t);if(r<1){var n=Math.expm1(r);return Y(t)*n*(1+1/(n+1))/2}var o=F(r-1);return Y(t)*(o-1/(o*Er*Er))*(Er/2)},tanh:function tanh(e){var t=Number(e);if(K(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(F(t)+F(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-k(-t):k(t)},imul:function imul(e,t){var r=le.ToUint32(e);var n=le.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||K(t)){return t}var r=Y(t);var n=L(t);if(n<Ir){return r*jr(n/Ir/Sr)*Ir*Sr}var o=(1+Sr/Number.EPSILON)*n;var i=o-(o-n);if(i>Tr||K(i)){return r*Infinity}return r*i}};var Nr=function withinULPDistance(e,t,r){return L(1-e/t)/Number.EPSILON<(r||8)};b(Math,xr);h(Math,"sinh",xr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",xr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",xr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",xr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"asinh",xr.asinh,Math.asinh(1e300)===Infinity);
h(Math,"atanh",xr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",xr.tanh,Math.tanh(-2e-17)!==-2e-17);h(Math,"acosh",xr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",xr.acosh,!Nr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",xr.cbrt,!Nr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",xr.sinh,Math.sinh(-2e-17)!==-2e-17);var Ar=Math.expm1(10);h(Math,"expm1",xr.expm1,Ar>22025.465794806718||Ar<22025.465794806718);h(Math,"hypot",xr.hypot,Math.hypot(Infinity,NaN)!==Infinity);var Rr=Math.round;var _r=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var kr=wr+1;var Lr=2*wr-1;var Fr=[kr,Lr].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=k(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!_r||!Fr);m.preserveToString(Math.round,Rr);var Dr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=xr.imul;m.preserveToString(Math.imul,Dr)}if(Math.imul.length!==2){oe(Math,"imul",function imul(e,t){return le.Call(Dr,Math,arguments)})}var zr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}le.IsPromise=function(e){if(!le.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!le.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(le.IsCallable(t.resolve)&&le.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&le.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=A(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=le.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(le.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!le.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!le.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!le.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Re(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=le.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=le.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=le.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{le.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=le.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{le.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!le.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(le.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!le.IsPromise(n)){throw new TypeError("not a promise")}var o=le.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=le.IsCallable(e)?e:a;var d=le.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof zr==="function"){b(S,{Promise:zr});var qr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var Wr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,G)});var Gr=i(function(){return S.Promise.call(3,G)});var Hr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,G).then(null,G)}catch(n){return true}return t===r}(S.Promise);var Vr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Br=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Br.prototype=Promise.prototype;Br.all=Promise.all;var Ur=a(function(){return!!Br.all([1,2])});if(!qr||!Wr||!Gr||Hr||!Vr||Ur){Promise=zr;oe(S,"Promise",zr)}if(Promise.all.length!==1){var $r=Promise.all;oe(Promise,"all",function all(e){return le.Call($r,this,arguments)})}if(Promise.race.length!==1){var Jr=Promise.race;oe(Promise,"race",function race(e){return le.Call(Jr,this,arguments)})}if(Promise.resolve.length!==1){var Xr=Promise.resolve;oe(Promise,"resolve",function resolve(e){return le.Call(Xr,this,arguments)})}if(Promise.reject.length!==1){var Kr=Promise.reject;oe(Promise,"reject",function reject(e){return le.Call(Kr,this,arguments)})}Nt(Promise,"all");Nt(Promise,"race");Nt(Promise,"resolve");Nt(Promise,"reject");Me(Promise)}var Zr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Yr=Zr(["z","a","bb"]);var Qr=Zr(["z",1,"a","3",2]);if(s){var en=function fastkey(e,t){if(!t&&!Yr){return null}if(ce(e)){return"^"+le.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Qr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var tn=function emptyObject(){return Object.create?Object.create(null):{}};var rn=function addIterableToMap(e,n,o){if(r(o)||ne.string(o)){l(o,function(e){if(!le.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!ce(o)){a=n.set;if(!le.IsCallable(a)){throw new TypeError("bad map")}i=le.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=le.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!le.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){le.IteratorClose(i,true);throw s}}}}};var nn=function addIterableToSet(e,n,o){if(r(o)||ne.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!ce(o)){a=n.add;if(!le.IsCallable(a)){throw new TypeError("bad set")}i=le.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=le.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){le.IteratorClose(i,true);throw s}}}}};var on={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!le.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+le.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");h(this,"head",e._head);h(this,"i",this.head);h(this,"kind",t)};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ze()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ze(n)}}this.i=void 0;return Ze()}};xe(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Re(this,Map,a,{_es6map:true,_head:null,_map:H?new H:null,_size:0,_storage:tn()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){rn(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=en(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}return}if(this._map){t=B.call(this._map,e);if(t){return t.value}return}var n=this._head;var i=n;while((i=i.next)!==n){if(le.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=en(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return U.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(le.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=en(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}a=this._storage[u]=new r(e,t);i=n.prev}else if(this._map){if(U.call(this._map,e)){B.call(this._map,e).value=t}else{a=new r(e,t);$.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(le.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(le.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=en(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!U.call(this._map,t)){return false}n=B.call(this._map,t).prev;V.call(this._map,t)}while((n=n.next)!==r){if(le.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=H?new H:null;this._size=0;this._storage=tn();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});xe(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!le.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+le.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Re(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:tn()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){nn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new on.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=en(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=en(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=en(e))!==null){var n=q(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=tn()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);xe(i.prototype,i.prototype.values);var f=function SetIterator(e){h(this,"it",e)};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};xe(f.prototype);return i}()};var an=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(an){S.Set=on.Set}if(S.Map||S.Set){var un=a(function(){return new Map([[1,2]]).get(1)===2});if(!un){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new H;if(arguments.length>0){rn(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(H.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,H)}var fn=new Map;var sn=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var cn=fn.set(1,2)===fn;if(!sn||!cn){oe(Map.prototype,"set",function set(e,r){t($,this,e===0?0:e,r);return this})}if(!sn){b(Map.prototype,{get:function get(e){return t(B,this,e===0?0:e)},has:function has(e){return t(U,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,B);m.preserveToString(Map.prototype.has,U)}var ln=new Set;var pn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(ln);var vn=ln.add(1)===ln;if(!pn||!vn){var yn=Set.prototype.add;Set.prototype.add=function add(e){t(yn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,yn)}if(!pn){var hn=Set.prototype.has;Set.prototype.has=function has(e){return t(hn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,hn);var bn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(bn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],bn)}var gn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var dn=Object.setPrototypeOf&&!gn;var mn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||dn||!mn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new H;if(arguments.length>0){rn(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=H.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,H)}var On=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var wn=Object.setPrototypeOf&&!On;var jn=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||wn||!jn){var Sn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new Sn;if(arguments.length>0){nn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=Sn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,Sn)}var Tn=new S.Map;var In=!a(function(){return Tn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||Tn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof Tn.keys().next!=="function"||In||!gn){b(S,{Map:on.Map,Set:on.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}xe(Object.getPrototypeOf((new S.Map).keys()));xe(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var En=S.Set.prototype.has;oe(S.Set.prototype,"has",function has(e){return t(En,this,e)})}}b(S,on);Me(S.Map);Me(S.Set)}var Pn=function throwUnlessTargetIsObject(e){if(!le.TypeIsObject(e)){throw new TypeError("target must be an object")}};var Cn={apply:function apply(){return le.Call(le.Call,null,arguments)},construct:function construct(e,t){if(!le.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!le.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return le.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){Pn(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){Pn(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(Cn,{ownKeys:function ownKeys(e){Pn(e);var t=Object.getOwnPropertyNames(e);if(le.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Mn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(Cn,{isExtensible:function isExtensible(e){Pn(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){Pn(e);return Mn(function(){return Object.preventExtensions(e)})}})}if(s){var xn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return xn(o,t,r)}if("value"in n){return n.value}if(n.get){return le.Call(n.get,r)}return void 0};var Nn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Nn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!le.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ue.defineProperty(o,r,{value:n})}return ue.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}if(i.set){t(i.set,o,n);return true}return false};Object.assign(Cn,{defineProperty:function defineProperty(e,t,r){Pn(e);return Mn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){Pn(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){Pn(e);var r=arguments.length>2?arguments[2]:e;return xn(e,t,r)},set:function set(e,t,r){Pn(e);var n=arguments.length>3?arguments[3]:e;return Nn(e,t,r,n)}})}if(Object.getPrototypeOf){var An=Object.getPrototypeOf;Cn.getPrototypeOf=function getPrototypeOf(e){Pn(e);return An(e)}}if(Object.setPrototypeOf&&Cn.getPrototypeOf){var Rn=function(e,t){var r=t;while(r){if(e===r){return true}r=Cn.getPrototypeOf(r)}return false};Object.assign(Cn,{setPrototypeOf:function setPrototypeOf(e,t){Pn(e);if(t!==null&&!le.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ue.getPrototypeOf(e)){return true}if(ue.isExtensible&&!ue.isExtensible(e)){return false}if(Rn(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var _n=function(e,t){if(!le.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){oe(S.Reflect,e,t)}}};Object.keys(Cn).forEach(function(e){_n(e,Cn[e])});var kn=S.Reflect.getPrototypeOf;if(c&&kn&&kn.name!=="getPrototypeOf"){oe(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(kn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){oe(S.Reflect,"setPrototypeOf",Cn.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){oe(S.Reflect,"defineProperty",Cn.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){oe(S.Reflect,"construct",Cn.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var Ln=Date.prototype.toString;var Fn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return le.Call(Ln,this)};oe(Date.prototype,"toString",Fn)}var Dn={anchor:function anchor(e){return le.CreateHTML(this,"a","name",e)},big:function big(){return le.CreateHTML(this,"big","","")},blink:function blink(){return le.CreateHTML(this,"blink","","")},bold:function bold(){return le.CreateHTML(this,"b","","")},fixed:function fixed(){return le.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return le.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return le.CreateHTML(this,"font","size",e)},italics:function italics(){return le.CreateHTML(this,"i","","")},link:function link(e){return le.CreateHTML(this,"a","href",e)},small:function small(){return le.CreateHTML(this,"small","","")},strike:function strike(){return le.CreateHTML(this,"strike","","")},sub:function sub(){return le.CreateHTML(this,"sub","","")},sup:function sub(){return le.CreateHTML(this,"sup","","")}};l(Object.keys(Dn),function(e){var r=String.prototype[e];var n=false;if(le.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){oe(String.prototype,e,Dn[e])}});var zn=function(){if(!ie){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e(J())!=="undefined"){return true}if(e([J()])!=="[null]"){return true}var t={a:J()};t[J()]=true;if(e(t)!=="{}"){return true}return false}();var qn=a(function(){if(!ie){return true}return JSON.stringify(Object(J()))==="{}"&&JSON.stringify([Object(J())])==="[{}]"});if(zn||!qn){var Wn=JSON.stringify;oe(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=le.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(ne.symbol(n)){return Rt({})(n)}return n}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return Wn.apply(this,o)})}return S});
//# sourceMappingURL=es6-shim.map
/*! jQuery v3.6.3 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,y=n.hasOwnProperty,a=y.toString,l=a.call(Object),v={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},S=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||S).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.3",E=function(e,t){return new E.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}E.fn=E.prototype={jquery:f,constructor:E,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=E.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return E.each(this,e)},map:function(n){return this.pushStack(E.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(E.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(E.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},E.extend=E.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(E.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||E.isPlainObject(n)?n:{},i=!1,a[t]=E.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},E.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=y.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?E.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:v}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=t[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,S,y,s,c,v,E="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",$=new RegExp(M+"+","g"),B=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,S)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&v(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!y||!y.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ve(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=E)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{if(d.cssSupportsSelector&&!CSS.supports("selector(:is("+c+"))"))throw new Error;return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===E&&e.removeAttribute("id")}}}return g(t.replace(B,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[E]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ye(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ve(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,S=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.cssSupportsSelector=ce(function(){return CSS.supports("selector(*)")&&C.querySelectorAll(":is(:jqfake)")&&!CSS.supports("selector(:is(*,:jqfake))")}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=E,!C.getElementsByName||!C.getElementsByName(E).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&S){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&S){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&S)return t.getElementsByClassName(e)},s=[],y=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+E+"'></a><select id='"+E+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+E+"-]").length||y.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||y.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+E+"+*").length||y.push(".#.+[+~]"),e.querySelectorAll("\\\f"),y.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&y.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),d.cssSupportsSelector||y.push(":has"),y=y.length&&new RegExp(y.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),v=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType&&e.documentElement||e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&v(p,e)?-1:t==C||t.ownerDocument==p&&v(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&S&&!N[t+" "]&&(!s||!s.test(t))&&(!y||!y.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),v(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!S):void 0;return void 0!==r?r:d.attributes||!S?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace($," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,y){var v="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===y?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=v!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(v){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[E]||(a[E]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[E]||(a[E]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[E]||(a[E]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=y)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[E]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace(B,"$1"));return s[E]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=S?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ye(function(){return[0]}),last:ye(function(e,t){return[t-1]}),eq:ye(function(e,t,n){return[n<0?n+t:n]}),even:ye(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ye(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ye(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ye(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[E]||(e[E]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,y,v,e){return y&&!y[E]&&(y=Ce(y)),v&&!v[E]&&(v=Ce(v,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?v||(e?d:l||y)?[]:t:f;if(g&&g(f,p,n,r),y){i=Te(p,u),y(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(v||d){if(v){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);v(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=v?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),v?v(null,t,p,r):H.apply(t,p)})}function Se(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[E]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(B,"$1"),t,s<n&&Se(e.slice(s,n)),n<r&&Se(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(B," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,y,v,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Se(t[n]))[E]?i.push(a):o.push(a);(a=A(e,(y=o,m=0<(v=i).length,x=0<y.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!S);while(s=y[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=v[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+v.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&S&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ve(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!S,n,!t||ee.test(e)&&ve(t.parentNode)||t),n},d.sortStable=E.split("").sort(j).join("")===E,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);E.find=d,E.expr=d.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=d.uniqueSort,E.text=d.getText,E.isXMLDoc=d.isXML,E.contains=d.contains,E.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&E(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=E.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?E.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?E.grep(e,function(e){return e===n!==r}):"string"!=typeof n?E.grep(e,function(e){return-1<i.call(n,e)!==r}):E.filter(n,e,r)}E.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?E.find.matchesSelector(r,e)?[r]:[]:E.find.matches(e,E.grep(t,function(e){return 1===e.nodeType}))},E.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(E(e).filter(function(){for(t=0;t<r;t++)if(E.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)E.find(e,i[t],n);return 1<r?E.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?E(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof E?t[0]:t,E.merge(this,E.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:S,!0)),N.test(r[1])&&E.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=S.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(E):E.makeArray(e,this)}).prototype=E.fn,D=E(S);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}E.fn.extend({has:function(e){var t=E(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(E.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&E(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&E.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?E.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(E(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),E.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),E.merge([],e.childNodes))}},function(r,i){E.fn[r]=function(e,t){var n=E.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=E.filter(t,n)),1<this.length&&(H[r]||E.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}E.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},E.each(e.match(P)||[],function(e,t){n[t]=!0}),n):E.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){E.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return E.each(arguments,function(e,t){var n;while(-1<(n=E.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<E.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},E.extend({Deferred:function(e){var o=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return E.Deferred(function(r){E.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(E.Deferred.getStackHook&&(t.stackTrace=E.Deferred.getStackHook()),C.setTimeout(t))}}return E.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?E.extend(e,a):a}},s={};return E.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=E.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},E.readyException=function(e){C.setTimeout(function(){throw e})};var F=E.Deferred();function $(){S.removeEventListener("DOMContentLoaded",$),C.removeEventListener("load",$),E.ready()}E.fn.ready=function(e){return F.then(e)["catch"](function(e){E.readyException(e)}),this},E.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--E.readyWait:E.isReady)||(E.isReady=!0)!==e&&0<--E.readyWait||F.resolveWith(S,[E])}}),E.ready.then=F.then,"complete"===S.readyState||"loading"!==S.readyState&&!S.documentElement.doScroll?C.setTimeout(E.ready):(S.addEventListener("DOMContentLoaded",$),C.addEventListener("load",$));var B=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)B(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(E(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=E.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||E.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!E.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}E.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),E.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):B(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),E.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,E.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=E.queue(e,t),r=n.length,i=n.shift(),o=E._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){E.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:E.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),E.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?E.queue(this[0],t):void 0===n?this:this.each(function(){var e=E.queue(this,t,n);E._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&E.dequeue(this,t)})},dequeue:function(e){return this.each(function(){E.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=E.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=S.documentElement,ie=function(e){return E.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return E.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===E.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return E.css(e,t,"")},u=s(),l=n&&n[3]||(E.cssNumber[t]?"":"px"),c=e.nodeType&&(E.cssNumber[t]||"px"!==l&&+u)&&te.exec(E.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)E.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,E.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=E.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}E.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?E(this).show():E(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=S.createDocumentFragment().appendChild(S.createElement("div")),(fe=S.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),v.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",v.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ye(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?E.merge([e],n):n}function ve(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,v.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))E.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+E.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;E.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<E.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ye(f.appendChild(o),"script"),l&&ve(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return S.activeElement}catch(e){}}()==("focus"===t)}function Se(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Se(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return E().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=E.guid++)),e.each(function(){E.event.add(this,t,i,r,n)})}function Ee(e,i,o){o?(Y.set(e,i,!1),E.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(E.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:E.event.trigger(E.extend(r[0],E.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&E.event.add(e,i,we)}E.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&E.find.matchesSelector(re,i),n.guid||(n.guid=E.guid++),(u=y.events)||(u=y.events=Object.create(null)),(a=y.handle)||(a=y.handle=function(e){return"undefined"!=typeof E&&E.event.triggered!==e.type?E.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=E.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=E.event.special[d]||{},c=E.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&E.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),E.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=Y.hasData(e)&&Y.get(e);if(y&&(u=y.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=E.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,y.handle)||E.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)E.event.remove(e,d+t[l],n,r,!0);E.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=E.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=E.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=E.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((E.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<E(i,this).index(l):E.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(E.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[E.expando]?e:new E.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Ee(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Ee(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},E.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},E.Event=function(e,t){if(!(this instanceof E.Event))return new E.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&E.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},function(t,e){E.event.special[t]={setup:function(){return Ee(this,t,Ce),!1},trigger:function(){return Ee(this,t),!0},_default:function(e){return Y.get(e.target,t)},delegateType:e}}),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){E.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||E.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),E.fn.extend({on:function(e,t,n,r){return Se(this,e,t,n,r)},one:function(e,t,n,r){return Se(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,E(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each(function(){E.event.remove(this,e,n,t)})}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&E(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)E.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=E.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!v.checkClone&&Ae.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=E.map(ye(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=E.clone(u,!0,!0),s&&E.merge(a,ye(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,E.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&E.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?E._evalUrl&&!u.noModule&&E._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?E.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||E.cleanData(ye(r)),r.parentNode&&(n&&ie(r)&&ve(ye(r,"script")),r.parentNode.removeChild(r));return e}E.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(v.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||E.isXMLDoc(e)))for(a=ye(c),r=0,i=(o=ye(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ye(e),a=a||ye(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ye(c,"script")).length&&ve(a,!f&&ye(e,"script")),c},cleanData:function(e){for(var t,n,r,i=E.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?E.event.remove(n,r):E.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),E.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return B(this,function(e){return void 0===e?E.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return He(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)})},prepend:function(){return He(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(E.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return E.clone(this,e,t)})},html:function(e){return B(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=E.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(E.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,function(e){var t=this.parentNode;E.inArray(this,n)<0&&(E.cleanData(ye(this)),t&&t.replaceChild(e,this))},n)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){E.fn[e]=function(e){for(var t,n=[],r=E(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),E(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=/^--/,Me=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Ie=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},We=new RegExp(ne.join("|"),"i"),Fe="[\\x20\\t\\r\\n\\f]",$e=new RegExp("^"+Fe+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Fe+"+$","g");function Be(e,t,n){var r,i,o,a,s=Re.test(t),u=e.style;return(n=n||Me(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace($e,"$1")||void 0),""!==a||ie(e)||(a=E.style(e,t)),!v.pixelBoxStyles()&&Pe.test(a)&&We.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o)),void 0!==a?a+"":a}function _e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=S.createElement("div"),l=S.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===l.style.backgroundClip,E.extend(v,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=S.createElement("table"),t=S.createElement("tr"),n=S.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var ze=["Webkit","Moz","ms"],Ue=S.createElement("div").style,Xe={};function Ve(e){var t=E.cssProps[e]||Xe[e];return t||(e in Ue?e:Xe[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=ze.length;while(n--)if((e=ze[n]+t)in Ue)return e}(e)||e)}var Ge=/^(none|table(?!-c[ea]).+)/,Ye={position:"absolute",visibility:"hidden",display:"block"},Qe={letterSpacing:"0",fontWeight:"400"};function Je(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ke(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=E.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=E.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=E.css(e,"border"+ne[a]+"Width",!0,i))):(u+=E.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=E.css(e,"border"+ne[a]+"Width",!0,i):s+=E.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Ze(e,t,n){var r=Me(e),i=(!v.boxSizingReliable()||n)&&"border-box"===E.css(e,"boxSizing",!1,r),o=i,a=Be(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!v.boxSizingReliable()&&i||!v.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===E.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===E.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Ke(e,t,n||(i?"border":"content"),o,r,a)+"px"}function et(e,t,n,r,i){return new et.prototype.init(e,t,n,r,i)}E.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Be(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Re.test(t),l=e.style;if(u||(t=Ve(s)),a=E.cssHooks[t]||E.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(E.cssNumber[s]?"":"px")),v.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Re.test(t)||(t=Ve(s)),(a=E.cssHooks[t]||E.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Be(e,t,r)),"normal"===i&&t in Qe&&(i=Qe[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),E.each(["height","width"],function(e,u){E.cssHooks[u]={get:function(e,t,n){if(t)return!Ge.test(E.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Ze(e,u,n):Ie(e,Ye,function(){return Ze(e,u,n)})},set:function(e,t,n){var r,i=Me(e),o=!v.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===E.css(e,"boxSizing",!1,i),s=n?Ke(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Ke(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=E.css(e,u)),Je(0,t,s)}}}),E.cssHooks.marginLeft=_e(v.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Be(e,"marginLeft"))||e.getBoundingClientRect().left-Ie(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),E.each({margin:"",padding:"",border:"Width"},function(i,o){E.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(E.cssHooks[i+o].set=Je)}),E.fn.extend({css:function(e,t){return B(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Me(e),i=t.length;a<i;a++)o[t[a]]=E.css(e,t[a],!1,r);return o}return void 0!==n?E.style(e,t,n):E.css(e,t)},e,t,1<arguments.length)}}),((E.Tween=et).prototype={constructor:et,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||E.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(E.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=E.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}}).init.prototype=et.prototype,(et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=E.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){E.fx.step[e.prop]?E.fx.step[e.prop](e):1!==e.elem.nodeType||!E.cssHooks[e.prop]&&null==e.elem.style[Ve(e.prop)]?e.elem[e.prop]=e.now:E.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},E.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},E.fx=et.prototype.init,E.fx.step={};var tt,nt,rt,it,ot=/^(?:toggle|show|hide)$/,at=/queueHooks$/;function st(){nt&&(!1===S.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(st):C.setTimeout(st,E.fx.interval),E.fx.tick())}function ut(){return C.setTimeout(function(){tt=void 0}),tt=Date.now()}function lt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ct(e,t,n){for(var r,i=(ft.tweeners[t]||[]).concat(ft.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ft(o,e,t){var n,a,r=0,i=ft.prefilters.length,s=E.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=tt||ut(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:E.extend({},e),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},t),originalProperties:e,originalOptions:t,startTime:tt||ut(),duration:t.duration,tweens:[],createTween:function(e,t){var n=E.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=E.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=ft.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(E._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return E.map(c,ct,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),E.fx.timer(E.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}E.Animation=E.extend(ft,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],ft.tweeners[n]=ft.tweeners[n]||[],ft.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),y=Y.get(e,"fxshow");for(r in n.queue||(null==(a=E._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,E.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ot.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!y||void 0===y[r])continue;g=!0}d[r]=y&&y[r]||E.style(e,r)}if((u=!E.isEmptyObject(t))||!E.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=y&&y.display)&&(l=Y.get(e,"display")),"none"===(c=E.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=E.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===E.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(y?"hidden"in y&&(g=y.hidden):y=Y.access(e,"fxshow",{display:l}),o&&(y.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)E.style(e,r,d[r])})),u=ct(g?y[r]:0,r,p),r in y||(y[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?ft.prefilters.unshift(e):ft.prefilters.push(e)}}),E.speed=function(e,t,n){var r=e&&"object"==typeof e?E.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return E.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in E.fx.speeds?r.duration=E.fx.speeds[r.duration]:r.duration=E.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&E.dequeue(this,r.queue)},r},E.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=E.isEmptyObject(t),o=E.speed(e,n,r),a=function(){var e=ft(this,E.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=E.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&at.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||E.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=E.timers,o=n?n.length:0;for(t.finish=!0,E.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),E.each(["toggle","show","hide"],function(e,r){var i=E.fn[r];E.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(lt(r,!0),e,t,n)}}),E.each({slideDown:lt("show"),slideUp:lt("hide"),slideToggle:lt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){E.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),E.timers=[],E.fx.tick=function(){var e,t=0,n=E.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||E.fx.stop(),tt=void 0},E.fx.timer=function(e){E.timers.push(e),E.fx.start()},E.fx.interval=13,E.fx.start=function(){nt||(nt=!0,st())},E.fx.stop=function(){nt=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(r,e){return r=E.fx&&E.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},rt=S.createElement("input"),it=S.createElement("select").appendChild(S.createElement("option")),rt.type="checkbox",v.checkOn=""!==rt.value,v.optSelected=it.selected,(rt=S.createElement("input")).value="t",rt.type="radio",v.radioValue="t"===rt.value;var pt,dt=E.expr.attrHandle;E.fn.extend({attr:function(e,t){return B(this,E.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){E.removeAttr(this,e)})}}),E.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?E.prop(e,t,n):(1===o&&E.isXMLDoc(e)||(i=E.attrHooks[t.toLowerCase()]||(E.expr.match.bool.test(t)?pt:void 0)),void 0!==n?null===n?void E.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=E.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!v.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),pt={set:function(e,t,n){return!1===t?E.removeAttr(e,n):e.setAttribute(n,n),n}},E.each(E.expr.match.bool.source.match(/\w+/g),function(e,t){var a=dt[t]||E.find.attr;dt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=dt[o],dt[o]=r,r=null!=a(e,t,n)?o:null,dt[o]=i),r}});var ht=/^(?:input|select|textarea|button)$/i,gt=/^(?:a|area)$/i;function yt(e){return(e.match(P)||[]).join(" ")}function vt(e){return e.getAttribute&&e.getAttribute("class")||""}function mt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}E.fn.extend({prop:function(e,t){return B(this,E.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[E.propFix[e]||e]})}}),E.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&E.isXMLDoc(e)||(t=E.propFix[t]||t,i=E.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=E.find.attr(e,"tabindex");return t?parseInt(t,10):ht.test(e.nodeName)||gt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),v.optSelected||(E.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){E.propFix[this.toLowerCase()]=this}),E.fn.extend({addClass:function(t){var e,n,r,i,o,a;return m(t)?this.each(function(e){E(this).addClass(t.call(this,e,vt(this)))}):(e=mt(t)).length?this.each(function(){if(r=vt(this),n=1===this.nodeType&&" "+yt(r)+" "){for(o=0;o<e.length;o++)i=e[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=yt(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(t){var e,n,r,i,o,a;return m(t)?this.each(function(e){E(this).removeClass(t.call(this,e,vt(this)))}):arguments.length?(e=mt(t)).length?this.each(function(){if(r=vt(this),n=1===this.nodeType&&" "+yt(r)+" "){for(o=0;o<e.length;o++){i=e[o];while(-1<n.indexOf(" "+i+" "))n=n.replace(" "+i+" "," ")}a=yt(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(t,n){var e,r,i,o,a=typeof t,s="string"===a||Array.isArray(t);return m(t)?this.each(function(e){E(this).toggleClass(t.call(this,e,vt(this),n),n)}):"boolean"==typeof n&&s?n?this.addClass(t):this.removeClass(t):(e=mt(t),this.each(function(){if(s)for(o=E(this),i=0;i<e.length;i++)r=e[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!==a||((r=vt(this))&&Y.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===t?"":Y.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+yt(vt(n))+" ").indexOf(t))return!0;return!1}});var xt=/\r/g;E.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,E(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=E.map(t,function(e){return null==e?"":e+""})),(r=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=E.valHooks[t.type]||E.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(xt,""):null==e?"":e:void 0}}),E.extend({valHooks:{option:{get:function(e){var t=E.find.attr(e,"value");return null!=t?t:yt(E.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=E(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=E.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<E.inArray(E.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),E.each(["radio","checkbox"],function(){E.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<E.inArray(E(e).val(),t)}},v.checkOn||(E.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),v.focusin="onfocusin"in C;var bt=/^(?:focusinfocus|focusoutblur)$/,wt=function(e){e.stopPropagation()};E.extend(E.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||S],d=y.call(e,"type")?e.type:e,h=y.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||S,3!==n.nodeType&&8!==n.nodeType&&!bt.test(d+E.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[E.expando]?e:new E.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:E.makeArray(t,[e]),c=E.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,bt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||S)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),E.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,wt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,wt),E.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=E.extend(new E.Event,n,{type:e,isSimulated:!0});E.event.trigger(r,null,t)}}),E.fn.extend({trigger:function(e,t){return this.each(function(){E.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return E.event.trigger(e,t,n,!0)}}),v.focusin||E.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){E.event.simulate(r,e.target,E.event.fix(e))};E.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var Tt=C.location,Ct={guid:Date.now()},St=/\?/;E.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||E.error("Invalid XML: "+(n?E.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Et=/\[\]$/,kt=/\r?\n/g,At=/^(?:submit|button|image|reset|file)$/i,Nt=/^(?:input|select|textarea|keygen)/i;function jt(n,e,r,i){var t;if(Array.isArray(e))E.each(e,function(e,t){r||Et.test(n)?i(n,t):jt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)jt(n+"["+t+"]",e[t],r,i)}E.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!E.isPlainObject(e))E.each(e,function(){i(this.name,this.value)});else for(n in e)jt(n,e[n],t,i);return r.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=E.prop(this,"elements");return e?E.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!E(this).is(":disabled")&&Nt.test(this.nodeName)&&!At.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=E(this).val();return null==n?null:Array.isArray(n)?E.map(n,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:n.replace(kt,"\r\n")}}).get()}});var Dt=/%20/g,qt=/#.*$/,Lt=/([?&])_=[^&]*/,Ht=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:GET|HEAD)$/,Pt=/^\/\//,Rt={},Mt={},It="*/".concat("*"),Wt=S.createElement("a");function Ft(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function $t(t,i,o,a){var s={},u=t===Mt;function l(e){var r;return s[e]=!0,E.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Bt(e,t){var n,r,i=E.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&E.extend(!0,e,r),e}Wt.href=Tt.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Tt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":It,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Bt(Bt(e,E.ajaxSettings),t):Bt(E.ajaxSettings,e)},ajaxPrefilter:Ft(Rt),ajaxTransport:Ft(Mt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,y=E.ajaxSetup({},t),v=y.context||y,m=y.context&&(v.nodeType||v.jquery)?E(v):E.event,x=E.Deferred(),b=E.Callbacks("once memory"),w=y.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Ht.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(y.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),y.url=((e||y.url||Tt.href)+"").replace(Pt,Tt.protocol+"//"),y.type=t.method||t.type||y.method||y.type,y.dataTypes=(y.dataType||"*").toLowerCase().match(P)||[""],null==y.crossDomain){r=S.createElement("a");try{r.href=y.url,r.href=r.href,y.crossDomain=Wt.protocol+"//"+Wt.host!=r.protocol+"//"+r.host}catch(e){y.crossDomain=!0}}if(y.data&&y.processData&&"string"!=typeof y.data&&(y.data=E.param(y.data,y.traditional)),$t(Rt,y,t,T),h)return T;for(i in(g=E.event&&y.global)&&0==E.active++&&E.event.trigger("ajaxStart"),y.type=y.type.toUpperCase(),y.hasContent=!Ot.test(y.type),f=y.url.replace(qt,""),y.hasContent?y.data&&y.processData&&0===(y.contentType||"").indexOf("application/x-www-form-urlencoded")&&(y.data=y.data.replace(Dt,"+")):(o=y.url.slice(f.length),y.data&&(y.processData||"string"==typeof y.data)&&(f+=(St.test(f)?"&":"?")+y.data,delete y.data),!1===y.cache&&(f=f.replace(Lt,"$1"),o=(St.test(f)?"&":"?")+"_="+Ct.guid+++o),y.url=f+o),y.ifModified&&(E.lastModified[f]&&T.setRequestHeader("If-Modified-Since",E.lastModified[f]),E.etag[f]&&T.setRequestHeader("If-None-Match",E.etag[f])),(y.data&&y.hasContent&&!1!==y.contentType||t.contentType)&&T.setRequestHeader("Content-Type",y.contentType),T.setRequestHeader("Accept",y.dataTypes[0]&&y.accepts[y.dataTypes[0]]?y.accepts[y.dataTypes[0]]+("*"!==y.dataTypes[0]?", "+It+"; q=0.01":""):y.accepts["*"]),y.headers)T.setRequestHeader(i,y.headers[i]);if(y.beforeSend&&(!1===y.beforeSend.call(v,T,y)||h))return T.abort();if(u="abort",b.add(y.complete),T.done(y.success),T.fail(y.error),c=$t(Mt,y,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,y]),h)return T;y.async&&0<y.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},y.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(y,T,n)),!i&&-1<E.inArray("script",y.dataTypes)&&E.inArray("json",y.dataTypes)<0&&(y.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(y,s,T,i),i?(y.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(E.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(E.etag[f]=u)),204===e||"HEAD"===y.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(v,[o,l,T]):x.rejectWith(v,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,y,i?o:a]),b.fireWith(v,[T,l]),g&&(m.trigger("ajaxComplete",[T,y]),--E.active||E.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return E.get(e,t,n,"json")},getScript:function(e,t){return E.get(e,void 0,t,"script")}}),E.each(["get","post"],function(e,i){E[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),E.ajax(E.extend({url:e,type:i,dataType:r,data:t,success:n},E.isPlainObject(e)&&e))}}),E.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),E._evalUrl=function(e,t,n){return E.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){E.globalEval(e,t,n)}})},E.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=E(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){E(this).wrapInner(n.call(this,e))}):this.each(function(){var e=E(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){E(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){E(this).replaceWith(this.childNodes)}),this}}),E.expr.pseudos.hidden=function(e){return!E.expr.pseudos.visible(e)},E.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var _t={0:200,1223:204},zt=E.ajaxSettings.xhr();v.cors=!!zt&&"withCredentials"in zt,v.ajax=zt=!!zt,E.ajaxTransport(function(i){var o,a;if(v.cors||zt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(_t[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),E.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return E.globalEval(e),e}}}),E.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),E.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=E("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),S.head.appendChild(r[0])},abort:function(){i&&i()}}});var Ut,Xt=[],Vt=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xt.pop()||E.expando+"_"+Ct.guid++;return this[e]=!0,e}}),E.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Vt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Vt,"$1"+r):!1!==e.jsonp&&(e.url+=(St.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||E.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?E(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Xt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),v.createHTMLDocument=((Ut=S.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ut.childNodes.length),E.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(v.createHTMLDocument?((r=(t=S.implementation.createHTMLDocument("")).createElement("base")).href=S.location.href,t.head.appendChild(r)):t=S),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&E(o).remove(),E.merge([],i.childNodes)));var r,i,o},E.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=yt(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&E.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?E("<div>").append(E.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},E.expr.pseudos.animated=function(t){return E.grep(E.timers,function(e){return t===e.elem}).length},E.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=E.css(e,"position"),c=E(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=E.css(e,"top"),u=E.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,E.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},E.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){E.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===E.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===E.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=E(e).offset()).top+=E.css(e,"borderTopWidth",!0),i.left+=E.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-E.css(r,"marginTop",!0),left:t.left-i.left-E.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===E.css(e,"position"))e=e.offsetParent;return e||re})}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;E.fn[t]=function(e){return B(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),E.each(["top","left"],function(e,n){E.cssHooks[n]=_e(v.pixelPosition,function(e,t){if(t)return t=Be(e,n),Pe.test(t)?E(e).position()[n]+"px":t})}),E.each({Height:"height",Width:"width"},function(a,s){E.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){E.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return B(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?E.css(e,t,i):E.style(e,t,n,i)},s,n?e:void 0,n)}})}),E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){E.fn[t]=function(e){return this.on(t,e)}}),E.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){E.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Gt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;E.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||E.guid++,i},E.holdReady=function(e){e?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=A,E.isFunction=m,E.isWindow=x,E.camelCase=X,E.type=w,E.now=Date.now,E.isNumeric=function(e){var t=E.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},E.trim=function(e){return null==e?"":(e+"").replace(Gt,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return E});var Yt=C.jQuery,Qt=C.$;return E.noConflict=function(e){return C.$===E&&(C.$=Qt),e&&C.jQuery===E&&(C.jQuery=Yt),E},"undefined"==typeof e&&(C.jQuery=C.$=E),E});
"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var n,r,a,o,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return r=!(n=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){r=!0,a=e},f:function(){try{n||null==i.return||i.return()}finally{if(r)throw a}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),o=0,{s:t=function(){},n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}define("engine",["jquery","utils","state","section","passages"],function(E,N,j,P,R){var t,I=N.impossible,V=N.passageSelector,M=N.transitionOut,D=N.options;function F(e,t,n){var r,a,o;if(n?(n=n.get("name"),(a=R.getTree(n)).children.length&&(r={type:"include",tag:t,name:n,children:a.children,text:a.text})):r=R.getTree(t),r){for(;(o=e[e.length-1])&&("root"===o.type||"include"===o.type)&&o.children.some(function(e){return e.type.startsWith("unclosed")});)e[e.length-1]=Object.create(o),e=e[e.length-1].children=o.children.slice();e.push(r)}}function n(e){var t,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=r.loadedGame,o=R.get(e),i=N.storyElement,s=i.parent(),c=r.stretch,r=r.transition,r=void 0===r?{}:r,l=r.depart,l=void 0===l?"instant":l,u=r.arrive,u=void 0===u?"dissolve":u,p=r.departOrigin,d=r.arriveOrigin,r=r.time,f=(s.findAndFilter("tw-enchantment").each(function(e,t){var n=(t=E(t)).data("enchantedProperties");n&&i.css(n.reduce(function(e,t){return e[t]="",e},{})),t[0]===s[0]&&(s=i.unwrap().parent())}),R.hasValid(e)||I("Engine.showPassage","There's no passage with the name \""+e+'"!'),i.children(V).not(".transition-out, .transition-out *")),o=(o.get("tags")||[]).join(" "),h=(t=E("<tw-passage><tw-sidebar>"),h=t.children("tw-sidebar"),m=E('<tw-icon tabindex=0 alt="Undo" title="Undo">&#8630;</tw-icon>'),n=E('<tw-icon tabindex=0 alt="Redo" title="Redo">&#8631;</tw-icon>'),j.pastLength<=0&&m.css("visibility","hidden"),j.futureLength<=0&&n.css("visibility","hidden"),h.append(m,n),t),m=("function"==typeof p&&(p=p.call(f)),"function"==typeof d&&(d=d.call(h)),N.detachStoryElement(),h.appendTo(i).attr({tags:o}),!c&&l&&(M(f,l,r,0,0,0,p),f.css("position","absolute")),i.attr({tags:o}),P.create(h)),g=(a&&(m.loadedGame=!0),[]);if(j.pastLength<=0&&1===j.turns){var y,b=_createForOfIteratorHelper(R.getTagged("startup"));try{for(b.s();!(y=b.n()).done;)F(g,"startup",y.value)}catch(e){b.e(e)}finally{b.f()}if(D.debug){var v,w=_createForOfIteratorHelper(R.getTagged("debug-startup"));try{for(w.s();!(v=w.n()).done;)F(g,"debug-startup",v.value)}catch(e){w.e(e)}finally{w.f()}}}var k,S=_createForOfIteratorHelper(R.getTagged("header"));try{for(S.s();!(k=S.n()).done;)F(g,"header",k.value)}catch(e){S.e(e)}finally{S.f()}if(D.debug){var T,_=_createForOfIteratorHelper(R.getTagged("debug-header"));try{for(_.s();!(T=_.n()).done;)F(g,"debug-header",T.value)}catch(e){_.e(e)}finally{_.f()}}F(g,e);var x,O=_createForOfIteratorHelper(R.getTagged("footer"));try{for(O.s();!(x=O.n()).done;)F(g,"footer",x.value)}catch(e){O.e(e)}finally{O.f()}if(D.debug){var A,C=_createForOfIteratorHelper(R.getTagged("debug-footer"));try{for(C.s();!(A=C.n()).done;)F(g,"debug-footer",A.value)}catch(e){C.e(e)}finally{C.f()}}m.renderInto(g,h,{transition:u,transitionTime:r,transitionOrigin:d}),m.loadedGame=!1,N.reattachStoryElement(),scroll(0,c?h.offset().top-.05*E(window).height():i[0].getBoundingClientRect().top+document.body.scrollTop)}return Object.freeze({goBack:function(e){j.rewind()&&n(j.passage,e)},goForward:function(e){j.fastForward()&&n(j.passage,e)},goToPassage:function(e,t){j.play(e),n(e,t)},redirect:function(e,t){j.redirect(e),n(e,t)},toggleFullscreen:function(){var e=document.documentElement;document.fullscreenElement?document.exitFullscreen():document.msFullscreenElement?document.msExitFullscreen():(e.msRequestFullscreen||e.requestFullscreen).call(e)},showPassage:n,enableDebugMode:function(){t&&t()},registerDebugMode:function(e){t=t||e}})}),define("harlowe",["jquery","debugmode/mode","renderer","state","section","engine","passages","utils","utils/renderutils","internaltypes/varscope","internaltypes/twineerror","macros","macrolib/values","macrolib/commands","macrolib/datastructures","macrolib/stylechangers","macrolib/enchantments","macrolib/metadata","macrolib/patterns","macrolib/links","macrolib/custommacros","utils/jqueryplugins","repl"],function($,DebugMode,Renderer,State,Section,Engine,Passages,Utils,_ref,VarScope){var dialog=_ref.dialog;function __HarloweEval(text){eval(text+"")}function printJSError(e){var t,n="".concat(e.name,": ").concat(e.message);return e.stack&&(t=(e=e.stack.split("\n")).findIndex(function(e){return e.includes("__HarloweEval")}),n+="\n".concat(e.slice(0,t).join("\n").replace(/\([^)]+\)/g,""))),"<div style='font-family:monospace;overflow-y:scroll;max-height:30vh'>```"+n+"```</div>"}!function(o){window.onerror=function(e,t,n,r,a){window.onerror=o,Utils.storyElement.parent().append(dialog({message:"Sorry to interrupt, but this page's code has got itself in a mess.\n\n".concat(printJSError(a),"\n(This is probably due to a bug in the Harlowe game engine.)")}).addClass("harlowe-crash")),"function"==typeof o&&o.apply(void 0,arguments)}}(window.onerror),Utils.onStartup(function(){var n,e,t,r,a=$("tw-storydata");0!==a.length&&(Utils.options.ifid=a.attr("ifid"),(a.attr("tags")||"").split(/\s/).forEach(function(e){"uncompressed-pure-values"!==e&&"uncompressed-saves"!==e||(Utils.options.uncompressedPureValues=!0),"uncompressed-structures"!==e&&"uncompressed-saves"!==e||(Utils.options.uncompressedStructures=!0)}),(a.attr("options")||"").split(/\s/).forEach(function(e){e&&(Utils.options[e]=!0),"debug"===e&&DebugMode()}),a=(a=a.attr("startnode"))||[].reduce.call($("tw-passagedata"),function(e,t){t=t.getAttribute("pid");return t<e?t:e},1/0),a=$("tw-passagedata[pid='"+a+"']").attr("name"),$(document.documentElement).on("keydown",function(e){13===e.which&&"0"===e.target.getAttribute("tabindex")&&$(e.target).trigger("click")}),n=!1,$("[role=script]").each(function(t){try{__HarloweEval($(this).html())}catch(e){n||(n=!0,dialog({parent:Utils.storyElement.parent(),message:"There is a problem with this story's "+Utils.nth(t+1)+" script:\n\n"+printJSError(e)}))}}),$("[role=stylesheet]").each(function(e,t){$(document.head).append("<style data-title=\"Story stylesheet '".concat(e+1,"'\">").concat($(t).html()))}),(e=Section.create()).stack=[{tempVariables:Object.create(VarScope)}],(r=Passages.loadMetadata(e)).length&&(t=dialog({parent:Utils.storyElement.parent(),message:"These errors occurred when running the `(metadata:)` macro calls in this story's passages:<p></p>"}),r.forEach(function(e){return t.find("p").append(e.render())})),(r=!Utils.options.debug&&State.hasSessionStorage&&sessionStorage.getItem("Saved Session"))&&!0===State.deserialise(e,r)?Engine.showPassage(State.passage):Engine.goToPassage(a))})}),define("macros",["utils/naturalsort","utils","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/lambda","datatypes/codehook","internaltypes/changedescriptor","internaltypes/twineerror"],function(g,e,t,o,r,y,b,p,v){var w=e.insensitiveName,k=e.nth,S=e.andList,T=t.objectName,_=t.typeName,d=t.toSource,x=Array.isArray,i={};function O(e){return e===s.TypeSignature.Any||(x(e.innerType)?e.innerType.some(O):!!e.innerType&&O(e.innerType))}function a(e,t,n,r){var a,o,i,s,c,l,u,p,d=t.fn,f=t.typeSignature,h=t.returnType,m=(r=function(e){for(var t,n,r,a=[],o=0;o<e.length;o+=1)o in e&&(!0===(null==(t=e[o])?void 0:t.spreader)?(n=t.value,(r=v.containsError(n))?a.push(r):x(n)||"string"==typeof n?a.push.apply(a,_toConsumableArray(n)):n instanceof Set?a.push.apply(a,_toConsumableArray(Array.from(n).sort(g("en")))):a.push(v.create("operation","I can't spread out "+T(n)+", because it is not a string, dataset, or array."))):a.push(t));return a}(r),"string"!=typeof e&&(a=e,e=""),a?"":"("+(x(e)&&1<e.length?e[0]:e)+":)");for(e=a?a.TwineScript_KnownName?"the custom macro, ".concat(a.TwineScript_KnownName):"an unnamed custom macro":"the ".concat(m," macro"),o=0<f.length?1===f.length&&O(f[0])?1===r.length?"That value can't be given to macros as-is.":"Give only a single value to this macro.":e+" must only be given "+S(f.map(_))+(1<f.length?", in that order":"."):e+" must not be given any data."+(a?"":" Just write "+m),s=0,c=Math.max(r.length,f.length);s<c;s+=1){if(p=f[s],l=r[s],v.containsError(l))return l;if(s>=f.length&&!i)return v.create("datatype",r.length-f.length+" too many values were given to "+e+".",o);if(!(p=p||i).innerType||"rest"!==p.pattern&&"zero or more"!==p.pattern||(i=p.innerType,"rest"===p.pattern&&(p=p.innerType)),!function e(t,n){if(null===n)return void 0===t;var r=_typeof(t);if("function"!=typeof n&&n.pattern){if("optional"===n.pattern||"zero or more"===n.pattern)return void 0===t||e(t,n.innerType);if("either"===n.pattern){for(var a=0;a<n.innerType.length;a+=1)if(e(t,n.innerType[a]))return!0;return!1}if("lambda"===n.pattern&&e(t,n.innerType))return n.clauses.includes("where")===("where"in t||"each"in t)&&n.clauses.includes("making")==="making"in t&&n.clauses.includes("via")==="via"in t&&n.clauses.includes("with")==="with"in t;if("insensitive set"===n.pattern)return n.innerType.includes(w(t));if("range"===n.pattern)return n.range(t);if("wrapped"===n.pattern)return e(t,n.innerType)}return(void 0===n||void 0!==t)&&("anything"===n.TwineScript_TypeName&&void 0!==t&&!t.TwineScript_Unstorable||"everything"===n.TwineScript_TypeName&&void 0!==t||(n===String?"string"===r:n===Boolean?"boolean"===r:n===parseInt?"number"===r&&!Number.isNaN(t)&&!(t+"").includes("."):n===Number?"number"===r&&!Number.isNaN(t):n===Array?x(t):n===Map||n===Set?t instanceof n:Object.isPrototypeOf.call(n,t)))}(l,p))return void 0===l?(u=f.filter(function(e){return!("optional"===e.pattern||"zero or more"===e.pattern)}).length,v.create("datatype","".concat(e," was given ").concat(r.length?S(r.map(T)):"nothing",", but needs ").concat(u-s," more value").concat(1<u-s?"s":"","."),o)):null!=(u=l)&&u.TwineScript_Unstorable&&O(p)?v.create("datatype",e+"'s "+k(s+1)+" value, "+T(l)+", is not valid data for this macro.",o):b.isPrototypeOf(l)&&"Changer"===h?v.create("syntax","Please put this hook outside the parentheses of "+e+", not inside it.","Hooks should appear after a macro"+(a?".":": "+m+"[Some text]")):l&&y.isPrototypeOf(l)&&"lambda"===p.pattern?v.create("datatype",e+"'s "+k(s+1)+" value (a lambda) should have "+S(["where","when","making","via","with"].filter(function(e){return p.clauses.includes(e)}).map(function(e){return"a '"+e+"' clause"}))+", not "+S(["where","when","making","via","with"].filter(function(e){return e in l}).map(function(e){return"a '"+e+"' clause"}))+"."):"insensitive set"===p.pattern?v.create("datatype",T(l)+" is not a valid name string for "+e+".","Only the following names are recognised (capitalisation and hyphens ignored): "+S(p.innerType)+"."):v.create("datatype","".concat(e,"'s ").concat(k(s+1)," value is ").concat(T(l),", but should be ").concat(_(p),"."),p.message||o)}return d.apply(null,[n].concat(r))}function f(e,t,n,r){var a={fn:n,typeSignature:r=[].concat(r||[]),returnType:t};Object.freeze(a),[].concat(e).forEach(function(e){return Object.defineProperty(i,w(e),{value:a})})}var s={has:function(e){return e=w(e),hasOwnProperty.call(i,e)},get:function(e){return e=w(e),hasOwnProperty.call(i,e)&&i[e]},add:function e(t,n,r,a){return f(t,n,r,a),e},addChanger:function e(t,n,r,a){return f(t,"Changer",n,a),o.register(x(t)?t[0]:t,r),e},addCommand:function e(t,n,r,a){var s,c,l,u,o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],i=[].concat(t)[0];return f(t,"Command",(s=i,c=n,l=r,u=o,function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,i=c.apply(void 0,n);return i||(a=p.create(),o=_objectSpread({TwineScript_TypeID:"command",TwineScript_ObjectName:"a (".concat(s,":) command"),TwineScript_TypeName:"a (".concat(s,":) command"),TwineScript_Print:function(){return"`[A (".concat(s,":) command]`")},TwineScript_ToSource:function(){return"(".concat(s,":").concat(n.map(d),")")},TwineScript_is:function(e){return d(this)===d(e)}},u?{TwineScript_Attach:function(e,t){return a.section=e,t.run(a),o},TwineScript_Run:function(e){e=l.apply(void 0,[a,e].concat(n));return a=p.create(),e}}:{TwineScript_Run:function(e){return l.apply(void 0,[e].concat(n))}}))}),a),e},TypeSignature:{optional:function(e){return{pattern:"optional",innerType:e}},zeroOrMore:function(e){return{pattern:"zero or more",innerType:e}},either:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"either",innerType:t}},rest:function(e){return{pattern:"rest",innerType:e}},insensitiveSet:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"insensitive set",innerType:t}},numberRange:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;return{pattern:"range",min:t,max:n,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&t<=e&&e<=n}}},nonNegativeInteger:{pattern:"range",integer:!0,min:0,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&0<=e&&!(e+"").includes(".")}},positiveInteger:{pattern:"range",integer:!0,min:1,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&1<=e&&!(e+"").includes(".")}},wrapped:function(e,t){return{pattern:"wrapped",innerType:e,message:t}},Any:{TwineScript_TypeName:"anything"},Everything:{TwineScript_TypeName:"everything"}},run:function(e,t,n){return s.has(e)?a(e,s.get(e),t,n):v.create("macrocall","I can't run the macro '"+e+"' because it doesn't exist.","Did you mean to run a macro? If you have a word written like (this:), it is regarded as a macro name.")},runCustom:function(e,t,n){return r.isPrototypeOf(e)?a(e,e,t,n):v.containsError(e)?e:v.create("macrocall","I can't call ".concat(T(e)," because it isn't a custom macro."))}};return Object.assign(s.TypeSignature,{positiveNumber:s.TypeSignature.numberRange(Math.pow(2,-52),1/0),nonNegativeNumber:s.TypeSignature.numberRange(0,1/0),percent:s.TypeSignature.numberRange(0,1)}),Object.freeze(s)}),define("passages",["jquery","utils/naturalsort","utils","markup","internaltypes/twineerror"],function(t,s,e,c,l){var u=e.insensitiveName,p=e.unescape,n=e.onStartup,o=e.impossible,d=Object.assign,f=RegExp(c.Patterns.macroFront+c.Patterns.macroName,"ig");function r(e){var t,r,a,o,n=e.attr("name"),i=p(e.html()),s=(t=n,o=["metadata","storylet","exclusivity","urgency"],((s=i).match(f)||[]).some(function(t){return o.some(function(e){return u(t.slice(1,-1))===e})})?(r=!1,a={},c.lex(s,t).children.forEach(function e(t){if("macro"===t.type){var n=u(t.name);if(o.some(function(e){return n===e})){if(l.isPrototypeOf(a[n]))return;if(r)return void(a[n]=l.create("syntax","The (".concat(t.name,":) macro can't appear after non-metadata macros.")));if(a[n])return void(a[n]=l.create("syntax","There is more than one (".concat(t.name,":) macro.")));a[n]=t}else r=!0;t.children.forEach(function e(t){var n=u(t.name);"macro"===t.type&&o.some(function(e){return n===e})?a[n]=l.create("syntax","The (".concat(t.name,":) macro can't be inside another macro.")):t.children.forEach(e)})}else t.children.forEach(e)}),a):{});return d(new Map([["source",i],["tags",(e.attr("tags")||"").split(/\s/)||[]],["name",n]]),{TwineScript_TypeName:"a passage datamap",TwineScript_ObjectName:"a passage datamap",metadata:s,tree:null})}var a=Object.create(null),i=[],h=null,m=d(new Map,{TwineScript_ObjectName:"the Passages datamap",getTagged:function(n){var e,r;return a[n]||(e=s("en",function(e){return e.get("name")}),r=[],this.forEach(function(e){var t=e instanceof Map&&e.get("tags");Array.isArray(t)&&t.includes(n)&&r.push(e)}),r.sort(e),a[n]=r)},clearTagCache:function(){a=Object.create(null)},clear:function(){Map.prototype.clear.call(this),this.clearTagCache(),this.clearTreeCache(),this.clearStoryletCache()},delete:function(){var e;(e=Map.prototype.delete).call.apply(e,[this].concat(Array.prototype.slice.call(arguments))),this.clearTagCache(),this.clearTreeCache(),this.clearStoryletCache()},getTree:function(e){if(!this.has(e))return o("Passages.getTree","No passage name?"),[];var t=this.get(e),n=t.get("tags");if(n.includes("header")||n.includes("footer")||n.includes("debug-header")||n.includes("debug-footer"))return t.tree||(t.tree=c.lex(t.get("source"),e)),t.tree;for(var r,a=0;a<i.length;a+=1)if(i[a]&&i[a].place===e)return r=i.splice(a,1)[0],i.unshift(r),r;n=c.lex(t.get("source"),e);return i.unshift(n),16<i.length&&i.pop(),n},clearTreeCache:function(){i=[]},getStorylets:function(r,e){var a,o,i,e=e?e.filter(r,_toConsumableArray(m.values())):_toConsumableArray(m.values());return l.containsError(e)?e:(a=[],o=-1/0,e.reduce(function(e,t){if(e)return e;e=t.get("storylet");if(e){var n=r.speculate(e,t.get("name"),"a (storylet:) macro");if(l.containsError(n))return n.message="There's an error in the storylet passage \""+t.get("name")+'":\n'+n.message,n.source=e.TwineScript_ToSource(),n;n&&(e=t.get("exclusivity"),o=Math.max(o,"number"==typeof e?e:0),a.push(t))}},void 0)||(i=s("en"),a.filter(function(e){e=e.get("exclusivity");return("number"==typeof e?e:0)===o}).sort(function(e,t){var n=e.get("urgency"),r=t.get("urgency");return(n="number"==typeof n?n:0)!==(r="number"==typeof r?r:0)?r-n:i(e.get("name"),t.get("name"))})))},allStorylets:function(){return h=h||_toConsumableArray(m.values()).filter(function(e){return e.get("storylet")})},clearStoryletCache:function(){h=null},loadMetadata:function(i){var s=[];return m.forEach(function(o){o.metadata&&Object.keys(o.metadata).forEach(function(e){var t,n,r;function a(e,t){o.has(e)?s.push(l.create("syntax","This passage's datamap already has a '"+JSON.stringify(e)+"' data name.")):o.set(e,t)}l.containsError(o.metadata[e])?s.push(o.metadata[e]):(t=o.metadata[e],n=i.speculate(t,o.get("name"),"a ("+e+":) macro"),r='In "'+o.get("name")+'":\n',l.containsError(n)?(n.message=r+n.message,n.source=t.text,s.push(n)):n instanceof Map?n.forEach(function(e,t){return a(t,e)}):a(e,n))}),o.metadata=void 0}),s},hasValid:function(e){e=this.get(e);return e&&e instanceof Map&&e.has("source")},create:r});return n(function(){t("tw-storydata > tw-passagedata").get().forEach(function(e){e=t(e),m.set(e.attr("name"),new r(e))})}),m}),define("renderer",["jquery","utils","markup","internaltypes/twineerror"],function(a,e,S,T){var _=e.escape,x=e.insensitiveName,O=e.options;function A(e,t,n){n=2<arguments.length&&void 0!==n?n:"";return"<"+t+(n?" "+n:"")+">"+e+"</"+t+">"}var C="text-align: center; max-width:50%; ";function E(m,g){function y(e,t,n){e=E(e.children,g);return e&&A(e,t,n)}var b="",v=[];if(m)for(var w=(m=Array.isArray(m)?m:[m]).length,k=0;k<w;k+=1){var e=function(e){var n=m[e];switch(n.type){case"include":b+=y(n,"tw-"+n.type,'type="'.concat(n.tag,'" name="').concat(n.name,'"'));break;case"error":b+=T.create("syntax",n.message,n.explanation).render(_(n.text))[0].outerHTML;break;case"numbered":case"bulleted":for(var t="numbered"===n.type?"ol":"ul",r=(b+="<"+t+">",1);e<w&&m[e];){if("br"===m[e].type){if(b+="</li>",!m[e+1]||m[e+1].type!==n.type)break}else m[e].type===n.type?(b=(b+=("<"+t+">").repeat(Math.max(0,m[e].depth-r)))+("</"+t+">").repeat(Math.max(0,r-m[e].depth))+"<li>",r=m[e].depth):b+=E([m[e]],g);e+=1}b+=("</"+t+">").repeat(r+1);break;case"align":for(;n&&"align"===n.type;){var a=n.align,o=e+=1;if("left"===a){--e;break}for(;e<w&&m[e]&&"align"!==m[e].type;)e+=1;var o=E(m.slice(o,e),g),i="";switch(a){case"center":i+=C+"margin-left: auto; margin-right: auto;";break;case"justify":case"right":i+="text-align: "+a+";";break;default:+a&&(i+=C+"margin-left: "+a+"%;")}b+="<tw-align "+(i?'style="'+i+'"':"")+">"+o+"</tw-align>\n",n=m[e]}break;case"column":for(var s,c=[];n&&"column"===n.type;){var l=n.column,u=e+=1;if("none"===l){--e;break}for(;e<w&&m[e]&&"column"!==m[e].type;)e+=1;c.push({text:n.text,type:l,body:E(m.slice(u,e),g),width:n.width,marginLeft:n.marginLeft,marginRight:n.marginRight}),n=m[e]}c.length&&(s=c.reduce(function(e,t){return e+t.width},0),b+="<tw-columns>"+c.map(function(e){return"<tw-column type=".concat(e.type," ",' style="width:').concat(e.width/s*100,"%; margin-left: ").concat(e.marginLeft,"em; margin-right: ").concat(e.marginRight,'em;">').concat(e.body,"</tw-column>\n")}).join("")+"</tw-columns>");break;case"heading":for(b+="<h"+n.depth+">";++e<w&&m[e];){if("br"===m[e].type){b+="</h"+n.depth+">";break}b+=E([m[e]],g)}break;case"br":if(!v.length||/td|th/.test(v[0])){b+="<br>";for(var p=m[e+1];p&&("br"===p.type||"tag"===p.type&&/^<br\b/i.test(p.text));)b+="<tw-consecutive-br"+("tag"===p.type?" data-raw":"")+"></tw-consecutive-br>",p=m[(e+=1)+1]}break;case"hr":b+="<hr>";break;case"escapedLine":case"comment":break;case"inlineUrl":b+='<a class="link" href="'+_(n.text)+'">'+n.text+"</a>";break;case"scriptStyleTag":case"tag":var d=n.text.toLowerCase();/^<\/?(?:table|thead|tbody|tr|tfoot|td|th|svg)\b/.test(d)&&!n.text.endsWith("/>")&&v[n.text.startsWith("</")?"shift":"unshift"](d),b+=n.text.startsWith("</")?n.text:n.text.replace(/(\/)?>$/,function(e,t){return" data-raw".concat(t?"></".concat(n.text.match(/[\w-]+/)):"",">")});break;case"sub":case"sup":case"strong":case"em":b+=y(n,n.type);break;case"strike":b+=y(n,"s");break;case"bold":b+=y(n,"b");break;case"italic":b+=y(n,"i");break;case"twineLink":d=_slicedToArray(S.lex("(link-goto:"+JSON.stringify(n.innerText)+","+JSON.stringify(n.passage)+")").children,1)[0];b+='<tw-expression type="macro" name="link-goto"'+(O.debug?' title="'+_(n.text)+'"':"")+' code="'+g.code.length+'"></tw-expression>',g.code.push(d);break;case"hook":b+="<tw-hook "+(n.hidden?"hidden ":"")+(n.name?'name="'+x(n.name)+'"':"")+(O.debug&&n.name?' title="Hook: ?'+n.name+'"':"")+' source="'+g.source.length+'"></tw-hook>',g.source.push(n.children);break;case"unclosedHook":return b+="<tw-hook "+(n.hidden?"hidden ":"")+(n.name?'name="'+x(n.name)+'"':"")+'source="'+g.source.length+'"></tw-hook>',g.source.push(m.slice(e+1,w)),{v:b};case"verbatim":b+=A(_(n.innerText).replace(/\n/g,"<br>"),"tw-verbatim");break;case"collapsed":b+=y(n,"tw-collapsed");break;case"unclosedCollapsed":return{v:b+="<tw-collapsed>"+E(m.slice(e+1,w),g)+"</tw-collapsed>"};case"variable":case"tempVariable":case"macro":var f=[],h=[];if("macro"===n.type&&!function e(t){"string"!==t.type&&"hook"!==t.type&&t.children.every(e);var n=x(t.name);if("macro"!==t.type||"prompt"!==n&&"confirm"!==n){if("hook"===t.type&&!t.everyLeaf(function(e){return"error"!==e.type||(h.push(e),!1)}))return!1}else f.push(t);return!0}(n),h.length)return{v:T.create("syntax","This code hook's markup contained "+h.length+" error"+(h.length?"s":"")+":<br>\u2014"+h.map(function(e){return e.message}).join("<br>\u2014")).render(_(n.text))[0].outerHTML};d=f.map(function(e){return e.blockerTree=g.blockers.length,g.blockers.push(e),e.blockerTree});b+='<tw-expression type="'+n.type+'" name="'+_(n.name||n.text)+'"'+(O.debug?' title="'+_(n.text)+'"':"")+(d.length?' blockers="'+d+'"':"")+' code="'+g.code.length+'"></tw-expression>',g.code.push(n);break;default:b+=n.children&&n.children.length?E(n.children,g):n.text}k=e}(k);if("object"===_typeof(e))return e.v}return b}return Object.freeze({exec:function(e){var r={code:[],blockers:[],source:[]},e=E(e="string"==typeof e?S.lex(e).children:e,r),e=a(a.parseHTML(e,document,!0));return e.findAndFilter("script:not([src])").each(function(e,t){var n=t.getAttribute("type");n&&"text/javascript"!==n.toLowerCase()||t.setAttribute("type","application/x-harlowe")}),r.blockers=r.blockers.map(function(e){e.blockedValue=!0;e=Object.create(e);return e.blockedValue=!1,e}),e.findAndFilter("tw-expression[code]:not([data-raw]), tw-expression[blockers]:not([data-raw]), tw-hook[source]:not([data-raw])").each(function(e,t){var n;(t=a(t)).attr("blockers")&&(n=t.popAttr("blockers").split(",").map(function(e){return r.blockers[e]}),t.data("blockers",n)),t.attr("source")&&t.data("source",r.source[t.popAttr("source")]),t.attr("code")&&t.data("code",r.code[t.popAttr("code")])}),e}})}),define("repl",["utils","markup","section"],function(e,t,n){e.onStartup(function(){return setTimeout(function(){e.options.debug&&(window.REPL=function(e){e=n.create().eval(t.lex("(print:"+e+")"));return e.TwineScript_Run?e.TwineScript_Run().source:e},window.LEX=function(e){e=t.lex(e);return 1===e.length?e[0]:e})})})}),define("section",["jquery","utils","twinescript/runner","twinescript/operations","state","utils/operationutils","utils/renderutils","utils/scripttag","datatypes/changercommand","datatypes/colour","datatypes/lambda","datatypes/codehook","internaltypes/changedescriptor","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(p,f,a,u,r,e,t,i,d,h,o,m,g,y,b,v){var w=e.printBuiltinValue,k=e.objectName,S=e.typeID,T=e.isObject,s=t.collapse,_=Object.assign,x=Object.create,O=Object.keys;function A(e,t,n){if(t&&"object"===_typeof(t)&&d.isPrototypeOf(t)){var r=n.popData("source")||(null==(r=n[0].cachedData)?void 0:r.source),a=(null!=(a=n[0])&&a.cachedData&&(n[0].cachedData.source=void 0),n.data("originalSource",r),g.create({target:n,source:r,section:this,append:"append"})),o=t.run(a);if(b.containsError(o)&&e.replaceWith(o.render(e.attr("title"))),!this.renderInto(r,null,a))return o=f.insensitiveName(e.attr("name")),["if","elseif","unless","else","testfalse"].includes(o)&&(e.addClass("false"),"elseif"!==o)&&(this.stackTop.lastHookShown=!1),n.data("live")&&function(t,n,r){function a(e){p&&(d-=(e-p)*(f.options.debug&&void 0!==f.options.speedMultiplier?f.options.speedMultiplier:1)),p=e,0<d?requestAnimationFrame(a):(d=s,o())}var o,i=this,e=r.data("live"),s=e.delay,c=e.event,l=((n=_objectSpread(_objectSpread({},n),{},{append:"replace",transitionDeferred:!1,enabled:!0})).data=_objectSpread(_objectSpread({},n.data),{},{live:void 0}),r.data("originalSource")||""),u=this.stackTop.tempVariables,p=null,d=s;o=this.whenUnblocked.bind(this,function(){var e;i.inDOM()&&(e=null==c?void 0:c.filter(i,[!0],u),b.containsError(e)?e.render(i,t.attr("title")).replaceAll(t):c&&!e[0]?requestAnimationFrame(a):(i.renderInto(l,r,n,u),e||r.find("tw-expression[name='stop']").length||i.inDOM()&&requestAnimationFrame(a)))}),requestAnimationFrame(a)}.call(this,e,a,n),!0}else{if(!1===t)return o=n.popData("source")||(null==(r=n[0].cachedData)?void 0:r.source),null!=(a=n[0])&&a.cachedData&&(n[0].cachedData.source=void 0),o&&(n.cachedData&&(n.cachedData.source=void 0),n.data("originalSource",o),n.data("hidden",!0)),e.addClass("false"),!(this.stackTop.lastHookShown=!1);if(!0!==t)return!1}return this.stackTop.lastHookShown=!0}function C(e){var t,n,e=(e instanceof p?e[0]:e).nextSibling;return e&&(e instanceof Text&&!e.textContent.trim()||["br","tw-consecutive-br"].includes((e.tagName||"").toLowerCase()))?(t=(n=C(e)).whitespace,n=n.nextElem,{whitespace:p(e).add(t),nextElem:n}):{whitespace:p(),nextElem:p(e)}}function E(e){if(null!=e&&e.length)return p("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",e)}function c(e,t){var n=this.eval(t);e.append(E(this.evalReplay)),e.append(function(e,t){if(/a \((go-to|undo|redirect|restart):\) command/.exec(null==t?void 0:t.TwineScript_TypeName))return p("<tw-open-button goto label='GO'>").data("goto",{section:e,command:t})}(this,n)),this.stackTop.evaluateOnly&&n&&(d.isPrototypeOf(n)||"function"==typeof n.TwineScript_Run)&&(n=b.create("syntax","I can't work out what ".concat(this.stackTop.evaluateOnly," should evaluate to, because it contains a ").concat(d.isPrototypeOf(n)?"changer.":"command."),"Please rewrite this without putting changers or commands here."));var r=p();for(i=e;d.isPrototypeOf(n);){var a=C(i),o=a.whitespace;if((i=a.nextElem)[0]&&i[0].nodeType===Node.TEXT_NODE&&"+"===i[0].textContent.trim()){var i,a=i,s=C(a),c=s.whitespace;if((i=s.nextElem).is("tw-expression")){var s=i.popData("code")||(null==(s=i[0])||null==(s=s.cachedData)?void 0:s.code),l=(null!=(l=i[0])&&l.cachedData&&(i[0].cachedData.code=void 0),this.eval(s));if(b.containsError(l)){n=l;break}s=u["+"](n,l);p(o).add(a).add(c).remove(),n=b.containsError(s)?b.create("operation","I can't combine "+k(n)+" with "+k(l)+".","function"==typeof l.TwineScript_Run?"If you want to attach this changer to ".concat(k(l),", remove the + between them."):"Changers can only be added to other changers."):s;continue}}if(i.is("tw-expression")){l=i.popData("code")||(null==(a=i[0])||null==(c=a.cachedData)?void 0:c.code),a=(null!=(s=i[0])&&s.cachedData&&(i[0].cachedData.code=void 0),this.eval(l));if(i.append(E(this.evalReplay)),b.containsError(a)){n=a;break}if(a&&"object"===_typeof(a)&&"function"==typeof a.TwineScript_Attach){n=a.TwineScript_Attach(this,n);break}return d.isPrototypeOf(a)?void e.replaceWith(b.create("operation","Changers like (".concat(n.macroName,":) need to be combined using + between them."),"Place the + between the changer macros, or the variables holding them. The + is absent only between a changer and its attached hook or command.").render(e.attr("title"))):void e.replaceWith(b.create("operation","".concat(k(a)," can't have changers like (").concat(n.macroName,":) attached."),"Changers placed just before hooks, links and commands will attempt to attach, but in this case it didn't work.").render(e.attr("title")))}if(i.is("tw-hook")){o.remove(),r=i;break}n.macroName||f.impossible("Section.runExpression","changer has no macroName");a=e.attr("title")||"("+n.macroName+": ...)";return void e.replaceWith(b.create("syntax","The (".concat(n.macroName,":) changer should be stored in a variable or attached to a hook."),"Macros like this should appear before a hook: ".concat(a,"[Some text]")).render(e.attr("title")))}e.attr("return",S(n)),r=r.length?r:C(e).nextElem.filter("tw-hook"),(t=b.containsError(n))?e.replaceWith(t.render(e.attr("title")).append(E(this.evalReplay))):v.isPrototypeOf(n)?e.append(n.render()):n&&"function"==typeof n.TwineScript_Run?(n=n.TwineScript_Run(this),b.containsError(n)?e.replaceWith(n.render(e.attr("title"))):g.isPrototypeOf(n)?null!=(t=n.data)&&t.live?e.replaceWith(b.create("unimplemented","I currently can't attach (live:) or (event:) macros to commands - only hooks.").render(e.attr("title"))):(n.section=this,n.target=i,this.renderInto("",i,n)):T(n)&&n.blocked?(this.stackTop.blocked=n.blocked,e.data("code",{type:"macro",blockedValue:!0,text:e.attr("title")||"",start:0,end:(e.attr("title")||"").length})):n&&f.impossible("Section.runExpression","TwineScript_Run() returned a non-ChangeDescriptor ".concat(_typeof(n),': "').concat(n,'"'))):r.length&&A.call(this,e,n,r)||("string"==typeof n||"number"==typeof n||n instanceof Map||n instanceof Set||Array.isArray(n)||h.isPrototypeOf(n)||m.isPrototypeOf(n)||n&&"function"==typeof n.TwineScript_Print&&!d.isPrototypeOf(n)?(n=w(n),b.containsError(n)?e.replaceWith(n.render(e.attr("title"))):"string"==typeof n||Array.isArray(n)?this.renderInto(n,e):f.impossible("printBuiltinValue() produced a non-string non-array ".concat(_typeof(n)))):d.isPrototypeOf(n)||"boolean"==typeof n||f.impossible("Section.runExpression","The expression evaluated to an unknown value: ".concat(n)))}var l={add:[],remove:[]};return Object.preventExtensions({create:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f.storyElement,n=_(x(this),{timestamp:Date.now(),dom:e,stack:[],enchantments:[],unblockCallbacks:[],freeVariables:null,evalReplay:null,loadedGame:!1,Identifiers:{TwineScript_Identifiers:!0,it:0,get time(){var e;return null!=(e=n.stackTop)&&e.evaluateOnly?b.create("operation","'time' can't be used in ".concat(n.stackTop.evaluateOnly,".")):(Date.now()-n.timestamp)*(f.options.debug&&void 0!==f.options.speedMultiplier?f.options.speedMultiplier:1)},get turns(){return r.turns},get turn(){return r.turns},get visits(){var t=n.stackTop.speculativePassage;return r.history().filter(function(e){return e===(t||r.passage)}).length+(!t||t===r.passage)},get visit(){return n.Identifiers.visits},get exits(){var e;return null!=(e=n.stackTop)&&e.evaluateOnly?b.create("operation","'exit' and 'exits' can't be used in ".concat(n.stackTop.evaluateOnly,".")):n.dom.find("tw-enchantment, tw-link").filter(function(e,t){return(t=p(t)).data("enchantmentEvent")||t.parent().data("linkPassageName")||t.parent().data("clickEvent")}).length},get exit(){return n.Identifiers.exits},get pos(){return n.stackTop&&!n.stackTop.evaluateOnly&&n.stackTop.lambdaPos?+n.stackTop.lambdaPos||1:b.create("operation","'pos' can only be used in lambdas that aren't 'when' lambdas.")}}});return n},eval:function(t){var e,n;f.options.debug&&f.options.evalReplay&&(n=Array.isArray(t)?t.reduce(function(e,t){return e+t.text},""):t.text||"",this.evalReplay=[{code:n,fromCode:n,basis:(Array.isArray(t)?t[0]:t).start,start:0,end:n.length,diff:0}]);try{e=a(this,t)}catch(e){return null!=(n=window.console)&&n.error(e),this.evalReplay=null,b.create("","An internal error occurred while trying to run ".concat([].concat(t).map(function(e){return e.text}).join(""),"."),'The error was "'.concat(e.message,'".\nIf this is the latest version of Harlowe, please consider reporting a bug (see the documentation).'))}return this.evalReplay&&2===this.evalReplay.length&&this.evalReplay.shift(),e},get stackTop(){return this.stack[0]},inDOM:function(){return 0<f.storyElement.find(this.dom).length},evaluateTwineMarkup:function(e,t){var n=p("<p>");return this.stack.unshift({desc:g.create({target:n,source:e,section:this,append:"append"}),tempVariables:this.stackTop.tempVariables,evaluateOnly:t,finalIter:!0}),this.execute(),0<(e=n.find("tw-error")).length?e:n},speculate:function(e,t,n){this.stack.unshift({evaluateOnly:n,finalIter:!0,tempVariables:_(x(y),{TwineScript_VariableStore:{type:"temp",name:n}}),speculativePassage:t});var r,n=this.evalReplay;return this.evalReplay=null,o.isPrototypeOf(e)?r=e.apply(this,{fail:!1,pass:!0}):e&&(r=a(this,e)),this.stack.shift(),this.evalReplay=n,r},renderInto:function(e,a,t){var o=this,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=g.create({target:a,source:e,section:this,append:"append"});if(t)if(d.isPrototypeOf(t)){var e=t.run(i);if(b.containsError(e))return e.render(a.attr("title")).replaceAll(a),!1}else _(i,t);if((a=i.target,50<=this.stack.length)&&50<=this.stack.reduce(function(e,t){return e+!!t.finalIter},0))return b.create("infinite","Printing this expression may have trapped me in an infinite loop.").render(a.attr("title")).replaceAll(a),!1;var s=function(e,t,n){var r=a instanceof p&&a.is("tw-hook")&&0<a.parents("tw-collapsed,[collapsing=true]").length;o.stack.unshift({desc:e,finalIter:n,tempVariables:t,collapses:r,evaluateOnly:o.stackTop&&o.stackTop.evaluateOnly})},r=r||x(this.stack.length?this.stackTop.tempVariables:y),t=(hasOwnProperty.call(r,"TwineScript_VariableStore")||(t=null==(e=a)?void 0:e.tag(),r.TwineScript_VariableStore={type:"temp",name:"tw-hook"===t?a.attr("name")?"?"+a.attr("name"):"an unnamed hook":"tw-expression"===t?"a "+a.attr("type")+" expression":"tw-passage"===t?"this passage":"an unknown scope"}),null==(e=this.stackTop)?void 0:e.blocked);if(O(i.loopVars).length){var c=_objectSpread({},i.loopVars),l=Math.min.apply(Math,_toConsumableArray(O(c).map(function(e){return c[e].length})));if(v.create(l+" loop"+(1!==l?"s":"")).render().prependTo(a),l){for(var n=l-1;0<=n;--n)!function(n){s(i,O(c).reduce(function(e,t){return e[t]=c[t][n],e},x(r),n===l-1))}(n);for(var u=l-1;0<=u&&!this.stackTop.blocked;--u)this.execute()}}else s(i,r,!0),this.execute();return(0===this.stack.length||!t&&null!=(e=this.stackTop)&&e.blocked)&&this.updateEnchantments(),i.enabled},execute:function(){var a=this,e=this.stackTop,t=e.desc,n=e.dom,r=e.collapses,o=e.evaluateOnly;t&&!n&&(n=t.render(),this.stackTop.dom=n,this.stackTop.desc=void 0),n.findAndFilter('tw-hook,tw-expression,script[type="application/x-harlowe"]').each(function(e,t){var n=p(t).data();t.cachedData={blockers:n.blockers,code:n.code,source:n.source}}).each(function(e,t){if(a.stackTop.blocked)return!1;var n=t.cachedData;switch(n&&(t.cachedData=void 0),(t=p(t)).tag()){case"tw-hook":var r=t.popData("source")||(null==n?void 0:n.source);(r&&t.data("originalSource",r),t.data("tempVariables",a.stackTop.tempVariables),t.popAttr("hidden"))?t.data("hidden",!0):r&&a.renderInto(r,t);break;case"tw-expression":var r=t.data("blockers")||(null==n?void 0:n.blockers);if(r){if(o)return void t.removeData("blockers").removeData("code").replaceWith(b.create("syntax","I can't use a macro like (prompt:) or (confirm:) in ".concat(o,"."),"Please rewrite this without putting such macros here.").render(t.attr("title"),t));if(r.length)return a.stackTop.blocked=!0,r=a.eval(r.shift()),b.containsError(r)&&(a.stackTop.blocked=!1,t.removeData("blockers").replaceWith(r.render(t.attr("title"),t))),!1;t.removeData("blockers")}r=t.popData("code")||(null==n?void 0:n.code);r&&c.call(a,t,r);break;case"script":if(f.reattachStoryElement(),t.text())try{i(t.text(),a.stackTop.tempVariables)}catch(e){b.isPrototypeOf(e)?t.replaceWith(e.render(t.text(),t)):(null!=(r=window.console)&&r.error(e),t.replaceWith(b.create("","A Javascript error occurred while running this <script> element.",'The error was "'.concat(e,'". Check the browser console for more details.')).render(t.text(),t)))}}}),this.stackTop.blocked||(n.length&&r&&s(n),n.findAndFilter("tw-collapsed,[collapsing=true]").each(function(){s(p(this))}),setTimeout(function(){return n.find("input, textarea").first().focus()},100),this.stack.shift())},updateEnchantments:function(){this.enchantments.forEach(function(e){e.disenchant(),e.enchantScope()})},on:function(e,t){return l[e].push(t),this},addEnchantment:function(t){var n=this;this.enchantments.push(t),l.add.forEach(function(e){return e(n,t)})},removeEnchantment:function(t){var n=this,e=this.enchantments.indexOf(t);this.enchantments.splice(e,1),t.disenchant(),l.remove.forEach(function(e){return e(n,t)})},unblock:function(e){for(this.stack.length||f.impossible("Section.unblock","stack is empty"),this.stackTop.blocked=!1,void 0!==e&&(this.stackTop.blockedValues=(this.stackTop.blockedValues||[]).concat(e));this.stack.length&&!this.stackTop.blocked;)this.execute();if(!this.stack.length)for(;0<this.unblockCallbacks.length;){var t;if(this.unblockCallbacks.shift()(),null!=(t=this.stackTop)&&t.blocked)return}},whenUnblocked:function(e,t){this.stack.length&&this.stackTop.blocked?this.unblockCallbacks=this.unblockCallbacks.concat(e):(t||e)()},blockedValue:function(){var e=this.stackTop;return e?e.blockedValues&&e.blockedValues.length?e.blockedValues.shift():(f.impossible("Section.blockedValue","blockedValues is missing or empty"),0):(f.impossible("Section.blockedValue","stack is empty"),0)}})}),define("state",["jquery","utils","passages","datatypes/customcommand","utils/operationutils","markup"],function(n,y,b,v,e,t){var i,w,C=e.toSource,E=e.is,k=t.lex,o=Object.assign,h=Object.create,e=Object.defineProperty,N=Array.isArray,s=Math.imul,t=(e(Map.prototype,"toJSON",{value:void 0}),e(Set.prototype,"toJSON",{value:void 0}),["localStorage","sessionStorage"].map(function(e){try{return!!window[e]&&(window[e].setItem("test","1"),window[e].removeItem("test"),!0)}catch(e){return!1}}));function S(e,t){var n=0<arguments.length&&void 0!==e?e:String.fromCodePoint(Date.now()%1114112),e=1<arguments.length&&void 0!==t?t:0;i.seedIter=e,i.seed=n;for(var r,a=0,o=2166136261;a<n.length;a+=1)r=s(n.charCodeAt(a),3432918353),o^=s(r<<15|r>>>17,461845907),o=s(o=o<<13|o>>>19,5)+3864292196|0;return o^=n.length,o=s(o^=o>>>16,2246822507),o=s(o^=o>>>13,3266489909),o=((o^=o>>>16)>>>0)+1831565813*e,function(){i.seedIter+=1;var e=o+=1831565813,e=s(e^e>>>15,1|e);return(((e^=e+s(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}}function r(e,t){for(var n,r=t.variables,a=h(null),o=e.length-1;0<=o;--o){for(var i,s,c=e[o],l=0,u=["mockVisits","mockTurns","seed","seedIter"];l<u.length;l++){var p=u[l];hasOwnProperty.call(c,p)&&!hasOwnProperty.call(t,p)&&(t[p]=c[p])}for(i in c.forgetVisits&&(t.forgetVisits=Math.max(t.forgetVisits||0,c.forgetVisits)),void 0!==c.turns&&(t.turns=(t.turns||0)+c.turns),t.pastVisits||(t.pastVisits=[]),o!==e.length-1&&(void 0!==e[o+1].visits&&Array.isArray(t.pastVisits[0])?t.pastVisits[0]:t.pastVisits).unshift(c.passage),void 0!==c.pastVisits&&t.pastVisits.unshift(c.pastVisits),void 0!==c.visits&&t.pastVisits.unshift(c.visits),c.variables)if("TwineScript_TypeDefs"===i)for(var d in r[i]||(r[i]=h(null)),c.variables[i])r[i][d]||(r[i][d]=c.variables[i][d]);else i.startsWith("TwineScript_")||i in r||(null===c.variables[i]&&(a[i]=!0),a[i])||(r[i]=c.variables[i],!(s=c.valueRefs[i]))||"via"in s||t.valueRefs[i]||(t.valueRefs[i]=s)}for(n in t.valueRefs){var f=t.valueRefs[n];f&&"via"in f&&delete t.valueRefs[n]}}var a,c={passage:"",variables:h(null),visits:void 0,turns:void 0,seed:void 0,seedIter:void 0,mockVisits:void 0,mockTurns:void 0,forgetVisits:void 0,create:function(e){var t=h(c);return t.passage=e||"",t.variables=h(null),t.valueRefs=h(null),t}},l={forward:[],back:[],load:[],beforeForward:[],beforeBack:[],beforeLoad:[],forgetUndos:[]},u=[],p=-1,d=c.create(),f="";function m(){i.history=i.pastVisits.slice(i.forgetVisits).reduce(function(e,t){return e.concat(t)},[]),i.mockVisits&&(i.history=i.mockVisits.concat(i.history))}function g(){var e=c.create();e.pastVisits=[],o(e.variables,{TwineScript_ObjectName:"this story's variables",TwineScript_TypeDefs:h(null),TwineScript_VariableStore:{type:"global",name:"this story's variables"},TwineScript_Delete:function(e){delete this[e],d.variables[e]=null,delete d.valueRefs[e]},TwineScript_Set:function(e,t,n){if(this[e]=t,d.variables[e]=t,n)d.valueRefs[e]=n;else if((N(t)||t instanceof Map||t instanceof Set||"string"==typeof t)&&!y.options.uncompressedStructures)for(var r=p;0<=r;--r){var a=u[r].variables[e];if(void 0!==a){a=function e(t,n,r){var a="it"===r?"its":r+"'s",o="";if(N(n)&&N(t)&&n.length){for(var i=n.length===t.length,o="(a:",s=0;s<n.length;s+=1){var c,l,u,p=n[s];E(p,t[s])?(c=C(p),l="".concat(a," ").concat(s+1,"th"),o+=(c.length<l.length?c:l)+","):(i=!1,-1<(c=t.indexOf(p))?(l=C(p),u="".concat(a," ").concat(c+1,"th"),o+=(l.length<u.length?l:u)+","):o+=e(t[s],p,"".concat(a," ").concat(s+1,"th"))+",")}o=i?r:o.slice(0,-1)+")"}else if(n instanceof Map&&t instanceof Map&&n.size){var d,f=n.size===t.size,h=(o="(dm:",_createForOfIteratorHelper(n.entries()));try{for(h.s();!(d=h.n()).done;){var m,g,y=_slicedToArray(d.value,2),b=y[0],v=y[1];o+="".concat(C(b),","),E(v,t.get(b))?(m=C(v),g="".concat(a," (").concat(C(b),")"),o+=(m.length<g.length?m:g)+","):(f=!1,o+=e(t.get(b),v,"".concat(a," (").concat(C(b),")"))+",")}}catch(e){h.e(e)}finally{h.f()}o=f?r:o.slice(0,-1)+")"}else if(n instanceof Set&&t instanceof Set&&n.size){var w,k=new Set,S=new Set,T=_createForOfIteratorHelper(t);try{for(T.s();!(w=T.n()).done;){var _=w.value;n.has(_)||k.add(_)}}catch(e){T.e(e)}finally{T.f()}var x,O=_createForOfIteratorHelper(n);try{for(O.s();!(x=O.n()).done;){var A=x.value;t.has(A)||S.add(A)}}catch(e){O.e(e)}finally{O.f()}k.size||S.size||(o=r),o=k.size+S.size>n.size?C(n):r+(S.size?"+"+C(S):"")+(k.size?"-"+C(k):"")}else"string"==typeof n&&"string"==typeof t&&n&&(n.startsWith(t)?o=r+"+"+C(n.slice(t.length)):n.endsWith(t)&&(o=C(n.slice(0,n.length-t.length))+"+"+r));return o?"it"===r?{via:o}:o:"it"===r?void 0:C(n)}(a,t,"it");a&&("it"===a.via?delete d.variables[e]:d.valueRefs[e]=a);break}}},TwineScript_GetProperty:function(e){return this[e]},TwineScript_DefineType:function(e,t){this.TwineScript_TypeDefs[e]=t,hasOwnProperty.call(d.variables,"TwineScript_TypeDefs")||(d.variables.TwineScript_TypeDefs=h(null)),d.variables.TwineScript_TypeDefs[e]=t}}),r(u.slice(0,p+1),e),i=e,m(),w=S(e.seed,e.seedIter)}function T(e){d=c.create(e);e=a.serialise(!0),f=e.past,e=e.pastAndPresent;if(a.hasSessionStorage&&"string"==typeof e)try{sessionStorage.setItem("Saved Session",e)}catch(e){}}function _(e,t,n,r){for(var a in r)if(hasOwnProperty.call(r,a)&&!a.startsWith("TwineScript_"))if("object"===_typeof(r[a]))if(hasOwnProperty.call(r[a],"at")){n.valueRefs[a]=r[a];var o=r[a],i=o.at,s=o.from,c=o.to,l=o.hash,u=o.seed,p=o.seedIter,o=o.blockedValues;if(!b.has(i))throw Error('The data refers to a passage named `"'.concat(n.passage,"\"`, but it isn't in this story."));var d=b.get(i).get("source"),f=d.slice(s,c);if(void 0!==l)for(var h=0,m=c-s;y.hash(f).toString(16)!==l;){if(h+m>=d.length)throw Error("The value (or type) of the variable `$".concat(a,"` couldn't be found in the passage `\"").concat(i,'"`.'));(h+=1)===s&&(h+=1),f=d.slice(h,h+m)}c=k(f,"","macro");void 0!==u&&void 0!==p&&(w=S(u,p)),void 0!==o&&(e.stackTop.blockedValues=o,c.forEach(function e(t){var n;"string"!==t.type&&"hook"!==t.type&&t.children.every(e),"macro"!==t.type||"prompt"!==(n=y.insensitiveName(t.name))&&"confirm"!==n||(t.blockedValue=!0)})),r[a]=e.eval(c)}else if(hasOwnProperty.call(r[a],"via")){for(var g=t.length-1;0<=g;--g)if(hasOwnProperty.call(t[g].variables,a)){e.Identifiers.it=t[g].variables[a];break}r[a]=e.eval(k(r[a].via,"","macro")),e.Identifiers.it=0}else hasOwnProperty.call(r[a],"changer")&&(r[a].changer=e.eval(k(r[a].changer,"","macro")),r[a].hook=e.eval(k(r[a].hook,"","macro")),_(e,t,n,r[a].variables),r[a]=v.create(r[a]));else r[a]=e.eval(k(r[a],"","macro"));else"TwineScript_MockVisits"===a&&(n.mockVisits=r[a])}return g(),d.seed=i.seed,d.seedIter=0,(a={get passage(){return d.passage},get variables(){return i.variables},get pastLength(){return p},get turns(){return p+1+(i.turns||0)+(i.mockTurns||0)},get futureLength(){return u.length-1-p},get mockVisits(){return i.mockVisits||[]},set mockVisits(e){i.mockVisits=e,d.mockVisits=e,m()},get mockTurns(){return i.mockTurns||0},set mockTurns(e){i.mockTurns=e,d.mockTurns=e},history:function(){return i.history},forgetUndos:function(e){e<0&&(e=u.length+e);var t,e=u.splice(0,Math.min(u.length-1,e));e.length&&(p=u.length-1,t=u[0],r(e,t),t.pastVisits.push(e[e.length-1].passage),t.turns=(t.turns||0)+e.length,i.turns=(i.turns||0)+e.length,t.forgetVisits&&(t.pastVisits=t.pastVisits.slice(t.forgetVisits-t.turns),t.forgetVisits-=t.turns),f="",0===p&&n("tw-link[undo], tw-icon[alt='Undo']",y.storyElement).each(function(e,t){(n(t).closest("tw-expression, tw-hook").data("forgetUndosEvent")||Object)(t)}),l.forgetUndos.forEach(function(e){return e()}))},forgetVisits:function(e){(e=e<0?u.length+e:e)>p+i.turns&&(e=p+i.turns),d.forgetVisits=i.forgetVisits=Math.max(i.forgetVisits||0,e),m()},passageNameVisited:function(e){var t=0;if(!b.get(e))return 0;for(var n=0;n<i.history.length;n++)t+=+(e===i.history[n]);return t},get timeline(){return u},play:function(t){var e;d||y.impossible("State.play","present is undefined!"),l.beforeForward.forEach(function(e){return e()}),d.passage&&((null!=(e=d.visits)&&e.length&&Array.isArray(i.pastVisits[i.pastVisits.length-1])?i.pastVisits[i.pastVisits.length-1]:i.pastVisits).push(d.passage),i.history.push(d.passage)),d.passage=t,u=u.slice(0,p+1).concat(d),p+=1,T(t),l.forward.forEach(function(e){return e(t)})},redirect:function(e){var t;d||y.impossible("State.redirect","present is undefined!"),d.passage&&(null!=(t=d.visits)&&t.length&&Array.isArray(i.pastVisits[i.pastVisits.length-1])?i.pastVisits[i.pastVisits.length-1].push(d.passage):i.pastVisits.push([d.passage]),i.history.push(d.passage)),d.visits=(d.visits||[]).concat(e),d.passage=e},rewind:function(e){for(var t=void 0!==e?e:1,n=!1;0<t&&0<p;t--)n=!0,--p;return n&&(l.beforeBack.forEach(function(e){return e()}),f="",T(u[p].passage),g(),l.back.forEach(function(e){return e()})),n},fastForward:function(e){var t=1,n=!1;for("number"==typeof e&&(t=e);0<t&&0<u.length;t--)n=!0,p+=1;return n&&(l.beforeForward.forEach(function(e){return e()}),T(u[p].passage),g(),l.forward.forEach(function(e){return e(u[p].passage,"fastForward")})),n},on:function(e,t){if(e in l)return"function"!=typeof t||l[e].includes(t)||l[e].push(t),a;y.impossible("State.on","invalid event name")},reset:function(){l.beforeLoad.forEach(function(e){return e()}),u=[],p=-1,g(),(d=c.create()).seed=i.seed,d.seedIter=0,f="",w=S(),l.load.forEach(function(e){return e(u)})},hasStorage:t[0],hasSessionStorage:t[1],setSeed:function(e){w=S(e),d.seed=i.seed,d.seedIter=0},get seed(){return i.seed},get seedIter(){return i.seedIter},random:function(){var e=w();return d.seedIter=i.seedIter,e},shuffled:function(){for(var a=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce(function(e,t,n){var r=a.random()*(n+1)|0;return r===n?e.push(t):(e.push(e[r]),e[r]=t),e},[]);return d.seedIter=i.seedIter,r}}).serialise=function(e){function o(e,t){if("TwineScript_TypeDefs"===t){var n,r={};for(n in e[t])r[n]=C(e[t][n]);return r}var a;return null===e[t]?null:e[t]&&hasOwnProperty.call(e[t],"TwineScript_CustomCommand")?(a=e[t].TwineScript_CustomCommand(),{changer:C(a.changer),toSource:a.toSource,hook:C(a.hook),variables:Object.keys(a.variables).reduce(function(e,t){return e[t]=o(a.variables,t),e},{})}):C(e[t])}function t(e,t){if(c.isPrototypeOf(t)&&void 0===t.visits&&void 0===t.turns&&void 0===t.mockVisits&&void 0===t.forgetVisits&&void 0===t.pastVisits&&void 0===t.mockTurns&&void 0===t.seed&&void 0===t.seedIter&&Object.keys(t.variables).every(function(e){return e.startsWith("TwineScript_")}))return t.passage;if(!c.isPrototypeOf(this)||"valueRefs"!==e){if(c.isPrototypeOf(this)&&"variables"===e){var n,r={};for(n in this.variables)this.valueRefs[n]?r[n]=this.valueRefs[n]:r[n]=o(this.variables,n);return r}return t}}var e=u.slice(f?e?p-1:p:0,p+1),n=e.slice(0,-1),r=f;try{return{past:r=n.length?(r?r.slice(0,-1)+",":"[")+JSON.stringify(n,t).slice(1):r,pastAndPresent:r.slice(0,-1)+(r?",":"[")+JSON.stringify(e.slice(-1),t).slice(1)}}catch(e){return{past:!1,pastAndPresent:!1}}},a.deserialise=function(e,t){var n;try{n=JSON.parse(t)}catch(e){return Error("The save data is unintelligible.")}if(!N(n))return Error("The save data isn't a sequence of past turns.");for(var r=0;r<n.length;r+=1){var a=n[r];if("string"==typeof a)a={passage:a,variables:{}};else if("object"!==_typeof(a)||!hasOwnProperty.call(a,"variables")){n.splice(r--,1);continue}if(a.valueRefs=h(null),a.variables=o(h(null),a.variables),!b.hasValid(a.passage))return Error('The data refers to a passage named `"'.concat(a.passage,"\"`, but it isn't in this story."));if(hasOwnProperty.call(a.variables,"TwineScript_TypeDefs"))try{_(e,n.slice(0,r),a,a.variables.TwineScript_TypeDefs)}catch(e){return Error("The variable types on turn ".concat(r+1," couldn't be reconstructed.").concat(e.message?" (".concat(e.message,")"):""))}try{_(e,n.slice(0,r),a,a.variables)}catch(e){return Error("The variables on turn ".concat(r+1," couldn't be reconstructed.").concat(e.message?" (".concat(e.message,")"):""))}n[r]=o(h(c),a)}return p=(u=n).length-1,l.load.forEach(function(e){return e(u)}),f="",g(),T(u[p].passage),!0},Object.seal(c),Object.freeze(a)}),define("utils",["jquery","markup","utils/polyfills"],function(d){var r=String.fromCharCode,n="audio,blockquote,canvas,div,h1,h2,h3,h4,h5,hr,ol,p,pre,table,ul,video,tw-align,tw-story,tw-passage,tw-sidebar,tw-columns,tw-column,tw-meter".split(","),a="a,b,i,em,strong,sup,sub,abbr,acronym,s,strike,del,big,small,script,img,button,input,tw-link,tw-broken-link,tw-verbatim,tw-collapsed,tw-error,tw-colour,tw-icon".split(","),f=["audio"],e=_slicedToArray([function(e){return r(e)!==r(e).toLowerCase()},function(e){return r(e)!==r(e).toUpperCase()},function(e){return r(e).toLowerCase()!==r(e).toUpperCase()}].map(function(e){return"["+Array.from(Array(57343)).map(function(e,t){return t}).filter(e).map(function(e,t,n){return e===n[t-1]+1&&e===n[t+1]-1?"-":r(e)}).join("").replace(/-+/g,"-")+"]"}),3),t=e[0],o=e[1],e=e[2];function s(e){return"instant"===e?0:800}var i,c,l=[],u={},p=0,h={},m=0,g={};function y(n,r,e,a,o){var i=null,s=0,c=r+e;function l(e){var t;1&n[0].compareDocumentPosition(document)&&(c=0),i&&(c-=t=e-i),i=e,0<a&&0<p+m&&n.data("expediteAnim")(a),c<=r&&(s+=t||0,"paused"===n.css("animation-play-state"))&&n.css({visibility:"","animation-play-state":"running"}),c<=0?(n.removeData("expediteAnim"),o()):requestAnimationFrame(l)}n.data("expediteAnim",function(e){var t;c-=e=void 0===e?s:e,"running"===n.css("animation-play-state")&&n.css("animation-delay",(("ms"===(t=(t=n.css("animation-delay")).toLowerCase()).slice(-2)?+t.slice(0,-2)||0:"s"===t.slice(-1)&&1e3*+t.slice(0,-1)||0)||0)-e+"ms")}),c?requestAnimationFrame(l):l()}d(document.documentElement).on("keydown keyup mousedown mouseup",function(e){var t=e.key,n=e.button,e=e.type.includes("down"),r=t?u:h,n=t&&v.insensitiveName(t)||n;r[n]&&!e?t?p=Math.max(p-1,0):m=Math.max(m-1,0):!r[n]&&e&&(t?p+=1:m+=1),r[n]=e}).on("mousemove",function(e){var t=e.pageX,e=e.pageY;g.x=t,g.y=e});var b=/-|_/g,v={hash:function(e){for(var t=9,n=e.length;0<n;)--n,t=Math.imul(t^e.charCodeAt(n),Math.pow(9,9));return(t^t>>>9)>>>0},permutations:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r,a,o=t.length,i=[[].concat(t)],s=Array(o).fill(0),c=1;c<o;)s[c]<c?(r=c%2&&s[c],a=t[c],t[c]=t[r],t[r]=a,++s[c],c=1,i.push([].concat(t))):(s[c]=0,++c);return i},nth:function(e){var t=+e+"";return e+("1"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"2"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"3"!==t[t.length-1]||1!==t.length&&"1"===t[t.length-2]?"th":"rd":"nd":"st")},plural:function(e,t,n){return e+" "+(1!==Math.abs(e)?n||t+"s":t)},andList:function(e){return e.length<=1?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},realWhitespace:"[ \\n\\r\\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]",anyRealLetter:"[\\dA-Za-z\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",anyUppercase:t,anyLowercase:o,anyCasedLetter:e,anyNewline:"(?:\\n|\\r|\\r\\n)",unescape:function(e){return e.replace(/&(?:amp|lt|gt|quot|nbsp|zwnj|#39|#96);/g,function(e){return{"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'","&nbsp;":String.fromCharCode(160),"&zwnj;":String.fromCharCode(8204)}[e]})},escape:function(e){return e.replace(/[&><"']/g,function(e){return{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})},insensitiveName:function(e){return(e+"").toLowerCase().replace(b,"")},allKeysDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return u[e]})},someKeysDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function(e){return u[e]})},buttonsDown:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return h[e]})},anyInputDown:function(){return 0<p+m},mouseCoords:g,parentColours:function(e){for(var t,n={colour:null,backgroundColour:null},r=/^\w+a\(.+?,\s*0\s*\)$|^transparent$/;e.length&&e[0]!==document;e=e.parent())if(n.backgroundColour||(t=e.css("background-color")).match(r)||(n.backgroundColour=t),n.colour||(t=e.css("color")).match(r)||(n.colour=t),n.colour&&n.backgroundColour)return n;return{colour:"#fff",backgroundColour:"#000"}},childrenProbablyInline:function(e){var t=[];return[].every.call(e.findAndFilter("*"),function(e){if(!(e.hidden||/none|inline/.test(e.style.display)||/display: (none|inline)/.test(e.getAttribute("style")))){if(n.includes(e.tagName.toLowerCase())||/display: (?!none|inline|inherit|unset)/.test(e.getAttribute("style")))return!1;a.includes(e.tagName.toLowerCase())||t.push(e)}return!0})&&t.every(function(e){return/inline|none/.test(window.getComputedStyle(e).display)})},transitionOut:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,i=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0;0!==e.length&&(n=n||s(t),!(1<e.length)&&v.childrenProbablyInline(e)&&["tw-hook","tw-passage","tw-sidebar","tw-expression"].includes(e.tag())||(e=e.wrapAll("<tw-transition-container>").parent()),i&&e.css("transform-origin",i),e.attr("data-t8n",t).addClass("transition-out").css({"animation-duration":"".concat(n,"ms"),"animation-delay":"".concat(-o,"ms"),"animation-play-state":"paused"}),requestAnimationFrame(function(){v.childrenProbablyInline(e)?e.css("display","inline"):e.parent().is("tw-backdrop,tw-story")||e[0].setAttribute("style",e[0].getAttribute("style")+"display:block !important;width:100%")}),y(e,n,r-o,a,function(){e.remove()}))},transitionIn:function(u,e,t){var p,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:void 0;0!==u.length&&(t=t||s(e),(p=1<u.length||!v.childrenProbablyInline(u)||!["tw-hook","tw-passage","tw-sidebar","tw-expression"].includes(u.tag()))&&(u=u.wrapAll("<tw-transition-container>").parent()),o&&u.css("transform-origin",o),u.attr("data-t8n",e).addClass("transition-in").css(_objectSpread({"animation-duration":"".concat(t,"ms"),"animation-delay":"".concat(-a,"ms")},n-a?{visibility:"hidden","animation-play-state":"paused"}:{})),requestAnimationFrame(function(){v.childrenProbablyInline(u)?u.css("display","inline"):u.parent().is("tw-backdrop,tw-story")||u[0].setAttribute("style",u[0].getAttribute("style")+"display:block !important;width:100%")}),y(u,t,n-a,r,function(){var e=0===u.filter(f.join(",")).length;if(p&&e){u.find("tw-transition-container, .transition-in, .transition-out").each(function(e,t){((t=d(t)).data("expediteAnim")||Object)()});for(var t=[],n=u.find("*"),r=0;r<n.length;r+=1){var a=n[r];0===a.scrollTop&&0===a.scrollLeft||t.push([a,a.scrollLeft,a.scrollTop])}e=u.find(document.activeElement);u.contents().unwrap();for(var o=0,i=t;o<i.length;o++){var s=_slicedToArray(i[o],3),c=s[0],l=s[1],s=s[2];c.scrollLeft=l,c.scrollTop=s}e.length&&e[0].focus()}else u.removeClass("transition-in").removeAttr("data-t8n")}))},debounce:function(e){function t(){300<Date.now()-l||s<=u?(u=n=0,p=!i,o?(e(c),c=[]):e.apply(void 0,_toConsumableArray(c)),p=!1):n=requestAnimationFrame(t)}var n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=r.batch,o=void 0!==a&&a,a=r.recur,i=void 0!==a&&a,a=r.maxWait,s=void 0===a?1/0:a,c=[],l=0,u=0,p=!1;return function(){var e;p||(e=Date.now(),u+=e-l,l=e,o?c.push(arguments):c=arguments,n&&cancelAnimationFrame(n),n=requestAnimationFrame(t))}},impossible:function(e,t){window.console&&console.error(e+"(): "+t)},onStartup:function(e){l?l.push(e):e()},get storyElement(){return i},detachStoryElement:function(){document.documentElement.contains(i[0])&&(c=i.parent(),i.detach())},reattachStoryElement:function(){document.documentElement.contains(i[0])||(c||d(document.body)).append(i.parents().length?i.parents().last():i)},options:{speedMultiplier:1}};return d(function(){i=d("tw-story"),l.forEach(function(e){return e()}),l=null}),Object.freeze(v)}),define("datatypes/assignmentrequest",["utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/varref","internaltypes/twineerror"],function(e,y,b,v,w){var k=e.objectName,S=e.matches,t=e.toSource;return Object.freeze({assignmentRequest:!0,TwineScript_TypeName:"a VariableToValue (a 'to' or 'into' expression)",TwineScript_ObjectName:"a VariableToValue (a 'to' or 'into' expression)",TwineScript_ToSource:function(){return"into"===this.operator?"".concat(t(this.src)," ").concat(this.operator," ").concat(t(this.dest)):"".concat(t(this.dest)," ").concat(this.operator," ").concat(t(this.src))},TwineScript_Unstorable:!0,set:function(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=[],r=function e(t,n,r){var a=!(2<arguments.length&&void 0!==r)||r,o=[],i=n&&v.isPrototypeOf(n)?n.get():n;if(w.containsError(i))return i;if(Array.isArray(i)&&Array.isArray(t)){for(var s=0,c=0;s<t.length&&c<i.length;){var l=t[s],u=i[c];if(y.isPrototypeOf(l)&&l.datatype.rest||b.isPrototypeOf(l)&&l.rest){for(var p=c;c<i.length&&S(l,u);)u=i[c+=1];y.isPrototypeOf(l)?l.datatype=[l.datatype]:b.isPrototypeOf(l)&&(l=b.create("array")),o=o.concat(e(l,v.isPrototypeOf(n)?v.create(n,{first:p+1,last:c+1}):i.slice(p,c)))}else o=o.concat(e(l,v.isPrototypeOf(n)?v.create(n,c+1):u)),c+=1;s+=1}return s<t.length?a&&w.create("operation","I can't unpack this array because it needs ".concat(t.length-s," more value").concat(0<t.length-s?"s":"",".")):o}if(t instanceof Map&&i instanceof Map){var d,f=_createForOfIteratorHelper(t.entries());try{for(f.s();!(d=f.n()).done;){var h=_slicedToArray(d.value,2),m=h[0],g=h[1];if(!i.has(m))return a&&w.create("operation","I can't unpack this datamap because it needs a '"+m+"' data name.");o=o.concat(e(g,v.isPrototypeOf(n)?v.create(n,m):i.get(m)))}}catch(e){f.e(e)}finally{f.f()}return o}if(y.isPrototypeOf(t)){if("function"==typeof t.datatype.destructure)return[{dest:t,value:i,src:n}].concat(t.datatype.destructure(i));if(!S(i,t.datatype))return a&&w.create("operation","I can't put ".concat(k(i)," into ").concat(t.varRef.TwineScript_ToSource()," because it doesn't match ").concat(t.varRef.TwineScript_ToSource(),"'s datatype, ").concat(k(t.datatype),"."));o=o.concat(e(t.datatype,i))}return v.isPrototypeOf(t)||y.isPrototypeOf(t)?o.concat({dest:t,value:i,src:n}):"function"==typeof t.destructure?o.concat(t.destructure(i)):S(i,t)?o:a&&w.create("operation","I tried to unpack, but "+k(t)+" in the pattern didn't match "+k(i)+".")}(this.dest,this.src);if(e=w.containsError(r))return e;if(!r.length)return w.create("operation","I can't store a new value inside "+k(this.dest)+" that isn't in a variable.","You need a variable, or a data structure containing variables at certain positions, to store the value.");var a,o=_createForOfIteratorHelper(r.reverse());try{for(o.s();!(a=o.n()).done;){var i=a.value,s=i.dest,c=i.value,l=i.src;if(y.isPrototypeOf(s)){if(e=w.containsError(s.defineType()))return e;s=s.varRef}if(e=s.set(c,this.srcRef),w.isPrototypeOf(e))return e;t&&l&&l.delete(),n.shift(k(s)+" is now "+k(c))}}catch(e){o.e(e)}finally{o.f()}return n.join("; ")},create:function(e,t,n,r){return w.containsError(e)?e:w.containsError(t)?t:Object.assign(Object.create(this),{dest:e,src:t,operator:n,srcRef:r})}})}),define("datatypes/changercommand",["utils","utils/operationutils","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r){var i=e.plural,a=e.impossible,o=t.is,s=t.toSource,c={},l={TwineScript_TypeID:"changer",TwineScript_TypeName:"a changer",TwineScript_Print:function(){return"`[A ("+this.macroName+":) changer]`"},TwineScript_ToSource:function(){return"("+this.macroName+":"+("else"===this.name?"":this.params.map(s))+")"+(this.next?"+"+this.next.TwineScript_ToSource():"")},get TwineScript_ObjectName(){1===this.params.length&&36<(e=s(this.params[0])).length&&(e=void 0);for(var e,t="a (".concat(this.macroName,":").concat(e||"",") changer"),n=this.next,r=(n&&(t+=" combined with "),0);n&&t.length<48;){var a="(".concat(n.macroName,":)");t+=(0<r&&!n.next?" and ":"")+a+(n.next?", ":""),n=n.next,r+=1}for(var o=0;n&&o<99;)n=n.next,o+=1;return 0<o&&(t+="".concat(0<r?" and ":"").concat(i(o,"other changer"))),t},summary:function(){var e=n.create();return this.run(e),e.summary()},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)||a("ChangerCommand.create","params was not an array but "+t),Object.assign(Object.create(this),{macroName:e,params:t,next:n,canEnchant:r})},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t.canEnchant=this.canEnchant&&e.canEnchant,t},TwineScript_is:function(e){if(l.isPrototypeOf(e))return this.macroName===e.macroName&&o(this.params,e.params)&&o(this.next,e.next)},TwineScript_Clone:function(){for(var e=l.create(this.macroName,this.params,this.next),t=e;t.next;)t=t.next=t.next.TwineScript_Clone();return e.canEnchant=this.canEnchant,e},run:function(e,t){var n="output"===this.macroName?[t||this]:this.params,n=c[this.macroName].apply(c,[e].concat(_toConsumableArray(n)));if(r.containsError(n))return n;this.next&&this.next.run(e,t||this)},register:function(e,t){c[e]=t}};return Object.freeze(l)}),define("datatypes/codehook",[],function(){var t=Object.freeze({TwineScript_TypeName:"a code hook",TwineScript_ObjectName:"a code hook",TwineScript_ToSource:function(){return this.source},TwineScript_Print:function(){return this.code},TwineScript_toString:function(){return this.source},TwineScript_is:function(e){return t.isPrototypeOf(e)&&this.source===e.source},TwineScript_Clone:function(){return t.create(this.code,this.source)},create:function(e,t){return Object.assign(Object.create(this),{code:e,source:t})}});return t}),define("datatypes/colour",["jquery"],function(c){var l=Math.max,u=Math.min,a=Math.sin,o=Math.cos,i=Math.pow,p=Math.round,d=Math.floor,s=Math.atan2,f=Math.cbrt,h=Math.sqrt,m=Math.PI,g=Object.assign,y=Object.create,b=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,t=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,v=y(null);function w(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(0<r.length)return w.apply(void 0,[w(e,t)].concat(r));if(!t)return e;for(var o=[],i=0;i<e.length;i++){o[i]=[];for(var s=0;s<t[0].length;s++){for(var c=0,l=0;l<e[0].length;l++)c+=e[i][l]*t[l][s];o[i][s]=c}}return o}function n(e){var t,n=e.r,r=e.g,a=e.b,e=e.a,o=l(n/=255,r/=255,a/=255),i=u(n,r,a),s=(o+i)/2,c=o-i;if(o===i)return{h:0,s:0,l:s};switch(o){case n:t=(r-a)/c+(r<a?6:0);break;case r:t=(a-n)/c+2;break;case a:t=(n-r)/c+4}return{h:t=p(60*t),s:.5<s?c/(2-o-i):c/(o+i),l:s,a:e}}var k=[.9642956764295677,1,.8251046025104602],S=24389/27,T=216/24389,_=function(e){return e.map(function(e){return[e]})},x=function(e){return e.map(function(e){return e[0]})};function O(e){var t=e.l,n=e.c,r=e.h,e=e.a,n=[t*=100,n*o(r*m/180),n*a(r*m/180)],r=[];r[1]=(n[0]+16)/116,r[0]=n[1]/500+r[1],r[2]=r[1]-n[2]/200;n=[i(r[0],3)>T?i(r[0],3):(116*r[0]-16)/S,S*T<t?i((16+t)/116,3):t/S,i(r[2],3)>T?i(r[2],3):(116*r[2]-16)/S].map(function(e,t){return e*k[t]}),t=_slicedToArray(x(w([[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]],w([[.9554734527042182,-.023098536874261423,.0632593086610217],[-.028369706963208136,1.0099954580058226,.021041398966943008],[.012314001688319899,-.020507696433477912,1.3303659366080753]],_(n)))).map(function(e){return u(255,l(0,255*(.0031308<(e=e)?1.055*i(e,1/2.4)-.055:12.92*e)))}),3);return{r:t[0],g:t[1],b:t[2],a:e}}function e(e){function t(e){return 1e-5<=n[e]&&n[e]<=255-1e-5}var n=O(e);if(Object.keys(n).every(t))return n;var r=(e=_objectSpread({},e)).c,a=0;for(e.c/=2;1e-5<r-a;)n=O(e),Object.keys(n).every(t)?a=e.c:r=e.c,e.c=(r+a)/2;return O(e)}var A=Object.freeze({TwineScript_TypeID:"colour",TwineScript_TypeName:"a colour",TwineScript_ObjectName:"a colour",TwineScript_DebugName:function(){return"a colour "+this.TwineScript_Print()},"TwineScript_+":function(e){var t=this.toRGBA(),e=e.toRGBA();return A.create({r:u(p(.6*(t.r+e.r)),255),g:u(p(.6*(t.g+e.g)),255),b:u(p(.6*(t.b+e.b)),255),a:(t.a+e.a)/2})},TwineScript_Print:function(){var e=this.toRGBA();return"<tw-colour style='background-color:rgba("+[e.r,e.g,e.b,e.a]+");'></tw-colour>"},TwineScript_is:function(e){var t;return!!A.isPrototypeOf(e)&&(e.lcha&&this.lcha?e.lcha.l===this.lcha.l&&e.lcha.c===this.lcha.c&&e.lcha.h===this.lcha.h&&e.a===this.a:(t=this.toRGBA(),(e=e.toRGBA()).r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a))},TwineScript_Clone:function(){return A.create(this)},toRGBAString:function(){var e=this.toRGBA(),t=e.r,n=e.g,r=e.b,e=e.a;return"rgba(".concat(t,", ").concat(n,", ").concat(r,", ").concat(e,")")},toHSLA:function(){return n(this.toRGBA())},toRGBA:function(){return this.lch?e(_objectSpread({a:this.a},this.lch)):this},toLCHA:function(){return this.lch?_objectSpread({a:this.a},this.lch):(t=(e=this).r,n=e.g,r=e.b,e=e.a,n=[116*(t=x(w([[1.0479298208405488,.022946793341019088,-.05019222954313557],[.029627815688159344,.990434484573249,-.01707382502938514],[-.009243058152591178,.015055144896577895,.7518742899580008]],w([[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],_([t/255,n/255,r/255].map(function(e){return e<.04045?e/12.92:i((e+.055)/1.055,2.4)}))))).map(function(e,t){return e/k[t]}).map(function(e){return T<e?f(e):(S*e+16)/116}))[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])],r=180*s(n[2],n[1])/m,{l:n[0]/100,c:h(i(n[1],2)+i(n[2],2)),h:0<=r?r:360+r,a:e});var e,t,n,r},LCHRotate:function(e){e<0&&(e=360+e);var t=this.toLCHA();return t.h=(t.h+e)%360,A.create(t)},TwineScript_GetProperty:function(e){var t;return"lch"===e?(t=this.toLCHA(),new Map([["l",t.l],["c",t.c],["h",t.h]])):(t=this.toRGBA(),"h"===e||"s"===e||"l"===e?n(t)[e]:"r"===e||"g"===e||"b"===e||"a"===e?t[e]:void 0)},TwineScript_Properties:["h","s","l","r","g","b","a","lch"],TwineScript_ToSource:function(){if(0===this.a)return"transparent";var e=!this.lch&&n(this);if(1===e.l&&!e.h&&!e.s)return"white";if(0===e.l&&!e.h&&!e.s)return"black";if(.5<=e.l&&e.l<.5334&&0===e.s)return"gray";if(.5===e.l&&.8<=e.s&&e.s<.804){var t={0:"red",30:"orange",60:"yellow",90:"lime",120:"green",180:"cyan",210:"blue",240:"navy",270:"purple",300:"magenta"}[e.h];if(t)return t}return"(".concat(this.lch?"lch":"hsl",":").concat(this.lch?[this.lch.l,this.lch.c,this.lch.h]:[e.h,e.s,e.l]).concat(1!==this.a?","+this.a:"",")")},create:function(e){var t,n,r,a,o,i;return"string"==typeof e?this.create((A.isHexString(e)?function(e){return"string"!=typeof e?e:(e=(e=e.replace("#","")).replace(b,"$1$1$2$2$3$3"),{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)})}:function(e){var t;return e in v?v[e]:(t="transparent"===(t=c("<p>").css("background-color",e).css("background-color"))?{r:0,g:0,b:0,a:0}:t.startsWith("rgb")?t.match(/\d+/g).reduce(function(e,t,n){return e["rgb"[n]]=+t,e},{}):{r:192,g:192,b:192},v[e]=t)})(e)):!("h"in e&&"s"in e&&"l"in e)||"r"in e||"g"in e||"b"in e?("a"in e&&"number"==typeof e.a||(e.a=1),"h"in e&&"c"in e&&!("s"in e)&&"l"in e?g(y(this),{a:e.a,lch:{l:e.l,c:e.c,h:e.h}}):g(y(this),e)):this.create((a=(t=e).h,o=e.s,i=e.l,t=e.a,0===o?{r:e=d(255*i),g:e,b:e}:(r=2*i-(n=i<.5?i*(1+o):i+o-i*o),{r:d(255*s((a/=360)+1/3)),g:d(255*s(a)),b:d(255*s(a-1/3)),a:t})));function s(e){return e<0&&(e+=1),1<e&&--e,e<1/6?r+6*(n-r)*e:e<.5?n:e<2/3?r+(n-r)*(2/3-e)*6:r}},isHexString:function(e){return"string"==typeof e&&"#"===e[0]&&(e.slice(1).match(b)||e.slice(1).match(t))},isCSS3Function:function(e){return"string"==typeof e&&/^(?:rgb|hsl)a?\(\s*\d+(?:\.\d+)?\s*,\s*\d+(?:\.\d+)?%?\s*,\s*\d+(?:\.\d+)?%?(?:,\s*\d+(?:\.\d+)?\s*)?\)$/.test(e)}});return A}),define("datatypes/customcommand",["internaltypes/changedescriptor","internaltypes/twineerror"],function(l,u){var p=Object.assign,d=Object.create;return Object.seal({TwineScript_TypeID:"command",TwineScript_ObjectName:"a custom command",TwineScript_TypeName:"a custom command",TwineScript_Print:function(){return"`[a custom command]`"},create:function(e){var t,n=e.toSource,r=e.changer,a=e.hook,o=e.variables,i={};for(t in o)i[t]=[o[t]];var s,c=l.create({source:a,loopVars:i},r);return u.containsError(c)?c:s=p(d(this),{TwineScript_Attach:function(e,t){c.section=e;e=t.run(c);return u.containsError(e)?e:s},TwineScript_Run:function(e){c.section=e;e=c;return c=l.create({source:a,loopVars:i},r),e},TwineScript_ToSource:function(){return n},TwineScript_CustomCommand:function(){return e}})}})}),define("datatypes/custommacro",["jquery","utils","renderer","utils/operationutils","datatypes/customcommand","internaltypes/varref","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(v,e,w,t,k,S,T,_,x){function n(b){return function(e){b.called+=1;for(var t=b.varNames,n=b.params,r=b.body,a=C(E(T),{TwineScript_VariableStore:{type:"temp",name:b.TwineScript_ObjectName+" call #"+b.called},TwineScript_TypeDefs:E(null)}),o=[],i=0,s=arguments.length,c=new Array(1<s?s-1:0),l=1;l<s;l++)c[l-1]=arguments[l];for(var u=0;u<c.length;u+=1){var p=c[u],d=t[i],f=(a.TwineScript_TypeDefs[d]=n[i].datatype.rest?n[i].datatype.create("array"):n[i].datatype,S.create(a,d));if(_.containsError(f))return f;if(n[i].datatype.rest){var h=(a[d]||[]).concat([p]);if(u<c.length-1){a[d]=h;continue}f.set(h)}else f.set(p),i+=1;o.push(x.create(O(f)+" is now "+O(a[d])))}if(c.length&&(i+=1),null!=(m=n[i])&&m.datatype.rest){var m=S.create(a,t[i]);if(_.containsError(m))return m;m.set([]),a.TwineScript_TypeDefs[name]=n[i].datatype.create("array")}var g,m=v("<p>").append(w.exec(r.code)),y=e.stack.length,r=(e.stack.unshift({tempVariables:a,dom:m,output:function(e){g=e}}),e.evalReplay);for(e.evalReplay=null,e.execute();e.stack.length>y;)e.stack.shift();e.evalReplay=r;r=m.find("tw-error");return r.length?(m.prepend(o.map(function(e){return e.render()}),"<br>"),_.create("propagated","".concat(r.length," error").concat(1<r.length?"s":""," occurred when running ").concat(b.TwineScript_ObjectName,"."),void 0,m)):void 0===g?_.create("custommacro","".concat(b.TwineScript_ObjectName," didn't output any data or hooks using (output:) or (output-data:).")):"object"===_typeof(g)&&"changer"in g?k.create(C(g,{toSource:"(".concat(b.TwineScript_KnownName||"unnamed",":").concat(c.map(A),")")})):g}}var r=e.andList,O=t.objectName,a=t.typeName,o=t.matches,A=t.toSource,C=Object.assign,E=Object.create,i=Object.seal({TwineScript_TypeID:"macro",TwineScript_TypeName:"a custom macro",TwineScript_GetProperty:function(e){if("params"===e)return _toConsumableArray(this.params)},TwineScript_Properties:["params"],TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},TwineScript_Clone:function(){var e=C(E(i),this);return e.fn=n(e),e},TwineScript_ToSource:function(){return"(macro:"+this.params.map(function(e){return e.TwineScript_ToSource()}).concat("")+this.body.TwineScript_ToSource()+")"},createFromFn:function(e,t,n,r){return C(E(i),{params:[],fn:e,typeSignature:r,TwineScript_ObjectName:t,TwineScript_ToSource:n,TwineScript_KnownName:""})},create:function(e,t){t=C(E(i),{params:e,called:0,varNames:e.map(function(e){return e.varRef.propertyChain[0]}),typeSignature:e.map(function(t){var e=t.datatype.toTypeSignatureObject?t.datatype.toTypeSignatureObject({rest:t.rest}):{pattern:"range",range:function(e){return o(t.datatype,e)},name:a(t.datatype)};return t.rest?{pattern:"zero or more",innerType:e}:e}),body:t,TwineScript_KnownName:"",TwineScript_ObjectName:"a custom macro (with ".concat(e.length?r(e.map(A)):"no params",")")});return t.fn=n(t),t}});return i}),define("datatypes/datatype",["utils","utils/operationutils","datatypes/changercommand","datatypes/colour","datatypes/gradient","datatypes/lambda","datatypes/custommacro","datatypes/codehook","internaltypes/twineerror"],function(e,t,n,r,a,o,i,s,c){var l=e.realWhitespace,u=e.anyRealLetter,p=e.anyCasedLetter,d=e.anyNewline,f=t.objectName,e=Object.seal,h=Object.keys,m=Math.floor,g=Math.abs,y={TwineScript_TypeID:"datatype",TwineScript_TypeName:"a datatype",TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},get TwineScript_ObjectName(){return"the "+(this.rest?"...":"")+this.name+" datatype"},TwineScript_is:function(e){return y.isPrototypeOf(e)&&e.name===this.name},TwineScript_Clone:function(){return this.rest?this:Object.create(this)},TwineScript_ToSource:function(){return(this.rest?"...":"")+this.name},TwineScript_IsTypeOf:function(e){var t=this.name,n=this.rest;return!!v[t]&&v[t](e,n)},toTypeSignatureObject:function(){var e=this.name,e={pattern:"range",range:v[e],name:"a "+("dm"===e?"datamap":"ds"===e?"dataset":"num"===e?e+"ber":"str"===e?e+"ing":"color"===e?"colour":"bool"===e?e+"ean":"alnum"===e?"alphanumeric character":"int"===e?e+"eger":"even"===e||"odd"===e?e+" number":e.endsWith("case")||"whitespace"===e?e+" character":"empty"===e?e+" value":e)};return this.rest?{pattern:"zero or more",innerType:e}:e},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=(e="datamap"===e?"dm":"dataset"===e?"ds":"number"===e?"num":"string"===e?"str":"color"===e?"colour":"boolean"===e?"bool":"alphanumeric"===e?"alnum":"integer"===e?"int":"newline"===e?"linebreak":e,Object.create(this));return n.name=e,n.rest=t,n},from:function(t){var e=h(b).find(function(e){return b[e](t)});return e?y.create(e):c.create("datatype",f(t)+" doesn't correspond to a datatype value.")}},b={array:Array.isArray,dm:function(e){return e instanceof Map},ds:function(e){return e instanceof Set},datatype:function(e){return y.isPrototypeOf(e)},changer:function(e){return n.isPrototypeOf(e)},colour:function(e){return r.isPrototypeOf(e)},gradient:function(e){return a.isPrototypeOf(e)},lambda:function(e){return o.isPrototypeOf(e)},macro:function(e){return i.isPrototypeOf(e)},codehook:function(e){return s.isPrototypeOf(e)},command:function(e){return e&&"command"===e.TwineScript_TypeID},str:function(e){return"string"==typeof e},num:function(e){return"number"==typeof e},bool:function(e){return"boolean"==typeof e}},v=_objectSpread(_objectSpread({},b),{},{even:function(e){return!isNaN(e)&&m(g(e))%2==0},odd:function(e){return!isNaN(e)&&m(g(e))%2==1},empty:function(e){return e instanceof Map||e instanceof Set?!e.size:!(!Array.isArray(e)&&"string"!=typeof e||e.length)},int:function(e){return"number"==typeof e&&e===(0|e)},uppercase:function(e){return"string"==typeof e&&1===_toConsumableArray(e).length&&_toConsumableArray(e).every(function(e){return e!==e.toLowerCase()})},lowercase:function(e){return"string"==typeof e&&1===_toConsumableArray(e).length&&_toConsumableArray(e).every(function(e){return e!==e.toUpperCase()})},whitespace:function(e){return"string"==typeof e&&!!e.match("^"+l+"$")},digit:function(e){return"string"==typeof e&&!!e.match("^\\d$")},alnum:function(e){return"string"==typeof e&&!!e.match("^"+u+"$")},anycase:function(e){return"string"==typeof e&&!!e.match("^"+p+"$")},linebreak:function(e){return"string"==typeof e&&!!e.match("^"+d+"$")},any:function(){return!0},const:function(){return!0}});return e(y)}),define("datatypes/gradient",["utils/operationutils"],function(e){var t=e.toSource,n=Object.freeze({TwineScript_TypeID:"gradient",TwineScript_TypeName:"a gradient",TwineScript_ObjectName:"a gradient",TwineScript_DebugName:function(){return"a gradient "+this.TwineScript_Print()},TwineScript_GetProperty:function(e){var t=this;return"angle"===e?this.angle:"stops"===e?this.stops.map(function(e){return new Map([[t.repeating?"pixels":"percent",e.stop],["colour",e.colour.TwineScript_Clone()]])}):void 0},TwineScript_Properties:["angle","stops"],TwineScript_ToSource:function(){return"(gradient:"+this.angle+","+this.stops.map(function(e){return t(e.stop)+","+t(e.colour)})+")"},TwineScript_is:function(e){var r=this;return e.angle===this.angle&&e.stops.length===this.stops.length&&e.stops.every(function(e,t){var n=e.colour,e=e.stop;return r.stops[t].stop===e&&r.stops[t].colour.TwineScript_is(n)})},TwineScript_Clone:function(){return n.create(this.angle,_toConsumableArray(this.stops))},TwineScript_Print:function(){return"<tw-colour style='background:"+this.toLinearGradientString()+"'></tw-colour>"},create:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return Object.assign(Object.create(this),{angle:e,stops:t.sort(function(e,t){return e.stop-t.stop}),repeating:n})},multiply:function(t){return n.create(this.angle,this.stops.map(function(e){return{colour:e.colour,stop:e.stop*t}}))},toLinearGradientString:function(){var r=this;return(this.repeating?"repeating-":"")+"linear-gradient(".concat(this.angle,"deg, ").concat(this.stops.reduce(function(e,t){var n=t.colour,t=t.stop;return e+n.toRGBAString()+" "+t*(r.repeating?1:100)+(r.repeating?"px,":"%,")},"").slice(0,-1),")")}});return n}),define("datatypes/hookset",["jquery","utils","utils/renderutils","utils/operationutils"],function(g,s,e,t){var y=e.textNodeToChars,b=e.realWhitespace,c=e.findTextInNodes,r=t.toSource;function l(e){function t(n,e){if(Array.isArray(e))return e.reduce(function(e,t){return e.add(n.get(t))},g());if(e&&"object"===_typeof(e)&&"first"in e&&"last"in e){for(var t=e.first,r=e.last,a=n.length,o=(t<0&&(t+=a),r<0&&(r+=a),[n.get(t)]);t!==r;)t+=Math.sign(r-t),o.push(n.get(t));return g(o)}if("string"==typeof e){if("chars"===e){var i,s=[],c=_createForOfIteratorHelper(n.textNodes(m));try{for(c.s();!(i=c.n()).done;){var l,u=i.value,p=_createForOfIteratorHelper(y(u));try{for(p.s();!(l=p.n()).done;){var d=l.value;d.textContent.match(b)||s.push(d)}}catch(e){p.e(e)}finally{p.f()}}}catch(e){c.e(e)}finally{c.f()}return g(s)}if("links"===e)return n.findAndFilter("tw-link, .enchantment-link");if("visited"===e)return n.findAndFilter("tw-link.visited");var f,h;if("lines"===e)return f=n.findAndFilter("br:not(tw-sidebar *),tw-consecutive-br:not(tw-sidebar *)").get(),h=[[]],n.contents().each(function e(t,n){var r=(n.tagName||"").toLowerCase();if("tw-sidebar"!==r)if("tw-passage"===r||"tw-transition-container"===r)g(n).contents().each(e);else{if(f.length){if(n===f[0])return f.shift(),void h.push([]);if(16&n.compareDocumentPosition(f[0]))return h.push([]),g(n).contents().each(e),void h.push([])}h[h.length-1].push(n)}}),g(h.map(function(e){return!!e.length&&g(e).wrapAll("<tw-pseudo-hook>").parent()[0]}).filter(Boolean))}return g(n.get(e))}var n,r,a=e.dom,m=":not(tw-error, tw-error *)",o=g();this.next&&(o=o.add(l.call(this.next,e)));if(this.selector){if("string"===this.selector.type)i=this.selector.data,n=c((n=a).textNodes(),i),r=g(),n.forEach(function(e){r=r.add(g(e).wrapAll("<tw-pseudo-hook>").parent())}),i=r;else{if("base"===this.selector.type)return o.add(t(l.call(this.selector.data,e),this.property));n=this.selector.data,e='tw-hook[name="'+(n=s.insensitiveName(n).replace(/"/g,"&quot;"))+'"],tw-enchantment[name="'+n+'"]';var e=e+={page:", tw-story",passage:", tw-passage",sidebar:", tw-sidebar",link:", tw-link, .enchantment-link"}[n]||"",i=a.findAndFilter(e).add(a.parentsUntil(s.storyElement.parent())).filter(e)}o=this.property?o.add(t(i,this.property)):o.add(i)}return o=o.get().reduce(function(e,t){return t=g(t),e.add(t.is("tw-enchantment")&&t.contents().length<=1?t.contents():t)},g())}function a(e){var t,n;return e?(t=e.selector,n=e.property,e=e.next,[JSON.stringify(["base"===t.type?a(t.data):s.insensitiveName(t.data),n])].concat(_toConsumableArray(a(e))).sort()):[]}var o=Object.freeze({forEach:function(e,n){var t=l.call(this,e).each(function(e,t){return n(g(t),e)});return e.dom.findAndFilter("tw-pseudo-hook").contents().unwrap(),t},hooks:function(e){return l.call(this,e)},get TwineScript_ObjectName(){return"the hook name ".concat(this.TwineScript_ToSource())},TwineScript_TypeID:"hookName",TwineScript_TypeName:"a hook name (like ?this)",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){var e="",t=this.selector,n=t.type,t=t.data;return"name"===n?t.match(RegExp("^"+s.anyRealLetter+"+$"))?e+="?"+t:e+="(hooks-named:"+JSON.stringify(t)+")":"string"===n?e+=JSON.stringify(t):"base"===n&&(e+=t.TwineScript_ToSource()+"'s "+r(this.property,"property")),this.next&&(e+=" + "+this.next.TwineScript_ToSource()),e},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){return a(this)+""==a(e)+""},TwineScript_GetProperty:function(e){return o.create({type:"base",data:this},e,void 0)},TwineScript_Properties:["chars","links","lines","visited"],TwineScript_Clone:function(){return o.create(this.selector,this.property,this.next)},create:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;return Object.assign(Object.create(this||o),{selector:Object.freeze(e),property:t,next:n})},from:function(e){return o.isPrototypeOf(e)||"string"==typeof e||s.impossible("HookSet.from() was given a non-HookSet non-string."),o.isPrototypeOf(e)?e:o.create({type:"string",data:e})}});return o}),define("datatypes/lambda",["utils/operationutils","internaltypes/varscope","internaltypes/varref","internaltypes/twineerror"],function(e,h,s,m){var g=e.objectName;var c=Object.freeze({TwineScript_TypeID:"lambda",TwineScript_TypeName:"a lambda",get TwineScript_ObjectName(){return'a "'+("making"in this?"making ... ":"")+("each"in this?"each ... ":"")+("where"in this?"where ... ":"")+("when"in this?"when ... ":"")+("via"in this?"via ... ":"")+'" lambda'},TwineScript_Print:function(){return"`[A lambda]`"},TwineScript_is:function(e){return e===this},TwineScript_ToSource:function(){return this.source},TypeSignature:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"lambda",innerType:c,clauses:t,typeName:'a "'+t.concat("").join(" ...")+'" lambda'}},TwineScript_Clone:function(){return Object.assign(Object.create(c),this)},create:function(e,t,n,r){var a,o="temp variable, or typed temp variable";function i(e){e=e&&e.varRef?e.varRef:e;return void 0===e||e&&s.isPrototypeOf(e)&&h.isPrototypeOf(e.object)&&1===e.propertyChain.length}if(m.containsError(n))return n;if("making"===t&&!i(n))return m.create("syntax","I need a "+o+", to the right of '"+t+"', not "+g(n)+".");if(m.containsError(e))return e;if(c.isPrototypeOf(e)){if("when"===t||"when"in e)return m.create("syntax","A 'when' lambda cannot have any other clauses, such as '"+t+"'.");if(t in e)return m.create("syntax","This lambda has two '"+t+"' clauses.");a=e}else{if("when"===t&&void 0!==e)return m.create("syntax","A 'when' lambda shouldn't begin with a temp variable (just use 'when' followed by the condition).");if(!i(e))return m.create("syntax","This lambda needs to start with a single "+o+", not "+g(e)+".");(a=Object.create(this)).loop=e||""}return a.source=r.trim(),a[t]=n,a.making&&a.making.getName()===(a.loop&&a.loop.getName())?m.create("syntax","This lambda has two variables named '"+a.loop.getName()+"'.","Lambdas should have all-unique parameter names."):a},apply:function(e,t){var n=t.loop,r=t.pos,a=t.making,o=t.ignoreVia;function i(e,t){if(e){var n,r;if("datatype"in e&&"varRef"in e)return n=e.varRef.create(s,e.varRef.propertyChain),m.containsError(n)?n:(r=n.defineType(e.datatype),m.containsError(r)||(r=n.set(t),m.containsError(r))?r:void 0);s[e.getName()]=t}}var s=(s=t.tempVariables)||Object.create(e.stack.length?e.stackTop.tempVariables:h),t=i(this.loop,n)||i(this.making,a);if(m.containsError(t))return t;e.stack.unshift(Object.assign(Object.create(e.stackTop||null),{tempVariables:s,lambdaPos:this.when?void 0:r})),!n||this.making||this.when?e.Identifiers.it=m.create("operation","I can't use 'it', or an implied 'it', in "+this.TwineScript_ObjectName):e.Identifiers.it=n;var c,l,u,p,d,t=!o&&this.via,o="where"in this||"when"in this,f=e.evalReplay;return e.evalReplay=f?[]:null,o?(c=e.eval(this.where||this.when),l=e.evalReplay,e.evalReplay=l&&t?[]:null,!n||this.making||this.when||(e.Identifiers.it=n),u=c,p=!t||e.eval(t),d=null,u=m.containsError(u)||("boolean"!=typeof u?m.create("operation","This lambda's 'where' clause must evaluate to true or false, not "+g(u)+"."):u?p:d)):c=u=!t||e.eval(t),p=t?e.evalReplay:null,e.stack.shift(),(e.evalReplay=f)&&(o||t)&&(((d=f[f.length-1])||{}).lambda&&d.lambda.obj===this||((d={lambda:{obj:this,loops:[]},code:(f[f.length-1]||{}).code||""}).fromCode=d.code,f.push(d)),d.lambda.loops.push(_objectSpread(_objectSpread(_objectSpread({it:n,pos:r},void 0!==a&&{making:a}),t&&{viaReplay:p,viaResult:u}),o&&{whereReplay:l,whereResult:null!==c&&c}))),u},filter:function(r,e){var a,o=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return e.reduce(function(e,t,n){return a||(n=o.apply(r,{loop:t,pos:n+1,ignoreVia:!0,tempVariables:i}),a=m.containsError(n))||e.concat(n?[t]:[])},[])}});return c}),define("datatypes/typedvar",["utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(e,a,o){var i=e.typeName,t=e.matches,n=e.toSource,s=e.unstorableValue,e=Object.freeze,c=Object.assign,l=Object.create,u=e({TwineScript_TypeName:"a TypedVar (typed variable name)",get TwineScript_ObjectName(){var e=n(this.datatype);return"the ".concat(e.length<24?e+"-":"","typed variable name, ").concat(this.varRef.TwineScript_ToSource())},TwineScript_Print:function(){return"`[A typed variable name]`"},TwineScript_Unstorable:!0,TwineScript_Clone:function(){return c(l(u),{datatype:this.datatype.TwineScript_Clone(),varRef:this.varRef})},TwineScript_ToSource:function(){return n(this.datatype)+"-type "+this.varRef.TwineScript_ToSource()},TwineScript_GetProperty:function(e){return"name"===e?this.getName():this[e]},TwineScript_Properties:["datatype","name"],TwineScript_IsTypeOf:function(e){return t(this.datatype,e)},get:function(){var e;return(e=this.varRef).get.apply(e,arguments)},getName:function(){return this.varRef.getName()},defineType:function(){if("any"!==this.datatype.name)return this.varRef.defineType(this.datatype)},create:function(e,t){var n,r;return(n=o.containsError(t)||o.containsError(e)||t.error)||(a.isPrototypeOf(t)?(n=t.object,r=t.compiledPropertyChain,n&&n.TwineScript_VariableStore&&1===r.length&&n.TwineScript_TypeDefs?(r=s(e))&&!u.isPrototypeOf(r)?o.create("syntax","The -type syntax can't have "+i(r)+" to its left."):c(l(this),{datatype:e,varRef:t}):o.create("unimplemented","I can only restrict the datatypes of variables, not data names or anything else.")):o.create("syntax","The -type syntax must have a variable to its right."))}});return u}),define("datatypes/varbind",["jquery","utils","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(o,e,t,n,r){var a=t.objectName;return n.on("set",function(r,a){r.TwineScript_VariableStore&&e.storyElement.find("[data-2bind]").each(function(e,t){var n=(t=o(t)).data("twoWayBindEvent");"function"==typeof n&&n(t,r,a)})}),Object.freeze({TwineScript_TypeName:"a VarBind (bound variable name)",get TwineScript_ObjectName(){return"a ".concat(this.bind," bind to ").concat(this.varRef.TwineScript_ToSource())},TwineScript_Print:function(){return"`[A bound variable name]`"},TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return("two way"===this.bind?"2":"")+"bind "+this.varRef.TwineScript_ToSource()},set:function(e){var e=this.varRef.set(e);if(e=r.containsError(e))return e},create:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"one way";return r.containsError(e)?e:n.isPrototypeOf(e)?e.error||Object.assign(Object.create(this),{varRef:e,bind:t}):r.create("operation","I can only 'bind' a variable, not "+a(e)+".")}})}),define("debugmode/highlight",["jquery","utils","utils/typecolours","macros","lexer"],function(u,e,t,p,n){var d=e.insensitiveName,f=t.versionClass,h=n.lex;return function(e,t,n,r){if(9999<e.length)return[u("<span>").text(e)];for(var a=h(e,"",t||"macro"),o=[],i="",s=a,c=a.start;c<a.end;c+=1){var l=a.pathAt(c);l[0]!==s[0]&&(o.length&&(o[o.length-1].textContent=i),i="",s=l,o.push(u("<".concat(r&&n<=c&&c<r?"mark":"span",' class="').concat(function(e){for(var t={},n="",r=0;r<e.length;r+=1){var a=e[r],o=a.type,i=a.text,s=("verbatim"!==o&&"comment"!==o||(n=""),f+o);switch(t[s]=(t[s]||0)+1,1<t[s]&&(s+="-"+t[s]),o){case"text":i.trim()&&e.slice(r+1).reduce(function(e,t){return void 0===e?"macro"===t.type||"hook"!==t.type&&e:e},void 0)&&(s+=" ".concat(f,"error"));break;case"macroName":var c,l=e[r].text[0];"_"!==l&&"$"!==l?(c=d(e[r].text.slice(0,-1)),p.has(c)?s+="-"+p.get(c).returnType.toLowerCase():s+=" ".concat(f,"error")):s+=" ".concat(f,"customMacro ").concat(f+("_"===l?"tempV":"v"),"ariable")}n+=s+" "}return n}(s),'">'))[0])),i+=a.text[c-a.start]}return o.length&&(o[o.length-1].textContent=i),o}}),define("debugmode/mode",["jquery","utils","utils/naturalsort","state","engine","internaltypes/varref","internaltypes/twineerror","utils/operationutils","utils/renderutils","passages","section","debugmode/panel","debugmode/highlight","utils/typecolours"],function(I,V,M,D,F,L,H,e,t,z,q,W,B,n){var U=e.objectName,$=e.isObject,G=e.toSource,Y=e.typeID,J=t.dialog,X=n.CSS,K=function(e,t){var f=V.escape,i=V.nth,n=V.debounce,r=I(document.documentElement),a=M(),o={darkMode:!0,fadePanel:!0,evalReplay:!0,width:null,maxHeight:400};if(D.hasStorage)try{var s=localStorage.getItem("(Debug Options "+V.options.ifid+")");s&&(o=JSON.parse(s))}catch(e){}function c(){if(D.hasStorage)try{localStorage.setItem("(Debug Options "+V.options.ifid+")",JSON.stringify(o))}catch(e){}}W.defaultMaxHeight=o.maxHeight;function l(e){return n(function(){if(V.options.debug)return e.apply(this,arguments)},{maxWait:2e3})}var h=I('<tw-debugger class="'.concat([o.darkMode?"theme-dark":"",o.fadePanel?"fade-panel":""].join(" "),'" style="').concat(o.width?"width:"+o.width+"px":"","\">\n<div class='panel panel-errors' hidden><table></table></div>\n<div class='tabs'></div>\n<label style='user-select:none'>Turns: </label><select class='turns' disabled></select>\n<button class='show-invisibles'>\ud83d\udd0d Debug View</button>\n<button class='show-dom'><span style=\"vertical-align:text-top\">&lt;</span><span style=\"vertical-align:text-bottom\">&gt;</span> DOM View</button>\n<button class='close'>\u2716</button>\n<div class='resizer-h'>\n</tw-debugger>")),s=h.find(".tabs"),u=h.find(".show-dom"),p=h.find(".show-invisibles"),d=h.find(".close"),m=h.find(".turns");I(document.documentElement).on("click","tw-expression, tw-error, tw-eval-explanation",n(function(e){var r,a,o,i,l,u,p,d,t=I(e.target).data("evalReplay");function n(){var e,s,c=r[a],t=o.find("tw-eval-explanation").empty(),n=o.find("tw-eval-code");c.toCode||c.toDesc||c.error||c.lambda?(o.find("tw-eval-code").empty().append(B(c.code,"macro",0<a&&c.start,0<a&&c.end+c.diff)),t.append(c.lambda?"":"<code class='".concat(56<c.fromCode.length?"from-block":"from-inline","'></code>"),c.error?"<span> caused an error: </span>":c.lambda?"<span>The lambda <code class='to-lambda'></code> was run, producing these results.</span>":"<span> became".concat(c.ToDesc?"\u2026":""," </span>").concat(c.toDesc?"<span class='to-desc'>".concat(f(c.toDesc),".</span>"):"<code class='to-code'></code>")),c.error?t.append(c.error):c.lambda?(s=function(e,t){return I("<".concat(e,"><code></").concat(e,">")).find("code").append(B(t,"macro")).end()},t.find(".to-lambda").append(B(c.lambda.obj.source,"macro")).end().append((e=I("<table>")).append.apply(e,[I("<tr>").append(s("th","pos"),c.lambda.obj.loop?s("th","_"+c.lambda.obj.loop.getName()).append(" / ",I("<code>").append(B("it","macro"))):s("th","it"),c.lambda.obj.making&&s("th","_"+c.lambda.obj.making.getName()),c.lambda.obj.where&&s("th","where").append(" result"),c.lambda.obj.via&&s("th","via").append(" result"))].concat(_toConsumableArray(c.lambda.loops.map(function(e){var t=e.it,n=e.pos,r=e.making,a=e.whereResult,o=e.whereReplay,i=e.viaResult,e=e.viaReplay;return I("<tr>").append(s("td",G(n)),s("td",G(t)),void 0!==r&&s("td",G(r)),null!=a&&(H.containsError(a)?I("<td>").append(a.render(c.lambda.obj.source,!0)):s("td",G(a))).append(o&&I("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",o)),null!=i&&(H.containsError(i)?I("<td>").append(i.render(c.lambda.obj.source,!0)):s("td",G(i))).append(e&&I("<tw-open-button replay label='\ud83d\udd0d'>").data("evalReplay",e)))})))))):c.toDesc||t.find(".to-code").append(B(c.toCode,"macro")),t.next().html(c.itIdentifier?'(The <code class="cm-harlowe-3-identifier">it</code> identifier now refers to '.concat(f(c.itIdentifier),".)"):"").next().text(c.reason||"")):(n.html(B(c.code,"macro")),t.html("<center>First, there was <code></code>.</center>").next().empty().next().empty()),c.lambda||t.find("code").first().append(B(c.fromCode,"macro")),o.find("mark").each(function(e,t){t.scrollIntoView()}),i.css("visibility",a<=9?"hidden":"visible"),l.css("visibility",a<=0?"hidden":"visible"),p.css("visibility",a>=r.length-1?"hidden":"visible"),d.css("visibility",a>=r.length-10?"hidden":"visible"),u.html("( ".concat(a+1,"/").concat(r.length," )"))}t&&(r=t,t=J({buttons:[{name:"Understood",confirm:!(a=0),callback:function(){return!h.find("tw-backdrop").length&&h.removeClass("show-dialog")}}]}).addClass("eval-replay"),o=I("<tw-eval-replay>".concat(1===r.length?"":"<tw-eval-code></tw-eval-code>","<tw-eval-explanation></tw-eval-explanation><tw-eval-it></tw-eval-it><tw-eval-reason></tw-eval-reason>").concat(1===r.length?"":"<tw-dialog-links><tw-link style='visibility:hidden'>\u2190 10</tw-link><tw-link style='visibility:hidden'>\u2190 \u2190</tw-link><b></b><tw-link>\u2192 \u2192</tw-link><tw-link>10 \u2192</tw-link></tw-dialog-links>","</tw-eval-replay>")),t.find("tw-dialog").css({width:"75vw","max-width":"75vw"}).prepend(o),i=o.find("tw-link:first-of-type"),l=i.next(),u=l.next(),p=u.next(),d=p.next(),n(),i.on("click",function(){a=Math.max(0,a-10),n()}),l.on("click",function(){a=Math.max(0,a-1),n()}),p.on("click",function(){a=Math.min(r.length-1,a+1),n()}),d.on("click",function(){a=Math.min(r.length-1,a+10),n()}),h.find("tw-backdrop").length?h.find("tw-backdrop").before(t):h.addClass("show-dialog").append(t));var s,t=I(e.target).data("goto");t&&(s=V.options.ignoreGotos,V.options.ignoreGotos=!1,t.command.TwineScript_Run(t.section),V.options.ignoreGotos=s),e.stopPropagation()})),h.find(".resizer-h").mousedown(function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageX,n=h.width();r.on("mousemove.debugger-resizer-h",function(e){e=e.pageX;h.width("".concat(n+t-e|0,"px"))}).on("mouseup.debugger-resizer-h",function(){r.off(".debugger-resizer-h"),o.width=h.width(),c()})}),h.on("mousedown",".resizer-v",function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageY,n=I(e.target.parentNode).height();r.on("mousemove.debugger-resizer-v",function(e){e=e.pageY;h.find(".panel").css("maxHeight","".concat(n+t-(0|e),"px"))}).on("mouseup.debugger-resizer-v",function(){r.off(".debugger-resizer-v"),o.maxHeight=h.find(".panel").css("maxHeight"),c()})}),p.click(function(){r.toggleClass("debug-mode").removeClass("dom-debug-mode"),p.toggleClass("enabled"),u.removeClass("enabled")}),u.click(function(){r.toggleClass("dom-debug-mode").removeClass("debug-mode"),u.toggleClass("enabled"),p.removeClass("enabled")}),d.click(function(){r.removeClass("debug-mode dom-debug-mode"),h.detach(),Object.assign(V.options,{debug:!1,speedMultiplier:1,ignoreClickEvents:!1,ignoreGotos:!1})});function g(e){(e=e.parents(".variable-row, .enchantment-row, .source-row")).next(".panel-row-source").find("td").empty().append(B(e.data("value")||G(e.data("enchantment").changer),e.is("source-row")?"markup":"macro"))}function y(){return k=new Set}function b(){I(document.body).append(h),V.options.debug=!0,V.options.evalReplay=o.evalReplay,V.options.speedMultiplier=1,V.options.ignoreClickEvents=!1,V.options.ignoreGotos=!1,R()}var v,w=l(function(){var r=m.children().get(),e=D.timeline,a=0;e.forEach(function(e,t){var n=e.turns,e=e.passage,n=(a+=1+(void 0===n?0:n))+": "+e;r[t]?r[t].textContent=n:m.append("<option value='".concat(t,"'>").concat(n,"</option>"))}),e.length<r.length&&I(r.slice(e.length)).remove(),m[1<=e.length?"removeAttr":"attr"]("disabled"),m.val(D.pastLength)}),k=(m.change(function(e){e=e.target.value-D.pastLength;0!=e&&(D[e<0?"rewind":"fastForward"](Math.abs(e)),F.showPassage(D.passage))}),w(),D.on("forward",w).on("load",w).on("forgetUndos",function(){return w}).on("back",function(){D.pastLength<=1&&m.attr("disabled"),m.find("[selected]").removeAttr("selected"),m.val(D.pastLength)}),new Set),S=W.create({className:"variables",tabName:"Variable",rowWrite:function(e,t){var n,r=e.name,a=e.dataset,o=e.path,i=e.value,s=e.tempScope,e=e.type,c=i&&48<i.length&&!i.TwineScript_DebugName,l=$(i)&&i.TwineScript_DebugName?i.TwineScript_DebugName():f(U(i)),u="",a=(o.length&&(u=o.reduce(function(e,t){return e+t+"'s "},"")),a&&(r="???"),e?G(e):""),e="object"===_typeof(i)||c;return t?(t[0].firstChild.innerHTML=a||"",u&&I(t[0].firstChild).children(".variable-path").html((s?"_":"$")+f(u)),t[0].childNodes[1].lastChild.textContent=(u?"":s?"_":"$")+f(r+""),t[0].childNodes[2].textContent=s||"",t[0].childNodes[3].innerHTML=l,n=(c=I(t[0].lastChild.firstChild)).is(".open"),c[e?"show":"hide"](),c=t.next(".panel-row-source"),n&&c.find("td").empty().append(B(G(i))),t.data("value",G(i)),t.add(c)):I('<div class="variable-row">').attr("data-name",r).attr("data-path",o+"").attr("data-scope",s||"").css("padding-left",Math.min(5,o.length)+"em").append("<td class='variable-type'>".concat(a||"","</td>"),"<td class='variable-name cm-harlowe-3-"+(s?"tempV":"v")+"ariable'><span class='variable-path'>"+(u?(s?"_":"$")+f(u):"")+"</span> "+(u?"":s?"_":"$")+f(r+"")+"</td>","<td class='temporary-variable-scope'>".concat(s||"","</td>"),"<td class='variable-value cm-harlowe-3-macroName-"+Y(i)+"'>"+l+"</td><td class='panel-row-buttons'><tw-folddown tabindex=0 style='display:"+(e?"visible":"none")+"'>(source:) </tw-folddown></td>").data("value",G(i)).find("tw-folddown").data("folddown",g).end().add("<tr class='variable-row panel-row-source' style='display:none'><td colspan='5'></td></tr>")},rowCheck:function(e,t){var n=e.name,r=e.path,e=e.tempScope;return t[0]&&t[0].getAttribute("data-name")===n&&t[0].getAttribute("data-path")===r+""&&t[0].getAttribute("data-scope")===e},columnHead:function(){return'<tr class="panel-head"><th data-col="variable-type">Type</th><th data-col="variable-name">Name</th><th data-col="temporary-variable-scope">Scope</th><th data-col="variable-value">Value</th></tr>'},rowSort:function(e,t,n){if("variable-value"===e)return a(t.attr("class"),n.attr("class"))||a(t.parent().data("value"),n.parent().data("value"))}}),T=l(function(){var e,t,o=[],n=D.variables,r=o.length;for(e in n)e.startsWith("TwineScript")||(r+=1,function n(e){var r,t,a;500<o.length||(o.push(e),r=e.path.concat(e.name),t=e.value,a=e.tempScope,r.length<=4&&(Array.isArray(t)?t.forEach(function(e,t){return n({name:i(t+1),path:r,value:e,tempScope:a})}):t instanceof Map?_toConsumableArray(t).forEach(function(e){var t=(e=_slicedToArray(e,2))[0],e=e[1];return n({name:t,path:r,value:e,tempScope:a})}):t instanceof Set&&_toConsumableArray(t).forEach(function(e,t){return n({name:t,dataset:!0,path:r,value:e,tempScope:a})})))}({name:e,path:[],value:n[e],tempScope:"",type:null==(t=n.TwineScript_TypeDefs)?void 0:t[e]}));o.push.apply(o,_toConsumableArray(k)),r+=k.size,S.update(o,r),0===r!==S.panel[0].classList.contains("panel-variables-empty")&&S.panel.toggleClass("panel-variables-empty")}),_=(L.on("set",function(e,t,n){var r,a;e===D.variables||"temp"!==(null==(a=e.TwineScript_VariableStore)?void 0:a.type)||null!=(a=e.TwineScript_VariableStore)&&a.name.match(/#\d+$/)||(r=null==(a=e.TwineScript_VariableStore)?void 0:a.name,e=null==(a=e.TwineScript_TypeDefs)?void 0:a[t],(a=_toConsumableArray(k).find(function(e){return e.name===t&&e.tempScope===r}))?a.value=n:k.add({name:t,path:[],value:n,tempScope:r,type:e})),T(),v()}).on("delete",function(){T(),v()}),S.panel.append("<div class='panel-variables-bottom'>\n\t\t\t<button class='panel-variables-copy'>Copy $ variables as (set:) call</button>\n\t\t\t<input class='clipboard' type=\"text\" style='opacity:0;pointer-events:none;position:absolute;'></input>\n\t\t</div>").removeAttr("hidden"),S.tab.addClass("enabled"),S.panel.find(".clipboard")),x=(r.on("click",".panel-variables-copy",function(){var e,t=[];for(e in D.variables)e.startsWith("TwineScript")||t.push("$"+e+" to "+G(D.variables[e]));_.val("(set:"+t+")")[0].select(),document.execCommand("copy")}),W.create({className:"enchantments",tabName:"Enchantment",rowWrite:function(e,t){var n=e.scope,r=e.changer,a=e.lambda,o=e.name,i=e.localHook,a=r?f(U(r)):a?f(G(a)):"<em>enchanted with ("+o+":)</em>";return t||I('<div class="enchantment-row">').data("enchantment",e).append("<td><span class='enchantment-name'>"+G(n)+(i?"</span><span class='enchantment-local cm-harlowe-3-hookName'>"+("function"==typeof i.TwineScript_ToSource?i.TwineScript_ToSource():i.attr("name")?"?"+i.attr("name"):"an unnamed hook"):"")+"</span></td><td class='enchantment-value cm-harlowe-3-macroName-"+(r?"changer":"command")+" '>"+a+"</td>"+(r?"<td class='panel-row-buttons'><tw-folddown tabindex=0>(source:)</tw-folddown></td>":"")).find("tw-folddown").data("folddown",g).end().add(r?I("<tr class='panel-row-source' style='display:none'><td colspan='3'></td></tr>"):"")},rowCheck:function(e,t){return t.data("enchantment")===e},columnHead:function(){return'<tr class="panel-head"><th data-col="enchantment-name">Scope</th><th data-col="enchantment-value">Value</th></div>'}})),d=l(function(e){x.update(e.enchantments,e.enchantments.length)}),O=(q.on("add",d).on("remove",d),q.create()),A=W.create({className:"storylets",tabName:"Storylet",rowWrite:function(e,t){var n=e.name,r=e.active,a=e.storyletSource,o=e.exclusive,e=e.urgent;return t?(t.toggleClass("storylet-closed",!r),t[0].firstChild.textContent=r?"\u2713":""):(t=I('<tr class="storylet-row '.concat(r?"":"storylet-closed",'">')).attr("data-name",n).append("<td class='storylet-open'>"+(r?"\u2713":"")+"</td><td class='storylet-name'>"+n+"</td><td class='storylet-lambda'></td><td class='storylet-exclusive'>"+o+"</td><td class='storylet-urgent'>"+e+"</td>")).find(".storylet-lambda").append(B(a.replace(/^when\s+/i,""))),t},rowCheck:function(e,t){e=e.name;return t[0].getAttribute("data-name")===f(e+"")},columnHead:function(){return'<tr class="panel-head"><th data-col="storylet-open" data-order="desc">Open</th><th data-col="storylet-name">Name</th><th data-col="storylet-lambda">Condition</th><th data-col="storylet-exclusive" class=\'storylet-exclusive\'>Exclusivity</th><th data-col="storylet-urgent" class=\'storylet-urgent\'>Urgency</th></tr>'}}),C=(A.tab.hide(),v=l(function(){var r,a,o=z.getStorylets(O),i=H.containsError(o),e=z.allStorylets();A.update(e.map(function(t){var e="number"==typeof t.get("exclusivity")?t.get("exclusivity"):0,n="number"==typeof t.get("urgency")?t.get("urgency"):0;return r=r||e,a=a||e,{name:t.get("name"),storyletSource:t.get("storylet").TwineScript_ToSource(),active:!i&&o.some(function(e){return e.get("name")===t.get("name")}),exclusive:e,urgent:n}}),i?0:o.length),A.panel.toggleClass("storylet-error",i),A.panel.toggleClass("panel-exclusive",r),A.panel.toggleClass("panel-urgent",a),e.length&&A.tab.show()}),W.create({className:"source",tabName:"Source",tabNameCounter:!1,rowWrite:function(e,t){var n=e.name,e=e.tag;return t?t.add(t.next(".panel-row-source")):(t=z.get(n).get("source"),I('<div class="source-row" data-tag="'.concat(e,'">')).data("value",t).append('<td class="source-name">'.concat(n,'</td><td class="source-tags">').concat(e,"</td><td class='panel-row-buttons'><tw-folddown class='").concat(e?"":"open","' tabindex=0></tw-folddown></td>")).find("tw-folddown").data("folddown",g).end().add(I("<tr class='panel-row-source' style='".concat(e?"display:none":"","'><td colspan='3'></td></tr>")).find("td").append(!e&&B(t,"markup")).end()))},rowCheck:function(e,t){e=e.name;return t[0].firstChild.textContent===f(e+"")},tabUpdate:I.noop,columnHead:I.noop})),E=["debug-startup","startup","header","debug-header","footer","debug-footer"].reduce(function(e,t){return e.concat(z.getTagged(t).map(function(e){return{name:e.get("name"),tag:t}}))},[]),N=W.create({className:"errors",tabName:"Error",rowWrite:I.noop,rowCheck:I.noop,columnHead:I.noop,tabUpdate:function(e){return N.tab.css({background:e?"rgba(230,101,204,0.3)":""}).text("".concat(e," Error").concat(1!==e?"s":""))}}),d=n(function(e){var t;V.options.debug&&(N.panelRows.append(e.reduce(function(e,t){var t=_slicedToArray(t,2),n=t[0],t=t[1];return"propagated"===n.type?e:e+'<tr class="error-row"><td class="error-passage">'+D.passage+'</td><td class="error-message" title="'+f(t)+'">'+n.message+"</td></tr>"},"")),500<(t=(e=N.panelRows.children()).length)&&I(Array.prototype.slice.call(N.panelRows[0].childNodes,0,t-500)).remove(),N.tabUpdate(Math.min(500,e.length)))},{batch:!0}),j=(H.on(d),N.panel.append("<div class='panel-errors-bottom'>\n\t\t\t<button class='panel-errors-clean'>\ud83e\uddf9 Clear this panel</button>\n\t\t</div>"),r.on("click",".panel-errors-clean",function(){N.panelRows.empty(),N.tabUpdate(0)}),W.create({className:"tools",tabName:"Tools",tabNameCounter:!1,rowWrite:function(e,t){var n=e.id,r=e.type,a=e.label,o=e.dropdownItems,i=e.dropdownValue;return"checkbox"===r?t?t.find("input").prop("checked",!1):I('<span><input id="debug-'.concat(n,'" type="checkbox"></input><label for="debug-').concat(n,'">').concat(a,"</label></span>")):"dropdown"===r?t?t.find("input").prop("checked",!1):I("<span>".concat(a,'<select style="width:3em" data-default="').concat(i,'" id="debug-').concat(n,'"></span>')).find("select").append(o.map(function(e){return"<option value='".concat(e,"' ").concat(e===i?"selected":"",">").concat(e,"x</option>")})).end():void 0},rowCheck:I.noop,columnHead:I.noop,tabUpdate:function(e){return j.tab.css({background:e?"hsla(210, 72%, 65%, .3)":""})}})),P=(r.on("click, change",'.panel-tools [type="checkbox"], .panel-tools select',function(e){var e=e.target,t=(e=I(e)).attr("id"),n=e.is(":checked")||e.is("select")&&e.val()!==+e.attr("data-default");"debug-peekBehindDialogs"===t&&r.toggleClass("debug-dialogs",n),"debug-ignoreClickEvents"===t&&(V.options.ignoreClickEvents=n),"debug-ignoreGotos"===t&&(V.options.ignoreGotos=n),"debug-speedMultiplier"===t&&(V.options.speedMultiplier=+e.val()),j.tabUpdate(n)}),j.update([{id:"peekBehindDialogs",type:"checkbox",label:"See through and click through <code>(dialog:)</code> boxes"},{id:"ignoreClickEvents",type:"checkbox",label:"Stop links, <code>(click:)</code> and <code>(hover-style:)</code> from activating"},{id:"ignoreGotos",type:"checkbox",label:"Stop <code>(go-to:)</code>, <code>(undo:)</code>, <code>(redirect:)</code> and <code>(restart:)</code> from activating<br><small>(Click 'GO' buttons in Debug View to activate later)</small>"},{id:"speedMultiplier",label:"Speed of timed events (<code>time</code>, <code>(live:)</code>, <code>(after:)</code>): ",type:"dropdown",dropdownValue:1,dropdownItems:[.25,.5,.75,1,1.25,1.5,1.75,2,3,5,10]}]),W.create({className:"options",tabName:"\u2699\ufe0f",tabNameCounter:!1,rowWrite:function(e,t){var n=e.name,e=e.label,r={darkMode:o.darkMode,fadePanel:o.fadePanel,evalReplay:o.evalReplay}[n];return t?t.find("input").prop("checked",r):I('<span><input id="debug-'.concat(n,'" type="checkbox" ').concat(r?"checked":"",'></input><label for="debug-').concat(n,'">').concat(e,"</label></span>"))},rowCheck:I.noop,tabUpdate:I.noop,columnHead:I.noop})),R=(r.on("click",'.panel-options [type="checkbox"]',function(e){var e=e.target,t=(e=I(e)).attr("id"),e=e.is(":checked");"debug-darkMode"===t&&(o.darkMode=e,h.toggleClass("theme-dark",e)),"debug-fadePanel"===t&&(o.fadePanel=e,h.toggleClass("fade-panel",e)),"debug-evalReplay"===t&&(V.options.evalReplay=o.evalReplay=e),c()}),P.update([{name:"darkMode",label:"Debug panel is dark"},{name:"fadePanel",label:"Debug panel is transparent unless the cursor is over it"},{name:"evalReplay",label:"Record expression replays (viewable via \ud83d\udd0d buttons in Debug View; slower)"}]),h.prepend(S.panel,x.panel,N.panel,A.panel,C.panel,j.panel,P.panel),s.prepend(S.tab,x.tab,N.tab,A.tab,C.tab,j.tab,P.tab),D.on("beforeForward",y).on("beforeBack",y).on("beforeLoad",y),l(function(){T(),v(),x.panelRows.empty(),x.tabUpdate(0),D.passage&&z.get(D.passage)&&(C.update(E.concat({name:D.passage,tag:""})),C.panel.find('[data-tag=""], [data-tag=""] + .panel-row-source').insertBefore(C.panel.find('[data-tag="footer"]').first()))}));D.on("forward",R).on("back",R).on("load",R);K=b,I(document.head).append(I("<style>").html(X)),b(),e&&d(e,t)};return F.registerDebugMode(function(e,t){return!V.options.debug&&K(e,t)}),K}),define("debugmode/panel",["jquery","utils/naturalsort"],function(d,e){var i=e();return Object.seal({create:function(e){var n,t=e.className,r=e.rowWrite,a=e.rowCheck,o=e.rowSort,i=e.columnHead,s=e.tabName,c=e.tabNameCounter,l=void 0===c||c,c=e.tabUpdate,u=d("<div class='panel panel-".concat(t,"' style='").concat(this.defaultMaxHeight?"max-height:"+this.defaultMaxHeight+"px":"","' hidden><div class=\"resizer-v\"></div><table class='panel-rows'></table></div>")),p=d("<button class='tab tab-".concat(t,"'>").concat(l?"0 ".concat(s,"s"):s,"</button>"));return p.click(function(){p.toggleClass("enabled"),p.parent().siblings(".panel").attr("hidden",""),p.is(".enabled")&&(p.siblings(".tab:not(.tab-"+t+")").removeClass("enabled"),u.removeAttr("hidden"))}),u.on("click","th",function(e){var e=e.target,t="desc"===(e=d(e)).attr("data-order")?"asc":"desc";n.sort(e.attr("data-col"),t),u.find("th[data-order]").removeAttr("data-order"),e.attr("data-order",t)}),c=c||function(e){return p.text(l?"".concat(e," ").concat(s).concat(1!==e?"s":""):s)},n=Object.assign(Object.create(this),{tabName:s,tab:p,panel:u,panelRows:u.find(".panel-rows"),rowWrite:r,rowSort:o,rowCheck:a,columnHead:i,tabUpdate:c})},sort:function(r,a){var o=this;this.panelRows.children(":not(.panel-head, .panel-row-source)").get().sort(function(e,t){var n;return"desc"===a&&(e=(n=[t,e])[0],t=n[1]),e=e.querySelector("."+r),t=t.querySelector("."+r),o.rowSort&&o.rowSort(r,d(e),d(t))||i(e.textContent,t.textContent)}).forEach(function(e){var t=d(e).next(".panel-row-source").get();o.panelRows.append(e,t)})},update:function(e,t){var r=this.rowCheck,a=this.rowWrite,o=this.panelRows,n=this.columnHead,i=this.panel,s=[],c=o.children(),e=(e.forEach(function(t){var e=c.get().filter(function(e){return r(t,d(e))}),n=a(t,e.length&&d(e));e.length||o.append(n),s.push.apply(s,_toConsumableArray(n.get()))}),c.filter(function(e,t){return!s.includes(t)&&!t.className.includes("panel-head")}).remove(),this.tabUpdate(t),0<t&&!o.find(".panel-head").length?o.prepend(n()):0===t&&o.find(".panel-head").remove(),i.find("th[data-order]"));e.length&&this.sort(e.attr("data-col"),e.attr("data-order"))},defaultMaxHeight:300})}),define("internaltypes/changedescriptor",["jquery","utils","renderer","datatypes/hookset","internaltypes/twineerror"],function(b,e,t,v,n){function w(e){return("string"==typeof e?e:e.map(function(e){return e.text}).join("")).split(/\n/g).reduce(function(e,t,n,r){r=r.length;return e.concat(document.createTextNode(t),n!==r-1&&document.createElement(t.length?"br":"tw-consecutive-br"))},[])}var k=e.impossible,S=e.transitionIn,T=t.exec,r=Object.assign,p=Object.keys,a=Object.create,e=Object.seal,_=Array.isArray,x={source:"",appendSource:null,enabled:!0,enablers:null,verbatim:!1,target:null,append:"",newTargets:null,transition:"",transitionTime:null,transitionDeferred:!1,transitionDelay:0,transitionSkip:0,transitionOrigin:null,loopVars:null,styles:null,attr:null,data:null,innerEnchantments:null,section:null,timestamp:0,output:!1,summary:function(){var t=this;return["source","appendSource","enabled","verbatim","target","append","newTargets","transition","transitionTime","transitionDeferred","transitionDelay","transitionSkip","transitionOrigin","innerEnchantments","enablers","output"].filter(function(e){return hasOwnProperty.call(t,e)}).concat([this.attr.length&&"attr",this.styles.length&&"styles",p(this.loopVars).length&&"loopVars",p(this.data).length&&"data"].filter(Boolean))},create:function(e,t){e=r(a(this),{attr:this.attr?this.attr.slice():[],styles:this.styles?this.styles.slice():[],loopVars:this.loopVars||{},data:this.data||{}},e);if(t){t=t.run(e);if(n.containsError(t))return t}return e},update:function(){function e(t){var e,n,r;_(a.styles)&&0<a.styles.length&&(n=(e=_slicedToArray(a.styles.reduce(function(n,r){return p(r).forEach(function(e){var t=r[e];n[+("function"==typeof t)].push(_defineProperty({},e,t))}),n},[[],[]]),2))[0],r=e[1],n.forEach(function(e){return t.css(e)}),setTimeout(function(){r.forEach(function(e){return t.css(e)})})),a.attr&&a.attr.forEach(function(e){return t.attr(e)}),a.data&&t.data(a.data)}var a=this,t=this.section,n=this.newTargets,r=this.transition,o=this.transitionDeferred,i=this.append,s=this.target;"function"==typeof s&&(s=s());if(_(n)&&n.length&&(s=n.map(function(e){return e.target})),_(s))for(var c=0;c<s.length;c+=1)v.isPrototypeOf(s[c])?s[c].forEach(t,e):e(s[c]);else v.isPrototypeOf(s)?s.forEach(t,e):e(s);if(r&&!o&&!i){for(var l,u=s;(l=u.data("timestamp"))||(u=u.parent()),!l&&u.length;);S(s,r,this.transitionTime,this.transitionDelay,this.transitionSkip,l?Date.now()-l:0,this.transitionOrigin)}},render:function(){var e,r=this,t=this.source,n=this.transition,a=this.transitionTime,o=this.transitionDeferred,i=this.enabled,s=this.enablers,c=this.data,l=this.section,u=this.newTargets,p=this.innerEnchantments,d=this.appendSource,f=this.output,h=this.target,m=this.target,g=this.append;if("function"==typeof h&&(h=h()),!g)return k("ChangeDescriptor.render","This doesn't have an 'append' method chosen."),b();if(f)return b();if(null!=s&&s.length)return s=(f=s[0]).descriptor,f=f.changer,s=s.render(),f&&(e=x.create({section:l,target:s}),f.run(e),e.update()),s;if(!i||void 0!==h.attr("hidden"))return x.create({target:h,attr:this.attr.filter(function(e){return!("style"in e)}),data:_objectSpread(_objectSpread({},c),{},{originalSource:t,hidden:!0})}).update(),b();if(!(h=_(u)&&u.length?u:h))return k("ChangeDescriptor.render","ChangeDescriptor has source but not a target!"),b();var y=b();if([].concat(h).filter(function(e){return!e.jquery}).map(function(e){var t,n,r=g;return e.target&&e.append&&(r=(t=e).append,n=t.before,e=e.target),{elements:e.hooks(l,m).filter(function(){return!(n&&1&this.compareDocumentPosition(document)&&2&this.compareDocumentPosition(m[0]))}),append:r}},[]).forEach(function(e){var t=e.elements,n=e.append;t.each(function(e,t){t=b(t),y=y.add(r.create({target:t,append:n,newTargets:null}).render()),t.filter("tw-pseudo-hook").contents().unwrap()})}),!(y.length||_(h)||v.isPrototypeOf(h))){f=g;if(!(f in h)){if("replace"!==f)return k("ChangeDescriptor.render","The target doesn't have a '"+f+"' method."),b();f=h[0]instanceof Text?"replaceWith":(h.empty(),"append")}h[0]instanceof Text&&"prepend"===(f="append"===f?"after":f)&&(f="before"),y=b(t&&(this.verbatim?w:T)(t)),_(d)&&d.forEach(function(e){var t=e.source,e=e.append,t=b((r.verbatim?w:T)(t));y="append"===e?y.add(t):"prepend"===e?t.add(y):t}),h[f](y.length?y:void 0),h.data("timestamp",Date.now()),this.update(),n&&!o&&S("replace"===g?h:y,n,a,this.transitionDelay,this.transitionSkip,this.expedite,this.transitionOrigin),p&&p.map(function(e){return e(h)}).forEach(function(e){return l.addEnchantment(e)})}return y}};return e(x)}),define("internaltypes/enchantment",["jquery","utils","internaltypes/changedescriptor","datatypes/changercommand","utils/operationutils","internaltypes/twineerror","utils/renderutils"],function(g,y,b,v,e,w,t){var k=e.objectName,S=e.toSource,T=t.collapse;return Object.freeze({create:function(e){return Object.assign(Object.create(this),{enchantments:g()},e)},enchantScope:function(){var i=this,s=this.attr,c=this.data,l=this.functions,u=this.section,p=this.scope,d=this.localHook,f=this.lambda,h=[],m=0;p.forEach(u,function(e,t){if(d){d=d.jquery?d:d.hooks(u);var n=e.find(d);if(n.length)e=n;else if(!d.has(e[0]).length)return}var r,a,o;(!e.is(":empty")||e.data("source")&&e.data("source").length)&&(m+=1,f?(o=f.apply(u,{loop:p.TwineScript_GetProperty(t),pos:m}),w.containsError(o)?(e.replaceWith(o.render()),f=o=null):v.isPrototypeOf(o)?o.canEnchant||(e.replaceWith(w.create("macrocall",'The lambda "'.concat(S(f),"\" can't be or include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:).")).render()),f=o=null):(e.replaceWith(w.create("macrocall",'The lambda "'.concat(S(f),'" must return a changer, not ').concat(k(o),".")).render()),f=o=null)):o=i.changer,n=!s&&!c&&(!o||o.summary().every(function(e){return e.startsWith("transition")})),r=n?e:e.wrap("<tw-enchantment>").parent(),s&&r.attr(s),c&&r.data(c),l&&l.forEach(function(e){return e(r)}),o&&(t=b.create({section:u,target:r}),o.run(t),t.update(),e.is(y.storyElement)?(a=Object.keys(Object.assign.apply(Object,[{}].concat(_toConsumableArray(t.styles)))),e.css(a.reduce(function(e,t){return"background-color"===t||"background-image"===t?(e["background-color"]="transparent",e["background-image"]="none",a.push("background-".concat("background-color"===t?"image":"color"))):e[t]="inherit",e},{})),r.data({enchantedProperties:a})):e.is("tw-passage")&&t.styles.some(function(e){return"margin-left"in e||"margin"in e||"margin-right"in e})&&(o="padding-right",y.storyElement.css(t="padding-left","0px").css(o,"0px"),r.data({enchantedProperties:[t,o]}))),e.is(y.storyElement)&&r.css({"min-width":"100%","min-height":"100%"}),"true"===r.attr("collapsing")&&(r.find("[collapsing=false]").each(function(){g(this).removeAttr("collapsing")}),T(r)),n||h.push(r))}),this.enchantments=g(h)},disenchant:function(){this.enchantments.each(function(e,t){(t=g(t)).contents().unwrap();t=t.data("enchantedProperties");t&&y.storyElement.css(t.reduce(function(e,t){return e[t]="",e},{}))})}})}),define("internaltypes/twineerror",["jquery","utils"],function(i,s){var a=s.impossible,c=s.escape,l=(i(document.documentElement).on("click","tw-folddown",function(e){var t=e.target,e=((t=i(t)).toggleClass("open"),t.popData("folddown"));for("function"==typeof e&&e(t);t&&!t.next().length;)t=t.parent();null!=(e=t)&&e.next().toggle()}),{syntax:"The markup seems to contain a mistake.",saving:"I tried to save or load the game, but I couldn't do it.",operation:"I tried to perform an operation on some data, but the data's type was incorrect.",macrocall:"I tried to use a macro, but its call wasn't written correctly.",datatype:"I tried to use a macro, but was given the wrong type of data to it.",custommacro:"I tried to use a custom macro, but its code hook had a mistake in it.",infinite:"I almost ended up doing the same thing over and over, forever.",property:"I tried to access a value in a string/array/datamap, but I couldn't find it.",unimplemented:"I currently don't have this particular feature. I'm sorry.",propagated:"Click the 'Open' button to see the code hook as it was executed.",user:"This is a custom error created by (error:). It usually means you used a custom macro incorrectly.",assertion:"This command exists to provide a helpful error if a certain important condition wasn't true.",debugonly:"This macro is not meant to be used outside of debugging your story."}),u=[],n={TwineError:!0,create:function(e,t,n,r){return t&&"string"==typeof t||a("TwineError.create","has a bad message string"),n||e in l||a("TwineError.create","no error explanation given"),"user"!==e&&(t=t[0].toUpperCase()+t.slice(1)),Object.assign(Object.create(this),{type:e,message:t,explanation:n,source:void 0,innerDOM:r,appendTitleText:!1})},containsError:function(){for(var e=0;e<arguments.length;e+=1){var t=arguments[e];if(n.isPrototypeOf(t))return t;if(Array.isArray(t)){t=n.containsError.apply(n,t);if(t)return t}}return!1},createWarning:function(e,t){return Object.assign(this.create(e,t),{warning:!0})},render:function(t){var n=this,e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=(t="string"==typeof t?t:this.source||"",i("<tw-error class='"+(this.warning?"warning":"error")+"' title='"+c(t)+"'>"+c(this.message+(this.appendTitleText?" "+t:""))+"</tw-error>")),a=i("<tw-error-explanation>").text(this.explanation||l[this.type]).hide(),o=i("<tw-folddown tabindex=0>");return this.innerDOM&&i("<tw-open-button label='Open'>").on("click",function(){var e=i("<tw-backdrop><tw-dialog></tw-backdrop>");e.find("tw-dialog").prepend(n.innerDOM,i("<tw-link tabindex=0>OK</tw-link>").on("click",function(){n.innerDOM.detach(),e.remove()}).wrap("<tw-dialog-links>").parent()),s.storyElement.prepend(e)}).appendTo(r),r.append(o).append(a),r.data("TwineError",this),e||u.forEach(function(e){return e(n,t)}),r},on:function(e){return"function"!=typeof e||u.includes(e)||u.push(e),n}};return Object.preventExtensions(n)}),define("internaltypes/twinenotifier",["jquery","utils"],function(e,t){var n=t.impossible,r={create:function(e){return e||n("TwineNotifier.create","called with only 1 string."),Object.assign(Object.create(r),{message:e})},render:function(){return e("<tw-notifier>").attr("message",this.message)}};return Object.preventExtensions(r)}),define("internaltypes/varref",["state","internaltypes/twineerror","utils","utils/operationutils","datatypes/hookset"],function(u,p,e,t,i){var c,n=e.impossible,s=e.andList,r=e.nth,o=t.is,d=t.isObject,f=t.toSource,h=t.isSequential,m=t.objectName,l=t.typeName,g=t.clone,y=t.isValidDatamapName,b=t.subset,v=t.collectionType,w=t.unstorableValue,a=t.matches,k=Array.isArray,S={set:[],delete:[]},T="You can only access position strings/numbers ('4th', 'last', '2ndlast', (2), etc.), slices ('1stTo2ndlast', '3rdTo5th'), ",_="You can't access the '0th' or '0thlast' position of ";function x(e,t){if(p.containsError(t))return n;if(e instanceof Map&&(n=p.containsError(y(e,t))))return n;if(h(e))if("number"==typeof t){if(0===t)return p.create("property","You can't access elements at position 0 of ".concat(m(e),"."),"Only positive and negative position values exist.");0<t&&--t}else if("string"==typeof t&&(r=/^(\d+)(?:st|[nr]d|th)last$/i.exec(t))){if("0"===r[1])return p.create("property",_+m(e)+".");t=-r[1]}else if("string"==typeof t&&(r=/^(\d+)(?:st|[nr]d|th)$/i.exec(t))){if("0"===r[1])return p.create("property",_+m(e)+".");t=r[1]-1}else if("string"==typeof t&&(r=/^(?:(\d+)(?:st|[nr]d|th)(last)?|last)to(?:(\d+)(?:st|[nr]d|th)(last)?|last)$/i.exec(t))){var n=_slicedToArray(r,5),r=n[1],r=void 0===r?0:r,a=n[2],o=n[3],o=void 0===o?0:o;t={last:n[4]?-o:o-1,first:a?-r:r-1}}else if("last"===t)t=-1;else if("random"===t){if(!e.length)return p.create("property","I can't get a random value from ".concat(m(e),", because it's empty."));t=u.random()*Array.from(e).length|0}else{if(i.isPrototypeOf(e)&&!i.TwineScript_Properties.includes(t))return p.create("property","".concat(T+s(i.TwineScript_Properties.map(function(e){return"'"+e+"'"}))," of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."));if(!["length","some","any","all","start","end","random"].includes(t)&&!i.isPrototypeOf(e))return p.create("property","".concat(T,"'length', 'some', 'any', 'all', 'start', 'end', and 'random' of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."))}else if(e instanceof Set){if(!["length","some","any","all"].includes(t))return p.create("property","".concat(T,"'length', 'some', 'any', and 'all' of ").concat(m(e),"."),"You can't access specific individual data values from datasets.");"length"===t&&(t="size")}else{if(k(e.TwineScript_Properties)&&!e.TwineScript_Properties.includes(t))return p.create("property","You can only get the ".concat(s(e.TwineScript_Properties.map(function(e){return"'"+e+"'"}))," of ").concat(m(e),", not ").concat(("string"==typeof t?f:m)(t),"."));if("number"==typeof e||"boolean"==typeof e)return p.create("property","You can't get any data values, let alone ".concat(m(t),", from ").concat(m(e)))}return t}function O(e,t){return+t<0&&Math.abs(t)<=e.length?e.length+ +t:t}var A=/[^\uD801-\uDFFF]/,C=new Map;function E(e,t){var n,r,a;return void 0===e?e:e instanceof Map?e.get(t):"some"!==t&&"any"!==t&&"all"!==t&&"start"!==t&&"end"!==t||e.TwineScript_VariableStore?("string"==typeof e&&(C.has(e)?e=C.get(e):A.test(e)?(a=_toConsumableArray(e),C.set(e,a),e=a):C.set(e,e)),h(e)&&Number.isFinite(t)&&(t=O(e,t)),e.TwineScript_GetProperty?e.TwineScript_GetProperty(t):"function"!=typeof(a=e[t])?a:void 0):(n=e,r=t,a='"'.concat(r," value").concat("any"===r?"":"s",'" of '),{determiner:r,determined:n,array:_toConsumableArray(n),string:"string"==typeof n&&n,TwineScript_ObjectName:a+m(n),TwineScript_ToSource:function(){return"".concat(r," of ").concat(f(n))},TwineScript_TypeName:a+"a data structure",TwineScript_Unstorable:!0,TwineScript_Print:function(){return"`["+this.TwineScript_TypeName+"]`"}})}function N(e){var t;return e.computed?(t=e.value,"string"==typeof(t=c.isPrototypeOf(t)?t.get():t)?"('"+t+"')":"("+t+")"):"number"==typeof e?r(e):"'"+e+"'"}function j(t,e,n){if(t.TwineScript_VariableStore){if(t.TwineScript_TypeDefs&&e in t.TwineScript_TypeDefs){var r=t.TwineScript_TypeDefs[e];if("const"===r.name){if(void 0!==t[e])return p.create("operation","I can't alter ".concat(t===u.variables?"$":"_").concat(e," because it's been restricted to a constant value."),"This variable can't be changed for the rest of the story.")}else if(!a(r,n))return p.create("operation","I can't set ".concat(t===u.variables?"$":"_").concat(e," to ").concat(l(n)," because it's been restricted to ").concat(f(r),"-type data."),"You can restrict a variable or data name by giving a typed variable to (set:) or (put:).")}return!0}return k(e)?e.map(function(e){return j(t,e)}):t instanceof Map?"string"==typeof e||p.create("operation","".concat(m(t)," can only have string data names, not ").concat(m(e),".")):h(t)?["length","random","some","any","all","start","end"].includes(e)?p.create("operation","I can't forcibly alter the '"+e+"' of "+m(t)+".","start"===e||"end"===e?"Alter the values at actual positions, like 1st or 2ndlast, rather than just the '"+e+"'.":void 0):+e==(0|e)||p.create("property",m(t)+" can only have position keys ('3rd', '1st', (5), etc.), not "+N(e)+"."):t.TwineScript_Identifiers&&e in t?p.create("keyword","I can't alter the value of the '"+e+"' identifier.","You can only alter data in variables, not fixed identifiers."):p.create("operation","I can't modify "+m(t),t instanceof Set?"You should use an (array:) if you need to modify the data inside this dataset.":i.isPrototypeOf(t)?"You should alter hooks indirectly using macros like (replace:) or (enchant:).":void 0)}function P(t,e,n,r){var a=e;t instanceof Map?t.set(e,n):(h(t)&&(e=O(t,e)),t.TwineScript_Set?t.TwineScript_Set(e,n,r):t[e]=n),S.set.forEach(function(e){return e(t,a,n)})}function R(t,e){var n=e;h(t)&&(e=O(t,e)),k(t)&&/^(?:[1-9]\d*|0)$/.exec(e)?t.splice(e,1):t instanceof Map||t instanceof Set?t.delete(e):t.TwineScript_Delete?t.TwineScript_Delete(e):delete t[e],S.delete.forEach(function(e){return e(t,n)})}function I(t,e){var n,r,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return e&&"object"===_typeof(e)&&"last"in e&&"first"in e?i.isPrototypeOf(t)?t.TwineScript_GetProperty(e):(n=e.first,r=e.last,b(t,n+(0<=n),r+(0<=r))):k(e)?i.isPrototypeOf(t)?t.TwineScript_GetProperty(e):e.map(function(e){return I(t,e,e)})["string"==typeof t?"join":"valueOf"](""):void 0!==(n=E(t,e))||o?n:t===u.variables?0:"temp"===(null==(r=t.TwineScript_VariableStore)?void 0:r.type)?p.create("property","There isn't a temp variable named _".concat(a," in this place."),"Temp variables only exist inside the same passage, hook, or lambda in which they're created."):k(t)&&"number"==typeof e?p.create("property","This array of ".concat(t.length," elements doesn't have a ").concat(N(a+("number"==typeof a?1:""))," element."),t.length?"It contains: ".concat(s(t.map(m)),"."):"The array is empty."):(o=Array.from("function"==typeof t.keys&&t.keys()),p.create("property","I can't find a ".concat(N(a)," data name in ").concat(m(t)),t instanceof Map&&o.length?"Its names include: ".concat(s(o),"."):void 0))}function V(e,t){var r=this,e=this.compiledPropertyChain.reduce(function(e,t){var n=0===e.length?r.object:I.apply(void 0,_toConsumableArray(e[e.length-1]));return e.push([n,t])&&e},[]).reduceRight(e,t);return p.containsError(e)?e:void 0}return c=Object.freeze({get:function(){for(var e=this.object,t=0;t<this.compiledPropertyChain.length-1;t+=1)if(e=I(e,this.compiledPropertyChain[t]),p.containsError(e))return e;return I(e,this.compiledPropertyChain.slice(-1)[0],this.propertyChain.slice(-1)[0])},has:function(){for(var e=this.object,t=0;t<this.compiledPropertyChain.length-1;t+=1)if(void 0===(e=I(e,this.compiledPropertyChain[t],void 0,!0))||p.containsError(e))return!1;return void 0!==I(e,this.compiledPropertyChain.slice(-1)[0],void 0,!0)},set:function(e,c){var l=this;return!this.object||this.object.TwineScript_VariableStore||this.object.TwineScript_Identifiers?V.call(this,function(n,e,t){var e=_slicedToArray(e,2),r=e[0],a=e[1];if(e=p.containsError(n,r,a)||p.containsError(j(r,a,n)))return e;if(e=w(n))return p.create("operation","".concat(m(n)," can't be stored").concat(!n.TwineScript_Unstorable&&v(n)?" because it holds ".concat(m(e)):"","."));if(0<t)r=g(r);else if("temp"===(null==(e=r.TwineScript_VariableStore)?void 0:e.type)&&r!==u.variables){for(var o=r;"temp"===(null==(i=o.TwineScript_VariableStore)?void 0:i.type)&&!hasOwnProperty.call(o,a);)var i,o=Object.getPrototypeOf(o);"temp"===(null==(t=o.TwineScript_VariableStore)?void 0:t.type)&&(r=o)}if("string"==typeof r){if("string"!=typeof n)return p.create("datatype","I can't put this non-string value, ".concat(m(n),", in a string."));if(n.length!==(k(a)?a.length:1))return p.create("datatype","".concat(m(n),"is not the right length to fit into this string location."));var r=_toConsumableArray(r),s=_toConsumableArray(n);[].concat(a).forEach(function(e){0+e<0&&(e=r.length+(0+e)),r=[].concat(_toConsumableArray(r.slice(0,e)),[s.shift()],_toConsumableArray(r.slice(e+1)))}),r=r.join("")}else d(r)&&(void 0!==n.TwineScript_KnownName&&((n=""!==n.TwineScript_KnownName?g(n):n).TwineScript_KnownName=f(l)),k(a)&&h(n)?("string"==typeof n&&(n=_toConsumableArray(n)),a.map(function(e,t){return[e,n[t]]}).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return P(r,t,e,c)})):P(r,a,n,c));return r},e):p.create("macrocall","I can't (set:) ".concat(m(this),", if the ").concat((m(this.object).match(/ (.+$)/)||["","value"])[1]," isn't stored in a variable."),"Modifying data structures that aren't in variables won't change the game state at all.")},delete:function(){return V.call(this,function(e,t,n){var r,t=_slicedToArray(t,2),a=t[0],t=t[1];return(r=p.containsError(e,a,t)||p.containsError(j(a,t)))||(0<n&&(a=g(a)),null===e?((r="string"==typeof a)&&(a=_toConsumableArray(a)),k(t)?(h(a)&&(t=_toConsumableArray(new Set(t))).sort(function(e,t){return O(a,t)-O(a,e)}),t.forEach(function(e){return R(a,e)})):R(a,t),r&&(a=a.join(""))):P(a,t,e,!1),a)},null)},defineType:function(e){var t=this.object,n=this.compiledPropertyChain[0],r=(hasOwnProperty.call(t,"TwineScript_TypeDefs")||(t.TwineScript_TypeDefs=Object.create(t.TwineScript_TypeDefs||null)),t.TwineScript_TypeDefs),a=r[n];if(a&&!o(a,e))return p.create("operation","I can't redefine the type of "+m(this)+" to "+(e.TwineScript_ObjectName||l(e))+", as it is already "+(a.TwineScript_ObjectName||l(a))+".");t.TwineScript_DefineType?t.TwineScript_DefineType(n,e):r[n]=e,"const"===e.name&&(t[n]=void 0)},matches:function(e,t){return this.object===e&&this.compiledPropertyChain[0]===t},getName:function(){return this.compiledPropertyChain[0]},create:function(e,t){var n;if(n=p.containsError(e))return n;Array.isArray(t)||(t=[].concat(t)),c.isPrototypeOf(e)&&(t=e.propertyChain.concat(t),e=e.object);var r=function(e,t){for(var n,r=[],a=0;a<t.length;a+=1){var o=t[a];if(o.computed&&(o=o.value),c.isPrototypeOf(o)&&(o=o.get()),k(o)){for(var i=[],s=0;s<o.length;s+=1)i[s]=x(e,o[s]);o=i}else o=x(e,o);if(n=p.containsError(o))return n;a<t.length-1&&(e=I(e,o)),r.push(o)}return r}(e,t);return(n=p.containsError(r))||Object.assign(Object.create(c),{object:e,propertyChain:t,compiledPropertyChain:r})},TwineScript_ToSource:function(){function r(e,t){return!t&&n.object.TwineScript_VariableStore?e:N(e)}var e,n=this;return(this.object===u.variables?"$":"temp"===(null==(e=this.object.TwineScript_VariableStore)?void 0:e.type)?"_":f(this.object)+"'s ")+(1===this.propertyChain.length?r(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,n){return e+"'s "+r(t,n)}))},get TwineScript_ObjectName(){var e;return this.object.TwineScript_VariableStore?"the ".concat("temp"===(null==(e=this.object.TwineScript_VariableStore)?void 0:e.type)?"temp ":"","variable ").concat(this.TwineScript_ToSource()):m(this.object)+"'s "+(1===this.propertyChain.length?N(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,n){return e+"'s "+N(t)}))},on:function(e,t){if(e in S)return"function"!=typeof t||S[e].includes(t)||S[e].push(t),c;n("VarRef.on","invalid event name")}})}),define("internaltypes/varscope",[],function(){return Object.seal({TwineScript_ObjectName:"the temporary variables",TwineScript_VariableStore:{type:"temp",name:"an unknown scope"},TwineScript_TypeDefs:Object.create(null)})}),define("macrolib/commands",["jquery","macros","utils","state","passages","engine","internaltypes/twineerror","internaltypes/twinenotifier","datatypes/assignmentrequest","datatypes/hookset","datatypes/codehook","datatypes/colour","datatypes/gradient","internaltypes/varref","datatypes/typedvar","datatypes/varbind","utils/operationutils","utils/renderutils"],function(u,n,y,c,l,a,b,M,e,o,t,p,d,i,s,v,r,f){var h=r.printBuiltinValue,m=r.objectName,g=r.clone,w=r.toSource,k=f.dialog,S=f.geomParse,D=f.geomStringRegExp,r=n.TypeSignature,f=r.Any,F=r.Everything,T=r.rest,_=r.either,x=r.optional,O=r.zeroOrMore,L=r.percent,H=r.nonNegativeInteger,A=r.positiveInteger,r=r.positiveNumber,C=Object.assign,E=Math.floor,N=Math.ceil,j=Math.abs,z=Math.max,q=Math.min,P=u.noop;function R(e){return"(".concat(e," ").concat(y.options.ifid,") ")}["set","put","unpack"].forEach(function(r){return n.add(r,"Instant",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if("into"===n.operator&&"set"===r)return b.create("macrocall","Please say 'to' when using the (set:) macro.");if("to"===n.operator&&"set"!==r)return b.create("macrocall","Please say 'into' when using the (put:) or (unpack:) macro.");if((i.isPrototypeOf(n.dest)||s.isPrototypeOf(n.dest))===("unpack"===r))return b.create("macrocall","unpack"===r?"Please use the (unpack:) macro with arrays, datamaps or (p:) patterns containing variables to the right of 'into'.":"Please use the (".concat(r,":) macro with just single variables and typed variables to the ").concat("set"===r?"left of 'to'.":"right of 'into'."),"You may wish to change this to the (".concat("unpack"!==r?"unpack":"to"===n.operator?"set":"put",":) macro."));n=n.set();if(b.containsError(n))return n}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (".concat(r,":) operation"),TwineScript_ObjectName:"a (".concat(r,":) operation"),TwineScript_Unstorable:!0,TwineScript_Print:function(){return y.options.debug,""}}},[T(e)])}),n.add("move","Instant",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if("into"!==n.operator)return b.create("macrocall","Please say 'into' when using the (move:) macro.");n=n.set(!0);if(b.containsError(n))return n}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (move:) operation",TwineScript_ObjectName:"a (move:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return y.options.debug,""}}},[T(e)]),n.addCommand("display",function(e){if(!l.hasValid(e))return b.create("macrocall","I can't (display:) the passage '".concat(e,"' because it doesn't exist."))},function(e,t,n){return e.source=l.getTree(n),e},[String])("print",P,function(e,t,n){return C(e,{source:h(n)})},[f])(["verbatim-print","v6m-print"],P,function(e,t,n){return C(e,{verbatim:!0,source:h(n)})},[f])(["verbatim-source","v6m-source"],function(e){if("command"===(null==e?void 0:e.TwineScript_TypeID)&&!e.TwineScript_ToSource)return b.create("datatype","I can't construct the source code of a command created by a custom macro.")},function(e,t,n){return C(e,{verbatim:!0,source:h(w(n))})},[f])("go-to",function(e){if(!l.hasValid(e))return b.create("macrocall","I can't (go-to:) to the passage '".concat(e,"' because it doesn't exist."),"Check that you didn't mistype the passage name, or rename the passage to something else.")},function(e,t,n){if(!y.options.ignoreGotos)return requestAnimationFrame(function(){return a.goToPassage(n,{transition:e.data.passageT8n})}),{blocked:!0}},[String])("redirect",function(e){if(!l.hasValid(e))return b.create("macrocall","I can't (redirect:) to the passage '".concat(e,"' because it doesn't exist."),"Check that you didn't mistype the passage name, or rename the passage to something else.")},function(e,t,n){if(!y.options.ignoreGotos)return requestAnimationFrame(function(){return a.redirect(n,{transition:e.data.passageT8n})}),{blocked:!0}},[String])("undo",P,function(e,t,n){return c.pastLength<1?C(e,{source:n}):y.options.ignoreGotos?void 0:(requestAnimationFrame(function(){return a.goBack({transition:e.data.passageT8n})}),{blocked:!0})},[x(String)])("debug",P,a.enableDebugMode,[],!1),y.onStartup(function(){return y.storyElement.on("click.icon","tw-icon",function(e){var t=u(this),n=t.data("clickEvent"),r=t.attr("alt");n&&n(t),"Undo"===r&&(e.stopPropagation(),a.goBack()),"Redo"===r&&(e.stopPropagation(),a.goForward()),"Fullscreen"===r&&(e.stopPropagation(),a.toggleFullscreen()),"Restart"===r&&(c.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload())})}),[["Undo","&#8630;",function(){return 0<c.pastLength}],["Redo","&#8631;",function(){return 0<c.futureLength}],["Fullscreen","&#9974;",function(){return document.fullscreenEnabled||document.msFullscreenEnabled}],["Restart","&#10226;",Object]].forEach(function(e){var e=_slicedToArray(e,3),o=e[0],i=e[1],s=e[2];n.addCommand("icon-".concat(o.toLowerCase()),function(e,t){if("string"==typeof e&&"string"==typeof t)return e=_toConsumableArray(e).length,t=_toConsumableArray(t).length,1<e&&1<t?b.create("datatype","One of the two strings given to (icon-".concat(o.toLowerCase(),":) should be 1 character long, for its icon.")):1===e&&1===t?b.create("datatype","One of the two strings given to (icon-".concat(o.toLowerCase(),":) should be 2 or more characters long, for its label.")):void 0},function(t,e,n,r){var a;return("string"==typeof r&&1===_toConsumableArray(r).length||"string"==typeof n&&1<_toConsumableArray(n).length)&&(n=(a=[r,n])[0],r=a[1]),"Undo"===o&&(t.data.forgetUndosEvent=function(e){t.section.whenUnblocked(function(){return u(e).css("visibility","hidden")})}),C(t,{source:'<tw-icon tabindex=0 alt="'.concat(o,'" ').concat(r?'data-label="'.concat(r.replace('"',"&quot;"),'"'):"",' title="').concat(o,'" ').concat(s()?"":'style="visibility:hidden"',">").concat(n||i,"</tw-icon>")})},[x(String),x(String)])}),n.addCommand("icon-counter",function(e,t,n){var r=" label string given to (icon-counter:) can't be empty or only whitespace.";return t&&t.trim()?"string"!=typeof n||n.trim()?void 0:b.create("datatype","The 2nd "+r):b.create("datatype","The 1st "+r)},function(r,e,a,o,i){r.attr.push({"data-2bind":!0}),r.data.twoWayBindEvent=function(e,t,n){a.varRef.matches(t,n)&&"number"==typeof(t=a.varRef.get())&&r.target.children("tw-icon").text((0<t?E:N)(t)).attr("data-label",1!==j(t)&&void 0!==i?i:o)};var t=a.varRef.get();return"number"!=typeof t?b.create("datatype","(icon-counter:) can only be bound to a variable holding a number, not ".concat(m(t),".")):C(r,{source:'<tw-icon data-label="'.concat(y.escape(1!==j(t)&&void 0!==i?i:o),'">').concat((0<t?E:N)(t),"</tw-icon>")})},[v,String,x(String)]),n.addCommand("meter",function(e,t,n,r){return"two way"===e.bind?b.create("datatype","(meter:) shouldn't be given two-way bound variables.",'Change the "2bind" keyword to just "bind".'):"string"!=typeof r||r.trim()?-1===n.search(D)||!n.includes("=")&&1<n.length?b.create("datatype",'The (meter:) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not '+JSON.stringify(n)+"."):void 0:b.create("datatype","The label string given to (meter:) can't be empty or only whitespace.")},function(r,e,a,n,t,o,i){o&&"string"!=typeof o&&(i=o,o=void 0),i=i||p.create({h:0,s:0,l:.5,a:.5}),p.isPrototypeOf(i)&&(i=d.create(90,[{colour:i,stop:0},{colour:i,stop:1}]));function s(e){var t=z(0,q(1,e/n)),e=i.repeating?i:i.multiply(n/e);return"height:100%;background-repeat:no-repeat;background-image:".concat((l?C(e,e.repeating?{}:{angle:270}).toLinearGradientString()+", ":"")+C(e,e.repeating?{}:{angle:l||0===c?90:270}).toLinearGradientString(),";background-size:").concat(l?Array(2).fill(50*t+"%"):100*t+"%",";background-position-x:").concat(l?-100/(2-t)+100+"%,"+100/(2-t)+"%":0===c?"left":"right",";text-align:").concat(l?"center":0===c?"left":"right")}var t=S(t),c=t.marginLeft,t=t.size,l=0<c&&Math.ceil(c+t)<100,u=(r.styles.push({"margin-left":c+"%",width:t+"%",height:"1.5em",display:"block"}),r.attr.push({"data-2bind":!0}),o&&e.stackTop.tempVariables),t=(r.data.twoWayBindEvent=function(e,t,n){a.varRef.matches(t,n)&&"number"==typeof(t=a.varRef.get())&&((n=r.target.children("tw-meter")).attr("style",s(t)),o)&&r.section.renderInto("",null,{source:o,target:n,append:"replace",transitionDeferred:!1},u)},a.varRef.get());return"number"!=typeof t?b.create("datatype","(meter:) can only be bound to a variable holding a number, not ".concat(m(t),".")):C(r,{source:'<tw-meter style="'.concat(s(t),'">').concat(o||"","</tw-meter>")})},[v,r,String,x(_(String,p,d)),x(_(p,d))]),[["cycling-link"],["seq-link","sequence-link"]].forEach(function(t,u){return n.addCommand(t,function(){var e;return""===(arguments.length<=0?void 0:arguments[0])?b.create("datatype","The first string in a ("+t[0]+":) can't be empty."):arguments.length<=(v.isPrototypeOf(arguments.length<=0?void 0:arguments[0])?2:1)?b.create("datatype","I need two or more strings to "+(u?"sequence":"cycle")+" through, not just '"+((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e])+"'."):void 0},function(a,e){for(var o,t=arguments.length,i=new Array(2<t?t-2:0),n=2;n<t;n++)i[n-2]=arguments[n];v.isPrototypeOf(i[0])&&(o=i.shift());var s=0,c=("two way"===(null==(l=o)?void 0:l.bind)&&(a.attr.push({"data-2bind":!0}),-1<(l=i.indexOf(o.varRef.get())))&&(s=l),e.stackTop.tempVariables);function r(e,t){var n=s>=i.length-1&&u,r=""===i[s]?"":n?i[s]:"<tw-link>".concat(i[s],"</tw-link>");if(n&&(a.data.clickEvent=void 0),o&&!t){n=o.set(i[s]);if(b.containsError(n))return void e.replaceWith(n.render(i[s]))}t=_objectSpread(_objectSpread({},a),{},{source:r,transitionDeferred:!1});a.section.renderInto("",null,t,c)}i[s]&&(a.data.clickEvent=function(e){s=(s+1)%i.length,r(e,!1)},a.data.twoWayBindEvent=function(e,t,n){o.varRef.matches(t,n)&&(t=o.varRef.get(),-1<(n=i.indexOf(t)))&&n!==s&&(s=n,r(e,!0))});var l="<tw-link>".concat(i[s],"</tw-link>");if(o){e=o.set(i[s]);if(b.containsError(e))return e}return C(a,{source:l,append:"replace",transitionDeferred:!0})},[_(v,String),T(String)])}),y.onStartup(function(){return y.storyElement.on("change.dropdown-macro","select",function(){var e=u(this),t=e.closest("tw-expression, tw-hook").data("dropdownEvent");t&&t(e)})}),n.addCommand("dropdown",function(e){var t;return""===(arguments.length<=1?void 0:arguments[1])||""===((t=(arguments.length<=1?0:arguments.length-1)-1+1)<1||arguments.length<=t?void 0:arguments[t])?b.create("datatype","The first or last strings in a (dropdown:) can't be empty.","Because empty strings create separators within (dropdown:)s, having them at the start or end doesn't make sense."):(arguments.length<=1?0:arguments.length-1)<=1?b.create("datatype","I need two or more strings to create a (dropdown:) menu, not just "+(arguments.length<=1?0:arguments.length-1)+"."):void 0},function(e,t,r){for(var n=arguments.length,a=new Array(3<n?n-3:0),o=3;o<n;o++)a[o-3]=arguments[o];var i=0,s=("two way"===r.bind&&(e.attr.push({"data-2bind":!0}),-1<(c=a.indexOf(r.varRef.get())))&&(i=c),Math.max.apply(Math,_toConsumableArray(a.map(function(e){return _toConsumableArray(e).length})))),c="<select>"+a.map(function(e,t){return"<option".concat(t===i?" selected":"").concat(""===e?" disabled":"",">").concat(y.escape(e||"\u2500".repeat(s)),"</option>")}).join("\n")+"</select>",l=(e.data.dropdownEvent=function(e){var t=e.val(),n=r.set(t);b.containsError(n)&&e.replaceWith(n.render(t))},e.data.twoWayBindEvent=function(e,t,n){r.varRef.matches(t,n)&&(t=r.varRef.get(),-1<(n=a.indexOf(t)))&&n!==i&&(e.find("select").val(t),i=n)},e.styles.push({"background-color":function(){return y.parentColours(u(this)).backgroundColour}}),r.set(a[i]));return b.containsError(l)?l:C(e,{source:c,append:"replace"})},[v,String,T(String)]),y.onStartup(function(){return y.storyElement.on("input.checkbox-macro","input[type=checkbox]",function(){var e=u(this),t=e.closest("tw-expression").data("checkboxEvent");t&&t(e)})});function I(e){return["I can't use a dialog macro in "+e+".","Please rewrite this without putting such macros here."]}var V=1;n.addCommand("checkbox",function(){},function(e,t,r,n){var a=!1,o="checkbox-"+ ++V,i=("two way"===r.bind&&(e.attr.push({"data-2bind":!0}),"boolean"==typeof(i=r.varRef.get())&&(a=i),e.data.twoWayBindEvent=function(e,t,n){r.varRef.matches(t,n)&&"boolean"==typeof(t=r.varRef.get())&&e.children("input[type=checkbox]").prop("checked",t)}),e.data.checkboxEvent=function(e){var t=e.is(":checked"),t=r.set(t);b.containsError(t)&&e.replaceWith(t.render(""))},r.set(a));return b.containsError(i)?i:C(e,{source:'<input id="'.concat(o,'" type="checkbox" ').concat(a?"checked":"",'><label for="').concat(o,'">').concat(n,"</label>"),append:"replace"})},[v,String]),y.onStartup(function(){return u(document).on("fullscreenchange",function(){u("input[type=checkbox][id^=fullscreen]",y.storyElement).each(function(e,t){(u(t).closest("tw-expression").data("fullscreenEvent")||Object)(t)})})}),n.addCommand("checkbox-fullscreen",function(){},function(e,t,n){var r="fullscreenCheckbox-"+ ++V;return e.data.fullscreenEvent=function(e){return u(e).prop("checked",!(!document.fullscreenElement&&!document.msFullscreenElement))},e.data.checkboxEvent=function(){return a.toggleFullscreen()},C(e,{source:'<input id="'.concat(r,'" type="checkbox" ').concat(document.fullscreenEnabled||document.msFullscreenEnabled?" ":"disabled ").concat(document.fullscreenElement||document.msFullscreenElement?"checked":"",'><label for="').concat(r,'">').concat(n,"</label>"),append:"replace"})},[String]),y.onStartup(function(){return y.storyElement.on("input.input-box-macro","textarea, input[type=text]",function(){var e=u(this),t=e.closest("tw-expression").data("inputBoxEvent");t&&t(e)})}),["input","force-input","input-box","force-input-box"].forEach(function(g){return n.addCommand(g,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=g.endsWith("box"),a=v.isPrototypeOf(t[0]),o="string"==typeof t[+a],r=r&&"number"==typeof t[o+a],i=o?t[+a]:t[a+r],s=0<S(i).size,o=s?t[a+r+o]:i;return g.startsWith("force")&&"string"!=typeof o?b.create("datatype","The (".concat(g,":) macro requires a string of text to forcibly input.")):t.length>a+r+s+("string"==typeof o)?b.create("datatype","An incorrect combination of values was given to this (".concat(g,":) macro.")):void 0},function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o=g.startsWith("force"),i=g.endsWith("box"),s=v.isPrototypeOf(r[0]),c="string"==typeof r[+s],l=i&&"number"==typeof r[c+s],u=s&&r[0],p=l?r[1+s]:3,d=c?S(r[+s]):{},f=d.marginLeft,d=d.size,h=(d?r[s+l+c]:c&&r[+s])||"",l=o?"":h,c=!1;if("two way"===u.bind){e.attr.push({"data-2bind":!0});s=u.varRef.get();if("string"==typeof s){l=o?h.slice(0,s.length):s,s=u.set(l),c=!0;if(b.containsError(s))return s}e.data.twoWayBindEvent=function(e,t,n){u.varRef.matches(t,n)&&"string"==typeof(t=u.varRef.get())&&e.find(i?"textarea":"input").val(o?h.slice(0,t.length):t)}}if(u&&!c){s=u.set(o?"":h);if(b.containsError(s))return s}!o&&u&&(e.data.inputBoxEvent=function(e){var t=e.val(),t=u.set(t);b.containsError(t)&&e.replaceWith(t.render(""))});var m,c="<".concat(i?"textarea":"input type=text",' style="width:100%" ').concat(i?"rows=".concat(p,">"):'value="').concat(y.escape(l)).concat(i?"</textarea>":'">');return o&&(m=Array.from(h),e.data.inputBoxEvent=function(e){var t=e.val().length,t=m.slice(0,t).join("");return e.val(t),u&&(t=u.set(t),b.containsError(t))&&e.replaceWith(t.render("")),!0}),e.styles.push({display:"block","margin-left":d?f+"%":void 0,width:d?d+"%":"100%","border-style":function(){return this.style.borderStyle||"solid"}}),C(e,{source:c,append:"replace"})},g.endsWith("box")?[_(v,String),x(_(A,String)),x(_(A,String)),x(String)]:[x(_(v,String)),x(String),x(String)])}),["show","rerun"].forEach(function(s){return n.addCommand(s,function(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function e(t){var n=t.selector,t=t.next;return"name"===n.type&&"page"===n.data?(r=b.create("macrocall","You can't (hide:) the ?page. Sorry."),!0):!!("base"===n.type&&e(n.data)||t&&e(t))||void 0}),r},function(o,i){for(var e=arguments.length,t=new Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return t.forEach(function(e){return e.forEach(i,function(e){var t,n,r,a=e.data("hidden");void 0!==a!=("rerun"===s)&&(e.removeData("hidden"),a instanceof u?e.empty().append(a):(a=e.data("tempVariables"),n=(t="tw-passage"===e.tag())?l.getTree(c.passage):e.data("originalSource")||"",t&&(r=e.find("tw-sidebar").detach()),i.renderInto("",null,_objectSpread(_objectSpread({},o),{},{append:"replace",source:n,target:e}),a&&Object.create(a)),r&&e.prepend(r)))})}),o},[T(o)])});n.addCommand("hide",function(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function e(t){var n=t.selector,t=t.next;return"name"===n.type&&"page"===n.data?(r=b.create("macrocall","You can't (hide:) the ?page. Sorry."),!0):!!("base"===n.type&&e(n.data)||t&&e(t))||void 0}),r},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,o=n;a<o.length;a++)o[a].forEach(e,function(e){e.data("hidden")||e.data("hidden",e.contents().detach())})},[T(o)],!1)("scroll",P,function(h,e,m){var g="number"==typeof m&&m;requestAnimationFrame(function(){e.forEach(h,function(e){if(!1!==g){var t,n;null!=(t=(n=(e=e[0]===y.storyElement[0]&&e[0].scrollHeight===e[0].clientHeight?[document.body]:e)[0]).scrollTo)&&t.call(n,0,(e[0].scrollHeight-e[0].clientHeight)*g)}else{var r,a=_createForOfIteratorHelper(m.hooks(h).get());try{for(a.s();!(r=a.n()).done;){var o=r.value;if(e.find(o)){for(var i=[],s=e[0];(s=s.parentNode)&&s!==document.body;)i.push([s,s.scrollLeft,s.scrollTop]);o.scrollIntoView();for(var c=0,l=i;c<l.length;c++){var u=_slicedToArray(l[c],3),p=u[0],d=u[1],f=u[2];p.scrollLeft=d,p.scrollTop=f}break}}}catch(e){a.e(e)}finally{a.f()}}})})},[o,_(L,o)],!1)("stop",P,P,[],!1)("load-game",P,function(e,t){var n,r;return e.loadedGame?b.create("infinite","I can't use (load-game:) immediately after loading a game."):(n=localStorage.getItem(R("Saved Game")+t))?(n=c.deserialise(e,n))instanceof Error?{blocked:r=k({message:"Sorry to interrupt... The story tried to load saved data, but there was a problem.\n"+n.message+"\n\nThat data might have been saved from a different version of this story. Should I delete it?\n(Type 'delete' and choose Yes to delete it.)\n\nEither way, the story will now continue without loading the data.",defaultValue:"",buttons:[{name:"Yes",confirm:!0,callback:function(){"delete"===r.find("input").last().val()&&localStorage.removeItem(R("Saved Game")+t),e.unblock("")}},{name:"No",cancel:!0,callback:function(){return e.unblock()}}]})}:void requestAnimationFrame(a.showPassage.bind(a,c.passage,{loadedGame:!0})):b.create("saving","I can't find a save slot named '"+t+"'!")},[String],!1)("forget-undos",P,function(e,t){c.futureLength||c.forgetUndos(t)},[parseInt],!1)("forget-visits",P,function(e,t){c.forgetVisits(t)},[parseInt],!1)("mock-visits",function(){if(!y.options.debug)return b.create("debugonly","(mock-visits:) cannot be used outside of debug mode.");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.find(function(e){return!l.hasValid(e)});return r?b.create("datatype","I can't mock-visit '"+r+"' because no passage with that name exists."):void 0},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];c.mockVisits=g(n)},[T(String)],!1)("mock-turns",function(){if(!y.options.debug)return b.create("debugonly","(mock-turns:) cannot be used outside of debug mode.")},function(e,t){c.mockTurns=t},[H],!1)("seed",P,function(e,t){c.setSeed(t)},[String],!1)(["dialog","alert"],function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(v.isPrototypeOf(e)){if("two way"===e.bind)return b.create("datatype","(dialog:) shouldn't be given two-way bound variables.",'Change the "2bind" keyword to just "bind".');if(void 0===t)return b.create("datatype","(dialog:) needs a message string or codehook to display.")}else void 0!==t&&r.unshift(t);e=r.findIndex(function(e){return""===e});if(-1<e)return b.create("datatype","(dialog:)'s ".concat(y.nth(e+1)," link text shouldn't be an empty string."))},function(e,n,r,t){for(var a=arguments.length,o=new Array(4<a?a-4:0),i=4;i<a;i++)o[i-4]=arguments[i];return v.isPrototypeOf(r)||(void 0!==t&&o.unshift(t),t=r,r=void 0),o.length||(o=["OK"]),{blocked:k({section:n,message:t,cd:e,buttons:o.map(function(t){return{name:t,callback:function(){var e;n.unblock((null==(e=r)?void 0:e.set(t))||"")}}})})}},[_(v,String,t),x(_(t,String)),O(String)])("open-url",P,function(e,t){window.open(t,"")},[String],!1)(["restart","reload"],P,function(){if(!y.options.ignoreGotos){if(c.turns<=1)return b.create("infinite","I mustn't (restart:) the story in the starting passage.");c.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload()}},[],!1)("goto-url",P,function(e,t){window.location.assign(t)},[String],!1)("ignore",P,P,[O(F)])("assert-exists",function(e){if(""===e)return b.create("datatype","(assert-exists:) mustn't be given an empty string.")},function(e,t,n){var r=0;return("string"==typeof n?o.create({type:"string",data:n}):n).forEach(t,function(){++r}),r?e:b.create("assertion","I didn't see any ".concat("string"==typeof n?"text occurrences of":"hooks matching"," ").concat(w(n)," in this passage."))},[_(o,String)]),n.add("assert","Instant",function(e,t){return t?{TwineScript_TypeID:"instant",TwineScript_TypeName:"an (assert:) operation",TwineScript_ObjectName:"an (assert:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}:C(b.create("assertion","An assertion failed: "),{appendTitleText:!0})},[Boolean])("save-game","Boolean",function(e,t,n){if(n=n||"",!c.hasStorage)return!1;var r=c.serialise(!1).pastAndPresent;if(b.containsError(r))return r;if(!1===r)return!1;try{return localStorage.setItem(R("Saved Game")+t,r),localStorage.setItem(R("Saved Game Filename")+t,n),!0}catch(e){return!1}},[String,x(String)])("prompt","String",function(e,t,n,r,a){var o,i;return null!=(o=e.stackTop)&&o.evaluateOnly?b.create.apply(b,["macrocall"].concat(_toConsumableArray(I(e.stackTop.evaluateOnly)))):""===a?b.create("datatype","The text for (prompt:)'s confirm link can't be blank."):(i=k({section:e,message:t,defaultValue:n,buttons:[{name:a||"OK",confirm:!0,callback:function(){return e.unblock(i.find("input").last().val())}}].concat(""===r?[]:{name:r||"Cancel",cancel:!0,callback:function(){return e.unblock(n)}})}),e.stackTop.blocked=i,0)},[_(String,t),String,x(String),x(String)])("confirm","Boolean",function(e,t,n,r){var a;return null!=(a=e.stackTop)&&a.evaluateOnly?b.create.apply(b,["macrocall"].concat(_toConsumableArray(I(e.stackTop.evaluateOnly)))):""===r?b.create("datatype","The text for (confirm:)'s confirm link can't be blank."):(a=k({section:e,message:t,defaultValue:!1,buttons:[{name:r||"OK",confirm:!0,callback:function(){return e.unblock(!0)}}].concat(""===n?[]:{name:n||"Cancel",cancel:!0,callback:function(){return e.unblock(!1)}})}),e.stackTop.blocked=a,0)},[_(String,t),x(String),x(String)])("page-url","String",function(){return window.location.href},[])}),define("macrolib/custommacros",["utils","macros","state","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/codehook","datatypes/typedvar","internaltypes/twineerror"],function(c,l,u,e,t,p,n,d,f){function s(e,t,n){if(!t.some(function(e){if("function"==typeof e.output)return e.output(n),!0}))return f.create("macrocall","("+e+":) should only be used inside a code hook passed to (macro:).")}var h=e.objectName,m=e.toSource,e=l.add,r=l.addChanger,a=l.addCommand,o=l.TypeSignature,i=o.rest,g=o.either,y=o.Any,b=o.Everything,o=o.zeroOrMore;e("macro","CustomMacro",function(e){for(var t,n=[],r=arguments.length,a=new Array(1<r?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];for(t=0;t<a.length;t+=1){var i=t===a.length-1;if(d.isPrototypeOf(a[t])===i)return f.create("datatype","The "+(i?"":c.nth(a.length-t+1)+"-")+"last value given to (macro:) should be a "+(i?"code hook":"datatyped variable")+", not "+h(a[t]));if(!i){i="A custom macro";if(a[t].varRef.object===u.variables)return f.create("datatype",i+"'s typed variables must be temp variables (with a '_'), not global variables (with a '$').","Write them with a _ symbol at the start instead of a $ symbol.");if(1<a[t].varRef.propertyChain.length)return f.create("datatype",i+"'s typed variables can't be properties inside a data structure.");if(a[t].datatype.rest&&t!==a.length-2)return f.create("datatype",i+" can only have one spread variable, and it must be its last variable.");var s=a[t].varRef.propertyChain[0];if(n.includes(s))return f.create("datatype",i+"'s typed variables can't both be named '"+s+"'.");n.push(s)}}return p.create(a.slice(0,-1),a[a.length-1])},[i(g(d,n))]);a(["output-data","out-data"],function(){},function(e,t){e=e.stack;return s("output-data",e,t)||{blocked:!0}},[y],!1),r(["output","out"],function(){return Object.assign(t.create("output",[]))},function(e,t){if(e.section){var n,r=e.section,a=r.stack,o=r.stackTop,i={};for(n in o.tempVariables)n.startsWith("TwineScript_")||(i[n]=o.tempVariables[n]);s("output",a,{changer:t,variables:i,hook:Array.isArray(e.source)?"["+e.source.map(function(e){return e.text}).join("")+"]":e.source}),e.output=!0,o.blocked=!0}},[]),a("error",function(e){if(!e)return f.create("datatype","This (error:) macro was given an empty string.")},function(e,t){e=e.stack;return s("error",e,f.create("user",t))||{blocked:!0}},[String],!1),e("partial","CustomMacro",function(e,a){for(var t=arguments.length,o=new Array(2<t?t-2:0),n=2;n<t;n++)o[n-2]=arguments[n];var r="string"!=typeof a&&a,i=!r&&a;if(!r){if(!l.has(i))return f.create("macrocall",'The macro name given to (partial:), "'.concat(a,"\", isn't the name of a built-in macro."));if("Metadata"===l.get(i).returnType)return f.create("macrocall","(partial:) can't be used with metadata macros such as (".concat(a,":)"))}var s="(partial:".concat(m(a),",").concat(o.map(function(e){return m(e)}),")"),c=p.createFromFn(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=l["string"==typeof a?"run":"runCustom"](a,e,o.concat(n));return f.containsError(e)&&(e.message="An error occurred while running the (partial:)-created macro, ".concat(c.TwineScript_ObjectName,":\n")+e.message),e},"a (partial:) custom macro of ".concat(i||r.TwineScript_KnownName?"(".concat(i||r.TwineScript_KnownName,":").concat(o.map(function(e){return m(e)}),")"):"another unnamed custom macro"),function(){return s},(i?l.get(i):r).typeSignature.filter(function(e,t){return t>=o.length||"rest"===e.pattern||"zero or more"===e.pattern}));return c},[g(String,p),o(b)])}),define("macrolib/datastructures",["utils","utils/naturalsort","macros","utils/operationutils","state","engine","passages","datatypes/lambda","datatypes/typedvar","internaltypes/twineerror"],function(e,i,t,n,s,r,a,c,o,l){var u=e.permutations,p=e.options,d=n.objectName,f=n.subset,h=n.collectionType,m=n.isValidDatamapName,g=n.is,y=n.unique,b=n.clone,v=n.range,e=t.TypeSignature,n=e.optional,w=e.rest,k=e.either,S=e.zeroOrMore,T=e.Any,e=e.nonNegativeInteger,_=i("en");t.add(["a","array"],"Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n},S(k(o,T)))("range","Array",function(e,t,n){return v(t,n)},[parseInt,parseInt])("subarray","Array",function(e,t,n,r){return f(t,n,r)},[Array,parseInt,parseInt])("reversed","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reverse().map(b)},S(T))("shuffled","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.shuffled.apply(s,n).map(b)},[S(T)])("sorted","Array",function(e){for(var t,n=arguments.length,r=new Array(1<n?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];if(!c.isPrototypeOf(r[0]))return(t=r.filter(function(e){return"string"!=typeof e&&"number"!=typeof e}))&&t.length?1===t.length&&Array.isArray(t[0])?l.create("macrocall","Please give multiple numbers or strings to (sorted:), not a single array.","You can use the spread ... syntax to spread out the array's values into (sorted:)."):l.create("datatype","If (sorted:) isn't given a 'via' lambda, it must be given only numbers and strings, not ".concat(d(t[0]),".")):r.sort(_);var o=r.shift();if("making"in o||"where"in o||"when"in o||!("via"in o))return l.create("datatype","The optional lambda given to (sorted:) must be a 'via' lambda, not ".concat(d(o),"."));for(var i=0;i<r.length;i+=1){var s=o.apply(e,{loop:r[i],pos:i+1});if(l.containsError(s))return s;if("string"!=typeof s&&"number"!=typeof s)return l.create("datatype",'The "via" lambda given to (sorted:) couldn\'t convert '.concat(d(r[i])," into a string or number."));r[i]=[r[i],s]}return r.sort(function(e,t){return _(e[1],t[1])}).map(function(e){return e[0]})},[S(T)])("rotated","Array",function(e,t){if(0===t)return l.create("macrocall","I can't rotate these values by 0 positions.");for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=-1*(t=Math.abs(t)%r.length*Math.sign(t));return r.slice(t).concat(r.slice(0,t)).map(b)},[parseInt,S(T)])("rotated-to","Array",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)?t:t.length?(e=r.indexOf(t[0]),r.slice(e).concat(r.slice(0,e)).map(b)):l.create("macrocall","None of these "+r.length+" values matched the lambda, so I can't rotate them.")},[c.TypeSignature("where"),w(T)])("repeated","Array",function(e,t){for(var n=[],r=arguments.length,a=new Array(2<r?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];if(!a.length)return n;for(;0<t--;)n.push.apply(n,a);return n.map(b)},[e,w(T)])("interlaced","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=Math.min.apply(Math,_toConsumableArray(n.map(function(e){return e.length}))),o=[],i=0;i<a;i+=1)for(var s=0;s<n.length;s+=1)o.push(b(n[s][i]));return o},[Array,w(Array)])("permutations","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.length?u.apply(void 0,n):[]},[S(T)])("unique","Array",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.filter(y)},[S(T)])("altered","Array",function(n,r){for(var e=arguments.length,t=new Array(2<e?e-2:0),a=2;a<e;a++)t[a-2]=arguments[a];return t.map(function(e,t){t=r.apply(n,{loop:e,pos:t+1});return null===t?e:t})},[k(c.TypeSignature("via"),c.TypeSignature("where","via")),S(T)])("find","Array",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return t.filter(e,r)},[c.TypeSignature("where"),S(T)])(["all-pass","pass"],"Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||t.length===r.length},[c.TypeSignature("where"),S(T)])("some-pass","Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||0<t.length},[c.TypeSignature("where"),S(T)])("none-pass","Boolean",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];t=t.filter(e,r);return l.containsError(t)||0===t.length},[c.TypeSignature("where"),S(T)])("folded","Any",function(r,a){for(var e=arguments.length,t=new Array(2<e?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return"where"in a&&(t=[t[0]].concat(_toConsumableArray(a.filter(r,t.slice(1))))),l.containsError(t)||t.reduce(function(e,t,n){return a.apply(r,{making:e,loop:t,pos:n+1})})},[k(c.TypeSignature("where","via","making"),c.TypeSignature("via","making")),w(T)])(["dm-names","datamap-names","datanames"],"Array",function(e,t){return Array.from(t.keys()).sort(i("en"))},[Map])(["dm-values","datamap-values","datavalues"],"Array",function(e,t){return Array.from(t.entries()).sort(i("en",function(e){return String(e[0])})).map(function(e){return b(e[1])})},[Map])(["dm-entries","datamap-entries","dataentries"],"Array",function(e,t){return Array.from(t.entries()).sort(function(e,t){return[e[0],t[0]].sort(i("en"))[0]===e[0]?-1:1}).map(function(e){return new Map([["name",e[0]],["value",b(e[1])]])})},[Map])(["dm-altered","datamap-altered"],"Datamap",function(a,o,e){return Array.from(e.entries()).sort(function(e,t){return[e[0],t[0]].sort(i("en"))[0]===e[0]?-1:1}).reduce(function(e,t,n){if(!l.containsError(e)){var r=new Map([["name",t[0]],["value",b(t[1])]]),r=o.apply(a,{loop:r,pos:n+1});if(l.containsError(r))return r;e.set(t[0],null===r?t[1]:r)}return e},new Map)},[k(c.TypeSignature("via"),c.TypeSignature("where","via")),Map])("history","Array",function(e,t){var n=s.history();return t?(t=t.filter(e,n.map(function(e){return a.get(e)})),l.containsError(t)?t:t.map(function(e){return e.get("name")})):n},[n(c.TypeSignature("where"))])("visited","Boolean",function(e,t){var n;return"string"==typeof t?a.has(t)?0<s.passageNameVisited(t)||s.passage===t:l.create("macrocall","There's no passage named '"+t+"' in this story."):(n=s.history(),n=t.filter(e,n.concat(s.passage).map(function(e){return a.get(e)})),l.containsError(n)?n:0<n.length)},[k(String,c.TypeSignature("where"))])("passage","Datamap",function(e,t){return b(a.get(t||s.passage))||l.create("macrocall","There's no passage named '"+t+"' in this story.")},[n(String)])("passages","Array",function(e,t){var n=i("en"),r=_toConsumableArray(a.values()).map(function(e){return b(e)}),t=t?t.filter(e,r):r,e=l.containsError(t);return e||t.sort(function(e,t){return n(e.get("name"),t.get("name"))})},[n(c.TypeSignature("where"))])("open-storylets","Array",function(e,t){return e.stackTop.evaluateOnly?l.create("macrocall","(open-storylets:) can't be used in "+e.stackTop.evaluateOnly+"."):(e=a.getStorylets(e,t),l.containsError(e)||e.map(b))},[n(c.TypeSignature("where"))])("savedgames","Datamap",function(){function e(e){return"("+e+" "+p.ifid+") "}var t,n,r=0,a=new Map;do{if(!s.hasStorage)break;t=localStorage.key(r),r+=1;var o=e("Saved Game")}while(null!=(n=t)&&n.startsWith(o)&&(t=t.slice(o.length),a.set(t,localStorage.getItem(e("Saved Game Filename")+t))),t);return a},[])(["datamap","dm"],"Datamap",function(e){for(var r,a=new Map,t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=n.reduce(function(e,t){var n;if(!l.containsError(e))if(void 0===r)r=t;else{if(n=l.containsError(m(a,r)))return n;if(a.has(r))return l.create("macrocall","You used the same data name ("+d(r)+") twice in the same (datamap:) call.");a.set(r,b(t)),r=void 0}return e},!0);return l.containsError(i)?i:void 0!==r?l.create("macrocall","This datamap has a data name without a value."):a},S(k(o,T)))(["dataset","ds"],"Dataset",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Set(n.filter(y).map(b))},S(T))("count","Number",function t(n,r){for(var e,a=arguments.length,o=new Array(2<a?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];if(1<o.length)return e=o.map(function(e){return t(n,r,e)}),l.containsError(e)||e.reduce(function(e,t){return e+t},0);var s=o[0];switch(h(r)){case"dataset":case"datamap":return l.create("macrocall","(count:) shouldn't be given a datamap or dataset.","You should use the 'contains' operator instead. For instance, write: $variable contains 'value'.");case"string":return"string"!=typeof s?l.create("macrocall",d(r)+" can't contain  "+d(s)+" because it isn't also a string."):s?r.split(s).length-1:0;case"array":return r.reduce(function(e,t){return e+g(t,s)},0);default:return l.create("macrocall",d(r)+" can't contain values, let alone "+d(s)+".")}},[T,w(T)])}),define("macrolib/enchantments",["jquery","utils","utils/operationutils","engine","state","passages","macros","datatypes/hookset","datatypes/codehook","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/enchantment","internaltypes/twineerror"],function(c,r,e,l,s,n,u,p,a,d,t,i,f,h){var m=e.is,e=u.TypeSignature,g=e.either,y=e.rest,o=e.optional,b=Object.assign;function v(e,t){if(d.isPrototypeOf(t)&&!t.canEnchant)return h.create("datatype","The changer given to (".concat(e,":) can't include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:)."))}["enchant","change"].forEach(function(o){u.addCommand(o,function(e,t){t=v(o,t);if(t)return t},function(t,n,e){n=p.from(n);var r,a=[];return d.isPrototypeOf(e)&&(r=i.create({section:t}),e.run(r),0<(r.innerEnchantments||[]).length)&&(r=r.innerEnchantments.map(function(e){return e(n)}),a.push.apply(a,_toConsumableArray(r))),a.push(f.create((_defineProperty(r={scope:n},d.isPrototypeOf(e)?"changer":"lambda",e),_defineProperty(r,"section",t),r))),a.forEach(function(e){"enchant"===o?(t.addEnchantment(e),t.updateEnchantments()):e.enchantScope()}),""},[g(p,String),g(d,t.TypeSignature("via"))],!1)}),u.addChanger("enchant-in",function(e,t,n){var r=v("enchant-in",n);return r||d.create("enchant-in",[t,n])},function(t,n,r){return t.innerEnchantments=(t.innerEnchantments||[]).concat(function(e){return f.create((_defineProperty(e={scope:p.from(n),localHook:e},d.isPrototypeOf(r)?"changer":"lambda",r),_defineProperty(e,"section",t.section),e))}),t},[g(p,String),g(d,t.TypeSignature("via"))]),[["link-style",p.create({type:"name",data:"link"})],["line-style",p.create({type:"base",data:p.create({type:"name",data:"page"})},"lines",void 0)],["char-style",p.create({type:"base",data:p.create({type:"name",data:"page"})},"chars",void 0)]].forEach(function(e){var e=_slicedToArray(e,2),r=e[0],a=e[1];u.addChanger(r,function(e,t){var n=v(r,t);return n||d.create(r,[t])},function(t,n){return t.innerEnchantments=(t.innerEnchantments||[]).concat(function(e){return f.create((_defineProperty(e={scope:a,localHook:e},d.isPrototypeOf(n)?"changer":"lambda",n),_defineProperty(e,"section",t.section),e))}),t},[g(d,t.TypeSignature("via"))])});e=["replace","append","prepend"];function w(i,s){return r.onStartup(function(){var e=i.classList.replace(/ /g,"."),t=i.blockClassList?i.blockClassList.replace(/ /g,"."):"",n="."+e+(t?",."+t:"");r.storyElement.on(i.event.map(function(e){return e+".enchantment"}).join(" "),n,function(){var e,t=c(this);r.options.debug&&r.options.ignoreClickEvents&&!t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||t.is("tw-open-button")||(e=(t=c(Array.from(t.parents(n).add(this)).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0])).data("enchantmentEvent"))&&e(t)})}),[function(e,t,n){if(!t)return h.create("datatype","A string given to this ("+s+":) macro was empty.");if(n){var r=v(s,n);if(r)return r}return d.create(s,[p.from(t)].concat(n?[n]:[]))},function(t,e,n){t.enabled=!1,t.transitionDeferred=!0,i.rerender&&(t.newTargets=(t.newTargets||[]).concat({target:e,append:i.rerender}));var r,a=null!=(r=t.section)&&r.stackTop?t.section.stackTop.tempVariables:Object.create(null),o=f.create(_defineProperty({functions:[function(e){e.attr("class",e.children().is("tw-story, tw-sidebar, tw-passage")||["block","flex"].includes(e.children().css("display"))?i.blockClassList:i.classList),e.attr({tabIndex:"0"})}],data:{enchantmentEvent:function(){var e;null!=(e=t.section.stackTop)&&e.blocked||(i.once&&t.section.removeEnchantment(o),i.goto?l.goToPassage(i.goto,{transition:i.transition}):i.undo?l.goBack({transition:i.transition}):t.section.renderInto(t.source,null,_objectSpread(_objectSpread({},t),{},{append:i.once?"append":"replace",enabled:!0,transitionDeferred:!1}),a))}},scope:e,section:t.section,name:s},d.isPrototypeOf(n)?"changer":"lambda",n));return t.section&&(t.section.addEnchantment(o),o.enchantScope()),t},[g(p,String),o(g(d,t.TypeSignature("via")))]]}e.forEach(function(o){u.addChanger(o,function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.every(Boolean)?d.create(o,n.map(p.from),null,!1):h.create("datatype","A string given to this (".concat(o,":) macro was empty."))},function(e){var t;0<c(e.target).parents().filter("tw-collapsed,[collapsing=true]").length||e.attr.some(function(e){return e.collapsing})||(e.attr=[].concat(_toConsumableArray(e.attr),[{collapsing:!1}])),e.newTargets=e.newTargets||[];for(var n=arguments.length,r=new Array(1<n?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=e.newTargets).push.apply(t,_toConsumableArray(r.filter(function(n){return!e.newTargets.some(function(e){var t=e.target,e=e.append;return m(n,t)&&o===e})}).map(function(e){return{target:e,append:o,before:!0}}))),e},y(g(p,String)))(o+"-with",function(e,t){return d.create(o+"-with",[t],null,!1)},function(e,t){return a.isPrototypeOf(t)&&(t=t.code),e.appendSource=(e.appendSource||[]).concat({source:t,append:o}),e},g(a,String))});var k="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,S=[{name:"click",enchantDesc:{event:["click"],once:!0,rerender:"",classList:"link enchantment-link",blockClassList:"enchantment-clickblock"}},{name:"mouseover",enchantDesc:{event:["mouseenter",k?"click":""].filter(Boolean),once:!0,rerender:"",classList:"link enchantment-mouseover",blockClassList:"enchantment-mouseoverblock"}},{name:"mouseout",enchantDesc:{event:["mouseleave",k?"click":""].filter(Boolean),once:!0,rerender:"",classList:"link enchantment-mouseout",blockClassList:"enchantment-mouseoutblock"}},{name:"doubleclick",enchantDesc:{event:["dblclick"],once:!0,rerender:"",classList:"link enchantment-dblclick",blockClassList:"enchantment-dblclickblock"}}];S.forEach(function(e){"doubleclick"!==e.name&&(u.addChanger.apply(u,[e.name].concat(_toConsumableArray(w(e.enchantDesc,e.name)))),"click"===e.name)&&u.addChanger.apply(u,[e.name+"-rerun"].concat(_toConsumableArray(w(_objectSpread(_objectSpread({},e.enchantDesc),{},{once:!1}),e.name+"-rerun"))))}),r.onStartup(function(){S.forEach(function(e){var n=e.enchantDesc;n.blockClassList&&r.storyElement.on(n.event.map(function(e){return e+".enchantment"}).join(" "),function(){var e,t=c(this);r.options.debug&&r.options.ignoreClickEvents&&!t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||t.is("tw-open-button")||(e=(t=c(Array.from(t.parents("."+n.blockClassList.replace(/ /g,"."))).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0])).data("enchantmentEvent"))&&e(t)})})}),e.forEach(function(n){S.forEach(function(e){var t;"doubleclick"!==e&&(t=_objectSpread(_objectSpread({},e.enchantDesc),{},{rerender:n}),e=e.name+"-"+n,u.addChanger.apply(u,[e].concat(_toConsumableArray(w(t,e)))))})}),S.forEach(function(i){"doubleclick"!==i&&["goto","undo"].forEach(function(a){var o=i.name+"-"+a;u.addCommand(o,function(e,t){return!e||!t&&"goto"===a?h.create("datatype","A string given to this ("+o+":) macro was empty."):"goto"!==a||n.hasValid(t)?void 0:h.create("macrocall","I can't ("+o+":) the passage '"+t+"' because it doesn't exist.")},function(e,t,n,r){return"undo"===a&&s.pastLength<1?h.create("macrocall","I can't (undo:) on the first turn."):((0,_slicedToArray(w(_objectSpread(_objectSpread({},i.enchantDesc),{},{transition:e.data.passageT8n},"undo"===a?{undo:!0}:{goto:r}),o),2)[1])({section:t},p.from(n)),b(e,{source:""}))},[g(p,String)].concat("undo"===a?[]:String))})})}),define("macrolib/links",["jquery","macros","utils","state","passages","engine","datatypes/changercommand","internaltypes/changedescriptor","datatypes/hookset","datatypes/lambda","internaltypes/twineerror"],function(i,e,c,l,u,p,a,d,t,f,h){var n=e.TypeSignature,r=n.optional,o=n.rest,n=n.either,m=["Links can't have empty strings for their displayed text.","In the link syntax, a link's displayed text is inside the [[ and ]], and on the non-pointy side of the -> or <- arrow if it's there."],g=Object.assign;function s(e,t,n){n=n||t;var r,a=u.hasValid(t)&&t===n,e=e.evaluateTwineMarkup(c.unescape(n),"a link's passage name");return a?t=(a=0<e.children().length?"`".repeat((n.match(/`+/)||[]).reduce(function(e,t){return Math.max(e,t.length+1)},1)):"")+"\0".repeat(!!a)+t+"\0".repeat(!!a)+a:(e.findAndFilter("tw-error").length&&(r=e.findAndFilter("tw-error").data("TwineError")),n=e.text()),{text:t,passage:n,error:r}}c.onStartup(function(){var e="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints;function t(e){var t=i(this),n=t.closest("tw-expression"),r=t.closest("tw-expression, tw-hook"),a=r.data("clickEvent"),r=r.data("section");if((!c.options.debug||!c.options.ignoreClickEvents||t.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *"))&&!t.is("tw-open-button")&&(null==r||!r.stackTop||!r.stackTop.blocked||r.stackTop.blocked instanceof i&&r.stackTop.blocked.find(t).length)){if(a)return 0<t.find("tw-error").length?void 0:(e.stopPropagation(),void a(t));var r=n.data("linkPassageName"),o=_objectSpread({},n.data("passageT8n")||{});n.find("tw-enchantment").each(function(e,t){Object.assign(o,i(t).data("passageT8n")||{})}),r?(e.stopPropagation(),p.goToPassage(r,{transition:o})):t.is("[undo]")?(e.stopPropagation(),p.goBack({transition:o})):t.is("[fullscreen]")&&(e.stopPropagation(),p.toggleFullscreen())}}c.storyElement.on("click.passage-link","tw-link"+(e?"":":not(.enchantment-mouseover):not(.enchantment-mouseout):not(.enchantment-dblclick)"),t).on("mouseover.passage-link","tw-link.enchantment-mouseover, tw-expression.enchantment-mouseover > tw-link",t).on("mouseout.passage-link","tw-link.enchantment-mouseout, tw-expression.enchantment-mouseout > tw-link",t).on("dblclick.passage-link","tw-link.enchantment-dblclick, tw-expression.enchantment-dblclick > tw-link",t),i(document).on("fullscreenchange",function(){i("tw-link[fullscreen]",c.storyElement).each(function(e,t){(i(t).closest("tw-expression, tw-hook").data("fullscreenEvent")||Object)(t)})})}),[["link","link-replace"],["link-reveal","link-append"],["link-repeat"],["link-rerun"]].forEach(function(s){return e.addChanger(s,function(e,t,n){return t?n&&!n.canEnchant?h.create("datatype","The changer given to (".concat(s[0],":) can't be (or include) a revision, enchantment, or interaction changer like (replace:), (click:), or (link:).")):a.create(s[0],[t].concat(n||[]),null,!0):h.create("datatype",m[0])},function(r,e,t){var n,a=s[0],o=null!=(n=r.section)&&n.stackTop?r.section.stackTop.tempVariables:Object.create(null),i=d.create({source:"<tw-link tabindex=0>"+e+"</tw-link>",target:function(){return r.target},append:"replace",data:{section:r.section,clickEvent:function(e){r.enablers=r.enablers.filter(function(e){return e.descriptor!==i}),"link-reveal"===a&&e.contents().unwrap();var t,n=e.parentsUntil(":not(tw-enchantment)").parent();n.length||(n=e.parent()),"link-rerun"===a&&(t=e.parentsUntil(":not(tw-enchantment)"),e.detach(),t.remove()),"link"!==a&&"link-rerun"!==a||n.empty(),r.section.renderInto("",null,r,o),"link-rerun"===a&&n.prepend(e)}}});return r.enablers=(r.enablers||[]).concat({descriptor:i,changer:t}),r},[String,r(a)])}),e.addCommand("link-goto",function(e){if(!e)return h.create.apply(h,["datatype"].concat(m))},function(e,t,n,r){var a,o=s(t,n,r);return n=o.text,r=o.passage,(o=o.error)||(e.transition?h.create("datatype","Please attach ("+(o="transition")+"-depart:) or ("+o+"-arrive:) to a passage link, not ("+o+":)."):(a=(a=u.hasValid(r)?a:'<tw-broken-link passage-name="'+c.escape(r)+'">'+n+"</tw-broken-link>")||"<tw-link tabindex=0 "+(0<l.passageNameVisited(r)?'class="visited" ':"")+">"+n+"</tw-link>",e.data.linkPassageName=r,e.data.section=t,g(e,{source:a,transitionDeferred:!0})))},[String,r(String)])("link-storylet",function(){var e=(e=1===arguments.length||"string"!=typeof(arguments.length<=0?void 0:arguments[0])?0:1)<0||arguments.length<=e?void 0:arguments[e];if(!e||"string"==typeof e)return h.create("datatype","(link-storylet:) should be given one index number or one 'where' lambda, after the optional link text string.")},function(e,t){var n=(n=2+("string"==typeof(arguments.length<=2?void 0:arguments[2])?1:0))<2||arguments.length<=n?void 0:arguments[n],r="string"==typeof(arguments.length<=2?void 0:arguments[2])&&(arguments.length<=2?void 0:arguments[2]),a=((a=(arguments.length<=2?0:arguments.length-2)-1+2)<2||arguments.length<=a?void 0:arguments[a])!==n&&((a=(arguments.length<=2?0:arguments.length-2)-1+2)<2||arguments.length<=a?void 0:arguments[a]);if(e.transition)return h.create("datatype","Please attach (".concat(o="transition","-depart:) or (").concat(o,"-arrive:) to (link-storylet:), not (").concat(o,":)."));var o=f.isPrototypeOf(n),i=u.getStorylets(t,o&&n),s=h.containsError(i);if(s)return s;var c,s=i[o?0:n<0?i.length+n:n-1];if(s)s=s.get("name"),r=r||s,c=c||"<tw-link tabindex=0 "+(0<l.passageNameVisited(s)?'class="visited" ':"")+">"+r+"</tw-link>",e.data.linkPassageName=s,e.data.section=t;else{if(!a)return e;c=a}return g(e,{source:c,transitionDeferred:!0})},[n(parseInt,String,f.TypeSignature("where")),r(n(parseInt,String,f.TypeSignature("where"))),r(String)])("link-undo",function(e){if(!e)return h.create("datatype",m[0])},function(t,e,n){var r,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";return l.pastLength<1?g(t,{source:a}):(r=(t.data.section=e).stackTop.tempVariables,t.data.forgetUndosEvent=function(){return t.data.section.whenUnblocked(function(){var e=_objectSpread(_objectSpread({},t),{},{append:"replace",source:a,transitionDeferred:!1});t.section.renderInto("",null,e,r)})},g(t,{source:"<tw-link tabindex=0 undo>"+n+"</tw-link>",transitionDeferred:!0}))},[String,r(String)])("link-show",function(e){if(!e)return h.create("datatype",m[0])},function(r,a,e){for(var t=arguments.length,n=new Array(3<t?t-3:0),o=3;o<t;o++)n[o-3]=arguments[o];return r.data.section=a,r.data.clickEvent=function(e){e.contents().unwrap(),n.forEach(function(e){return e.forEach(a,function(e){var t=e.data("originalSource")||"",n=e.data("hidden");n&&(e.removeData("hidden"),n instanceof i?e.empty().append(n):(n=e.data("tempVariables"),a.renderInto("",null,_objectSpread(_objectSpread({},r),{},{source:t,target:e,transitionDeferred:!1}),n&&Object.create(n))))})})},g(r,{source:"<tw-link tabindex=0>"+e+"</tw-link>",transitionDeferred:!0})},[String,o(t)])("link-fullscreen",function(e,t){if(!e||!t)return h.create("datatype",m[0])},function(t,e,n,r){function a(){return document.fullscreenEnabled||document.msFullscreenEnabled?"<tw-link tabindex=0 fullscreen>"+(document.fullscreenElement||document.msFullscreenElement?r:n)+"</tw-link>":r?"<tw-broken-link>"+r+"</tw-broken-link>":""}var o=e.stackTop.tempVariables;return t.data.section=e,t.data.fullscreenEvent=function(){(document.fullscreenEnabled||document.msFullscreenEnabled)&&t.data.section.whenUnblocked(function(){var e=_objectSpread(_objectSpread({},t),{},{append:"replace",source:a(),transitionDeferred:!1});t.section.renderInto("",null,e,o)})},g(t,{source:a(),transitionDeferred:!0})},[String,String,r(String)]),e.addChanger(["link-reveal-goto"],function(e,t,n,r){if(!t)return h.create.apply(h,["datatype"].concat(m));if(a.isPrototypeOf(n)){if(a.isPrototypeOf(r))return h.create("datatype","You mustn't give two changers to (link-reveal-goto:)");r=n,n=void 0}return r&&!r.canEnchant?h.create("datatype","The changer given to (link-reveal-goto:) can't include a revision, enchantment, or interaction changer like (replace:), (click:), or (link:)."):(t=(e=s(e,t,n)).text,n=e.passage,e.error||a.create("link-reveal-goto",[t,n,r].filter(function(e){return void 0!==e}),null,!1))},function(t,e,n,r){var a,o,i,s;if(u.hasValid(n))return o=l.passageNameVisited(n),i=null!=(a=t.section)&&a.stackTop?t.section.stackTop.tempVariables:Object.create(null),s=d.create({source:"<tw-link tabindex=0 "+(0<o?'class="visited" ':"")+">"+e+"</tw-link>",target:t.target,append:"replace",data:{section:t.section,append:"replace",clickEvent:function(e){t.enablers=t.enablers.filter(function(e){return e.descriptor!==s}),e.contents().unwrap(),t.section.renderInto("",null,t,i),t.section.whenUnblocked(function(){return p.goToPassage(n,{transition:t.data.passageT8n})})}}}),t.enablers=(t.enablers||[]).concat({descriptor:s,changer:r}),t;t.source='<tw-broken-link passage-name="'+c.escape(n)+'">'+e+"</tw-broken-link>"},[String,r(n(a,String)),r(a)])}),define("macrolib/metadata",["macros","utils/operationutils","datatypes/lambda","internaltypes/twineerror"],function(t,e,n,s){function c(e){return{TwineScript_TypeName:"a ("+e+":) macro",TwineScript_ObjectName:"a ("+e+":) macro",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}}var l=e.clone,u=e.objectName,p=e.isValidDatamapName,e=t.TypeSignature,r=e.zeroOrMore,e=e.Any;[["storylet",n.TypeSignature("when")],["urgency",Number],["exclusivity",Number]].forEach(function(e){var e=_slicedToArray(e,2),n=e[0],e=e[1];t.add(n,"Metadata",function(e,t){return e.stackTop.speculativePassage?t:c(n)},e)}),t.add("metadata","Metadata",function(e){for(var r,a=new Map,t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=n.reduce(function(e,t){var n;if(!s.containsError(e))if(void 0===r)r=t;else{if(n=s.containsError(p(a,r)))return n;if(a.has(r))return s.create("macrocall","You used the same data name ("+u(r)+") twice in the same (metadata:) call.");a.set(r,l(t)),r=void 0}return e},!0);return s.containsError(i)?i:void 0!==r?s.create("macrocall","This (metadata:) macro has a data name without a value."):e.stackTop.speculativePassage?a:c("metadata")},r(e))}),define("macrolib/patterns",["macros","utils","utils/operationutils","datatypes/lambda","datatypes/datatype","datatypes/typedvar","internaltypes/twineerror","internaltypes/varscope"],function(e,t,n,y,b,h,v,w){function k(e){var r,t,a=e.name,n=e.fullArgs,o=e.args,i=e.makeRegExpString,s=void 0===i?function(e){return e.join("")}:i,c=void 0!==(i=e.insensitive)&&i,l=void 0===(i=e.canContainTypedVars)||i,u=void 0===(i=e.canBeUsedAlone)||i,p=void 0===(i=e.canContainTypedGlobals)||i,d=o||n,f=E(null),e=d.map(function e(t){if(h.isPrototypeOf(t)){var n=t.varRef;if(!l)return v.create("operation","Optional string patterns, like (".concat(a,":)").concat("p-many"===a?" with a minimum of 0 matches":"",", can't have typed variables inside them."));if(!p&&!w.isPrototypeOf(n.object))return v.create("operation","Only typed temp variables can be used in patterns given to (".concat(a,":)"));n=n.getName();if(n in f)return v.create("operation","There's already a typed temp variable named _".concat(n," inside this (").concat(a,":) call."));f[n]=!0;n=e(t.datatype);return v.containsError(n)?n:"("+n+")"}if(b.isPrototypeOf(t)){if(!(l&&p||"function"!=typeof t.typedVars)){n=t.typedVars();if(!l&&n.length)return v.create("operation","(".concat(a,":) can't have typed variables inside its pattern."));if(!p&&n.some(function(e){return!w.isPrototypeOf(e.varRef.object)}))return v.create("operation","Only typed temp variables can be used in patterns given to (".concat(a,":)"))}var r;return t.regExp?(t.rest?"(?:":"")+(c?t.insensitive():t).regExp+(t.rest?")*":""):(n=t.name,r=t.rest?"*":"","alnum"===n?m+r:"whitespace"===n?_+r:"uppercase"===n?(c?T:g)+r:"lowercase"===n?(c?T:S)+r:"anycase"===n?T+r:"digit"===n?"\\d"+r:"linebreak"===n?"(?:\\r|\\n|\\r\\n)"+r:"str"===n?".*?":["even","odd","int","num"].includes(n)?v.create("datatype","Please use string datatypes like 'digit' in (".concat(a,":) instead of number datatypes.")):v.create("datatype","The (".concat(a,":) macro must only be given string-related datatypes, not ").concat(O(t),".")))}return"string"==typeof t?(t=t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),c?t.replace(RegExp("(".concat(g,"|").concat(S,")"),"g"),function(e){return"["+e.toUpperCase()+e.toLowerCase()+"]"}):t):(x("createPattern","mapper() was given a non-string non-datatype "+t),"")});return(i=v.containsError(e))||(r=s(e),t=C(E(b),{name:a,regExp:r,insensitive:function(){return c?t:k({name:a,fullArgs:n,args:d.map(function(e){return b.isPrototypeOf(e)&&"function"==typeof e.insensitive?e.insensitive():e}),makeRegExpString:s,insensitive:!0,canContainTypedVars:l,canBeUsedAlone:u})},typedVars:function(){return d.reduce(function(e,t){return h.isPrototypeOf(t)&&(e=e.concat(c?h.create(k({name:"p-ins",fullArgs:[t.datatype],insensitive:!0}),t.varRef):t),t=t.datatype),e=b.isPrototypeOf(t)&&"function"==typeof t.typedVars?e.concat(t.typedVars()):e},[])},destructure:function(e){var n,t;return"string"!=typeof e?[v.create("operation","I can't put ".concat(O(e)," into ").concat(this.TwineScript_ToSource()," because it isn't a string."))]:(n=this.typedVars()).length?(t=(RegExp("^"+(this.rest?"(?:":"")+r+(this.rest?")*":"")+"$").exec(e)||[]).slice(1)).length?t.map(function(e,t){t=n[t];if(t)return t.datatype.rest&&!t.datatype.regExp&&((t=t.TwineScript_Clone()).datatype=k({name:"p",fullArgs:[t.datatype]})),{dest:t,value:e||"",src:void 0}}).filter(Boolean):[v.create("operation","I can't put ".concat(O(e)," because it doesn't match the pattern ").concat(this.TwineScript_ToSource(),"."))]:[]},TwineScript_IsTypeOf:function(e){return u?"string"==typeof e&&!!e.match("^"+(this.rest?"(?:":"")+r+(this.rest?")*":"")+"$"):v.create("operation","A (".concat(a,":) datatype must only be used with a (p:) macro."))},TwineScript_toTypeSignatureObject:function(){var t=this;return{pattern:"range",name:a,range:function(e){return t.TwineScript_IsTypeOf(e)}}},TwineScript_ToSource:function(){return(this.rest?"...":"")+"("+a+":"+n.map(A)+")"}}),Object.defineProperty(t,"TwineScript_ObjectName",{get:function(){return"a (".concat(a,":) datatype")}}),t)}var m=t.anyRealLetter,g=t.anyUppercase,S=t.anyLowercase,T=t.anyCasedLetter,_=t.realWhitespace,x=t.impossible,O=n.objectName,A=n.toSource,t=e.TypeSignature,n=t.rest,r=t.either,a=t.optional,t=t.nonNegativeInteger,C=Object.assign,E=Object.create,o=n(r(String,b,h));e.add(["p","pattern"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p",fullArgs:n})},o)(["p-either","pattern-either"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-either",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("|")+")"}})},o)(["p-opt","pattern-opt","p-optional","pattern-optional"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-opt",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("")+")?"}})},o)(["p-not","pattern-not"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.find(function(e){return"string"==typeof e?1!==_toConsumableArray(e).length:e.rest||e.regExp||["str","empty"].includes(e.name)})?v.create("datatype","(p-not:) should only be given single characters, or datatypes that match single characters"):k({name:"p-not",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"[^"+e.map(function(e){return e.startsWith("[")&&e.endsWith("]")?e.slice(1,-1):e}).join("")+"]"}})},o)(["p-not-before","pattern-not-before"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-not-before",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?!"+e.join("")+")"}})},o)(["p-before","pattern-before"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-before",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?="+e.join("")+")"}})},o)(["p-start","pattern-start"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-start",fullArgs:n,makeRegExpString:function(e){return"^(?:"+e.join("")+")"}})},o)(["p-end","pattern-end"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-end",fullArgs:n,makeRegExpString:function(e){return"(?:"+e.join("")+")$"}})},o)(["p-many","pattern-many"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,i,s=n.slice();return"number"==typeof n[0]&&(a=n.shift(),o="number"==typeof n[0]?n.shift():1/0),!(void 0!==o&&o<a)&&n.length?(i=n.find(function(e){return"string"!=typeof e&&!b.isPrototypeOf(e)&&!h.isPrototypeOf(e)}))?v.create("datatype","This (p-many:) macro can only be given a min and max number followed by datatypes or strings, but was also given "+O(i)+"."):k({name:"p-many",args:n,fullArgs:s,canContainTypedVars:0<a,makeRegExpString:function(e){return"(?:"+e.join("")+")"+(void 0!==a?"{"+a+(o===1/0?",":o!==a?","+o:"")+"}":"+")}}):v.create("datatype","The (p-many:) macro needs to be given string patterns, not just min and max numbers.")},[n(r(t,String,b,h))])(["p-ins","pattern-ins","p-insensitive","pattern-insensitive"],"Datatype",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k({name:"p-ins",fullArgs:n,insensitive:!0})},o)(["split","splitted"],"Array",function(e,t,n){if(t=k({name:"split",fullArgs:[t],canContainTypedVars:!1}),v.containsError(t))return t;if(!n)return[""];if(!t.regExp)return _toConsumableArray(n);for(var r,a=RegExp(t.regExp),o=[];n&&(r=a.exec(n));){if(r.index+r[0].length===0)return o;o.push(n.slice(0,r.index)),n=n.slice(r.index+r[0].length)}return o.concat(n||[])},[r(String,b),String])("trimmed","String",function(e,t,n){return void 0===n||b.isPrototypeOf(t)&&"whitespace"===t.name?t.trim():(t=k({name:"trimmed",fullArgs:[t],canContainTypedVars:!1}),v.containsError(t)?t:t.regExp?n.replace(RegExp("^("+t.regExp+")*|("+t.regExp+")*$","g"),""):n)},[r(String,b),a(String)])(["str-find","string-find"],"String",function(e,t,n){if(t=k({name:"str-find",fullArgs:[t],canContainTypedGlobals:!1}),v.containsError(t))return t;for(var r,a=t.typedVars(),o=RegExp(t.regExp,"g"),i=[],s=o.lastIndex;(r=o.exec(n))&&s!==o.lastIndex;)if(s=o.lastIndex,a.length){for(var c=new Map,l=0;l<a.length;l+=1){if("match"===a[l].varRef.getName())return v.create("macrocall","There was a typed temp variable named _match in the pattern given to (str-find:)","The variable _match is reserved, and can't be used inside (str-find:)'s pattern.");c.set(a[l].varRef.getName(),r[l+1]),c.set("match",r[0])}i.push(c)}else i.push(r[0]);return i},[b,String])(["str-replaced","string-replaced","replaced"],"String",function(e,t,n,r,a){if("number"!=typeof t){if(void 0!==a)return v.create("macrocall","1 too many values were given to (str-replaced:).","If this is given 5 values, the first value must be a number of replacements.");a=r,r=n,n=t,t=1/0}else if(void 0===a)return v.create("macrocall","The (str-replaced:) macro needs 1 more value.","The final string seems to be missing.");if(b.isPrototypeOf(r))return v.create("datatype","The replacement value for (str-replaced:) must be a string or lambda, not ".concat(O(r)));if(y.isPrototypeOf(a)||y.isPrototypeOf(n))return v.create("datatype","The ".concat(y.isPrototypeOf(a)?"final string":"search pattern"," given to (str-replaced:) can't be a lambda."),"Only the replacement value (after the search pattern) can be a 'via' lambda.");if(n=k({name:"str-replaced",fullArgs:[n],canContainTypedGlobals:!1}),v.containsError(n))return n;if(!n.regExp)return a;for(var o,i=RegExp(n.regExp,"g"),s=y.isPrototypeOf(r)?n.typedVars():[],c=1,l=0,u="",p=i.lastIndex;a&&(o=i.exec(a))&&0<t&&p!==i.lastIndex;){for(var p=i.lastIndex,d=Object.create(e.stack.length?e.stackTop.tempVariables:w),f=0;f<s.length;f+=1){var h=s[f],m=h.varRef.create(d,h.varRef.propertyChain);if(v.containsError(m))return m;h=m.defineType(h.datatype);if(v.containsError(h))return h;m.set(o[f+1])}var g=y.isPrototypeOf(r)?r.apply(e,{loop:o[0],pos:c,tempVariables:d}):r;if(v.containsError(g))return g;if("string"!=typeof g)return v.create("datatype","(str-replaced:)'s lambda must produce a string, but it produced ".concat(O(g),' when given "').concat(o[0],'".'));u+=a.slice(l,o.index)+g,c+=1,--t,l=o.index+o[0].length}return u+=a.slice(l)},[r(t,String,b),r(b,String,y.TypeSignature("via")),r(String,y.TypeSignature("via")),a(String)])}),define("macrolib/stylechangers",["jquery","macros","utils","utils/renderutils","datatypes/colour","datatypes/hookset","datatypes/gradient","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/twineerror"],function(s,e,c,t,a,n,r,o,i,l,u){var p,d,f=t.geomParse,h=t.geomStringRegExp,m=Object.assign,t=e.TypeSignature,g=t.either,y=t.wrapped,b=t.optional,v=t.Any,w=t.Everything,k=t.zeroOrMore,S=t.rest,T=t.insensitiveSet,_=t.positiveNumber,x=t.positiveInteger,O=t.nonNegativeNumber,t=t.percent,y=[y(Boolean,'If you gave a number, you may instead want to check that the number is not 0. If you gave a string, you may instead want to check that the string is not "".')],A=(c.onStartup(function(){return c.storyElement.on("mouseenter.hover-macro","[hover=false]",function(){var e=s(this),t=e.data("hoverChanger");c.options.debug&&c.options.ignoreClickEvents&&!e.is("tw-backdrop.eval-replay *, tw-backdrop.harlowe-crash *")||(e.data({mouseoutStyle:e.attr("style")||""}),l.create({target:e},t).update(),e.attr("hover",!0))}).on("mouseleave.hover-macro","[hover=true]",function(){var e=s(this),t=e.data("mouseoutStyle");e.attr("style",t).removeData("mouseoutStyle").attr("hover",!1)})}),u.on(function(){s("tw-expression, tw-hook",c.storyElement).each(function(e,t){((t=s(t)).data("errorEvent")||Object)(t)})}),T("instant","dissolve","fade","rumble","shudder","pulse","zoom","flicker","slideleft","slideright","slideup","slidedown","fadeleft","faderight","fadeup","fadedown","blur")),C=T("dotted","dashed","solid","double","groove","ridge","inset","outset","none");e.addChanger("if",function(e,t){return o.create("if",[t])},function(e,t){return e.enabled=e.enabled&&t},y)("unless",function(e,t){return o.create("unless",[t])},function(e,t){return e.enabled=e.enabled&&!t},y)("elseif",function(e,t){return"lastHookShown"in e.stack[0]?o.create("elseif",[!1===e.stack[0].lastHookShown&&!!t]):u.create("macrocall","There's no (if:) or something else before this to do (else-if:) with.")},function(e,t){return e.enabled=e.enabled&&t},y)("else",function(e){return"lastHookShown"in e.stack[0]?o.create("else",[!1===e.stack[0].lastHookShown]):u.create("macrocall","There's nothing before this to do (else:) with.")},function(e,t){return e.enabled=e.enabled&&t},null)("hidden",function(){return o.create("hidden")},function(e){return e.enabled=!1},null)(["verbatim","v6m"],function(){return o.create("verbatim")},function(e){return e.verbatim=!0},null)("live",function(e,t){return o.create("live",t?[t]:[])},function(e,t){e.enabled=!1,e.transitionDeferred=!0,e.data.live={delay:t}},b(Number))("event",function(e,t){return o.create("event",[t])},function(e,t){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:t}},i.TypeSignature("when"))("more",function(){return o.create("more")},function(e){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:{when:!0,filter:function(e){return 0!==e.Identifiers.exits?[]:[!0]}}}},null)("after",function(e,t,n){return o.create("after",[t].concat(void 0!==n?[n]:[]))},function(e,t,n){e.enabled=!1,e.transitionDeferred=!0,e.data.live={event:{when:!0,filter:function(e){return c.anyInputDown()&&n&&(t-=n),e.Identifiers.time>t?[!0]:[]}}}},[_,b(O)])("after-error",function(){return o.create("after-error",[])},function(n){n.enabled=!1,n.transitionDeferred=!0;var r=n.section.stackTop.tempVariables;n.data.errorEvent=function(e){e.removeData("errorEvent");var t=_objectSpread(_objectSpread({},n),{},{enabled:!0,transitionDeferred:!1});t.data&&(t.data.errorEvent=void 0),n.section.whenUnblocked(function(){return n.section.renderInto("",null,t,r)})}},[])("hook",function(e,t){var n;return t?(n=c.insensitiveName(t))?o.create("hook",[n]):u.create("datatype",'The string given to (hook:), "'.concat(t,'", contained only dashes and underscores.')):u.create("datatype","The string given to (hook:) was empty.")},function(e,t){return e.attr.push({name:t})},[String])(["for","loop"],function(e,t){if(!t.loop)return u.create("datatype","The lambda provided to (for:) must refer to a temp variable, not just 'it'.");for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return o.create("for",[t].concat(r))},function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o,i=t.filter(e.section,r);if(o=u.containsError(i))return o;e.loopVars[t.loop.getName()]=i||[]},[i.TypeSignature("where"),k(v)])(["transition","t8n"],function(e,t){return o.create("transition",[c.insensitiveName(t)])},function(e,t){return"zoom"===(e.transition=t)&&(e.transitionOrigin=function(){var e=s(this).offset(),t=e.left,e=e.top;return c.mouseCoords.x-t+"px "+(c.mouseCoords.y-e)+"px"}),e},[A])(["transition-time","t8n-time"],function(e,t){return o.create("transition-time",[t])},function(e,t){return e.transitionTime=t,e.data.passageT8n=m(e.data.passageT8n||{},{time:t}),e},[_])(["transition-delay","t8n-delay"],function(e,t){return o.create("transition-delay",[t])},function(e,t){return e.transitionDelay=t,e},[O])(["transition-skip","t8n-skip"],function(e,t){return o.create("transition-skip",[t])},function(e,t){return e.transitionSkip=t,e},[_])(["transition-depart","t8n-depart"],function(e,t){return o.create("transition-depart",[c.insensitiveName(t)])},function(e,t){return e.data.passageT8n=m(e.data.passageT8n||{},{depart:t}),"zoom"===t&&(e.data.passageT8n.departOrigin=function(){var e=s(this).offset(),t=e.left,e=e.top;return c.mouseCoords.x-t+"px "+(c.mouseCoords.y-e)+"px"}),e},[A])(["transition-arrive","t8n-arrive"],function(e,t){return o.create("transition-arrive",[c.insensitiveName(t)])},function(e,t){return e.data.passageT8n=m(e.data.passageT8n||{},{arrive:t}),"zoom"===t&&(e.data.passageT8n.arriveOrigin=function(){var e=s(this),t=e.offset(),n=t.left,t=t.top,r=e.height();return{"transform-origin":100*(c.mouseCoords.x-n)/e.width()+"% "+100*(c.mouseCoords.y-t)/r+"%",height:r+"px"}}),e},[A])("button",function(e,t){return void 0===t||f(t).size?o.create("button",t?[t]:[]):u.create("datatype",'The string given to (button:) should be a sizing line ("==X==", "==X", "=XXXX=" etc.), not '.concat(JSON.stringify(t),"."))},function(e,t){var t=f(t),n=t.marginLeft,t=t.size;return e.attr.push({class:function(){return this.className+(this.classList.contains("enchantment-button")?"":" ".repeat(0<this.className.length)+"enchantment-button")}}),e.styles.push({"margin-left":t?n+"%":void 0,width:t?t+"%":"100%"}),e},[b(String)]).apply(void 0,_toConsumableArray((d={click:{className:"enchantment-link",blockClassName:"enchantment-clickblock"},doubleclick:{className:"enchantment-dblclick",blockClassName:"enchantment-dblclickblock"},mouseover:{className:"enchantment-mouseover",blockClassName:"enchantment-mouseoverblock"},mouseout:{className:"enchantment-mouseout",blockClassName:"enchantment-mouseoutblock"}},["action",function(e,t){return o.create("action",[c.insensitiveName(t)])},function(e,t){return e.attr.push({class:function(){var e=function e(t){return(t=s(t)).is("tw-story, tw-sidebar, tw-passage")||["block","flex"].includes(t.css("display"))||t.children().get().some(e)}(this);return Array.from(this.classList).filter(function(t){return!Object.keys(d).some(function(e){return d[e].className===t||d[e].blockClassName===t})}).concat(d[t][e?"blockClassName":"className"]).join(" ")}}),e},[T.apply(void 0,_toConsumableArray(Object.keys(d)))]])))(["border","b4r"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border",n.map(c.insensitiveName))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({display:function(){var e=s(this).css("display");return n.every(function(e){return"none"===e})||!e.includes("inline")?e:"inline-block"},"border-style":n.join(" "),"border-width":function(){return this.style.borderWidth||"2px"}}),e},[C].concat(_toConsumableArray(Array(3).fill(b(C)))))(["border-size","b4r-size"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border-size",n)},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-width":n.map(function(e){return e+"px"}).join(" ")}),e},[O].concat(_toConsumableArray(Array(3).fill(b(O)))))("corner-radius",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("corner-radius",n)},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-radius":n.map(function(e){return e+"px"}).join(" "),padding:function(){return this.style.padding||n.map(function(e){return e+"px"}).join(" ")}}),e},[O].concat(_toConsumableArray(Array(3).fill(b(O)))))(["border-colour","b4r-colour","border-color","b4r-color"],function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("border-colour",n.map(function(e){return a.isPrototypeOf(e)?e.toRGBAString(e):e}))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-color":n.join(" ")}),e},[g(String,a)].concat(_toConsumableArray(Array(3).fill(b(g(String,a))))))("opacity",function(e,t){return o.create("opacity",[t])},function(e,t){return e.styles.push({opacity:t})},[t])("font",function(e,t){return o.create("font",[t])},function(e,t){return e.styles.push({"font-family":t}),e},[String])("align",function(e,t){var n=t.indexOf("><");return/^(==+>|<=+|=+><=+|<==+>)$/.test(t)?((n=~n?_objectSpread({"text-align":"center","max-width":"50%"},25===(n=Math.round(n/(t.length-2)*50))?{"margin-left":"auto","margin-right":"auto"}:{"margin-left":n+"%"}):"<"===t[0]&&">"===t.slice(-1)?{"text-align":"justify","max-width":"50%"}:t.includes(">")?{"text-align":"right"}:{"text-align":"left"}).display="block",o.create("align",[n])):u.create("datatype",'The (align:) macro requires an alignment arrow ("==>", "<==", "==><=" etc.) be provided, not "'+t+'"')},function(e,t){e.styles.push(t)},[String])(["text-colour","text-color","color","colour"],function(e,t){return o.create("text-colour",[t])},function(e,t){return a.isPrototypeOf(t)&&(t=t.toRGBAString(t)),e.styles.push({color:t}),e},[g(String,a)])(["text-size","size"],function(e,t){return o.create("text-size",[t])},function(e,t){return e.styles.push({"font-size":24*t+"px","line-height":36*t+"px"}),e},[O])("text-indent",function(e,t){return o.create("text-indent",[t])},function(e,t){return e.styles.push({"text-indent":t+"px",display:"inline-block"}),e},[O])(["text-rotate-z","text-rotate"],function(e,t){return o.create("text-rotate-z",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" rotate("+t+"deg)"}}),e},[Number])("text-rotate-y",function(e,t){return o.create("text-rotate-y",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" perspective(50vw) rotateY("+t+"deg)"}}),e},[Number])("text-rotate-x",function(e,t){return o.create("text-rotate-x",[t])},function(e,t){return e.styles.push({display:"inline-block",transform:function(){var e=s(this).css("transform")||"";return(e="none"===e?"":e)+" perspective(50vw) rotateX("+t+"deg)"}}),e},[Number])(["background","bg"],function(e,t){return o.create("background",[t])},function(e,t){return a.isPrototypeOf(t)?t=t.toRGBAString():r.isPrototypeOf(t)&&(t=t.toLinearGradientString()),t=a.isHexString(t)||a.isCSS3Function(t)?{"background-color":t}:t.startsWith("linear-gradient(")||t.startsWith("repeating-linear-gradient(")?{"background-image":t}:{"background-size":"cover","background-image":"url(".concat(t,")"),"background-attachment":"fixed"},e.styles.push(t,{display:function(){var e=s(this);return!e.children().length||c.childrenProbablyInline(e)?s(this).css("display"):"block"}}),e},[g(String,a,r)]).apply(void 0,_toConsumableArray((y={color:function(){return"transparent"}},p=m(Object.create(null),{none:{},bold:{"font-weight":"bold"},italic:{"font-style":"italic"},underline:{"text-decoration":"underline"},doubleunderline:{"text-decoration":"underline","text-decoration-style":"double"},wavyunderline:{"text-decoration":"underline","text-decoration-style":"wavy"},strike:{"text-decoration":"line-through"},doublestrike:{"text-decoration":"line-through","text-decoration-style":"double"},wavystrike:{"text-decoration":"line-through","text-decoration-style":"wavy"},superscript:{"vertical-align":"super","font-size":".83em"},subscript:{"vertical-align":"sub","font-size":".83em"},blink:{animation:"fade-in-out 1s steps(1,end) infinite alternate"},shudder:{animation:"shudder linear 0.1s 0s infinite"},mark:{"background-color":"hsla(60, 100%, 50%, 0.6)"},condense:{"letter-spacing":"-0.08em"},expand:{"letter-spacing":"0.1em"},outline:[{"text-shadow":function(){var e=s(this).css("color");return"-1px -1px 0 "+e+", 1px -1px 0 "+e+",-1px  1px 0 "+e+", 1px  1px 0 "+e}},{color:function(){return c.parentColours(s(this)).backgroundColour}}],shadow:{"text-shadow":function(){return"0.08em 0.08em 0.08em "+s(this).css("color")}},emboss:{"text-shadow":function(){return"0.04em 0.04em 0em "+s(this).css("color")}},smear:[{"text-shadow":function(){var e=s(this).css("color");return"0em   0em 0.02em "+e+",-0.2em 0em  0.5em "+e+", 0.2em 0em  0.5em "+e}},y],blur:[{"text-shadow":function(){return"0em 0em 0.08em "+s(this).css("color")}},y],blurrier:[{"text-shadow":function(){return"0em 0em 0.2em "+s(this).css("color")},"user-select":"none"},y],mirror:{display:"inline-block",transform:"scaleX(-1)"},upsidedown:{display:"inline-block",transform:"scaleY(-1)"},tall:{display:"inline-block",transform:"scaleY(1.5) translateY(-0.25ex)"},flat:{display:"inline-block",transform:"scaleY(0.5) translateY(0.25ex)"},fadeinout:{animation:"fade-in-out 2s ease-in-out infinite alternate"},rumble:{animation:"rumble linear 0.1s 0s infinite"},sway:{animation:"sway linear 2.5s 0s infinite"},buoy:{animation:"buoy linear 2.5s 0s infinite"},fidget:{animation:function(){return"fidget step-end 60s "+60*-Math.random()+"s infinite"+(Math.random()<.5?" reverse":"")}}}),["text-style",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.create("text-style",n.map(c.insensitiveName))},function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=1)"none"===n[a]?e.styles=[]:e.styles=e.styles.concat(p[n[a]]);return e},[S(T.apply(void 0,_toConsumableArray(Object.keys(p))))]])))("collapse",function(){return o.create("collapse")},function(e){return e.attr.push({collapsing:!0}),e},[])("hover-style",function(e,t){var n=l.create(),r=(t.run(n),n.summary());return r+""=="styles"||r.every(function(e){return"styles"===e||"attr"===e})&&n.attr.every(function(e){return Object.keys(e)+""=="style"})?o.create("hover-style",[t]):u.create("datatype","The changer given to (hover-style:) must only change the hook's style.")},function(e,t){return e.data.hoverChanger=t,e.attr.push({hover:function(e,t){return void 0!==t&&t}}),e},[o])("css",function(e,t){return t.trim().endsWith(";")||(t+=";"),o.create("css",[t])},function(e,t){return e.attr.push({style:function(){return(s(this).attr("style")||"")+t}}),e},[String])("test-true",function(){return o.create("test-true",[])},function(e){return e.enabled=!0},k(w))("test-false",function(){return o.create("test-false",[])},function(e){return e.enabled=!1},k(w)),e.addCommand("animate",s.noop,function(r,e,t,a,o){t.forEach(e,function(e){var t,n;"zoom"===name&&(n=(t=e.offset()).left,t=t.top,n=c.mouseCoords.x-n+"px "+(c.mouseCoords.y-t)+"px"),c.transitionIn(e,a,r.transitionTime||o,r.transitionDelay,r.transitionSkip,0,n)})},[S(n),T.apply(void 0,_toConsumableArray(A.innerType.filter(function(e){return"instant"!==e}))),b(_)]),["box","float-box"].forEach(function(i){return e.addChanger(i,function(e,t,n){var r=-1===t.search(h)||1<t.length&&!t.includes("="),a="float-box"===i&&(-1===n.search(h)||1<n.length&&!n.includes("="));return r||a?u.create("datatype","The ("+i+':) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not "'+(r?t:n)+'".'):o.create(i,[t,n].filter(function(e){return void 0!==e}))},function(e,t,n){var r,t=f(t),a=t.marginLeft,t=t.size,o=("float-box"===i&&(r=(o=f(n)).marginLeft,n=o.size),"box"===i?"%":"vw"),a=(_defineProperty(t={display:"block",width:t+o,"max-width":t+o},"box"===i?"margin-left":"left",a+o),_defineProperty(t,"overflow-y","auto"),_defineProperty(t,"padding",function(){var e=s(this).css("padding");return e&&"0px"!==e?e:"1em"}),t);return void 0!==n&&(a.height="box"===i?1.5*n+2+"em":n+"vh"),"float-box"===i&&m(a,{position:"fixed",top:r+"vh","background-color":function(){return c.parentColours(s(this)).backgroundColour}}),e.styles.push(a),e},[String,"box"===i?b(x):String])})}),define("macrolib/values",["macros","state","utils","utils/operationutils","datatypes/colour","datatypes/gradient","datatypes/datatype","datatypes/hookset","datatypes/codehook","internaltypes/twineerror"],function(t,r,e,n,l,c,a,o,i,f){var s=e.realWhitespace,u=e.nth,p=e.anyRealLetter,d=e.plural,h=n.subset,m=n.objectName,g=n.clone,y=n.toSource,e=t.TypeSignature,n=e.rest,b=e.zeroOrMore,v=e.either,w=e.optional,k=e.insensitiveSet,S=e.numberRange,T=e.percent,_=e.nonNegativeInteger,x=e.positiveInteger,e=e.Any,O=Math.max,A=Math.min,C=Math.round,E=Math.floor,N=Math.ceil;function j(t){return function(){var e=t.apply(void 0,arguments);return"number"!=typeof e||isNaN(e)?f.create("macrocall","This mathematical expression doesn't compute!"):e}}t.add(["str","string","text"],"String",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.map(function(e){return i.isPrototypeOf(e)?e.source:e}).join("")},[b(t.TypeSignature.either(String,Number,Boolean,Array,i))])("source","String",function(e,t){return"command"!==(null==t?void 0:t.TwineScript_TypeID)||t.TwineScript_ToSource?y(t):f.create("datatype","I can't construct the source code of a command created by a custom macro.")},[e])("substring","String",function(e,t,n,r){return h(t,n,r)},[String,parseInt,parseInt])("lowercase","String",function(e,t){return t.toLowerCase()},[String])("uppercase","String",function(e,t){return t.toUpperCase()},[String])("lowerfirst","String",function(e,t){return t.replace(RegExp(p+"+"),function(e){return(e=Array.from(e))[0].toLowerCase()+e.slice(1).join("").toLowerCase()})},[String])("upperfirst","String",function(e,t){return t.replace(RegExp(p+"+"),function(e){return(e=Array.from(e))[0].toUpperCase()+e.slice(1).join("").toLowerCase()})},[String])("words","Array",function(e,t){return t.split(RegExp(s+"+")).filter(Boolean)},[String])(["str-repeated","string-repeated"],"String",function(e,t,n){return 0===n.length?f.create("macrocall","I can't repeat an empty string."):n.repeat(t)},[_,String])(["str-reversed","string-reversed"],"String",function(e,t){return _toConsumableArray(t).reverse().join("")},[String])("joined","String",function(e,t){for(var n=arguments.length,r=new Array(2<n?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.join(t)},[n(String)])("plural","String",function(e,t,n,r){return n&&""!==r?d(t,n,r):f.create("macrocall","The (plural:) macro can't be given empty strings.")},[parseInt,String,w(String)])(["str-nth","string-nth"],"String",function(e,t){return u(t)},[parseInt])("digit-format","String",function(e,t,n){if(1e21<=Math.abs(n))return f.create("macrocall","The number given to (digit-format:) is too big.");for(var r=/([^#0])(?=[#0]*$)/g,a=(r.exec(t)||[])[1],o=(/^[#0]*([^#0])/g.exec(t)||[])[1],i=(t=_toConsumableArray(t)).length,s=(a&&(","!==a||o&&","!==o)&&(i=r.lastIndex-1),Math.abs(n).toFixed(16).replace(/(\.\d*?)0+$/,function(e,t){return t}).replace(/^0+/,"")),c=s.includes(".")?s.indexOf("."):s.length,l=0,u="",p=t.length-1;0<=p;--p){var d=t[p];"0"===d||"#"===d?u=(s[c-i+p+l]||("0"===d?"0":""))+u:p<t.length-1&&0<p&&(u=d+u,l+=p===i?0:1)}return(n<0?"-":"")+u},[String,Number])(["num","number"],"Number",function(e,t){return Number.isNaN(+t)?f.create("macrocall","I couldn't convert "+m(t)+" to a number."):+t},[String])("datatype","Datatype",function(e,t){return a.from(t)},[e])("datapattern","Any",function(e,t){return function n(e){var r;return Array.isArray(e)?r=e.map(n):e instanceof Map?(r=new Map,_toConsumableArray(e).forEach(function(e){var e=_slicedToArray(e,2),t=e[0],e=e[1];return r.set(t,n(e))})):r=a.from(e),(e=f.containsError(r))||r}(t)},[e])(["rgb","rgba"],"Colour",function(e){return l.create({r:arguments.length<=1?void 0:arguments[1],g:arguments.length<=2?void 0:arguments[2],b:arguments.length<=3?void 0:arguments[3],a:arguments.length<=4?void 0:arguments[4]})},[S(0,255),S(0,255),S(0,255),w(T)])(["hsl","hsla"],"Colour",function(e,t,n,r,a){return(t=C(t)%360)<0&&(t+=360),l.create({h:t,s:n,l:r,a:a})},[Number,T,T,w(T)])(["lch","lcha"],"Colour",function(e,t,n,r,a){return(r=C(r)%360)<0&&(r+=360),l.create({l:t,c:n,h:r,a:a})},[T,S(0,132),Number,w(T)])("complement","Colour",function(e,t){return t.LCHRotate(180)},[l])("mix","Colour",function(e,t,n,r,a){n=n.toLCHA(),a=a.toLCHA();var o=1,i=(t+r!==1&&(t+r<1&&(o=t+r),t=(i=[t/(t+r),r/(t+r)])[0],r=i[1]),n.c<2||n.l<.01||.99<n.l?n.h=a.h:(a.c<2||a.l<.01||.99<a.l)&&(a.h=n.h),n.l*=n.a,n.c*=n.a,a.l*=a.a,a.c*=a.a,180<a.h-n.h?n.h+=360:a.h-n.h<-180&&(a.h+=360),n.a*t+a.a*r),s=(n.l*t+a.l*r)/i,c=(n.c*t+a.c*r)/i,n=(n.h*t+a.h*r)/i;return l.create({l:s,c:c,h:n,a:i*o})},[T,l,T,l])("palette","Array",function(e,t,n){var r,a=n.toLCHA(),o=a.l,a={l:o<=.75?.75+o/3:.75-3*(1-o),c:80,h:a.h,a:1},i=l.create(a);return a.l+=o<=.75?-.1:.1,a.l<.5&&(a.l*=.5/a.l),r=l.create(a),a.l+=o<=.85?.15:-.15,o=l.create(a),"adjacent"===t?(r=(i=i.LCHRotate(-30)).LCHRotate(30),o=i.LCHRotate(60)):"triad"===t&&(o=i.LCHRotate(180),r=i.LCHRotate(140),i=i.LCHRotate(-140)),[n,i,r,o]},[k("mono","adjacent","triad"),l])("gradient","Gradient",function(e,t){(t=C(t)%360)<0&&(t+=360);for(var n,r,a,o=arguments.length,i=new Array(2<o?o-2:0),s=2;s<o;s++)i[s-2]=arguments[s];return i.length<4?f.create("datatype","(gradient:) must be given at least 2 colour-stop pairs of numbers and colours."):(r=[],a=i.reduce(function(e,t){if(!f.containsError(e))if(void 0===n)n=t;else{if("number"!=typeof n||!l.isPrototypeOf(t))return f.create("datatype","(gradient:) colour-stops should be pairs of numbers and colours, not colours and numbers.");r.push({stop:n,colour:g(t)}),n=void 0}return e},!0),f.containsError(a)?a:void 0!==n?f.create("macrocall","This gradient has a colour-stop percent without a colour."):c.create(t,r))},[Number,n(v(T,l))])("stripes","Gradient",function(e,t,n){(t=C(t)%360)<0&&(t+=360);for(var r=0,a=[],o=arguments.length,i=new Array(3<o?o-3:0),s=3;s<o;s++)i[s-3]=arguments[s];return i.forEach(function(e){a.push({stop:r,colour:g(e)}),r+=n,a.push({stop:r,colour:g(e)})}),c.create(t,a,!0)},[Number,x,l,n(l)])("hooks-named","HookName",function(e,t){return t?o.create({type:"name",data:t}):f.create("datatype","(hooks-named:) can't be given an empty string.")},[String])("cond","Any",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=2){var o=n[a];if(a===n.length-1||f.containsError(o))return o;if("boolean"!=typeof o)return f.create("datatype","(cond:)'s "+u(a+1)+" value is "+m(o)+", but should be a boolean.");if(o)return n[a+1]}return f.create("macrocall","An odd number of values must be given to (cond:), not "+n.length,"(cond:) must be given one or more pairs of booleans and values, as well as one final value.")},[Boolean,e,n(e)]);({weekday:[function(){return["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][(new Date).getDay()]+"day"},null],monthday:[function(){return(new Date).getDate()},null],currenttime:[function(){var e=new Date,t=e.getHours()<12;return(e.getHours()%12||12)+":"+((e.getMinutes()<10?"0":"")+e.getMinutes())+" "+(t?"A":"P")+"M"},null],currentdate:[function(){return(new Date).toDateString()},null],min:[A,n(Number)],max:[O,n(Number)],abs:[Math.abs,Number],sign:[Math.sign,Number],sin:[Math.sin,Number],cos:[Math.cos,Number],tan:[Math.tan,Number],floor:[E,Number],round:[C,Number],trunc:[function(e){return(0<e?E:N)(e)},Number],ceil:[N,Number],pow:[j(Math.pow),[Number,Number]],exp:[Math.exp,Number],sqrt:[j(Math.sqrt),Number],log:[j(Math.log),Number],log10:[j(Math.log10),Number],log2:[j(Math.log2),Number],random:[function(e,t){var n,t=t?(n=A(e,t),O(e,t)):(n=0,e);return t+=1,~~(r.random()*(t-n))+n},[parseInt,t.TypeSignature.optional(parseInt)]],"":function(){for(var e in this)e&&hasOwnProperty.call(this,e)&&t.add(e,"Number",function(a){return function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.apply(void 0,n)}}(this[e][0]),this[e][1])}})[""](),t.add("either","Any",function(e){var t=1+~~(r.random()*(arguments.length<=1?0:arguments.length-1));return t<1||arguments.length<=t?void 0:arguments[t]},n(e))("nth","Any",function(e,t){return t<=0?f.create("datatype","(nth:)'s first value should be a positive whole number, not "+t):(t=(t-1)%(arguments.length<=2?0:arguments.length-2)+2)<2||arguments.length<=t?void 0:arguments[t]},[parseInt,n(e)])}),!function(){var a,k={};function o(e){for(var t in e)this[t]=e[t]}function i(e,t){for(var n,r,a=e.innerText,o=null,i=0,s=i,c=a.length,l=null;i<c;){for(var u=a.slice(i),p=(o&&o.length?o[0]:e).innerMode,d=0,f=p.length;d<f;d+=1){var h=k[p[d]];if(!(h.constraint&&!h.constraint(l)||h.cannotFollowText&&("text"===(null==(w=l)?void 0:w.type)||s<i))&&(h.plainCompare?u.startsWith(h.pattern):h.pattern.test(u))){var m=h.fn(h.plainCompare?h.pattern:h.pattern.exec(u)),g=!1,y=0;if(m.matches){for(;o&&y<o.length;y+=1){var b=o[y],v=b.type,b=b.aka;if(v in m.matches){g=!0;break}b&&(v=b),-1<(null==(b=m.cannotCross)?void 0:b.indexOf(v))&&(y=o.length-1)}if((!o||y>=o.length)&&!m.isFront)continue}s<i&&e.addChild({type:"text",text:a.slice(s,i),innerMode:p});var s=i+=(l=e.addChild(m)).text.length,w=!1;g&&(t&&S(e,l,o[y]),o=o.slice(y+1),w=!0),!w&&l.isFront&&(o?o.unshift(l):o=[l]);break}}d===f&&(i+=1,null===l)&&(l={type:"text"})}for(s<i&&e.addChild({type:"text",text:a.slice(s,i),innerMode:(null!=(n=o)&&n.length?o[0]:e).innerMode});0<(null==(r=o)?void 0:r.length);)o.shift().demote();return e}function S(e,t,n){var r=e.children.indexOf(t),a=e.children.indexOf(n);t.children=e.children.splice(a+1,r-(a+1)),t.type=t.matches[n.type],t.innerText="";for(var o,i=0,s=t.children.length;i<s;i++)t.innerText+=t.children[i].text;for(o in t.start=n.start,t.text=n.text+t.innerText+t.text,n)hasOwnProperty.call(n,o)&&!hasOwnProperty.call(t,o)&&(t[o]=n[o]);t.isFront&&(t.isFront=!1),e.children.splice(a,1)}o.prototype={constructor:o,addChild:function(e){var t=this.lastChildEnd(),n=new o(e);return n.start=t,n.end=e.text&&t+e.text.length,n.place=this.place,n.children=[],n.innerText&&i(n),this.children.push(n),n},lastChildEnd:function(){var e=this.children&&this.children[this.children.length-1]||null;return e?e.end:this.start+Math.max(0,this.text.indexOf(this.innerText))},tokenAt:function(e){if(e<this.start||e>=this.end)return null;if(this.children.length)for(var t=0;t<this.children.length;t+=1)if(e>=this.children[t].start&&e<this.children[t].end){var n=this.children[t].tokenAt(e);if(n)return n}return this},pathAt:function(e){if(e<this.start||e>=this.end)return[];var t=[];if(this.children.length)for(var n=0;n<this.children.length;n+=1)if(e>=this.children[n].start&&e<this.children[n].end){var r=this.children[n].pathAt(e);if(r.length){t=t.concat(r);break}}return t.concat(this)},nearestTokenAt:function(n){return n<this.start||n>=this.end?null:this.children?this.children.reduce(function(e,t){return e||(n>=t.start&&n<t.end?t:null)},null):this},everyLeaf:function(n){return this.children&&0!==this.children.length?this.children.reduce(function(e,t){return e&&t.everyLeaf(n)},!0):!!n(this)},demote:function(){this.type="text"},error:function(e){this.type="error",this.message=e},toString:function(){var e=this.type+"("+this.start+"\u2192"+this.end+")";return this.children&&0<this.children.length&&(e+="["+this.children+"]"),e},copy:function(){var e=new o(this);return e.children=e.children.slice(),e},foldChildren:function(){for(var e=[],t=this.children.slice(),n=0;n<t.length;n+=1){var r=t[n],a=!1;if(r.matches)for(var o=0;o<e.length;o+=1)e[o].type in r.matches&&(S(this,r,e[o]),e=e.slice(o+1),a=!0);!a&&r.isFront&&e.unshift(r)}}},a={lex:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"start",r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return i(new o({type:"root",place:t,start:0,end:e.length,text:e,innerText:e,children:[],innerMode:a.modes[n]}),!r)},rules:k,modes:{}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=a:"function"==typeof define&&define.amd?define("lexer",[],function(){return a}):this&&null!=this&&this.loaded?(this.modules||(this.modules={}),this.modules.Lexer=a):this.Lexer=a}.call(eval("this")||("undefined"!=typeof global?global:window)),!function(){Object.assign=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var m,g=Object.keys,y=Object.assign;function t(e){function t(n){return n=n||"innerText",function(e){var e=e.reduceRight(function(e,t,n){return e||(n?t:"")},""),t={};return t[n]=e,t}}function n(e,t){var n={};return n[e]=t,function(){return{isFront:!0,matches:n,cannotCross:["verbatimOpener"]}}}var r=Object.bind(0,null);function a(a,e){return Object.keys(e).forEach(function(n){var r=e[n].fn;e[n].fn=function(e){var t=r(e);return t.text||(t.text="string"==typeof e?e:e[0]),t.type||(t.type=n),t.innerMode||(t.innerMode=a),t}}),e}function o(e){switch(e&&e.type){case null:case"br":case"hr":case"bulleted":case"numbered":case"heading":case"align":case"column":case"escapedLine":return!0}return!1}var i=[],s=[],c=[],l=a(i,{hr:{fn:r},bulleted:{fn:function(e){return{depth:e[1].length}}},numbered:{fn:function(e){return{depth:e[1].length/2}}},heading:{fn:function(e){return{depth:e[1].length}}},align:{fn:function(e){var t,e=e[1],n=e.indexOf("><");return~n?25===(t=Math.round(n/(e.length-2)*50))&&(t="center"):"<"===e[0]&&">"===e.slice(-1)?t="justify":-1<e.indexOf(">")?t="right":-1<e.indexOf("<")&&(t="left"),{align:t}}},column:{fn:function(e){var t,e=e[1],n=e.indexOf("|");return n&&n<e.length-1?t="center":"|"===e[0]&&"|"===e.slice(-1)?t="none":n===e.length-1?t="right":n||(t="left"),{column:t,width:/\|+/.exec(e)[0].length,marginLeft:/^=*/.exec(e)[0].length,marginRight:/=*$/.exec(e)[0].length}}}}),u=(g(l).forEach(function(e){l[e].constraint=o,l[e].cannotFollowText=!0}),a(i,{twine1Macro:{fn:function(){return{type:"error",message:"Harlowe macros use a different syntax to Twine 1, SugarCube, and Yarn macros."}}},emBack:{fn:function(){return{matches:{emFront:"em"},cannotCross:["verbatimOpener"]}}},strongBack:{fn:function(){return{matches:{strongFront:"strong"},cannotCross:["verbatimOpener"]}}},strongFront:{fn:function(){return{isFront:!0}}},emFront:{fn:function(){return{isFront:!0}}},boldOpener:{fn:n("boldOpener","bold")},italicOpener:{fn:n("italicOpener","italic")},strikeOpener:{fn:n("strikeOpener","strike")},supOpener:{fn:n("supOpener","sup")},commentFront:{fn:function(){return{isFront:!0}}},commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},scriptStyleTag:{fn:r},tag:{fn:r},url:{fn:r},hookPrependedFront:{fn:function(e){return{name:e[1],hidden:")"===e[2],isFront:!0,tagPosition:"prepended"}}},hookFront:{fn:function(){return{isFront:!0}}},hookBack:{fn:function(){return{matches:{hookPrependedFront:"hook",hookFront:"hook"},cannotCross:["verbatimOpener"]}}},hookAppendedBack:{fn:function(e){return{name:e[2],hidden:"("===e[1],tagPosition:"appended",matches:{hookFront:"hook"},cannotCross:["verbatimOpener"]}}},unclosedHook:{fn:r},unclosedHookPrepended:{fn:function(e){return{type:"unclosedHook",name:e[1],hidden:")"===e[2]}}},verbatimOpener:{fn:function(e){var e=e[0].length,t={};return{type:(t["verbatim"+e]="verbatim")+e,isFront:!0,matches:t,aka:"verbatimOpener"}}},unclosedCollapsed:{fn:r},collapsedFront:{fn:function(){return{isFront:!0}}},collapsedBack:{fn:function(){return{matches:{collapsedFront:"collapsed"},cannotCross:["verbatimOpener"]}}},escapedLine:{fn:r},legacyLink:{fn:function(e){return{type:"twineLink",innerText:e[1],passage:e[2],innerMode:i}}},br:{fn:r}})),p=y(a(s,{macroFront:{fn:function(e){return{isFront:!0,name:e[1]}}},groupingBack:{fn:function(){return{matches:{groupingFront:"grouping",macroFront:"macro"},cannotCross:["singleStringOpener","doubleStringOpener","hookFront"]}}},passageLink:{fn:function(e){var t=e[1]||"",n=e[2]||"",e=e[3]||"";return{type:"twineLink",innerText:n?e:t,passage:t?e:n,innerMode:i}}},simpleLink:{fn:function(e){return{type:"twineLink",innerText:e[1]||"",passage:e[1]||"",innerMode:i}}},variable:{constraint:function(e){return!e||"macroFront"!==e.type},fn:t("name")},tempVariable:{constraint:function(e){return!e||"macroFront"!==e.type},fn:t("name")}}),{hookFront:u.hookFront,hookBack:u.hookBack}),d=a(s,_objectSpread(_objectSpread({commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},macroName:{constraint:function(e){return e&&"macroFront"===e.type},fn:t("name")},groupingFront:{fn:function(){return{isFront:!0}}},property:{fn:t("name"),constraint:function(e){if(e)switch(e.type){case"variable":case"hookName":case"property":case"tempVariable":case"colour":case"itsProperty":case"belongingItProperty":case"macro":case"grouping":case"string":case"datatype":case"hook":case"boolean":case"number":return!0}}},possessiveOperator:{fn:r},itsProperty:{cannotFollowText:!0,fn:t("name")},itsOperator:{cannotFollowText:!0,fn:r},belongingItProperty:{cannotFollowText:!0,fn:t("name")},belongingItOperator:{cannotFollowText:!0,fn:r},belongingProperty:{cannotFollowText:!0,fn:t("name")},belongingOperator:{cannotFollowText:!0,fn:r},escapedStringChar:{fn:function(){return{type:"text"}}},singleStringOpener:{fn:function(){return{isFront:!0,matches:{singleStringOpener:"string"},innerMode:c}}},doubleStringOpener:{fn:function(){return{isFront:!0,matches:{doubleStringOpener:"string"},innerMode:c}}},hookName:{fn:t("name")},cssTime:{fn:function(e){return{value:+e[1]*("s"===e[2].toLowerCase()?1e3:1)}}},datatype:{cannotFollowText:!0,fn:function(e){return{name:e[0].toLowerCase()}}},colour:{cannotFollowText:!0,fn:function(e){var e=e[0].toLowerCase(),t={red:"e61919",orange:"e68019",yellow:"e5e619",lime:"80e619",green:"19e619",cyan:"19e5e6",aqua:"19e5e6",blue:"197fe6",navy:"1919e6",purple:"7f19e6",fuchsia:"e619e5",magenta:"e619e5",white:"fff",black:"000",gray:"888",grey:"888"},t=hasOwnProperty.call(t,e)?"#"+t[e]:e;return{colour:t}}},number:{fn:function(e){return{value:parseFloat(e[0])}}},inequality:{fn:function(e){return{operator:e[2],negate:-1<e[1].indexOf("not")}}},augmentedAssign:{fn:function(e){return{operator:e[0][0]}}},identifier:{fn:t("name"),cannotFollowText:!0},whitespace:{fn:r,cannotFollowText:!0},incorrectOperator:{fn:function(e){var t={"=>":">=","=<":"<=",gte:">=",lte:"<=",gt:">",lt:"<",eq:"is",isnot:"is not",neq:"is not",isa:"is a",are:"is",x:"*","or a":"or"}[e[0].toLowerCase().replace(/\s+/g," ")];return{type:"error",message:"Please say "+(t?"'"+t+"'":"something else")+" instead of '"+e[0]+"'.",explanation:"In the interests of readability, I want certain operators to be in a specific form."}},cannotFollowText:!0}},["boolean","is","to","into","where","when","via","making","each","and","or","not","isNot","contains","doesNotContain","isIn","isA","isNotA","isNotIn","matches","doesNotMatch","bind"].reduce(function(e,t){return e[t]={fn:r,cannotFollowText:!0},e},{})),["comma","spread","typeSignature","addition","subtraction","multiplication","division"].reduce(function(e,t){return e[t]={fn:r},e},{}))),f=a(c,{singleStringCloser:d.singleStringOpener,doubleStringCloser:d.doubleStringOpener,escapedStringChar:d.escapedStringChar}),h=(i.push.apply(i,_toConsumableArray(g(l)).concat(_toConsumableArray(g(p)),_toConsumableArray(g(u)))),s.push.apply(s,_toConsumableArray(g(p)).concat(_toConsumableArray(g(d)))),c.push.apply(c,_toConsumableArray(g(f))),_objectSpread(_objectSpread(_objectSpread(_objectSpread(_objectSpread({},l),u),p),d),f)),u=(g(h).forEach(function(e){m.PlainCompare[e]?(h[e].pattern=m.PlainCompare[e],h[e].plainCompare=!0):h[e].pattern=RegExp("^(?:"+m[e]+")","i")}),y(e.rules,h),e.modes);return u.start=u.markup=i,u.macro=s,u.string=c,e}function n(e){return Object.freeze({lex:t(e).lex,Patterns:m})}"object"===("undefined"==typeof module?"undefined":_typeof(module))?(m=require("./patterns"),module.exports=n(require("./lexer"))):"function"==typeof define&&define.amd?define("markup",["lexer","patterns"],function(e,t){return m=t,n(e)}):this&&this.loaded&&this.modules?(m=this.modules.Patterns,this.modules.Markup=n(this.modules.Lexer)):(m=this.Patterns,this.Markup=n(this.Lexer))}.call(eval("this")||("undefined"!=typeof global?global:window)),!function(){var e;function n(t){return t&&"object"===_typeof(t)?(Object.keys(t).forEach(function(e){t[e]=n(t[e])}),t):(t+"").replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function t(e){return function(){return"("+e+Array.apply(0,arguments).join("|")+")"}}var r=t("?:"),a=t("?!"),o=t("?="),i="[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",s=i.replace("*","+"),c="\\b",l="[\\w\\-\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",u=l.replace("\\-",""),p=r("\\n","$"),d=i+"(\\*+)"+s,f=i+"((?:0\\.)+)"+s,h=i+"-{3,}"+i+p,m=i+"(==+>|<=+|=+><=+|<==+>)"+i+p,p=i+"(=+\\|+|\\|+=+|=+\\|+=+|\\|=+\\|)"+i+p,g={opener:"\\[\\[(?!\\[)",text:"("+function(){return"[^"+Array.apply(0,arguments).map(n).join("")+"]*"}("]")+")",rightSeparator:r("\\->","\\|"),leftSeparator:"<\\-",closer:"\\]\\]",legacySeparator:"\\|",legacyText:"("+r("[^\\|\\]]","\\]"+a("\\]"))+"+)"},y=u+"*"+u.replace("\\w","a-zA-Z")+u+"*",b="\\$("+y+")",v="_("+y+")",w="'s"+s+a("_")+"("+y+")",k="("+y+")"+s+"of"+c+a("it\\b"),S="'s"+s,T=r("it","time","turns?","visits?","exits?","pos")+c,_="its"+s+"("+y+")",x="("+y+")"+s+"of"+s+"it"+c,O="of"+s+"it"+c,A={opener:"\\(",name:"("+r("\\$","_")+"?"+l+"+):"+a("\\/"),closer:"\\)"},C=r("=<","=>","[gl]te?\\b","n?eq\\b","isnot\\b","are\\b","x\\b","isa\\b","or"+s+"a"+c),E="[a-zA-Z][\\w\\-]*",N="(?:\"[^\"]*\"|'[^']*'|[^'\">])*?",j="\\|("+l+"+)(>|\\))",P="(<|\\()("+l+"+)\\|",R="((?:\\b\\d+(?:\\.\\d+)?|\\.\\d+)(?:[eE][+\\-]?\\d+)?)"+a("m?s")+c;g.main=g.opener+r(g.text+g.rightSeparator,g.text.replace("*","*?")+g.leftSeparator)+g.text,e={upperLetter:"[A-Z\\u00c0-\\u00de\\u0150\\u0170]",lowerLetter:"[a-z0-9_\\-\\u00df-\\u00ff\\u0151\\u0171]",anyLetter:l,anyLetterStrict:u,whitespace:s.replace("[","[\\n\\r"),escapedLine:"\\\\\\n\\\\?|\\n\\\\",br:"\\n(?!\\\\)",tag:"<\\/?"+E+N+">",scriptStyleTag:"<("+r("script","style","textarea")+")"+N+">[^]*?<\\/\\1>",scriptStyleTagOpener:"<",url:"("+r("https?","mailto","javascript","ftp","data")+":\\/\\/[^\\s<]+[^<.,:;\"')\\]\\s])",bullet:"\\*",hr:h,heading:"[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*(#{1,6})[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",align:m,column:p,bulleted:d,numbered:f,verbatimOpener:"`+",hookAppendedFront:"\\["+a("=+"),hookPrependedFront:j+"\\["+a("=+"),hookFront:"\\["+a("=+"),hookBack:"\\]"+a(P),hookAppendedBack:"\\]"+P,unclosedHook:"\\[=+",unclosedHookPrepended:j+"\\[=+",unclosedCollapsed:"\\{=+",passageLink:g.main+g.closer,legacyLink:g.opener+g.legacyText+g.legacySeparator+g.legacyText+g.closer,simpleLink:g.opener+g.legacyText+g.closer,macroFront:A.opener+o(A.name),macroName:A.name,groupingFront:"\\("+a(A.name),twine1Macro:"<<[^>\\s]+\\s*(?:\\\\.|'(?:[^'\\\\]*\\\\.)*[^'\\\\]*'|\"(?:[^\"\\\\]*\\\\.)*[^\"\\\\]*\"|[^'\"\\\\>]|>(?!>))*>>",validPropertyName:y,property:w,belongingProperty:k,possessiveOperator:S,belongingOperator:"of\\b",itsOperator:"its\\b",belongingItOperator:O,variable:b,tempVariable:v,hookName:"\\?("+l+"+)\\b",cssTime:"(\\d+\\.?\\d*|\\d*\\.?\\d+)(m?s)\\b",colour:r(r("Red","Orange","Yellow","Lime","Green","Cyan","Aqua","Blue","Navy","Purple","Fuchsia","Magenta","White","Gray","Grey","Black","Transparent"),"#[\\dA-Fa-f]{3}(?:[\\dA-Fa-f]{3})?"),datatype:r("alnum","alphanumeric","any(?:case)?","array","bool(?:ean)?","changer","codehook","colou?r","const","command","dm","data"+r("map","type","set"),"ds","digit","gradient","empty","even","int"+a("o")+"(?:eger)?","lambda","lowercase","macro","linebreak","newline","num(?:ber)?","odd","str(?:ing)?","uppercase","whitespace")+c,number:R,boolean:r("true","false")+c,identifier:T,itsProperty:_,belongingItProperty:x,escapedStringChar:"\\\\[^\\n]",singleStringOpener:"'",doubleStringOpener:'"',singleStringCloser:"'",doubleStringCloser:'"',is:"is"+a(s+"not"+c,s+"an?"+c,s+"in"+c,s+"<",s+">")+c,isNot:"is"+s+"not"+a(s+r("an?","in")+c)+c,isA:"is"+s+"an?"+c,isNotA:"is"+s+"not"+s+"an?"+c,matches:"matches\\b",doesNotMatch:"does"+s+"not"+s+"match"+c,and:"and\\b",or:"or\\b",not:"not\\b",inequality:"((?:is(?:"+s+"not)?"+i+")*)("+r("<(?!=)","<=",">(?!=)",">=")+")",isIn:"is"+s+"in"+c,contains:"contains\\b",doesNotContain:"does"+s+"not"+s+"contain"+c,isNotIn:"is"+s+"not"+s+"in"+c,addition:n("+")+a("="),subtraction:n("-")+a("=","type"),multiplication:n("*")+a("="),division:r("/","%")+a("="),spread:"\\.\\.\\."+a("\\."),to:r("to\\b","="),into:"into\\b",making:"making\\b",where:"where\\b",when:"when\\b",via:"via\\b",each:"each\\b",augmentedAssign:r("\\+","\\-","\\*","\\/","%")+"=",bind:"2?bind\\b",typeSignature:n("-type")+c,incorrectOperator:C,PlainCompare:{comma:",",commentFront:"\x3c!--",commentBack:"--\x3e",strikeOpener:"~~",italicOpener:"//",boldOpener:"''",supOpener:"^^",strongFront:"**",strongBack:"**",emFront:"*",emBack:"*",collapsedFront:"{",collapsedBack:"}",groupingBack:")"}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:"function"==typeof define&&define.amd?define("patterns",[],function(){return e}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Patterns=e):this.Patterns=e}.call(eval("this")||("undefined"!=typeof global?global:window)),define("twinescript/operations",["utils","utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/twineerror"],function(e,t,n,r,m){var a=e.plural,o=t.isObject,i=t.collectionType,s=t.is,c=t.isA,l=t.clone,u=t.unique,p=t.contains,e=t.matches,g=t.objectName,d=t.toSource;function f(r,a,o,i){return o=o||"do this to",function(e,t){var n;return 1===a.length&&(t=e),(n=m.containsError(e,t))||(_typeof(e)!==r||_typeof(t)!==r?m.create("operation","I can only ".concat(o," ").concat(r,"s, not ").concat(g(_typeof(e)!==r?e:t),"."),i):a(e,t))}}function h(a){return function(e,t){var n,r;return(n=m.containsError(e,t))||(_typeof(e)!==_typeof(t)||o(e)&&"TwineScript_TypeName"in e&&o(t)&&"TwineScript_TypeName"in t&&e.TwineScript_TypeName!==t.TwineScript_TypeName||i(e)!==i(t)?(n="".concat(g(e)," isn't the same type of data as ").concat(g(t)),_typeof(e)+_typeof(t)!=="stringnumber"&&_typeof(e)+_typeof(t)!=="numberstring"||(r="You might want to convert one side to a number using (num:), or to a string using (str:)."),m.create("operation",n[0].toUpperCase()+n.slice(1),r)):a(e,t))}}function y(d,f,e){var h=2<arguments.length&&void 0!==e&&e;return function r(a,o){var e;if(e=m.containsError(a,o))return e;var t=_slicedToArray(a.determiner?[a,o]:o.determiner?[o,a]:[],2),i=t[0],t=t[1];if(i){var n=i,s=n.determiner,n=n.determined;if("start"===s||"end"===s){if(f)return m.create("operation","I can't use '".concat(f,"' with the 'start' or 'end' of ").concat(g(n),"."));if(t.determiner){if("start"===t.determiner||"end"===t.determiner)return m.create("operation","I can't compare one value's 'start' or 'end' with another value's 'start' or 'end'.","Please change one of them to use an exact range, such as '1stto4th' or '2ndlasttolast'.");n=[t,i],i=n[0]}for(var c=i.string||i.array,l=0;l<c.length+1;l+=1){var u=l?"end"===s?c.slice(-l):c.slice(0,l):c.constructor(),u=i===a?r(u,o):r(a,u);if(e=m.containsError(u))return e;if(u!==h)return u}return h}var p="all"===s;return i.array.reduce(function(e,t){var n,t=i===a?r(t,o):r(a,t);return(n=m.containsError(e,t))||(p?e&&t:e||t)},p)}return d(a,o)}}function b(n,e){return y(function(e,t){e=n(e,t);return m.containsError(e)?e:!e},e,!0)}t="If one of these values is a number, you may want to write a check that it 'is not 0'. Also, if one is a string, you may want to write a check that it 'is not \"\" '.",t={and:f("boolean",h(function(e,t){return e&&t}),"use 'and' to join",t),or:f("boolean",h(function(e,t){return e||t}),"use 'or' to join",t),not:f("boolean",function(e){return!e},"use 'not' to invert",t),"+":h(function(e,t){var n;return Array.isArray(e)?[].concat(_toConsumableArray(e),_toConsumableArray(t)):e instanceof Map?(n=new Map(e),t.forEach(function(e,t){return n.set(t,e)}),n):e instanceof Set?new Set([].concat(_toConsumableArray(e),_toConsumableArray(t)).filter(u).map(l)):"function"==typeof e["TwineScript_+"]?e["TwineScript_+"](t):"string|number|boolean".includes(_typeof(e))?e+t:m.create("operation","I can't use + on ".concat(g(e),"."))}),"-":h(function(e,n){var r;return Array.isArray(e)?e.filter(function(t){return!n.some(function(e){return s(t,e)})}):e instanceof Set?(r=_toConsumableArray(n),new Set(_toConsumableArray(e).filter(function(t){return!r.some(function(e){return s(t,e)})}))):"string"==typeof e?e.split(n).join(""):"number"==typeof e?e-n:m.create("operation","I can't use - on ".concat(g(e),"."))}),"*":f("number",h(function(e,t){return e*t}),"multiply"),"/":f("number",h(function(e,t){return 0===t?m.create("operation","I can't divide ".concat(g(e)," by zero.")):e/t}),"divide"),"%":f("number",h(function(e,t){return 0===t?m.create("operation","I can't modulo ".concat(g(e)," by zero.")):e%t}),"modulus"),"<":y(f("number",h(function(e,t){return e<t}),"do < to"),"<"),">":y(f("number",h(function(e,t){return t<e}),"do > to"),">"),"<=":y(f("number",h(function(e,t){return e<=t}),"do <= to"),"<="),">=":y(f("number",h(function(e,t){return t<=e}),"do >= to"),">="),is:y(s),isNot:b(s),contains:y(p,"contains"),doesNotContain:b(p,"does not contain"),isIn:y(function(e,t){return p(t,e)},"is in"),isNotIn:b(function(e,t){return p(t,e)},"is not in"),isA:y(c,"is a"),isNotA:b(c,"is not a"),typifies:y(function(e,t){return c(t,e)}),untypifies:b(function(e,t){return c(t,e)}),matches:y(e),doesNotMatch:b(e),makeSpreader:function(e){var t;return m.containsError(e)?e:n.isPrototypeOf(e)||r.isPrototypeOf(e)?(t=l(e),(n.isPrototypeOf(e)?t.datatype:t).rest=!0,t):{value:e,spreader:!0,TwineScript_TypeName:"a spreaded '...' value",TwineScript_ObjectName:a("string"==typeof e||Array.isArray(e)?_toConsumableArray(e).length:1,"spreaded '...' value"),TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return""+_toConsumableArray(e).map(d)}}}};return Object.freeze(t)}),define("twinescript/runner",["macros","state","utils","utils/operationutils","twinescript/operations","datatypes/colour","datatypes/hookset","datatypes/lambda","datatypes/datatype","datatypes/varbind","datatypes/codehook","datatypes/typedvar","datatypes/assignmentrequest","internaltypes/varref","internaltypes/twineerror"],function(Macros,State,Utils,_ref127,Operations,Colour,HookSet,Lambda,Datatype,VarBind,CodeHook,TypedVar,AssignmentRequest,VarRef,TwineError){var toSource=_ref127.toSource,typeName=_ref127.typeName,objectName=_ref127.objectName,insensitiveName=Utils.insensitiveName,impossible=Utils.impossible,hash=Utils.hash;function addFreeVariable(e,t){var n,r=e.freeVariables;"macro"===t.type?"current-time"===(n=insensitiveName(t.name))||"current-date"===n||"monthday"===n||"weekday"===n||"history"===n||"visited"===n||"passage"===n?e.freeVariables=!0:t.blockedValue&&!r.blockedValues?r.blockedValues=e.stackTop.blockedValues.concat():"random"!==n&&"either"!==n&&"shuffled"!==n||r.seed||(r.seed=State.seed,r.seedIter=State.seedIter):"identifier"===t.type?"time"!==(n=insensitiveName(t.text))&&"exits"!==n&&"it"!==n&&"visits"!==n&&"turns"!==n||(e.freeVariables=!0):"property"===t.type||"belongingProperty"===t.type?"random"!==insensitiveName(t.name)||r.seed||(r.seed=State.seed,r.seedIter=State.seedIter):"variable"!==t.type&&"tempVariable"!==t.type||(e.freeVariables=!0)}var precedenceTable=[["error","text"],["comma"],["to","into"],["where","when","via","making","each"],["typeSignature"],["augmentedAssign"],["and","or"],["is","isNot"],["contains","doesNotContain","isIn","isNotIn"],["isA","isNotA","matches","doesNotMatch"],["inequality"],["addition","subtraction"],["multiplication","division"],{rightAssociative:["spread","bind"]},{rightAssociative:["not","positive","negative"]},{rightAssociative:["belongingProperty","belongingItProperty","belongingOperator","belongingItOperator"]},["property","itsProperty","possessiveOperator","itsOperator"],["twineLink","macro","identifier","variable","tempVariable","hookName","number","cssTime","boolean","string","hook","colour","datatype","root"],["grouping"]];function precedentToken(e,t){var n,r,a,o=[];if(e.length)for("most"===t?(n=precedenceTable.length-1,r=a=-1):(n=0,r=precedenceTable.length,a=1);n!==r;n+=a){var i=precedenceTable[n],s=NaN;if(i.rightAssociative){for(var c=0;c<e.length;c+=1)if(i.rightAssociative.includes(e[c].type)){s=c;break}}else for(var l=e.length-1;0<=l;--l)if(i.includes(e[l].type)){s=l;break}if(!Number.isNaN(s)&&-1<s){o=[e[s],s];break}}return o}var comparisonOpTypes=["inequality","is","isNot","isIn","contains","doesNotContain","isNotIn","isA","typifies","isNotA","untypifies","matches","doesNotMatch"],inequalityNegator={">":"<=","<":">=",">=":"<","<=":">"};function compileComparisonOperator(e){return"inequality"===e.type?e.negate?inequalityNegator[e.operator]:e.operator:e.type}var comparisonReverser={">":"<","<":">",">=":"<=","<=":">=",contains:"isIn",doesNotContain:"isNotIn",isIn:"contains",isA:"typifies",typifies:"isA",isNotA:"untypifies",untypifies:"isNotA"};function reverseComparisonOperator(e){e=compileComparisonOperator(e);return comparisonReverser[e]||e}var tokenSides={error:"neither",identifier:"neither",variable:"neither",tempVariable:"neither",hookName:"neither",number:"neither",boolean:"neither",string:"neither",hook:"neither",colour:"neither",datatype:"neither",root:"neither",twineLink:"neither",macro:"neither",grouping:"neither",itsProperty:"neither",belongingItProperty:"neither",to:"both",into:"both",typeSignature:"both",augmentedAssign:"both",and:"both",or:"both",belongingOperator:"both",possessiveOperator:"both",multiplication:"both",division:"both",spread:"after",bind:"after",not:"after",belongingProperty:"after",each:"after",itsOperator:"after",positive:"after",negative:"after",belongingItOperator:"before",property:"before"};function missingSideError(e,t,n){return TwineError.create("syntax","I need usable code to be ".concat(e?"left ":"").concat(e&&t?"and ":"").concat(t?"right ":"","of ").concat(n.text,"."))}function wrongSideError(e,t,n){return TwineError.create("syntax","There can't be a ".concat(e&&t?e.map(function(e){return e.text}).join("")+" or "+t.map(function(e){return e.text}).join(""):(e||t).map(function(e){return e.text}).join("")," to the ").concat(e?"left ":"").concat(e&&t?"or ":"").concat(t?"right ":"","of ").concat(n.text,"."),"There could be a comma missing between them.")}function makeEvalReplayFrame(e,t){var n=t.val,r=t.fromCode,a=t.toCode,o=t.toDesc,i=t.reason,s=t.it,c=t.tokens,t=t.i;if(!(200<=e.length)){var l=c[t],u=c.slice(0,t),t=c.slice(t+1);if(1===c.length&&(u=t=!1,l=c[0]),!e[e.length-1].error){var p,d,c=TwineError.containsError(n),f=e[e.length-1].code,h=e[0].basis,m=(null!=(p=u)&&p.length&&null!=(p=t)&&p.length&&u[0].start>t[0].start&&(u=(p=[t,u])[0],t=p[1]),p=a||"".concat(null!=(p=u)&&p.length&&"whitespace"===u[u.length-1].type?" ":"").concat(c?" \ud83d\udc1e ":(n&&!n.TwineScript_ToSource&&n.TwineScript_Unstorable?objectName:toSource)(n)).concat(null==(p=t)||!p.length||"whitespace"!==t[0].type&&"addition"!==l.type&&"subtraction"!==l.type?"":" "),(u.length?u[0]:l).start-h),g=(t.length?t[t.length-1]:l).end-h,y=_createForOfIteratorHelper(e);try{for(y.s();!(d=y.n()).done;){var b=d.value;b.start<m?(m+=b.diff,g+=b.diff):b.start<g&&(g+=b.diff)}}catch(e){y.e(e)}finally{y.f()}!r&&(r=f.slice(m,g),a)&&a.trim()===r.trim()||(u=p.length-(g-m),e.push({code:f.slice(0,m)+p+f.slice(g),fromCode:r,toCode:!c&&a,toDesc:!c&&!a&&(o||objectName(n)),start:m,end:g,diff:u,reason:i,itIdentifier:void 0!==s&&objectName(s),error:c&&c.render(f.slice(m,g),!0)}))}}}function setIt(e,t){return(VarRef.isPrototypeOf(t)||TypedVar.isPrototypeOf(t))&&(e.Identifiers.it=t.get()),t}return function run(section,tokens){var isVarRef=2<arguments.length&&void 0!==arguments[2]&&arguments[2],isTypedVar=3<arguments.length&&void 0!==arguments[3]&&arguments[3],evalReplay=section.evalReplay,hasEvalReplay=null==evalReplay?void 0:evalReplay.length,evalReplayReason,evalReplaySkip=!1,evalReplayIt,ops=Operations,token,ret,i,before,after,_precedentToken,_precedentToken2,token,i,before,after;if(Array.isArray(tokens)||(tokens=[tokens]),!tokens.length||!tokens[0])return impossible("Runner.run","No tokens to run!"),0;1===tokens.length?token=tokens[0]:(_precedentToken=precedentToken(tokens,"least"),_precedentToken2=_slicedToArray(_precedentToken,2),token=_precedentToken2[0],i=_precedentToken2[1],before=tokens.slice(0,i),after=tokens.slice(i+1),before.length&&(1!==before.length||"whitespace"!==before[0].type)||(before=!1),after.length&&(1!==after.length||"whitespace"!==after[0].type)||(after=!1));var type=token.type;if(!type)return impossible("Runner.run","Token has no type!"),0;var sides=tokenSides[type]||"",VARREF=("both"!==sides||before&&after?"neither"===sides&&(before||after)?ret=wrongSideError(before,after,token):"before"===sides?before?after&&(ret=wrongSideError(null,after,token)):ret=missingSideError(!0,!1,token):"after"===sides&&(after?before&&(ret=wrongSideError(before,null,token)):ret=missingSideError(!1,!0,token)):ret=missingSideError(!before,!after,token),section.freeVariables&&"object"===_typeof(section.freeVariables)&&addFreeVariable(section,token),!0),TYPEDVAR=!0,_ret4,val,evalReplayReason,ret,source,_source4,_value4,msg;if(!ret){if("comma"===type)return impossible("Section.run","a comma token was run() somehow."),0;if("root"===type)ret=run(section,token.children);else if("identifier"===type)ret=isVarRef?VarRef.create(section.Identifiers,token.text.toLowerCase()):section.Identifiers[token.text.toLowerCase()];else if("variable"===type||"tempVariable"===type){ret=VarRef.create("tempVariable"===type?section.stackTop.tempVariables:State.variables,token.name),isTypedVar?(ret=TypedVar.create(Datatype.create("any"),ret),evalReplayReason=hasEvalReplay&&"Variables in 'to' or 'into' expressions with no -type to their left are considered to be 'any-type' variables that can store any storable value."):isVarRef||TwineError.containsError(ret)?evalReplaySkip=!0:(val=ret.get(),evalReplayReason=hasEvalReplay&&((null==(_ret4=ret)?void 0:_ret4.object)!==State.variables||hasOwnProperty.call(ret.object,ret.compiledPropertyChain[0])?"":"This variable didn't exist; for story-wide $ variables, a default value of 0 is used if they don't exist."),ret=val)}else if("hookName"===type)ret=HookSet.create({type:"name",data:token.name}),evalReplaySkip=!0;else if("number"===type||"cssTime"===type)ret=token.value,evalReplayReason=hasEvalReplay&&"cssTime"===type&&(token.text.endsWith("ms")?"The letters 'ms' at the end of numbers are ignored, so you can use them to indicate that a number represents milliseconds.":"The letter 's' at the end of numbers represents 'seconds'. Harlowe converts them to milliseconds (multiplies them by 1000)."),evalReplaySkip=!evalReplayReason;else if("boolean"===type)ret="true"===token.text.toLowerCase(),evalReplaySkip=!0;else if("string"===type){var t=token.text.replace(/(.?)\n/g,function(e,t){return("\\"===t?"\\\\":"\n"===t?"\\n":t)+"\\n"}).replace(/(\\*)\\0/g,function(e,t){return(t?"\\".repeat(2*t.length):"")+"0"});ret=eval(t),evalReplaySkip=!0}else if("hook"===type)ret=CodeHook.create(token.children,token.text),evalReplaySkip=!0;else if("colour"===type)ret=Colour.create(token.colour),evalReplaySkip=!0;else if("datatype"===type)ret=Datatype.create(token.name),evalReplaySkip=!0;else if("spread"===type)ret=ops.makeSpreader(run(section,after,!1,isTypedVar));else if("bind"===type)ret=VarBind.create(run(section,after,VARREF),token.text.startsWith("2")?"two way":""),evalReplaySkip=!0;else if("to"===type||"into"===type){var dest="to"===type?setIt(section,run(section,before,VARREF,TYPEDVAR)):run(section,after,VARREF,TYPEDVAR);if(TwineError.containsError(dest))ret=dest;else{(VarRef.isPrototypeOf(dest)&&dest.propertyChain.length<=1||TypedVar.isPrototypeOf(dest)&&dest.varRef.propertyChain.length<=1)&&(section.freeVariables=Object.create(null));var src="to"===type?run(section,after,VARREF):setIt(section,run(section,before,VARREF));if(TwineError.containsError(src))return src;var freeVariables=section.freeVariables,srcRef;section.freeVariables=null,token.place&&freeVariables&&"object"===_typeof(freeVariables)&&"boolean"!=typeof src&&"number"!=typeof src&&!Utils.options.uncompressedPureValues&&(srcRef=freeVariables,srcRef.at=token.place,srcRef.from=after[0].start,srcRef.to=after[after.length-1].end,srcRef.hash=hash(after.reduce(function(e,t){return e+t.text},"")).toString(16),JSON.stringify(srcRef).length>=toSource(src).length)&&(srcRef=void 0),ret=AssignmentRequest.create(dest,src,type,srcRef),evalReplaySkip=!0,evalReplayIt=section.Identifiers.it}}else if("typeSignature"===type){var datatype=run(section,before),free=section.freeVariables,variable=(section.freeVariables=null,run(section,after,VARREF));section.freeVariables=free,ret=TypedVar.create(datatype,variable),evalReplaySkip=!0}else if("where"===type||"when"===type||"via"===type){after?(source=tokens.map(function(e){return e.text}).join(""),ret=Lambda.create(before?run(section,before,VARREF):void 0,token.type,after,source),evalReplaySkip=!0):ret=missingSideError(!1,!0,token)}else if("making"===type||"each"===type){after?(_source4=[].concat(tokens).map(function(e){return e.text}).join(""),ret="each"===type?Lambda.create(run(section,after,VARREF),"each",null,_source4):Lambda.create(before?run(section,before,VARREF):void 0,token.type,run(section,after,VARREF),_source4),evalReplaySkip=!0):ret=missingSideError(!1,!0,token)}else if("augmentedAssign"===type)ret=ops.makeAssignmentRequest(run(section,before,VARREF),ops[token.operator](run(section,before),run(section,after)),token.operator),evalReplaySkip=!0;else if("and"===type||"or"===type){var isComparisonOp=function e(t){var n=_slicedToArray(precedentToken(t,"least"),2),r=n[0],n=n[1];if(r&&"whitespace"!==r.type)return comparisonOpTypes.includes(r.type)?r:r.type===type?e(t.slice(0,n))||e(t.slice(n+1)):void 0},leftIsComparison=isComparisonOp(before),rightIsComparison=isComparisonOp(after),ambiguityError=TwineError.create("operation",'This use of "is not" and "'.concat(type,'" is grammatically ambiguous.'),'Maybe try rewriting this as "__ is not __ '.concat(type,' __ is not __"')),operator,getElisionOperands=function e(t){var n,r=_slicedToArray(precedentToken(t,"least"),2),a=r[0],r=r[1];return a&&"whitespace"!==a.type?a.type===type?[].concat(_toConsumableArray(e(t.slice(0,r))),_toConsumableArray(e(t.slice(r+1)))):(a=run(section,t),hasEvalReplay&&"boolean"!=typeof a&&(n=operator.replace(/[A-Z]/g,function(e){return" "+e.toLowerCase()}),makeEvalReplayFrame(evalReplay,{toCode:" it ".concat(n," ").concat(toSource(a)," "),reason:"A missing 'it ".concat(n,"' was inferred to correct the '").concat(type,"' operation."),tokens:t,i:r}),makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(section.Identifiers.it)," ").concat(n," ").concat(toSource(a)," "),tokens:t,i:r})),[{val:a,tokens:t,i:r}]):[]},elidedComparisonOperator=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){var n=t.val,r=t.tokens,t=t.i;return"boolean"==typeof n?n:(e=Operations[token.type](e,Operations[operator](section.Identifiers.it,n)),hasEvalReplay&&makeEvalReplayFrame(evalReplay,{val:e,tokens:r,i:t}),e)},"and"===token.type)},leftSide,evalBefore,operator,rightSide,rightIndex,swappedSides,evalAfter;ret=leftIsComparison&&!rightIsComparison?(leftSide=leftIsComparison,operator=compileComparisonOperator(leftSide),"isNot"===leftSide.type||"isNotA"===leftSide.type||"untypifies"===leftSide.type?ambiguityError:(evalBefore=run(section,before),ops[type](evalBefore,elidedComparisonOperator.apply(void 0,_toConsumableArray(getElisionOperands(after)))))):!leftIsComparison&&rightIsComparison?(rightSide=rightIsComparison,rightIndex=tokens.indexOf(rightSide),operator=reverseComparisonOperator(rightSide),"isNot"===rightSide.type||"isNotA"===rightSide.type||"untypifies"===rightSide.type?ambiguityError:(swappedSides=[].concat(_toConsumableArray(tokens.slice(rightIndex+1)),[Object.assign(Object.create(rightSide),_defineProperty({},"inequality"===rightSide.type?"operator":"type",reverseComparisonOperator(rightSide)))],_toConsumableArray(tokens.slice(i+1,rightIndex))),evalAfter=run(section,swappedSides),ops[type](evalAfter,elidedComparisonOperator.apply(void 0,_toConsumableArray(getElisionOperands(before)))))):ops[type](run(section,before),run(section,after))}else if(comparisonOpTypes.includes(type)){after||missingSideError(!1,!0,token);var leftOp=before?run(section,before):section.Identifiers.it;ret=ops[compileComparisonOperator(token)](leftOp,run(section,after)),section.Identifiers.it=leftOp,evalReplayIt=leftOp,evalReplayReason=hasEvalReplay&&!before&&"A missing 'it' was inferred to complete the operation."}else if("addition"===type||"subtraction"===type){after||missingSideError(!1,!0,token);var convert=!before,_precedentToken7,_precedentToken8,previousPrecedentToken,_i10,_sides,pType,convert;before&&(_precedentToken7=precedentToken(before,"least"),_precedentToken8=_slicedToArray(_precedentToken7,2),previousPrecedentToken=_precedentToken8[0],_i10=_precedentToken8[1],_sides=tokenSides[previousPrecedentToken.type],pType=previousPrecedentToken.type,convert=("both"===_sides||"after"===_sides||"addition"===pType||"subtraction"===pType)&&(_i10===before.length-1||_i10===before.length-2&&"whitespace"===before[before.length-1].type)),convert?(token.type="addition"===type?"positive":"negative",ret=run(section,tokens),token.type=type,evalReplaySkip=!0):ret=ops[token.text](run(section,before),run(section,after))}else if("multiplication"===type||"division"===type)ret=ops[token.text](run(section,before),run(section,after));else if("positive"===type||"negative"===type)ret=ops["*"]("negative"===type?-1:1,run(section,after)),evalReplaySkip=!0;else if("not"===type)ret=ops.not(run(section,after));else if("belongingProperty"===type){var container=run(section,after,isVarRef),isRef=(ret=VarRef.create(container,token.name),isVarRef||TwineError.containsError(ret));ret=isRef?ret:ret.get(),isRef=isVarRef||TwineError.containsError(ret),hasEvalReplay&&!isRef?makeEvalReplayFrame(evalReplay,{toCode:" ".concat(token.name," of ").concat(toSource(VarRef.isPrototypeOf(container)?container.get():container)," "),tokens:tokens,i:i}):isRef||(evalReplayReason="The value to the right of 'of', ".concat(typeName(container),', had a "').concat(token.name,'" data name corresponding to that data value.'))}else if("belongingOperator"===type||"belongingItOperator"===type){var value=run(section,before);"random"===value&&section.freeVariables&&"object"===_typeof(section.freeVariables)&&!section.freeVariables.seed&&(section.freeVariables.seed=State.seed,section.freeVariables.seedIter=State.seedIter),ret=VarRef.create("belongingItOperator"===type?section.Identifiers.it:run(section,after,isVarRef),{computed:!0,value:value}),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),"belongingItOperator"===type&&hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(value)," of ").concat(toSource(section.Identifiers.it)," "),tokens:tokens,i:i})}else if("property"===type){var _container=run(section,before,VARREF),_isRef=(ret=VarRef.create(_container,token.name),isVarRef||TwineError.containsError(ret));ret=_isRef?ret:ret.get(),_isRef=isVarRef||TwineError.containsError(ret),hasEvalReplay&&VarRef.isPrototypeOf(_container)&&!_isRef?makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(_container.get()),"'s ").concat(token.name," "),tokens:tokens,i:i}):_isRef||(evalReplayReason="The value to the left of 's, ".concat(typeName(_container),', had a "').concat(token.name,'" data name corresponding to that data value.'))}else if("itsProperty"===type||"belongingItProperty"===type)ret=VarRef.create(section.Identifiers.it,token.name),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:"itsProperty"===type?" ".concat(toSource(section.Identifiers.it),"'s ").concat(token.name," "):" ".concat(token.name," of ").concat(toSource(section.Identifiers.it)," "),tokens:tokens,i:i});else if("possessiveOperator"===type||"itsOperator"===type){!after||!before&&"itsOperator"!==token.type?ret=missingSideError(!before,!after,token):(_value4=run(section,after),"random"===_value4&&section.freeVariables&&"object"===_typeof(section.freeVariables)&&!section.freeVariables.seed&&(section.freeVariables.seed=State.seed,section.freeVariables.seedIter=State.seedIter),ret=VarRef.create("itsOperator"===token.type?section.Identifiers.it:run(section,before,isVarRef),{computed:!0,value:_value4}),ret=isVarRef||TwineError.containsError(ret)?ret:ret.get(),"itsOperator"===type&&hasEvalReplay&&makeEvalReplayFrame(evalReplay,{toCode:" ".concat(toSource(section.Identifiers.it),"'s ").concat(toSource(_value4)," "),tokens:tokens,i:i}))}else if("twineLink"===type)ret=Macros.run("link-goto",section,[token.innerText,token.passage]),evalReplayReason=hasEvalReplay&&"Passage links are the same as (link-goto:) macro calls.";else if("macro"===type)if(token.blockedValue&&!section.blocked){if(ret=section.blockedValue(),void 0===ret)return impossible("Runner.run","section.blockedValue() returned undefined"),0}else{var macroNameToken=token.children[0],variableCall="$"===macroNameToken.text[0]||"_"===macroNameToken.text[0],macroRef;if("macroName"!==macroNameToken.type&&!variableCall)return impossible("Runner.run","macro token had no macroName child token"),0;variableCall?(macroRef=VarRef.create("_"===macroNameToken.text[0]?section.stackTop.tempVariables:State.variables,macroNameToken.text.trim().slice(1,-1)),TwineError.containsError(macroRef)||(macroRef=macroRef.get())):macroRef=token.name,ret=Macros[variableCall?"runCustom":"run"](macroRef,section,token.children.slice(1).reduce(function(e,t){return"comma"===t.type?e.push([]):e[e.length-1].push(t),e},[[]]).filter(function(e){return e.length&&(1<e.length||"whitespace"!==e[0].type)}).map(function(e){return run(section,e,!1,isTypedVar)})),evalReplayReason=hasEvalReplay&&variableCall&&"I called ".concat(objectName(macroRef),".")}else if("grouping"===type)ret=run(section,token.children,isVarRef),evalReplaySkip=!0;else if("error"===type)ret=TwineError.create("syntax",token.message,token.explanation||"");else{if("text"!==type)return impossible("Section.run","unknown syntax token type: ".concat(type,"!!")),0;token.text.trim().match(/^\d+(?:th|nd|st|rd)(?:last)?(?:to\d+(?:nth|nd|st|rd)(?:last)?)?$/g)&&(msg='Position data names like "'.concat(token.text,'" need to be either left of "of" or right of "\'s".')),ret=TwineError.create("syntax",msg||'"'.concat(token.text,"\" isn't valid Harlowe syntax for the inside of a macro call."),"Maybe you misspelled something? Also, as of 3.3.0, Javascript syntax is not allowed inside macro calls.")}}return void 0===ret?(impossible("Section.run","token ".concat(type).concat(token.name?" (".concat(token.name,":)"):""," produced undefined")),0):ret===section?(impossible("Section.run","token ".concat(type).concat(token.name?" (".concat(token.name,":)"):""," produced the section")),0):(hasEvalReplay&&!evalReplaySkip&&makeEvalReplayFrame(evalReplay,{val:ret,reason:evalReplayReason,it:evalReplayIt,tokens:tokens,i:i}),ret)}}),define("utils/jqueryplugins",["jquery"],function(e){e.prototype.extend({popAttr:function(e){var t=this.attr(e);return this.removeAttr(e),t},popData:function(e){var t=this.data(e);return this.removeData(e),t},tag:function(){return this[0]&&this[0].tagName&&this[0].tagName.toLowerCase()},textNodes:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*";return 1===this.length&&this[0]&&this[0].nodeType===Node.TEXT_NODE?[this[0]]:this.get().concat(this.contents().get(),this.find(e).contents().get()).filter(function(e,t,n){return(null==e?void 0:e.nodeType)===Node.TEXT_NODE&&n.indexOf(e)===t}).sort(function(e,t){return 2&e.compareDocumentPosition(t)?1:-1})},findAndFilter:function(e){var t=this.find(e),e=this.filter(e);return e.length?t.add(e):t}})}),define("utils/naturalsort",[],function(){return function(h){var m=1<arguments.length&&void 0!==arguments[1]?arguments[1]:String;return function(e,t){var n,r,a,o,i=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[/-]\d{1,4}[/-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,c=/^0x[0-9a-f]+$/i,l=/^0/,e=m(e).trim(),t=m(t).trim(),u=e.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=t.replace(i,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),i=parseInt(e.match(c))||1!==u.length&&e.match(s)&&Date.parse(e),e=parseInt(t.match(c))||i&&t.match(s)&&Date.parse(t)||null;if(h&&window.Intl&&window.Intl.Collator&&(a=window.Intl.Collator(h)),e){if(i<e)return-1;if(e<i)return 1}for(var d=0,f=Math.max(u.length,p.length);d<f;d++){if(n=!(u[d]||"").match(l)&&parseFloat(u[d])||u[d]||0,r=!(p[d]||"").match(l)&&parseFloat(p[d])||p[d]||0,isNaN(n)!==isNaN(r))return isNaN(n)?1:-1;if(_typeof(n)!==_typeof(r))n+="",r+="";else if("string"==typeof n&&a&&0!==(o=a.compare(n,r)))return o;if(n<r)return-1;if(r<n)return 1}return 0}}}),define("utils/operationutils",["utils/naturalsort","utils","internaltypes/twineerror","patterns"],function(f,e,h,t){var m=e.impossible,g=e.nth,u=e.permutations,s=e.plural,y=t.validPropertyName,r="object",n="boolean",b="string",v="number",w="function";function a(e){return!!e&&(_typeof(e)===r||_typeof(e)===w)}var k=Array.isArray;function S(e){return e&&Object.getPrototypeOf(e)===Object.prototype}function i(e){return k(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":_typeof(e)===b?b:e&&_typeof(e)===r?r:""}function c(e){if(a(e)){if(_typeof(e.TwineScript_Clone)===w)return e.TwineScript_Clone();if(k(e))return _toConsumableArray(e);if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(_typeof(e)===w)return Object.assign(e.bind(),e);switch(Object.getPrototypeOf(e)){case Object.prototype:return _objectSpread({},e);case null:return Object.assign(Object.create(null),e)}m("OperationUtils.clone","The value "+e+" cannot be cloned!")}return e}function o(e,t,n,r){for(var a="",o=0;a.length<=t&&o<e.length;){var i=r(e[o]);if(!(i.length+a.length<=t)){a+=(0<o?" and ":"")+s(e.length-o,(0<o?"other ":"")+n);break}a+=(0<o&&o===e.length-1?" and ":"")+i+(o<e.length-1?", ":""),o+=1}return a}function l(e){var t;return a(e)&&"TwineScript_ObjectName"in e?e.TwineScript_ObjectName:k(e)?0===e.length?"an empty array":"an array (with "+o(e,48,"item",l)+")":e instanceof Map?0===e.size?"an empty datamap":"a datamap (with "+o(_toConsumableArray(e.keys()),48,"dataname",_)+")":e instanceof Set?0===e.size?"an empty dataset":"a dataset (with "+o(_toConsumableArray(e.values()),48,"item",l)+")":_typeof(e)===b?0===e.length?"an empty string":48<(t=_toConsumableArray(e)).length?"a ".concat(t.length,"-character string starting with ").concat(JSON.stringify(t.slice(0,48).join(""))):"the string ".concat(JSON.stringify(e)):_typeof(e)===n?"the boolean value '"+e+"'":_typeof(e)===v?"the number "+JSON.stringify(e):void 0===e?"an empty variable":"...whatever this is"}function T(e,t){return[e[0],t[0]].sort(f("en"))[0]===e[0]?-1:1}function _(e,t){var n=h.containsError(e);if(n&&m("toSource","received a TwineError: "+n.message),_typeof(e.TwineScript_ToSource)===w)return e.TwineScript_ToSource();if(S(e)&&"first"in e&&"last"in e)return(e.first<0?(-1!==e.first?g(-e.first):"")+"last":g(e.first+1))+"to"+(e.last<0?(-1!==e.last?g(-e.last):"")+"last":g(e.last+1));if(k(e)){var r,a="",o=_createForOfIteratorHelper(e);try{for(o.s();!(r=o.n()).done;)var i=r.value,a=(a+=a?",":"(a:")+("property"===t?i+(0<i):_(i))}catch(e){o.e(e)}finally{o.f()}return a+(a?")":"(a:)")}if(e instanceof Map){var s,c="",l=_createForOfIteratorHelper(Array.from(e.entries()).sort(T));try{for(l.s();!(s=l.n()).done;){var u=_slicedToArray(s.value,2),p=u[0],d=u[1];c+=(c?",":"(dm:")+_(p)+","+_(d)}}catch(e){l.e(e)}finally{l.f()}return c+(c?")":"(dm:)")}return e instanceof Set?"(ds:"+Array.from(e).sort(f("en")).map(_)+")":_typeof(e)===v&&"property"===t?e<0?-1===e?"last":g(-e)+"last":g(e+1):_typeof(e)===b&&"property"===t?RegExp(y).test(e)?e:"("+JSON.stringify(e)+")":JSON.stringify(e)}function p(t,n){return _typeof(t)!==r&&_typeof(n)!==r?t===n:k(t)&&k(n)?t.length===n.length&&t.every(function(e,t){return p(n[t],e)}):t instanceof Map&&n instanceof Map?p(Array.from(t.entries()).sort(),Array.from(n.entries()).sort()):t instanceof Set&&n instanceof Set?p(_toConsumableArray(t),_toConsumableArray(n)):t&&_typeof(t.TwineScript_is)===w?t.TwineScript_is(n):t&&_typeof(t)===r&&n&&_typeof(n)===r&&S(t)&&S(n)?p(Object.getOwnPropertyNames(t).map(function(e){return[e,t[e]]}),Object.getOwnPropertyNames(n).map(function(e){return[e,n[e]]})):Object.is(t,n)}return Object.freeze({isObject:a,isValidDatamapName:function(e,t){var n;return e instanceof Map||m("isValidDatamapName","called with non-Map"),h.containsError(t)?t:_typeof(t)!==b&&_typeof(t)!==v?h.create("property","Only strings and numbers can be used as data names for "+l(e)+", not "+l(t)+"."):(n=_typeof(t)===b?+t:""+t,!(!Number.isNaN(n)&&e.has(n))||h.create("property","You mustn't use both "+l(t)+" and "+l(n)+" as data names in the same datamap."))},collectionType:i,isSequential:function(e){return _typeof(e)===b||k(e)||_typeof(e.hooks)===w},unstorableValue:function e(t){return(null==t?void 0:t.TwineScript_Unstorable)&&t||k(t)&&t.find(e)||t instanceof Map&&_toConsumableArray(t.values()).find(e)||t instanceof Set&&_toConsumableArray(t).find(e)},isHarloweJSValue:function e(t){return _typeof(t)===b||_typeof(t)===n||_typeof(t)===v&&!Number.isNaN(t)&&Math.abs(t)!==1/0||Array.isArray(t)&&t.every(e)||t instanceof Set&&_toConsumableArray(t).every(e)||t instanceof Map&&_toConsumableArray(t.values()).every(e)&&_toConsumableArray(t.keys()).every(function(e){return _typeof(e)===b})},clone:c,objectName:l,typeName:function e(t){var n,r=S(t);return r&&t.innerType?t.typeName||("insensitive set"===t.pattern?"a case-insensitive string name":"either"===t.pattern?(k(t.innerType)||m("typeName",'"either" pattern had non-array inner type'),t.innerType.map(e).join(" or ")):"optional"===t.pattern?"(optional) "+e(t.innerType):e(t.innerType)):r&&"range"===t.pattern?t.name||(r=t.min,n=t.max,"a"+(0<r?" positive":"")+(t.integer?" whole":"")+" number"+(0===r?" between 0 and "+n:n<1/0?" up to "+n:"")):t===String||t===Number||t===Boolean?"a "+_typeof(t()):t===parseInt?"a whole number":t===Map?"a datamap":t===Set?"a dataset":t===Array?"an array":a(t)&&"TwineScript_TypeName"in t?t.TwineScript_TypeName:l(t)},typeID:function(e){var t=_typeof(e);return[n,b,v].includes(t)?t:k(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":e.TwineScript_TypeID||""},toSource:_,is:p,contains:function(e,t){if(e||""===e){if(_typeof(e)===b)return _typeof(t)!==b?h.create("operation",l(e)+" can only contain strings, not "+l(t)+"."):e.includes(t);if(k(e))return e.some(function(e){return p(e,t)});if(e instanceof Set||e instanceof Map)return Array.from(e.keys()).some(function(e){return p(e,t)})}return h.create("operation",l(e)+" cannot contain any values, let alone "+l(t))},isA:function(e,t){return _typeof(t.TwineScript_IsTypeOf)===w?t.TwineScript_IsTypeOf(e):h.create("operation",'"is a" should only be used to compare type names, not '+l(t)+".")},matches:function t(n,e){var r=!1;if(n&&_typeof(n.TwineScript_IsTypeOf)===w){var a=n.TwineScript_IsTypeOf(e);if(h.containsError(a))return a;r|=a}if(e&&_typeof(e.TwineScript_IsTypeOf)===w){if(a=e.TwineScript_IsTypeOf(n),h.containsError(a))return a;r|=a}if(r)return!0;if(k(n)&&k(e)){for(var o=0,i=0,s=!0;s&&o<n.length&&i<e.length;){var c=n[o],l=e[i];if(c.rest){for(;i<e.length&&t(c,l);)l=e[i+=1];o+=1}else if(l.rest){for(;o<n.length&&t(c,l);)c=n[o+=1];i+=1}else t(c,l)?(o+=1,i+=1):s=!1}return s&&o>=n.length&&i>=e.length}return n instanceof Map&&e instanceof Map?t(Array.from(n.entries()).sort(),Array.from(e.entries()).sort()):n instanceof Set&&e instanceof Set?(n=_toConsumableArray(n),u.apply(void 0,_toConsumableArray(e)).some(function(e){return t(n,e)})):p(n,e)},subset:function e(t,n,r){var a,o;return n&&r?((a=_typeof(t)===b)&&(t=Array.from(t)),n<0&&(n=Math.max(0,t.length+n+1)),(r=r<0?Math.max(0,t.length+r+1):r)<n?e(arguments[0],r,n):(o=t.slice(0<n?n-1:n,r).map(c),a?o.join(""):o)):h.create("macrocall","The sub"+i(t)+" index value must not be "+(n&&r)+".")},range:function e(t,n){if(n<t)return e(n,t);var r=[t];for(n-=t;0<n--;)r.push(++t);return r},printBuiltinValue:function r(e){return h.containsError(e)?e:e&&_typeof(e.TwineScript_Print)===w?e.TwineScript_Print():e instanceof Map?(e=Array.from(e.entries()),h.containsError(e)?e:e.reduce(function(e,t){var n=(t=_slicedToArray(t,2))[0],t=t[1];return e+"<tr><td>`"+r(n)+"`</td><td>`"+r(t)+"`</td></tr>"},"<table class=datamap>")+"</table>"):e instanceof Set?Array.from(e.values()).map(r)+"":k(e)?e.map(r)+"":e&&_typeof(e.jquery)===b?e:a(e)?h.create("unimplemented","I don't know how to print this value yet."):e+""},unique:function(t,e,n){return n.findIndex(function(e){return p(t,e)})===e}})}),define("utils/polyfills",[],function(){var o=Array.prototype;"function"!=typeof o.includes&&(o.includes=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!Number.isNaN(e)&&Number.isFinite(t)&&void 0!==e)return-1<o.indexOf.call(this,e,t);var n=Object(this),r=parseInt(n.length);if(!(r<=0))for(var a=0<=t?t:Math.max(0,r+t);a<r;){if(Object.is(e,n[a]))return!0;a+=1}return!1}),window.Symbol||(window.Symbol={iterator:"_es6-shim iterator_"})}),define("utils/renderutils",["jquery","utils","renderer"],function(l,u,p){var n=RegExp(u.realWhitespace+"+"),s=RegExp(u.realWhitespace+"+","g");function d(e,t,n){var r,a=e.textContent.length;if(!(a<=t))return r=[e=0===t?e:e.splitText(t)],n&&(n=n<=0?a-n:n)<a&&r.push(e.splitText(n-t)),r}var t,c=function(){var e;return void 0!==t?t:(e=l("<p>"),t=!!e[0].normalize&&(e.append(document.createTextNode("0-"),document.createTextNode("2"),document.createTextNode(""))[0].normalize(),1===e.contents().length))};var f="tw-collapsed,[collapsing=true]";var o=/^(=*)([^=]+)=*$/;return Object.freeze({dialog:function(){var e,t=(c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).section,n=void 0===(n=c.parent)?u.storyElement:n,r=c.cd,a=void 0===(a=c.message)?"":a,o=c.defaultValue,i=void 0===(c=c.buttons)?[{name:"OK",confirm:!0,callback:Object}]:c,s=("a code hook"===a.TwineScript_TypeName&&(a=a.code),l("<tw-backdrop><tw-dialog>"+(o||""===o?"<input type=text style='display:block;margin:0 auto'></input>\n":"")+"<tw-dialog-links>"+(i.length?i.reduce(function(e,t,n){t=t.name;return e+"<tw-link style='margin:0 "+(n===i.length-1?"0 0 0.5em":0===n?"0.5em 0 0":"0.5em")+"' tabindex=0>"+t+"</tw-link>"},""):"<tw-link tabindex=0>"+i[0].name+"</tw-link>")+"</tw-dialog-links></tw-dialog></tw-backdrop>")),c=s.find("tw-dialog");return n.append(s),t?(t.renderInto(a,c,_objectSpread(_objectSpread({},r),{},{append:"prepend"})),null!=(n=(null==r?void 0:r.transition)&&s.find("tw-dialog > tw-transition-container"))&&n.length&&n.appendTo(s).append(c.prepend(n.contents().detach()))):c.prepend(p.exec(a)),o&&((e=s.find("input").last()).val(o).on("keypress",function(e){13===e.which&&(s.remove(),i.filter(function(e){return e.confirm}).forEach(function(e){return e.callback()}))}),setTimeout(function(){return e.focus()},100)),i.reverse().forEach(function(e,t){l(s.find("tw-link").get(-t-1)).on("click",function(){u.options.debug&&u.options.ignoreClickEvents&&!l(s).is(".eval-replay, .harlowe-crash")||(s.remove(),e.callback())})}),s},realWhitespace:n,textNodeToChars:function(r){var e=_toConsumableArray(r.textContent);return 1===e.length?[r]:e.reduce(function(e,t){return t.match(n)&&e.length&&e[e.length-1].match(n)?e[e.length-1]+=t:e.push(t),e},[]).reduce(function(e,t){var n=r;return t.length<r.textContent.length&&(r=r.splitText(t.length)),e.concat(n)},[])},findTextInNodes:function e(t,n){var r=[],a="",o=[];if(!t.length||!n)return o;for(;0<t.length;){r.push(t[0]),a+=t[0].textContent,t.shift();var i=a.indexOf(n);if(-1<i){for(var s=a.length-(i+n.length);i>=r[0].textContent.length;)i-=r[0].textContent.length,r.shift();if(1===r.length){var c=d(r[0],i,i+n.length);o.push(c[0]),c[1]&&t.unshift(c[1]);break}o.push(d(r[0],i,r[0].length)[0]),o.push.apply(o,_toConsumableArray(r.slice(1,-1))),c=d(r[r.length-1],0,r[r.length-1].textContent.length-s),o.push(c[0]),c[1]&&t.unshift(c[1]),o=o.filter(Boolean);break}}return[o].concat(_toConsumableArray(e(t,n)))},collapse:function(e){function n(e){return 0===l(this||e).parentsUntil(f).filter("tw-verbatim, tw-expression, [collapsing=false]").length}var t=function e(t){var n=t[0],r=t.parent();return!r.length||t.findAndFilter("tw-story").length?null:(t=(t=r.textNodes().filter(function(e){return 4&(e=e.compareDocumentPosition(n))&&!(8&e)}))[t.length-1])||e(r)}(e),r=(l(t).parents(f).length||(t=null),function e(t){var n=t[0],r=t.parent();return!r.length||t.findAndFilter("tw-story").length?null:r.textNodes().filter(function(e){return 2&(e=e.compareDocumentPosition(n))&&!(8&e)})[0]||e(r)}(e)),a=(l(r).parents(f).length||(r=null),"br:not([data-raw]),tw-consecutive-br:not([data-raw])"),o=(e.find(a).filter(n).replaceWith(document.createTextNode(" ")),(e=l(e.get().map(function(e){return l(e).filter(n).is(a)?l(document.createTextNode(" ")).replaceAll(e)[0]:e}))).textNodes()),i=0;o.reduce(function(e,t){return n(t)?(t.textContent=t.textContent.replace(s," ")," "!==t.textContent[0]||e&&e.textContent&&!(-1<e.textContent.search(/\s$/))||(t.textContent=t.textContent.slice(1)),t):document.createTextNode("A")},t),_toConsumableArray(o).reverse().every(function(e){return!(!n(e)||(e.textContent.match(/^\s*$/)?(i+=e.textContent.length,e.textContent=""):(e.textContent=e.textContent.replace(/\s+$/,function(e){return i+=e.length,""}),1)))}),0<i&&r&&(o[o.length-1].textContent+=" "),e[0]&&c()&&e[0].normalize()},geomStringRegExp:o,geomParse:function(e){var t,n,r,a;return!e||(t=e.length,n=(a=_slicedToArray(o.exec(e)||[],3))[0],r=a[1],a=a[2],!n)||a===e&&1<a.length?{marginLeft:0,size:0}:{marginLeft:r.length/t*100,size:a.length/t*100}}})}),define("utils/scripttag",["state","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(a,o,i,s){return function(e,r){Function("script","scope","with(scope){var scope=void 0,arguments=void 0;eval([script,script=void 0][0]);}")(e,Object.create(null,Object.keys(a.variables).map(function(e){return!e.startsWith("TwineScript_")&&"$"+e}).concat(Object.keys(r).map(function(e){return!e.startsWith("TwineScript_")&&"_"+e})).reduce(function(e,n){return n&&(e[n]={get:function(){var e=("$"===n[0]?a.variables:r)[n.slice(1)];if(o.isHarloweJSValue(e))return o.clone(e);throw s.create("","The contents of the variable ".concat(n,", ").concat(o.objectName(e),", couldn't be converted to a Javascript value."),"Only booleans, strings, numbers, datamaps, datasets and arrays can be converted to Javascript values.")},set:function(e){var t="$"===n[0]?a.variables:r;if(!o.isHarloweJSValue(e))throw s.create("","The Javascript value, ".concat(e,", couldn't be converted to a Harlowe value and assigned to the variable ").concat(n,"."),"Only booleans, strings, numbers (except NaN and Infinity), Maps, Sets and Arrays can be converted to Harlowe values.");e=o.clone(e);t=i.create(t,n.slice(1)).set(e);if(s.containsError(t))throw t}}),e},{})))}}),!function(){function e(t,n,r){return function(e){return"background-color: hsla(".concat(t,",").concat(n,"%,").concat(r,"%,").concat(e,");")}}var t={boolean:"color:hsla(0,0%,30%,1.0)",array:"color:hsla(0,100%,30%,1.0)",dataset:"color:hsla(30,100%,40%,1.0)",number:"color:hsla(30,100%,30%,1.0)",datamap:"color:hsla(60,100%,30%,1.0)",changer:"color:hsla(90,100%,30%,1.0)",lambda:"color:hsla(120,100%,40%,1.0)",hookName:"color:hsla(160,100%,30%,1.0)",string:"color:hsla(180,100%,30%,1.0)",identifier:"color:hsla(200,80%,40%,1.0)",variable:"color:hsla(200,100%,30%,1.0)",tempVariable:"color:hsla(200,70%,20%,1.0)",datatype:"color:hsla(220,100%,30%,1.0)",colour:"color:hsla(280,100%,30%,1.0)",macro:"color:hsla(320,80%,30%,1.0)",twineLink:"color:hsla(240,100%,20%,1.0)"},o=(t.gradient=t.colour,t.command=t.twineLink,t.instant=t.metadata=t.any=t.customMacro=t.macro,Math.min),n=e(40,100,50),r=e(220,100,50),i=/hsla\((\d+),\s*(\d+)%,\s*(\d+)%,\s*(\d+\.\d+)\)/g,s="cm-harlowe-3-",a=(_defineProperty(n={root:"box-sizing:border-box;",hook:n(.05),"hook-2":n(.1),"hook-3":n(.15),"hook-4":n(.2),"hook-5":n(.25),"hook-6":n(.3),"hook-7":n(.35),"hook-8":n(.4),"^=hook , ^=hook-":"font-weight:bold;",unclosedHook:n(.05)+"font-weight:bold;"},"error:not([class*='"+s+"string'])","background-color: hsla(17,100%,50%,0.5) !important;"),_defineProperty(n,"^=macroName","font-style:italic;"),_defineProperty(n,"macroName-boolean",t.boolean),_defineProperty(n,"macroName-array",t.array),_defineProperty(n,"macroName-dataset",t.dataset),_defineProperty(n,"macroName-datatype",t.datatype),_defineProperty(n,"macroName-number",t.number),_defineProperty(n,"macroName-datamap",t.datamap),_defineProperty(n,"macroName-changer",t.changer),_defineProperty(n,"macroName-string",t.string),_defineProperty(n,"macroName-colour, macroName-gradient",t.colour),_defineProperty(n,"macroName-command, macroName-instant, macroName-metadata",t.command),_defineProperty(n,"macroName-custommacro, macroName-macro, macroName-any",t.macro),_defineProperty(n,"^=macro ","font-weight:bold;"+t.macro),_defineProperty(n,"comma, spread",t.macro),_defineProperty(n,"addition",t.any),_defineProperty(n,"subtraction, multiplication, division",t.number),_defineProperty(n,"is, and, or, not, isNot, contains, doesNotContain, isIn, isA, isNotA, isNotIn, matches, doesNotMatch",t.boolean),_defineProperty(n,"bold, strong","font-weight:bold;"),_defineProperty(n,"italic, em","font-style:italic;"),_defineProperty(n,"sup","vertical-align: super;font-size:0.8em;"),_defineProperty(n,"strike","text-decoration: line-through;"),_defineProperty(n,"verbatim","background-color: hsla(0,0%,50%,0.1);font:var(--font-monospaced)"),_defineProperty(n,"^=bold, ^=strong, ^=italic, ^=em, ^=sup, ^=verbatim, ^=strike","font-weight:100; color: hsla(0,0%,0%,0.5)"),_defineProperty(n,"^=collapsed","font-weight:bold; color: hsla(201,100%,30%,1.0);"),_defineProperty(n,"unclosedCollapsed",r(.025)+"font-weight:bold; color: hsla(201,100%,30%,1.0);"),_defineProperty(n,"collapsed",r(.025)),_defineProperty(n,"collapsed.hook",r(.05)),_defineProperty(n,"collapsed.hook-2",r(.1)),_defineProperty(n,"collapsed.hook-3",r(.15)),_defineProperty(n,"collapsed.hook-4",r(.2)),_defineProperty(n,"collapsed.hook-5",r(.25)),_defineProperty(n,"collapsed.hook-6",r(.3)),_defineProperty(n,"collapsed.hook-7",r(.35)),_defineProperty(n,"collapsed.hook-8",r(.4)),_defineProperty(n,"twineLink:not(.text)",t.twineLink),_defineProperty(n,"tag, scriptStyleTag, comment","color: hsla(240,34%,25%,1.0);"),_defineProperty(n,"boolean",t.boolean),_defineProperty(n,"string",t.string),_defineProperty(n,"number",t.number),_defineProperty(n,"variable",t.variable),_defineProperty(n,"tempVariable",t.tempVariable),_defineProperty(n,"hookName",t.hookName),_defineProperty(n,"datatype",t.datatype),_defineProperty(n,"colour",t.colour),_defineProperty(n,"cssTime",t.number),_defineProperty(n,"passageString",t.variable+";text-decoration:underline 1px;"),_defineProperty(n,"tagString",t.variable+";text-decoration:underline 1px dotted;"),_defineProperty(n,"variableOccurrence, hookOccurrence","background: hsla(159,50%,75%,1.0) !important;"),_defineProperty(n,"^=where, ^=via, ^=with, ^=making, ^=each, ^=when",t.lambda+"; font-style:italic;"),_defineProperty(n,"heading","font-weight:bold;"),_defineProperty(n,"hr","background-image: linear-gradient(0deg, transparent, transparent 45%, hsla(0,0%,75%,1.0) 45%, transparent 55%, transparent);"),_defineProperty(n,"align","color: hsla(14,99%,37%,1.0); background-color: hsla(14,99%,87%,0.1);"),_defineProperty(n,"column","color: hsla(204,99%,37%,1.0); background-color: hsla(204,99%,87%,0.1);"),_defineProperty(n,"escapedLine","font-weight:bold; color: hsla(51,100%,30%,1.0);"),_defineProperty(n,"identifier, property, belongingProperty, itsProperty, belongingItProperty, belongingItOperator, possessiveOperator, belongingOperator",t.identifier),_defineProperty(n,"toString",function(){var a=this;return Object.keys(this).reduce(function(e,n){var r;return"toString"!==n&&(r=n.split(", ").map(function e(t){return-1<t.indexOf(".")?t.split(/\./g).map(e).join(""):0===t.indexOf("^=")?"[class^='"+s+t.slice(2)+"']":"."+s+t}),e+=r.join(", ")+"{"+a[n]+"}",a[n].match(i))&&[".theme-dark","[data-app-theme=dark]"].forEach(function(t){e+=r.map(function(e){return t+" "+e}).join(", ")+"{"+a[n].replace(i,function(e,t,n,r,a){return"hsla("+t+","+o(100,1.5*+n)+"%,"+(100-r)+"%,"+a+")"})+"}"}),e},"")}),n+"");"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports={Colours:t,CSS:a,versionClass:s}:"function"==typeof define&&define.amd&&define("utils/typecolours",[],function(){return{Colours:t,CSS:a,versionClass:s}})}.call(void 0);
;require("harlowe")}());
</script>

</body>
</html>
